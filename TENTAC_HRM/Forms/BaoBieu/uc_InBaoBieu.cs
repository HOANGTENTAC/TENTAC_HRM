using System;
using System.Data;
using System.Data.SqlClient;
using System.Drawing;
using System.Globalization;
using System.Runtime.InteropServices;
using System.Threading;
using System.Windows.Forms;
using TENTAC_HRM.Models.BaoBieuModel;
using TENTAC_HRM.BLL.BaoBieuBLL;
using TENTAC_HRM.BLL.ChamCongBLL;
using TENTAC_HRM.BLL.QuanLyNhanVienBLL;
using TENTAC_HRM.Models.ChamCongModel;
using TENTAC_HRM.Common;
using TENTAC_HRM.BLL.DuLieuMayChamCongBLL;
using TENTAC_HRM.Models.QuanLyNhanVienModel;
using TENTAC_HRM.Forms.Common;
using TENTAC_HRM.Models;
using Excel = Microsoft.Office.Interop.Excel;
using TENTAC_HRM.BLL.BLL.ChamCongBLL;
using System.Linq;

namespace TENTAC_HRM.Forms.BaoBieu
{
    public partial class uc_InBaoBieu : UserControl
    {
        //private byte[] imageData;

        private ConvertMoney _convertMoney = new ConvertMoney();

        private CongTyBLL _congTyBLL = new CongTyBLL();

        private CongTyModel _congTyDTO = new CongTyModel();

        private KhuVucModel _khuVucDTO = new KhuVucModel();

        private KhuVucBLL _khuVucBLL = new KhuVucBLL();

        private PhongBanModel _phongBanDTO = new PhongBanModel();

        private PhongBanBLL _phongBanBLL = new PhongBanBLL();

        private ChucVuModel _chucVuDTO = new ChucVuModel();

        private ChucVuBLL _chucVuBLL = new ChucVuBLL();

        private NhanVienBLL _nhanVienBLL = new NhanVienBLL();

        private NhanVienModel _nhanVienDTO = new NhanVienModel();

        private KyHieuChamCongModel _kyHieuChamCongDTO = new KyHieuChamCongModel();

        private KyHieuChamCongBLL _kyHieuChamCongBLL = new KyHieuChamCongBLL();

        private Models.ChamCongModel.TuyChonModel _tuyChonDTO = new Models.ChamCongModel.TuyChonModel();

        private TuyChonBLL _tuyChonBLL = new TuyChonBLL();

        private ChiTietTamUngLuongModel _chiTietTamUngLuongDTO = new ChiTietTamUngLuongModel();

        private ChiTietTamUngLuongBLL _chiTietTamUngLuongBLL = new ChiTietTamUngLuongBLL();

        private ChiTietPhuCapNhanVienBLL _chiTietPhuCapNhanVienBLL = new ChiTietPhuCapNhanVienBLL();

        private ChiTietPhuCapNhanVienModel _chiTietPhuCapNhanVienDTO = new ChiTietPhuCapNhanVienModel();

        private ViPhamModel _viPhamDTO = new ViPhamModel();

        private ViPhamBLL _viPhamBLL = new ViPhamBLL();

        private ThuongModel _thuongDTO = new ThuongModel();

        private ThuongBLL _thuongBLL = new ThuongBLL();

        private NgayLeModel _ngayLeDTO = new NgayLeModel();

        private NgayLeBLL _ngayLeBLL = new NgayLeBLL();

        private ChiTietDiCongTacModel _chiTietDiCongTacDTO = new ChiTietDiCongTacModel();

        private ChiTietDiCongTacBLL _chiTietDiCongTacBLL = new ChiTietDiCongTacBLL();

        private PhepNamModel _phepNamDTO = new PhepNamModel();

        private PhepNamBLL _phepNamBLL = new PhepNamBLL();

        private KhaiBaoVangChoNhanVienModel _khaiBaoVangChoNhanVienDTO = new KhaiBaoVangChoNhanVienModel();

        private KhaiBaoVangChoNhanVienBLL _khaiBaoVangChoNhanVienBLL = new KhaiBaoVangChoNhanVienBLL();

        private CacLoaiVangModel _cacLoaiVangDTO = new CacLoaiVangModel();

        private CacLoaiVangBLL _cacLoaiVangBLL = new CacLoaiVangBLL();

        private SapXepLichTrinhChoNhanVienModel _sapxepLichTrinhChoNhanVienDTO = new SapXepLichTrinhChoNhanVienModel();

        private SapXepLichTrinhChoNhanVienBLL _sapXepLichTrinhChoNhanVienBLL = new SapXepLichTrinhChoNhanVienBLL();

        private Models.LichTrinhVaoRaModel _lichTrinhVaoRaDTO = new Models.LichTrinhVaoRaModel();

        private LichTrinhVaoRaBLL _lichTrinhVaoRaBLL = new LichTrinhVaoRaBLL();

        private CheckInOutModel _checkInOutDTO = new CheckInOutModel();

        private CheckInOut_BLL _checkInOutBLL = new CheckInOut_BLL();

        private ChiTietLichTrinhChoCaLamViecBLL _chiTietLichTrinhChoCaLamViecBLL = new ChiTietLichTrinhChoCaLamViecBLL();

        private ChiTietLichTrinhChoCaLamViecModel _chiTietLichTrinhChoCalamViecDTO = new ChiTietLichTrinhChoCaLamViecModel();

        private CaLamViecBLL _caLamViecBLL = new CaLamViecBLL();

        private CaLamViecModel _caLamViecDTO = new CaLamViecModel();

        private PhanTheoGioBLL _phanTheoGioBLL = new PhanTheoGioBLL();

        private PhanTheoGioModel _phanTheoGioDTO = new PhanTheoGioModel();

        private SqlConnection con;

        private SqlDataAdapter da;

        private SqlCommand cmd;

        private DataSet ds;

        protected static string strConnect;

        public string _sAn;

        private string sTenCongTyReport;

        private string sDiaChiCongTyReport;

        private NgayTinhCongBLL _ngayTinhCongBLL = new NgayTinhCongBLL();

        private NgayTinhCongModel _ngayTinhCongDTO = new NgayTinhCongModel();

        private string sTongNgayTinh;

        private string sMaChamCong;

        private string sMaNhanVien;

        private string sTenNhanVien;

        private string sGioVao;

        private string sGioRa;

        private string sMaKyHieu;

        private string sDungGio;

        private string sVang;

        private string sNgayVaoLamViec;

        private string sPhongBanTinhCong;

        private string sKHMaKyHieu;

        private string sKHDiTre;

        private string sKHVeSom;

        private string sKHDungGio;

        private string sKHTangCa;

        private string sKHThieuGioVao;

        private string sKHThieuGioRa;

        private string sKHVang;

        private string sKHChuaXepCa;

        private string sKHPhepNam;

        private string sKHLe;

        private string sKHCongTac;

        private string sKHVeTre;

        private string sKHCuoiTuan;

        private string sKiemTraMin;

        private string sKiemTraMax;

        private int iLuaChon;

        private int demNhanVienVangTinhCong;

        private int demNhanVienNghiLeTinhCong;

        private string sID;

        private string sMaLichTrinhCalamViec;

        private string sThu;

        private string sCaThu1;

        private string sCaThu2;

        private string sCaThu3;

        private string sCaThu4;

        private string sCaThu5;

        private string sCaThu6;

        private string sCaThu7;

        private string sCaThu8;

        private string sCaThu9;

        private string sCaThu10;

        private string sFiloTenCaLamViec;

        private string sFiloMaCaLamViec;

        private string sTuDongQuaDemMaCaLamViec;

        private string sTuDongQuaDemTenCaLamViec;

        private string sChonTuMayMaCaLamViec;

        private string sChonTuMayTenCaLamViec;

        private string sTheoIDMayMaCaLamViec;

        private string sTheoIDMayTenCaLamViec;

        private string sTinhTheoGioTenCaLamViec;

        private string sTinhTheoGioMaCaLamViec;

        private string sPhanTheoGioTenCaLamViec;

        private string sPhanTheoGioMaCaLamViec;

        private double dTongTienPhuCap;

        private double dTongTienPhuCapTienCom;

        private double dTongTienPhuCapKhac;

        private double dTongTienTamUng;

        private double dTongTienViPham;

        private double dTongTienThuong;

        private int iDemCuoiTuan;

        private TinhCongBLL _tinhCongBLL = new TinhCongBLL();

        private TinhCongModel _tinhCongDTO = new TinhCongModel();

        private TinhLuongModel _tinhLuongDTO = new TinhLuongModel();

        private TinhLuongBLL _tinhLuongBLL = new TinhLuongBLL();

        private ChiTietCongTruLuongModel _chiTietCongTruLuongDTO = new ChiTietCongTruLuongModel();

        private ChiTietCongTruLuongBLL _chiTietCongTruLuongBLL = new ChiTietCongTruLuongBLL();

        private LichTrinhChoCaLamViecModel _lichTrinhChoCaLamViecDTO = new LichTrinhChoCaLamViecModel();

        private LichTrinhChoCaLamViecBLL _lichTrinhChoCaLamViecBLL = new LichTrinhChoCaLamViecBLL();

        private ChiTietDangKyTangCaBLL _chiTietDangKyTangCaBLL = new ChiTietDangKyTangCaBLL();

        private ChiTietDangKyTangCaModel _chiTietDangKyTangCaDTO = new ChiTietDangKyTangCaModel();

        public int iDemNhanVienDuocChon;

        private int iLamTronCong;

        private int iLamTronGio;

        private string sDinhDangThoiGian;

        private string sLuaChonKhaiBaoLuongBaoHiem;

        private double dTangCa1HeSo;

        private double dTangCa2HeSo;

        private double dTangCa3HeSo;

        private double dTangCa4HeSo;

        private double dSoTienKhaiBao;

        private double dTangCaChuNhatHeSo;

        private double dHeSoBaoHiemXaHoi;

        private double dHeSoBaoHiemYTe;

        private double dHeSoBaoHiemThatNghiep;

        private int iLamTronTuA;

        private int iLamTronDenA;

        private int iLamTronTuB;

        private int iLamTronDenB;

        private int iLamTronTuC;

        private int iLamTronDenC;

        private int iLamTronTuD;

        private int iLamTronDenD;

        private string sLamTronA;

        private string sLamTronB;

        private string sLamTronC;

        private string sLamTronD;

        private string sMaChamCongSuaXoaGioCham;

        private string sNgayChamSuaXoaGioCham;

        private string sGioChamSuaXoaGioCham;

        private string sKieuChamSuaXoaGioCham;

        private string sMaSoMaySuaXoaGioCham;

        private string sIDSuaXoaGioCham;

        private string _tenNode;

        private string sMaPhongBanTreeView;

        private string sMaCongTyTreeView;

        private string sMaKhuVucTreeView;

        private string sMaChucVuTreeView;

        private string sDanhSachNhanVienMoi;

        private string sNghiViecTamThoi;

        private int iChonLanXuat;

        private int demProcess = -1;

        private int testProcess;

        private string sTuNgayChiTietThoiGianLamViec;

        private string sDenNgayChiTietThoiGianLamViec;

        private string sMaChamCongThemGio;

        private DateTime dNgayChamCongThemGio = default(DateTime);

        private DateTime dGioChamVaoThemGio = default(DateTime);

        private DateTime dGioChamRaThemGio = default(DateTime);

        private DateTime dGioChamVaoThemGioCheck = default(DateTime);

        private DateTime dGioChamRaThemGioCheck = default(DateTime);

        private int iCheckTrongVao;

        private int iCheckTrongRa;

        private int iCheckCaDem;

        private DateTime dNgayCham = default(DateTime);

        private DateTime dGioCham = default(DateTime);

        private string sKieuChamSuaGio;

        private int iMaSoMaySuaGioA;

        private int sIDSuaGio;
        public int[] IdPermision { get; set; }
        public uc_InBaoBieu(int[] permissions = null)
        {
            IdPermision = permissions;
            InitializeComponent();
        }

        private void frmTinhCongVaInBaoBieu_Load(object sender, EventArgs e)
        {
            xuatThuTuNgay();
            xuatThuDenNgay();
            loadTreeView();
            DGVDanhSachNhanVien.Columns.Insert(0, new DataGridViewCheckBoxColumn());
            DGVDanhSachNhanVien.Columns[0].Width = 30;
            ngayTinhCong();
            loadControlTinhCong();
            loadControlTinhLuong();
            //loadTuyChon();
            //loadListViewBaoCao();
            loadThongTinCongTy();
        }

        private void loadThongTinCongTy()
        {
            new DataTable();
            _congTyDTO.MaCongTy = "CT00001";
            DataTable dtloadThongTinCongTy;
            dtloadThongTinCongTy = _congTyBLL.showThongTinCongTy(_congTyDTO);
            for (int iLoadThongTinCongTy = 0; iLoadThongTinCongTy < dtloadThongTinCongTy.Rows.Count; iLoadThongTinCongTy++)
            {
                sTenCongTyReport = dtloadThongTinCongTy.Rows[iLoadThongTinCongTy]["TenCongTy"].ToString();
                sDiaChiCongTyReport = dtloadThongTinCongTy.Rows[iLoadThongTinCongTy]["DiaChi"].ToString();
            }
            new DataTable();
            _kyHieuChamCongDTO.MaKyHieu = "KH00001";
            DataTable dtKyHieu;
            dtKyHieu = _kyHieuChamCongBLL.showLoadKyHieuChamCong(_kyHieuChamCongDTO);
            for (int _kyHieu = 0; _kyHieu < dtKyHieu.Rows.Count; _kyHieu++)
            {
                sKHDiTre = dtKyHieu.Rows[_kyHieu]["DiTre"].ToString();
                sKHVeSom = dtKyHieu.Rows[_kyHieu]["VeSom"].ToString();
                sKHDungGio = dtKyHieu.Rows[_kyHieu]["DungGio"].ToString();
                sKHTangCa = dtKyHieu.Rows[_kyHieu]["TangCa"].ToString();
                sKHThieuGioVao = dtKyHieu.Rows[_kyHieu]["ThieuGioVao"].ToString();
                sKHThieuGioRa = dtKyHieu.Rows[_kyHieu]["ThieuGioRa"].ToString();
                sKHVang = dtKyHieu.Rows[_kyHieu]["Vang"].ToString();
                sKHChuaXepCa = dtKyHieu.Rows[_kyHieu]["ChuaXepCa"].ToString();
                sKHPhepNam = dtKyHieu.Rows[_kyHieu]["PhepNam"].ToString();
                sKHLe = dtKyHieu.Rows[_kyHieu]["Le"].ToString();
                sKHCongTac = dtKyHieu.Rows[_kyHieu]["CongTac"].ToString();
                sKHVeTre = dtKyHieu.Rows[_kyHieu]["VeTre"].ToString();
                sKHCuoiTuan = dtKyHieu.Rows[_kyHieu]["CuoiTuan"].ToString();
            }
        }

        private void ngayTinhCong()
        {
            dateTimeTuNgay.Text = DateTime.Now.ToString();
            dateTimeDenNgay.Text = DateTime.Now.ToString();
        }

        private void loadTreeView()
        {
            DataTable dtCongTy = _congTyBLL.showThongTinCongTy(_congTyDTO);
            for (int i = 0; i < dtCongTy.Rows.Count; i++)
            {
                TreeNode treeCongTy = new TreeNode()
                {
                    Text = dtCongTy.Rows[i][1].ToString(),
                    Tag = dtCongTy.Rows[i][0].ToString()
                };
                treeViewSoDoQuanLy.Nodes.Add(treeCongTy);
                _khuVucDTO.MaCongTy = dtCongTy.Rows[i]["MaCongTy"].ToString();
                DataTable dtKhuVuc = _khuVucBLL.GETKHUVUCTREEVIEW(_khuVucDTO);
                for (int j = 0; j < dtKhuVuc.Rows.Count; j++)
                {
                    TreeNode treeKhuVuc = new TreeNode()
                    {
                        Text = dtKhuVuc.Rows[j][2].ToString(),
                        Tag = dtKhuVuc.Rows[j][0].ToString()
                    };
                    treeViewSoDoQuanLy.Nodes[i + 0].Nodes.Add(treeKhuVuc);
                    _phongBanDTO.MaKhuVuc = dtKhuVuc.Rows[j]["MaKhuVuc"].ToString();
                    DataTable dtPhongBan = _phongBanBLL.GETPHONGBANTREEVIEW(_phongBanDTO);

                    for (int z = 0; z < dtPhongBan.Rows.Count; z++)
                    {
                        TreeNode treePhongBan = new TreeNode()
                        {
                            Text = dtPhongBan.Rows[z][3].ToString(),
                            Tag = dtPhongBan.Rows[z][0].ToString()
                        };

                        treeViewSoDoQuanLy.Nodes[i + 0].Nodes[j].Nodes.Add(treePhongBan);
                        _chucVuDTO.MaPhongBan = dtPhongBan.Rows[z]["MaPhongBan"].ToString();
                        DataTable dtChucVu = _chucVuBLL.GETCHUCVUTREEVIEW(_chucVuDTO);
                        for (int v = 0; v < dtChucVu.Rows.Count; v++)
                        {
                            TreeNode treeChucVu = new TreeNode()
                            {
                                Text = dtChucVu.Rows[v][4].ToString(),
                                Tag = dtChucVu.Rows[v][0].ToString()
                            };

                            treeViewSoDoQuanLy.Nodes[i + 0].Nodes[j].Nodes[z].Nodes.Add(treeChucVu);
                            _chucVuDTO.MaChucVu = dtChucVu.Rows[v]["MaChucVu"].ToString();
                        }
                    }
                }
            }
        }

        private void MenuChonTatCa_Click(object sender, EventArgs e)
        {
            bool _selectAllNhanVien;
            _selectAllNhanVien = 0 == 0;
            if (_selectAllNhanVien)
            {
                for (int iNhanVienMoi = 0; iNhanVienMoi < DGVDanhSachNhanVien.Rows.Count; iNhanVienMoi++)
                {
                    DGVDanhSachNhanVien.Rows[iNhanVienMoi].Cells[0].Value = _selectAllNhanVien;
                }
            }
        }

        private void MenuBoChonTatCa_Click(object sender, EventArgs e)
        {
            bool _selectAllNhanVien;
            _selectAllNhanVien = 1 == 0;
            if (!_selectAllNhanVien)
            {
                for (int iNhanVienMoi = 0; iNhanVienMoi < DGVDanhSachNhanVien.Rows.Count; iNhanVienMoi++)
                {
                    DGVDanhSachNhanVien.Rows[iNhanVienMoi].Cells[0].Value = _selectAllNhanVien;
                }
            }
        }

        private void btnTinhToan_Click(object sender, EventArgs e)
        {
            this.iDemNhanVienDuocChon = 0;
            this.tabControl2.SelectedTabIndex = 0;
            this._tinhCongBLL.TinhCongDelete(this._tinhCongDTO);
            this._tinhLuongBLL.TinhLuongDelete();
            this._chiTietCongTruLuongBLL.ChiTietCongTruLuongDelete();
            DataTable dt_ca = SQLHelper.ExecuteDt($"select * from MITACOSQL.dbo.BangXepCa where Nam = '{dateTimeTuNgay.Value.Year}' and Thang = '{dateTimeTuNgay.Value.Month}'");
            int TestDemNhanVien;
            TestDemNhanVien = 0;
            for (int iTestDemNhanVien = 0; iTestDemNhanVien < this.DGVDanhSachNhanVien.Rows.Count; iTestDemNhanVien++)
            {
                if (Convert.ToBoolean(this.DGVDanhSachNhanVien[0, iTestDemNhanVien].Value))
                {
                    TestDemNhanVien++;
                    this.iDemNhanVienDuocChon++;
                }
            }
            this.loadTuyChon();
            new DataTable();
            this._kyHieuChamCongDTO.MaKyHieu = "KH00001";
            DataTable dtKyHieu;
            dtKyHieu = this._kyHieuChamCongBLL.showLoadKyHieuChamCong(this._kyHieuChamCongDTO);
            for (int _kyHieu = 0; _kyHieu < dtKyHieu.Rows.Count; _kyHieu++)
            {
                this.sKHDiTre = dtKyHieu.Rows[_kyHieu]["DiTre"].ToString();
                this.sKHVeSom = dtKyHieu.Rows[_kyHieu]["VeSom"].ToString();
                this.sKHDungGio = dtKyHieu.Rows[_kyHieu]["DungGio"].ToString();
                this.sKHTangCa = dtKyHieu.Rows[_kyHieu]["TangCa"].ToString();
                this.sKHThieuGioVao = dtKyHieu.Rows[_kyHieu]["ThieuGioVao"].ToString();
                this.sKHThieuGioRa = dtKyHieu.Rows[_kyHieu]["ThieuGioRa"].ToString();
                this.sKHVang = dtKyHieu.Rows[_kyHieu]["Vang"].ToString();
                this.sKHChuaXepCa = dtKyHieu.Rows[_kyHieu]["ChuaXepCa"].ToString();
                this.sKHPhepNam = dtKyHieu.Rows[_kyHieu]["PhepNam"].ToString();
                this.sKHLe = dtKyHieu.Rows[_kyHieu]["Le"].ToString();
                this.sKHCongTac = dtKyHieu.Rows[_kyHieu]["CongTac"].ToString();
                this.sKHVeTre = dtKyHieu.Rows[_kyHieu]["VeTre"].ToString();
                this.sKHCuoiTuan = dtKyHieu.Rows[_kyHieu]["CuoiTuan"].ToString();
            }
            new DataTable();
            DataTable _dtNgayTinhCong;
            _dtNgayTinhCong = this._ngayTinhCongBLL.showThongTinNgayTinhCong();
            if (_dtNgayTinhCong.Rows.Count == 0)
            {
                this._ngayTinhCongDTO.ID = 1;
                this._ngayTinhCongDTO.NgayBatDau = Convert.ToDateTime(this.dateTimeTuNgay.Value);
                this._ngayTinhCongDTO.NgayKetThuc = Convert.ToDateTime(this.dateTimeDenNgay.Value);
                this._ngayTinhCongBLL.Insert_NgayTinhCong(this._ngayTinhCongDTO);
            }
            if (_dtNgayTinhCong.Rows.Count == 1)
            {
                this._ngayTinhCongDTO.ID = 1;
                this._ngayTinhCongDTO.NgayBatDau = Convert.ToDateTime(this.dateTimeTuNgay.Value);
                this._ngayTinhCongDTO.NgayKetThuc = Convert.ToDateTime(this.dateTimeDenNgay.Value);
                this._ngayTinhCongBLL.Update_NgayTinhCong(this._ngayTinhCongDTO);
            }
            this.DGVChiTietLuong.Rows.Clear();
            this.DGVTinhCong.Rows.Clear();
            this.DGVSuaXoaGioCham.Rows.Clear();
            this.sTongNgayTinh = Convert.ToInt32((this.dateTimeDenNgay.Value - this.dateTimeTuNgay.Value).TotalDays).ToString();
            if (Convert.ToInt32(this.sTongNgayTinh) < 0)
            {
                MessageBox.Show("Xin chọn lại ngày");
                return;
            }
            frm_LoadTinhCong _loadTinhCong;
            _loadTinhCong = new frm_LoadTinhCong();
            _loadTinhCong.Show();
            int demNhanVienDuocChon;
            demNhanVienDuocChon = 0;
            int demProcess;
            demProcess = -1;
            int testProcess;
            testProcess = TestDemNhanVien;

            var DanhSachNhanVien_check = (from DataGridViewRow r in DGVDanhSachNhanVien.Rows
                                 where Convert.ToBoolean(r.Cells[0].Value) == true
                                 select r).ToList();

            for (int abc = 0; abc < DanhSachNhanVien_check.Count; abc++)
            {
                int iKiemTraNhanVien;
                iKiemTraNhanVien = 0;
                this.iDemCuoiTuan = 0;
                int dem;
                dem = 0;
                string sLTVRNhanVien;
                sLTVRNhanVien = "";
                string sLTCCLVNhanVien;
                sLTCCLVNhanVien = "";
                int iChonLichTrinh;
                iChonLichTrinh = 0;
                int iThoiGianNhoNhat;
                iThoiGianNhoNhat = 0;
                int iThoiGianLonNhat;
                iThoiGianLonNhat = 0;
                int iKhoangCachGiuaHaiCapVaoRa;
                iKhoangCachGiuaHaiCapVaoRa = 0;
                int iCheckCaDemThangTruoc;
                iCheckCaDemThangTruoc = 0;
                bool bCheckGioRaCaTruoc;
                bCheckGioRaCaTruoc = false;
                DateTime dTuGioLoc;
                dTuGioLoc = default(DateTime);
                DateTime dDenGioLoc;
                dDenGioLoc = default(DateTime);
                int iChuKyKiemTra;
                iChuKyKiemTra = 0;
                if (!Convert.ToBoolean(DanhSachNhanVien_check[abc].Cells[0].Value))
                {
                    continue;
                }
                int demSapXep;
                demSapXep = 0;
                this.dTongTienPhuCap = 0.0;
                this.dTongTienPhuCapTienCom = 0.0;
                this.dTongTienPhuCapKhac = 0.0;
                this.dTongTienTamUng = 0.0;
                this.dTongTienViPham = 0.0;
                this.dTongTienThuong = 0.0;
                this.demNhanVienNghiLeTinhCong = 0;
                this.demNhanVienVangTinhCong = 0;
                this.sMaChamCong = DanhSachNhanVien_check[abc].Cells[3].Value.ToString();
                this.sMaNhanVien = DanhSachNhanVien_check[abc].Cells[1].Value.ToString();
                this.sTenNhanVien = DanhSachNhanVien_check[abc].Cells[2].Value.ToString();
                this.sPhongBanTinhCong = DanhSachNhanVien_check[abc].Cells[7].Value.ToString();
                _loadTinhCong.lbTenNhanVien.Text = "Nhân viên: " + this.sTenNhanVien;
                Application.DoEvents();
                new DataTable();
                this._sapxepLichTrinhChoNhanVienDTO.MaChamCong = Convert.ToInt32(this.sMaChamCong);
                DataTable dtSapXepLichTrinh;
                dtSapXepLichTrinh = this._sapXepLichTrinhChoNhanVienBLL.get_SapXepLichTrinhChoNhanVienByMaChamCong(Convert.ToInt32(this.sMaChamCong));
                for (int iSapXepLichTrinh = 0; iSapXepLichTrinh < dtSapXepLichTrinh.Rows.Count; iSapXepLichTrinh++)
                {
                    sLTVRNhanVien = dtSapXepLichTrinh.Rows[iSapXepLichTrinh]["MaLichTrinhVaoRa"].ToString();
                    new DataTable();
                    this._lichTrinhVaoRaDTO.MaLichTrinhVaoRa = sLTVRNhanVien;
                    DataTable dtLichTrinhVaoRa;
                    dtLichTrinhVaoRa = this._lichTrinhVaoRaBLL.get_LichTrinhVaoRaByMaLichTrinhVaoRa(sLTVRNhanVien);
                    for (int iLichTrinhVaoRa = 0; iLichTrinhVaoRa < dtLichTrinhVaoRa.Rows.Count; iLichTrinhVaoRa++)
                    {
                        dtLichTrinhVaoRa.Rows[iLichTrinhVaoRa]["TenLichTrinhVaoRa"].ToString();
                        iChonLichTrinh = Convert.ToInt32(dtLichTrinhVaoRa.Rows[iLichTrinhVaoRa]["ChonLichTrinhVaoRa"].ToString());
                        dtLichTrinhVaoRa.Rows[iLichTrinhVaoRa]["MotLanChamCong"].ToString();
                        dtLichTrinhVaoRa.Rows[iLichTrinhVaoRa]["LoaiBoGio"].ToString();
                        dtLichTrinhVaoRa.Rows[iLichTrinhVaoRa]["TuGio"].ToString();
                        dtLichTrinhVaoRa.Rows[iLichTrinhVaoRa]["DenGio"].ToString();
                        iThoiGianNhoNhat = Convert.ToInt32(dtLichTrinhVaoRa.Rows[iLichTrinhVaoRa]["ThoiGianNhoNhat"].ToString());
                        iThoiGianLonNhat = Convert.ToInt32(dtLichTrinhVaoRa.Rows[iLichTrinhVaoRa]["ThoiGianLonNhat"].ToString());
                        iKhoangCachGiuaHaiCapVaoRa = Convert.ToInt32(dtLichTrinhVaoRa.Rows[iLichTrinhVaoRa]["KhoangCachGiuaHaiCapVaoRa"].ToString());
                        if (dtLichTrinhVaoRa.Rows[iLichTrinhVaoRa]["LoaiBoGio"].ToString() == "True")
                        {
                            dTuGioLoc = Convert.ToDateTime(dtLichTrinhVaoRa.Rows[iLichTrinhVaoRa]["TuGio"].ToString());
                            dDenGioLoc = Convert.ToDateTime(dtLichTrinhVaoRa.Rows[iLichTrinhVaoRa]["DenGio"].ToString());
                            bCheckGioRaCaTruoc = true;
                        }
                    }
                    sLTCCLVNhanVien = dtSapXepLichTrinh.Rows[iSapXepLichTrinh]["MaLichTrinhCaLamViec"].ToString();
                    new DataTable();
                    this._chiTietLichTrinhChoCalamViecDTO.MaLichTrinhCaLamViec = sLTCCLVNhanVien;
                    DataTable dtChiTietLichTrinhChoCalamViec;
                    dtChiTietLichTrinhChoCalamViec = this._chiTietLichTrinhChoCaLamViecBLL.ChiTietLichTrinhChoCaLamViecgetByMaLichTrinhCalamViec(sLTCCLVNhanVien);
                    for (int iChiTietLichTrinhChoCaLamViec = 0; iChiTietLichTrinhChoCaLamViec < dtChiTietLichTrinhChoCalamViec.Rows.Count; iChiTietLichTrinhChoCaLamViec++)
                    {
                        new DataTable();
                        this._lichTrinhChoCaLamViecDTO.MaLichTrinhCaLamViec = dtChiTietLichTrinhChoCalamViec.Rows[iChiTietLichTrinhChoCaLamViec]["MaLichTrinhCaLamViec"].ToString();
                        DataTable dtTestChuKy;
                        dtTestChuKy = this._lichTrinhChoCaLamViecBLL.get_LichTrinhChoCaLamViecByMaLichTrinhCaLamViec(dtChiTietLichTrinhChoCalamViec.Rows[iChiTietLichTrinhChoCaLamViec]["MaLichTrinhCaLamViec"].ToString());
                        for (int iTestChuKy = 0; iTestChuKy < dtTestChuKy.Rows.Count; iTestChuKy++)
                        {
                            iChuKyKiemTra = Convert.ToInt32(dtTestChuKy.Rows[iTestChuKy]["ChuKy"].ToString());
                        }
                    }
                    demSapXep++;
                }
                this.sNgayVaoLamViec = DanhSachNhanVien_check[abc].Cells[4].Value.ToString();
                for (int _tongNgay = 0; _tongNgay <= Convert.ToInt32(this.sTongNgayTinh); _tongNgay++)
                {
                    int iTinhBuTru;
                    iTinhBuTru = 0;
                    int kiemTraVao;
                    kiemTraVao = 0;
                    int kiemTraRa;
                    kiemTraRa = 0;
                    int _nhanVien;
                    _nhanVien = this.DGVTinhCong.Rows.Add();
                    this.DGVTinhCong.Rows[_nhanVien].Cells[0].Value = this.sMaNhanVien;
                    this.DGVTinhCong.Rows[_nhanVien].Cells[1].Value = this.sTenNhanVien;
                    DateTime dt;
                    dt = this.dateTimeTuNgay.Value;
                    DateTime dtDinhDang;
                    dtDinhDang = Convert.ToDateTime(dt.AddDays(dem).ToString());
                    string sNgayChamChuKyThang;
                    sNgayChamChuKyThang = dtDinhDang.Day.ToString();
                    string sNgayCham;
                    sNgayCham = $"{dtDinhDang:yyyy/MM/dd}";
                    string sThu;
                    sThu = DateTimeProgress.Test((int)dt.AddDays(dem).DayOfWeek);
                    if (iChuKyKiemTra == 1)
                    {
                        sThu = DateTimeProgress.Test((int)dt.AddDays(dem).DayOfWeek);
                    }
                    if (iChuKyKiemTra == 2)
                    {
                        sThu = sNgayChamChuKyThang;
                    }
                    this.DGVTinhCong.Rows[_nhanVien].Cells[2].Value = $"{dtDinhDang:yyyy/MM/dd}";
                    string sNhanCaLamViecTheoThang;
                    sNhanCaLamViecTheoThang = "";
                    int iLichTrinhThang;
                    iLichTrinhThang = 0;
                    new DataTable();
                    this._chiTietDangKyTangCaDTO.MaChamCong = Convert.ToInt32(this.sMaChamCong);
                    this._chiTietDangKyTangCaDTO.Ngay = Convert.ToDateTime(Convert.ToDateTime(this.DGVTinhCong.Rows[_nhanVien].Cells[2].Value.ToString()));
                    DataTable dtKiemTraCaDem;
                    dtKiemTraCaDem = this._chiTietDangKyTangCaBLL.ChiTietDangKyTangCaGetByMaChamCongAndNgay(Convert.ToInt32(this.sMaChamCong), Convert.ToDateTime(Convert.ToDateTime(this.DGVTinhCong.Rows[_nhanVien].Cells[2].Value.ToString())));
                    for (int iDangKy = 0; iDangKy < dtKiemTraCaDem.Rows.Count; iDangKy++)
                    {
                        dtKiemTraCaDem.Rows[iDangKy]["TrangThai"].ToString();
                        iLichTrinhThang++;
                        sNhanCaLamViecTheoThang = dtKiemTraCaDem.Rows[iDangKy]["TrangThai"].ToString();
                        iChonLichTrinh = 5;
                    }
                    int iKiemTraSapXepCa;
                    iKiemTraSapXepCa = 0;
                    string ca = dt_ca.Rows.Cast<DataRow>().Where(x => x["MaChamCong"].ToString() == int.Parse(sMaNhanVien.Remove(0, 2)).ToString()).Select(x => x["D" + dtDinhDang.Day].ToString()).FirstOrDefault();
                    if (demSapXep > 0)
                    {
                        if (iChonLichTrinh == 1)
                        {
                            int iKiemTraLanChamLichTrinhVaoRa;
                            iKiemTraLanChamLichTrinhVaoRa = 0;
                            int iKiemTraLanChamKhoangCachTuDongQuaDemLichTrinhVaoRa;
                            iKiemTraLanChamKhoangCachTuDongQuaDemLichTrinhVaoRa = 0;
                            DateTime dGioVaoTuDongQuaDemKiemTraLichTrinhVaoRa;
                            dGioVaoTuDongQuaDemKiemTraLichTrinhVaoRa = default(DateTime);
                            DateTime dGioRaTuDongQuaDemKiemTraLichTrinhVaoRa;
                            dGioRaTuDongQuaDemKiemTraLichTrinhVaoRa = default(DateTime);
                            int iLanCham;
                            iLanCham = 1;
                            int addChonTuMay;
                            addChonTuMay = 0;
                            int iKiemTra;
                            iKiemTra = 0;
                            int iKiemTraB;
                            iKiemTraB = 0;
                            DateTime dGioVaoChonTuMay;
                            dGioVaoChonTuMay = default(DateTime);
                            new DataTable();
                            DataTable dtChonTuMay;
                            dtChonTuMay = this._checkInOutBLL.getCheckInOutByMaChamCongAndNgayCham(Convert.ToInt32(this.sMaChamCong), Convert.ToDateTime(this.DGVTinhCong.Rows[_nhanVien].Cells[2].Value.ToString()));
                            for (int iChonTuMay = 0; iChonTuMay < dtChonTuMay.Rows.Count; iChonTuMay++)
                            {
                                iKiemTraLanChamLichTrinhVaoRa++;
                                if (iKiemTraLanChamLichTrinhVaoRa == 1)
                                {
                                    dGioVaoTuDongQuaDemKiemTraLichTrinhVaoRa = Convert.ToDateTime(dtChonTuMay.Rows[iChonTuMay]["GioCham"].ToString());
                                    if (dtChonTuMay.Rows.Count > 2 && iKiemTraLanChamKhoangCachTuDongQuaDemLichTrinhVaoRa == 3)
                                    {
                                        if (Convert.ToInt32(Convert.ToInt32((dGioVaoTuDongQuaDemKiemTraLichTrinhVaoRa - dGioRaTuDongQuaDemKiemTraLichTrinhVaoRa).TotalMinutes).ToString()) < iKhoangCachGiuaHaiCapVaoRa)
                                        {
                                            iKiemTraLanChamLichTrinhVaoRa = 0;
                                            continue;
                                        }
                                        iKiemTraLanChamLichTrinhVaoRa = 1;
                                    }
                                }
                                if (iKiemTraLanChamLichTrinhVaoRa == 2)
                                {
                                    dGioRaTuDongQuaDemKiemTraLichTrinhVaoRa = Convert.ToDateTime(dtChonTuMay.Rows[iChonTuMay]["GioCham"].ToString());
                                    if (Convert.ToInt32(Convert.ToInt32((dGioRaTuDongQuaDemKiemTraLichTrinhVaoRa - dGioVaoTuDongQuaDemKiemTraLichTrinhVaoRa).TotalMinutes).ToString()) < iThoiGianNhoNhat)
                                    {
                                        iKiemTraLanChamLichTrinhVaoRa = 1;
                                        continue;
                                    }
                                }
                                DateTime dateGioChamChonTuMay;
                                dateGioChamChonTuMay = Convert.ToDateTime(dtChonTuMay.Rows[iChonTuMay]["GioCham"].ToString());
                                if (Convert.ToInt32(dtChonTuMay.Rows[iChonTuMay]["KieuCham"].ToString()) == 0)
                                {
                                    if (iLanCham == 1)
                                    {
                                        dGioVaoChonTuMay = Convert.ToDateTime(dateGioChamChonTuMay.ToString());
                                        this.DGVTinhCong.Rows[_nhanVien].Cells[4].Value = ca;
                                        this.DGVTinhCong.Rows[_nhanVien].Cells[5].Value = string.Format(this.sDinhDangThoiGian, dGioVaoChonTuMay);
                                        this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = "0";
                                        this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = "0";
                                        this.DGVTinhCong.Rows[_nhanVien].Cells[17].Value = "0";
                                        this.DGVTinhCong.Rows[_nhanVien].Cells[18].Value = this.sKHVang;
                                        if (DateTimeProgress.XuatIDThu((int)dt.AddDays(dem).DayOfWeek) == "0")
                                        {
                                            this.DGVTinhCong.Rows[_nhanVien].Cells[19].Value = "CN";
                                        }
                                        else
                                        {
                                            this.DGVTinhCong.Rows[_nhanVien].Cells[19].Value = "NT";
                                        }
                                        this.DGVTinhCong.Rows[_nhanVien].Cells[20].Value = this.sMaChamCong;
                                        this.DGVTinhCong.Rows[_nhanVien].Cells[21].Value = this.sPhongBanTinhCong;
                                        iKiemTra = 1;
                                    }
                                    else
                                    {
                                        addChonTuMay = this.DGVTinhCong.Rows.Add();
                                        dGioVaoChonTuMay = Convert.ToDateTime(dateGioChamChonTuMay.ToString());
                                        this.DGVTinhCong.Rows[addChonTuMay].Cells[5].Value = string.Format(this.sDinhDangThoiGian, dGioVaoChonTuMay);
                                        iKiemTraB = 1;
                                        this.DGVTinhCong.Rows[addChonTuMay].Cells[0].Value = this.sMaNhanVien;
                                        this.DGVTinhCong.Rows[addChonTuMay].Cells[1].Value = this.sTenNhanVien;
                                        this.DGVTinhCong.Rows[addChonTuMay].Cells[2].Value = this.DGVTinhCong.Rows[_nhanVien].Cells[2].Value.ToString();
                                        this.DGVTinhCong.Rows[addChonTuMay].Cells[4].Value = dt_ca.Rows.Cast<DataRow>().Where(x => x["MaChamCong"].ToString() == int.Parse(sMaNhanVien.Remove(0, 2)).ToString()).Select(x => x["D" + dtDinhDang.Day]);
                                        this.DGVTinhCong.Rows[addChonTuMay].Cells[7].Value = "0";
                                        this.DGVTinhCong.Rows[addChonTuMay].Cells[8].Value = "0";
                                        this.DGVTinhCong.Rows[addChonTuMay].Cells[3].Value = DateTimeProgress.XuatThuTinhCong((int)dt.AddDays(dem).DayOfWeek);
                                        this.DGVTinhCong.Rows[addChonTuMay].Cells[17].Value = "0";
                                        this.DGVTinhCong.Rows[addChonTuMay].Cells[18].Value = this.sKHVang;
                                        if (DateTimeProgress.XuatIDThu((int)dt.AddDays(dem).DayOfWeek) == "0")
                                        {
                                            this.DGVTinhCong.Rows[addChonTuMay].Cells[19].Value = "CN";
                                        }
                                        else
                                        {
                                            this.DGVTinhCong.Rows[addChonTuMay].Cells[19].Value = "NT";
                                        }
                                        this.DGVTinhCong.Rows[addChonTuMay].Cells[20].Value = this.sMaChamCong;
                                        this.DGVTinhCong.Rows[addChonTuMay].Cells[21].Value = this.sPhongBanTinhCong;
                                    }
                                }
                                else
                                {
                                    if ((iKiemTra == 1 && iLanCham == 2) || iLanCham == 1)
                                    {
                                        DateTime dGioRaChonTuMay;
                                        if (iKiemTra == 0 && iLanCham == 1)
                                        {
                                            if (_nhanVien == 0)
                                            {
                                                dGioRaChonTuMay = Convert.ToDateTime(dateGioChamChonTuMay.ToString());
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[6].Value = string.Format(this.sDinhDangThoiGian, dGioRaChonTuMay);
                                                this.DGVTinhCong.Rows[addChonTuMay].Cells[7].Value = "0";
                                                this.DGVTinhCong.Rows[addChonTuMay].Cells[8].Value = "0";
                                                this.DGVTinhCong.Rows[addChonTuMay].Cells[18].Value = this.sKHVang;
                                                if (DateTimeProgress.XuatIDThu((int)dt.AddDays(dem).DayOfWeek) == "0")
                                                {
                                                    this.DGVTinhCong.Rows[addChonTuMay].Cells[19].Value = "CN";
                                                }
                                                else
                                                {
                                                    this.DGVTinhCong.Rows[addChonTuMay].Cells[19].Value = "NT";
                                                }
                                                this.DGVTinhCong.Rows[addChonTuMay].Cells[20].Value = this.sMaChamCong;
                                                this.DGVTinhCong.Rows[addChonTuMay].Cells[21].Value = this.sPhongBanTinhCong;
                                                iLanCham++;
                                                continue;
                                            }
                                            if (this.DGVTinhCong.Rows[_nhanVien - 1].Cells[5].Value != null && this.DGVTinhCong.Rows[_nhanVien - 1].Cells[6].Value == null)
                                            {
                                                DateTime dGioNgayHomTruoc;
                                                dGioNgayHomTruoc = default(DateTime);
                                                DateTime dNgayTruocChonTuMay;
                                                dNgayTruocChonTuMay = Convert.ToDateTime(dt.AddDays(dem - 1).ToString());
                                                new DataTable();
                                                DataTable dtNgayTruocChonTuMay;
                                                dtNgayTruocChonTuMay = this._checkInOutBLL.getCheckInOutByMaChamCongAndNgayCham(Convert.ToInt32(this.sMaChamCong), dNgayTruocChonTuMay);
                                                for (int iNgayTruocChonTuMay = 0; iNgayTruocChonTuMay < dtNgayTruocChonTuMay.Rows.Count; iNgayTruocChonTuMay++)
                                                {
                                                    dGioNgayHomTruoc = Convert.ToDateTime(dtNgayTruocChonTuMay.Rows[iNgayTruocChonTuMay]["GioCham"].ToString());
                                                }
                                                dGioRaChonTuMay = Convert.ToDateTime(dateGioChamChonTuMay.ToString());
                                                this.DGVTinhCong.Rows[_nhanVien - 1].Cells[6].Value = string.Format(this.sDinhDangThoiGian, dGioRaChonTuMay);
                                                new DataTable();
                                                this._chiTietLichTrinhChoCalamViecDTO.MaLichTrinhCaLamViec = sLTCCLVNhanVien;
                                                this._chiTietLichTrinhChoCalamViecDTO.Thu = sThu;
                                                DataTable dtNhanCaQuaDemChonTuMay;
                                                dtNhanCaQuaDemChonTuMay = this._chiTietLichTrinhChoCaLamViecBLL.ChiTietLichTrinhChoCaLamViecNhanCa(this._chiTietLichTrinhChoCalamViecDTO);
                                                int iChiTietLichTrinhChoCaLamViecQuaDemChonTuMay;
                                                iChiTietLichTrinhChoCaLamViecQuaDemChonTuMay = 0;
                                                if (iChiTietLichTrinhChoCaLamViecQuaDemChonTuMay >= dtNhanCaQuaDemChonTuMay.Rows.Count)
                                                {
                                                    continue;
                                                }
                                                int cellChiTietLichTrinhChoCaLamViecQuaDemChonTuMay;
                                                cellChiTietLichTrinhChoCaLamViecQuaDemChonTuMay = 3;
                                                while (true)
                                                {
                                                    if (cellChiTietLichTrinhChoCaLamViecQuaDemChonTuMay < 13)
                                                    {
                                                        kiemTraVao = 0;
                                                        kiemTraRa = 0;
                                                        this.sChonTuMayMaCaLamViec = dtNhanCaQuaDemChonTuMay.Rows[iChiTietLichTrinhChoCaLamViecQuaDemChonTuMay][cellChiTietLichTrinhChoCaLamViecQuaDemChonTuMay].ToString();
                                                        new DataTable();
                                                        DataTable dtChonTuMayCa4;
                                                        dtChonTuMayCa4 = this._caLamViecBLL.CaLamViecGetByMaCaLamViec(sChonTuMayMaCaLamViec);
                                                        int iChonTuMayCa4;
                                                        iChonTuMayCa4 = 0;
                                                        while (iChonTuMayCa4 < dtChonTuMayCa4.Rows.Count)
                                                        {
                                                            this.sChonTuMayTenCaLamViec = dtChonTuMayCa4.Rows[iChonTuMayCa4]["CaLamViec"].ToString();
                                                            DateTime dBatDauVaoChonTuMayB4;
                                                            dBatDauVaoChonTuMayB4 = Convert.ToDateTime(sNgayCham + " " + string.Format("{0:T}", Convert.ToDateTime(dtChonTuMayCa4.Rows[iChonTuMayCa4]["BatDauVao"].ToString()))).AddDays(-1.0);
                                                            DateTime dKetThucVaoChonTuMayB4;
                                                            dKetThucVaoChonTuMayB4 = Convert.ToDateTime(sNgayCham + " " + string.Format("{0:T}", Convert.ToDateTime(dtChonTuMayCa4.Rows[iChonTuMayCa4]["KetThucVao"].ToString()))).AddDays(-1.0);
                                                            string sBatDauRaChonTuMayA;
                                                            sBatDauRaChonTuMayA = string.Format("{0:T}", Convert.ToDateTime(dtChonTuMayCa4.Rows[iChonTuMayCa4]["BatDauRa"].ToString()));
                                                            string sBatDauRaChonTuMayB4;
                                                            sBatDauRaChonTuMayB4 = sNgayCham + " " + sBatDauRaChonTuMayA;
                                                            DateTime dBatDauRaChonTuMayB4;
                                                            dBatDauRaChonTuMayB4 = Convert.ToDateTime(sBatDauRaChonTuMayB4).AddDays(-1.0);
                                                            dBatDauRaChonTuMayB4 = ((!(sBatDauRaChonTuMayA == "12:01:00 AM")) ? Convert.ToDateTime(sBatDauRaChonTuMayB4) : Convert.ToDateTime(dBatDauRaChonTuMayB4.AddDays(1.0).ToString()));
                                                            string sKetThucRaChonTuMayB;
                                                            sKetThucRaChonTuMayB = sNgayCham + " " + string.Format("{0:T}", Convert.ToDateTime(dtChonTuMayCa4.Rows[iChonTuMayCa4]["KetThucRa"].ToString()));
                                                            DateTime dKetThucRaChonTuMayB4;
                                                            dKetThucRaChonTuMayB4 = Convert.ToDateTime(sKetThucRaChonTuMayB).AddDays(-1.0);
                                                            dKetThucRaChonTuMayB4 = ((!(sBatDauRaChonTuMayA == "12:01:00 AM")) ? Convert.ToDateTime(sKetThucRaChonTuMayB) : Convert.ToDateTime(dKetThucRaChonTuMayB4.AddDays(1.0).ToString()));
                                                            if (dGioNgayHomTruoc >= dBatDauVaoChonTuMayB4 && dGioNgayHomTruoc <= dKetThucVaoChonTuMayB4)
                                                            {
                                                                kiemTraVao++;
                                                            }
                                                            if (dGioRaChonTuMay >= dBatDauRaChonTuMayB4 && dGioRaChonTuMay <= dKetThucRaChonTuMayB4)
                                                            {
                                                                kiemTraRa++;
                                                            }
                                                            if (kiemTraVao != 1 || kiemTraRa != 1)
                                                            {
                                                                iChonTuMayCa4++;
                                                                continue;
                                                            }
                                                            goto IL_18e8;
                                                        }
                                                        if (!(this.sChonTuMayMaCaLamViec == ""))
                                                        {
                                                            cellChiTietLichTrinhChoCaLamViecQuaDemChonTuMay++;
                                                            continue;
                                                        }
                                                        this.DGVTinhCong.Rows[_nhanVien - 1].Cells[4].Value = dt_ca.Rows.Cast<DataRow>().Where(x => x["MaChamCong"].ToString() == int.Parse(sMaNhanVien.Remove(0, 2)).ToString()).Select(x => x["D" + dtDinhDang.Day]);
                                                        this.DGVTinhCong.Rows[_nhanVien - 1].Cells[7].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien - 1].Cells[8].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien - 1].Cells[9].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien - 1].Cells[10].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien - 1].Cells[11].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien - 1].Cells[12].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien - 1].Cells[13].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien - 1].Cells[14].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien - 1].Cells[15].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien - 1].Cells[16].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien - 1].Cells[17].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien - 1].Cells[18].Value = this.sKHVang;
                                                        if (DateTimeProgress.XuatThuQuaDem((int)dt.AddDays(dem).DayOfWeek) == "1")
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien - 1].Cells[19].Value = "CN";
                                                        }
                                                        else
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien - 1].Cells[19].Value = "NT";
                                                        }
                                                        this.DGVTinhCong.Rows[_nhanVien - 1].Cells[20].Value = this.sMaChamCong;
                                                        this.DGVTinhCong.Rows[_nhanVien - 1].Cells[21].Value = this.sPhongBanTinhCong;
                                                        break;
                                                    }
                                                    goto IL_18e8;
                                                IL_18e8:
                                                    this.DGVTinhCong.Rows[_nhanVien - 1].Cells[4].Value = this.sChonTuMayTenCaLamViec;
                                                    new DataTable();
                                                    DataTable dtThongSoCaLamViecChonTuMay;
                                                    dtThongSoCaLamViecChonTuMay = this._caLamViecBLL.CaLamViecGetByMaCaLamViec(sChonTuMayMaCaLamViec);
                                                    for (int iThongSoCaLamViecChonTuMay = 0; iThongSoCaLamViecChonTuMay < dtThongSoCaLamViecChonTuMay.Rows.Count; iThongSoCaLamViecChonTuMay++)
                                                    {
                                                        double dTongGioChonTuMay;
                                                        dTongGioChonTuMay = Math.Round(Convert.ToDouble(Convert.ToInt32((dGioRaChonTuMay - dGioNgayHomTruoc).TotalMinutes)) / 60.0, this.iLamTronGio);
                                                        this.DGVTinhCong.Rows[_nhanVien - 1].Cells[16].Value = dTongGioChonTuMay.ToString();
                                                        this.DGVTinhCong.Rows[_nhanVien - 1].Cells[17].Value = dtThongSoCaLamViecChonTuMay.Rows[iThongSoCaLamViecChonTuMay]["CongTinh"].ToString();
                                                        string sGiayGioVao10;
                                                        sGiayGioVao10 = dGioNgayHomTruoc.Second.ToString();
                                                        string sGiayGioRa10;
                                                        sGiayGioRa10 = dGioRaChonTuMay.Second.ToString();
                                                        string sGioVaoKhaiBaoChonTuMayB;
                                                        sGioVaoKhaiBaoChonTuMayB = sNgayCham + " " + string.Format("{0:T}", Convert.ToDateTime(dtThongSoCaLamViecChonTuMay.Rows[iThongSoCaLamViecChonTuMay]["GioVaoLamViec"].ToString())).Replace("00 ", sGiayGioVao10 + " ");
                                                        string sGioRaKhaiBaoChonTuMayB;
                                                        sGioRaKhaiBaoChonTuMayB = sNgayCham + " " + string.Format("{0:T}", Convert.ToDateTime(dtThongSoCaLamViecChonTuMay.Rows[iThongSoCaLamViecChonTuMay]["GioKetThucLamViec"].ToString())).Replace("00 ", sGiayGioRa10 + " ");
                                                        string sCatChuoi3;
                                                        sCatChuoi3 = sGioRaKhaiBaoChonTuMayB.Substring(sGioRaKhaiBaoChonTuMayB.Length - 2);
                                                        string sTruGioDiTre8;
                                                        sTruGioDiTre8 = dtThongSoCaLamViecChonTuMay.Rows[iThongSoCaLamViecChonTuMay]["TruGioDiTre"].ToString();
                                                        string sBatDauTinhDiTre8;
                                                        sBatDauTinhDiTre8 = dtThongSoCaLamViecChonTuMay.Rows[iThongSoCaLamViecChonTuMay]["BatDauTinhDiTre"].ToString();
                                                        if (sTruGioDiTre8 == "True")
                                                        {
                                                            int iChoPhepTreChonTuMay;
                                                            iChoPhepTreChonTuMay = Convert.ToInt32(dtThongSoCaLamViecChonTuMay.Rows[iThongSoCaLamViecChonTuMay]["ChoPhepDiTre"].ToString());
                                                            if (sBatDauTinhDiTre8 == "True")
                                                            {
                                                                int iPhutTreChonTuMay;
                                                                iPhutTreChonTuMay = Convert.ToInt32((dGioNgayHomTruoc - Convert.ToDateTime(sGioVaoKhaiBaoChonTuMayB).AddDays(-1.0)).TotalMinutes) - iChoPhepTreChonTuMay;
                                                                if (iPhutTreChonTuMay > 0)
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien - 1].Cells[9].Value = iPhutTreChonTuMay.ToString();
                                                                }
                                                                else
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien - 1].Cells[9].Value = "0";
                                                                }
                                                            }
                                                            else if (Convert.ToInt32((dGioNgayHomTruoc - Convert.ToDateTime(sGioVaoKhaiBaoChonTuMayB).AddDays(-1.0)).TotalMinutes) - iChoPhepTreChonTuMay > 0)
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien - 1].Cells[9].Value = Convert.ToInt32((dGioNgayHomTruoc - Convert.ToDateTime(sGioVaoKhaiBaoChonTuMayB).AddDays(-1.0)).TotalMinutes).ToString();
                                                            }
                                                            else
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien - 1].Cells[9].Value = "0";
                                                            }
                                                        }
                                                        else
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien - 1].Cells[9].Value = "0";
                                                        }
                                                        string sTruGioVeSom8;
                                                        sTruGioVeSom8 = dtThongSoCaLamViecChonTuMay.Rows[iThongSoCaLamViecChonTuMay]["TruGioVeSom"].ToString();
                                                        string sBatDauTinhVeSom8;
                                                        sBatDauTinhVeSom8 = dtThongSoCaLamViecChonTuMay.Rows[iThongSoCaLamViecChonTuMay]["BatDauTinhVeSom"].ToString();
                                                        if (sTruGioVeSom8 == "True")
                                                        {
                                                            int iChoPhepVeSomChonTuMay;
                                                            iChoPhepVeSomChonTuMay = Convert.ToInt32(dtThongSoCaLamViecChonTuMay.Rows[iThongSoCaLamViecChonTuMay]["ChoPhepVeSom"].ToString());
                                                            if (sBatDauTinhVeSom8 == "True")
                                                            {
                                                                if (sCatChuoi3 == "PM")
                                                                {
                                                                    int iPhutVeSomChonTuMay2;
                                                                    iPhutVeSomChonTuMay2 = Convert.ToInt32((Convert.ToDateTime(sGioRaKhaiBaoChonTuMayB).AddDays(-1.0) - dGioRaChonTuMay).TotalMinutes) - iChoPhepVeSomChonTuMay;
                                                                    if (iPhutVeSomChonTuMay2 > 0)
                                                                    {
                                                                        this.DGVTinhCong.Rows[_nhanVien - 1].Cells[10].Value = iPhutVeSomChonTuMay2.ToString();
                                                                    }
                                                                    else
                                                                    {
                                                                        this.DGVTinhCong.Rows[_nhanVien - 1].Cells[10].Value = "0";
                                                                    }
                                                                }
                                                                else
                                                                {
                                                                    int iPhutVeSomChonTuMay;
                                                                    iPhutVeSomChonTuMay = Convert.ToInt32((Convert.ToDateTime(sGioRaKhaiBaoChonTuMayB) - dGioRaChonTuMay).TotalMinutes) - iChoPhepVeSomChonTuMay;
                                                                    if (iPhutVeSomChonTuMay > 0)
                                                                    {
                                                                        this.DGVTinhCong.Rows[_nhanVien - 1].Cells[10].Value = iPhutVeSomChonTuMay.ToString();
                                                                    }
                                                                    else
                                                                    {
                                                                        this.DGVTinhCong.Rows[_nhanVien - 1].Cells[10].Value = "0";
                                                                    }
                                                                }
                                                            }
                                                            else if (Convert.ToInt32((Convert.ToDateTime(sGioRaKhaiBaoChonTuMayB) - dGioRaChonTuMay).TotalMinutes) - iChoPhepVeSomChonTuMay > 0)
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien - 1].Cells[10].Value = Convert.ToInt32((Convert.ToDateTime(sGioRaKhaiBaoChonTuMayB) - dGioRaChonTuMay).TotalMinutes).ToString();
                                                            }
                                                            else
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien - 1].Cells[10].Value = "0";
                                                            }
                                                        }
                                                        else
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien - 1].Cells[10].Value = "0";
                                                        }
                                                        if (sCatChuoi3 == "PM")
                                                        {
                                                            int iPhutVeTre6;
                                                            iPhutVeTre6 = Convert.ToInt32((dGioRaChonTuMay - Convert.ToDateTime(sGioRaKhaiBaoChonTuMayB).AddDays(-1.0)).TotalMinutes);
                                                            if (iPhutVeTre6 > 0)
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien - 1].Cells[11].Value = iPhutVeTre6;
                                                            }
                                                            else
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien - 1].Cells[11].Value = "0";
                                                            }
                                                        }
                                                        else
                                                        {
                                                            int iPhutVeTre5;
                                                            iPhutVeTre5 = Convert.ToInt32((dGioRaChonTuMay - Convert.ToDateTime(sGioRaKhaiBaoChonTuMayB)).TotalMinutes);
                                                            if (iPhutVeTre5 > 0)
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien - 1].Cells[11].Value = iPhutVeTre5;
                                                            }
                                                            else
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien - 1].Cells[11].Value = "0";
                                                            }
                                                        }
                                                        double dTongGioTrongCaChonTuMay;
                                                        dTongGioTrongCaChonTuMay = Convert.ToDouble(dtThongSoCaLamViecChonTuMay.Rows[iThongSoCaLamViecChonTuMay]["TongGioTrongCaLamViec"].ToString());
                                                        double dTongCongTrongCaChonTuMay;
                                                        dTongCongTrongCaChonTuMay = Convert.ToDouble(dtThongSoCaLamViecChonTuMay.Rows[iThongSoCaLamViecChonTuMay]["CongTinh"].ToString());
                                                        double dTongPhutTreSomChonTuMay;
                                                        dTongPhutTreSomChonTuMay = Convert.ToDouble(this.DGVTinhCong.Rows[_nhanVien - 1].Cells[9].Value.ToString()) + Convert.ToDouble(this.DGVTinhCong.Rows[_nhanVien - 1].Cells[10].Value.ToString());
                                                        this.DGVTinhCong.Rows[_nhanVien - 1].Cells[8].Value = Math.Round((dTongGioTrongCaChonTuMay * 60.0 - dTongPhutTreSomChonTuMay) / 60.0, this.iLamTronGio);
                                                        this.DGVTinhCong.Rows[_nhanVien - 1].Cells[7].Value = Math.Round(Convert.ToDouble(this.DGVTinhCong.Rows[_nhanVien - 1].Cells[8].Value.ToString()) * dTongCongTrongCaChonTuMay / dTongGioTrongCaChonTuMay, this.iLamTronCong);
                                                        string sChoPhepTangCaTruocGioLamViecChonTuMay4;
                                                        sChoPhepTangCaTruocGioLamViecChonTuMay4 = dtThongSoCaLamViecChonTuMay.Rows[iThongSoCaLamViecChonTuMay]["TangCaTruocGioLamViec"].ToString();
                                                        int iPhutTangCaTruocGioLamViecChonTuMay4;
                                                        iPhutTangCaTruocGioLamViecChonTuMay4 = Convert.ToInt32(dtThongSoCaLamViecChonTuMay.Rows[iThongSoCaLamViecChonTuMay]["SoPhutTangCaTruocGioLamViec"].ToString());
                                                        int iPhutTangCaTruocGioLamViecDatDen9;
                                                        iPhutTangCaTruocGioLamViecDatDen9 = Convert.ToInt32(dtThongSoCaLamViecChonTuMay.Rows[iThongSoCaLamViecChonTuMay]["TangCaTruocGioLamViecDatDen"].ToString());
                                                        int iPhutTruTangCaTruoc9;
                                                        iPhutTruTangCaTruoc9 = Convert.ToInt32(dtThongSoCaLamViecChonTuMay.Rows[iThongSoCaLamViecChonTuMay]["PhutTruTangCaTruoc"].ToString());
                                                        string sChoPhepTangCaSauGioLamViecChonTuMay4;
                                                        sChoPhepTangCaSauGioLamViecChonTuMay4 = dtThongSoCaLamViecChonTuMay.Rows[iThongSoCaLamViecChonTuMay]["TangCaSauGioLamViec"].ToString();
                                                        int iPhutTangCaSauGioLamViecChonTuMay4;
                                                        iPhutTangCaSauGioLamViecChonTuMay4 = Convert.ToInt32(dtThongSoCaLamViecChonTuMay.Rows[iThongSoCaLamViecChonTuMay]["SoPhutTangCaSauGioLamViec"].ToString());
                                                        int iPhutTangCaSauGioLamViecDatDen9;
                                                        iPhutTangCaSauGioLamViecDatDen9 = Convert.ToInt32(dtThongSoCaLamViecChonTuMay.Rows[iThongSoCaLamViecChonTuMay]["TangCaSauGioLamViecDatDen"].ToString());
                                                        int iPhutTruTangCaSau9;
                                                        iPhutTruTangCaSau9 = Convert.ToInt32(dtThongSoCaLamViecChonTuMay.Rows[iThongSoCaLamViecChonTuMay]["PhutTruTangCaSau"].ToString());
                                                        int iGioiHanTC1ChonTuMay4;
                                                        iGioiHanTC1ChonTuMay4 = Convert.ToInt32(dtThongSoCaLamViecChonTuMay.Rows[iThongSoCaLamViecChonTuMay]["GioiHanTangCa1"].ToString());
                                                        int iGioiHanTC2ChonTuMay4;
                                                        iGioiHanTC2ChonTuMay4 = Convert.ToInt32(dtThongSoCaLamViecChonTuMay.Rows[iThongSoCaLamViecChonTuMay]["GioiHanTangCa2"].ToString());
                                                        int iGioiHanTC3ChonTuMay4;
                                                        iGioiHanTC3ChonTuMay4 = Convert.ToInt32(dtThongSoCaLamViecChonTuMay.Rows[iThongSoCaLamViecChonTuMay]["GioiHanTangCa3"].ToString());
                                                        int iGioiHanTC4ChonTuMay4;
                                                        iGioiHanTC4ChonTuMay4 = Convert.ToInt32(dtThongSoCaLamViecChonTuMay.Rows[iThongSoCaLamViecChonTuMay]["GioiHanTangCa4"].ToString());
                                                        int iTongGioTangCaSauChonTuMay4;
                                                        iTongGioTangCaSauChonTuMay4 = 0;
                                                        int iTongGioTangCaTruocChonTuMay4;
                                                        iTongGioTangCaTruocChonTuMay4 = 0;
                                                        if (sChoPhepTangCaTruocGioLamViecChonTuMay4 == "False" && sChoPhepTangCaSauGioLamViecChonTuMay4 == "False")
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien - 1].Cells[12].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien - 1].Cells[13].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien - 1].Cells[14].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien - 1].Cells[15].Value = "0";
                                                        }
                                                        else
                                                        {
                                                            if (sChoPhepTangCaTruocGioLamViecChonTuMay4 == "True")
                                                            {
                                                                int iThoiGianTruocGioLamChonTuMay4;
                                                                iThoiGianTruocGioLamChonTuMay4 = Convert.ToInt32(Convert.ToInt32((Convert.ToDateTime(sGioVaoKhaiBaoChonTuMayB).AddDays(-1.0) - dGioNgayHomTruoc).TotalMinutes).ToString());
                                                                if (iThoiGianTruocGioLamChonTuMay4 > 0 && iThoiGianTruocGioLamChonTuMay4 > iPhutTangCaTruocGioLamViecChonTuMay4 && iThoiGianTruocGioLamChonTuMay4 > iPhutTangCaTruocGioLamViecDatDen9)
                                                                {
                                                                    iTongGioTangCaTruocChonTuMay4 = iThoiGianTruocGioLamChonTuMay4 - iPhutTruTangCaTruoc9;
                                                                }
                                                            }
                                                            if (sChoPhepTangCaSauGioLamViecChonTuMay4 == "True")
                                                            {
                                                                if (sCatChuoi3 == "PM")
                                                                {
                                                                    int iThoiGianSauGioLamViecChonTuMay5;
                                                                    iThoiGianSauGioLamViecChonTuMay5 = Convert.ToInt32(Convert.ToInt32((dGioRaChonTuMay - Convert.ToDateTime(sGioRaKhaiBaoChonTuMayB).AddDays(-1.0)).TotalMinutes).ToString());
                                                                    if (iThoiGianSauGioLamViecChonTuMay5 > 0 && iThoiGianSauGioLamViecChonTuMay5 > iPhutTangCaSauGioLamViecChonTuMay4 && iThoiGianSauGioLamViecChonTuMay5 > iPhutTangCaSauGioLamViecDatDen9)
                                                                    {
                                                                        iTongGioTangCaSauChonTuMay4 = iThoiGianSauGioLamViecChonTuMay5 - iPhutTruTangCaSau9;
                                                                    }
                                                                }
                                                                else
                                                                {
                                                                    int iThoiGianSauGioLamViecChonTuMay4;
                                                                    iThoiGianSauGioLamViecChonTuMay4 = Convert.ToInt32(Convert.ToInt32((dGioRaChonTuMay - Convert.ToDateTime(sGioRaKhaiBaoChonTuMayB)).TotalMinutes).ToString());
                                                                    if (iThoiGianSauGioLamViecChonTuMay4 > 0 && iThoiGianSauGioLamViecChonTuMay4 > iPhutTangCaSauGioLamViecChonTuMay4 && iThoiGianSauGioLamViecChonTuMay4 > iPhutTangCaSauGioLamViecDatDen9)
                                                                    {
                                                                        iTongGioTangCaSauChonTuMay4 = iThoiGianSauGioLamViecChonTuMay4 - iPhutTruTangCaSau9;
                                                                    }
                                                                }
                                                            }
                                                        }
                                                        double dTongThoiGianTangCaChonTuMay4;
                                                        dTongThoiGianTangCaChonTuMay4 = Convert.ToDouble(iTongGioTangCaTruocChonTuMay4 + iTongGioTangCaSauChonTuMay4);
                                                        if (dTongThoiGianTangCaChonTuMay4 > 0.0)
                                                        {
                                                            if (iGioiHanTC1ChonTuMay4 == 0)
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien - 1].Cells[12].Value = Math.Round(dTongThoiGianTangCaChonTuMay4 * this.dTangCa1HeSo / 60.0, this.iLamTronGio);
                                                                this.DGVTinhCong.Rows[_nhanVien - 1].Cells[13].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien - 1].Cells[14].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien - 1].Cells[15].Value = "0";
                                                            }
                                                            if (iGioiHanTC1ChonTuMay4 != 0 && iGioiHanTC2ChonTuMay4 == 0)
                                                            {
                                                                if (dTongThoiGianTangCaChonTuMay4 < Convert.ToDouble(iGioiHanTC1ChonTuMay4))
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien - 1].Cells[12].Value = Math.Round(dTongThoiGianTangCaChonTuMay4 * this.dTangCa1HeSo / 60.0, this.iLamTronGio);
                                                                    this.DGVTinhCong.Rows[_nhanVien - 1].Cells[13].Value = "0";
                                                                    this.DGVTinhCong.Rows[_nhanVien - 1].Cells[14].Value = "0";
                                                                    this.DGVTinhCong.Rows[_nhanVien - 1].Cells[15].Value = "0";
                                                                }
                                                                else
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien - 1].Cells[12].Value = Math.Round(Convert.ToDouble(iGioiHanTC1ChonTuMay4) / 60.0 * this.dTangCa1HeSo, this.iLamTronGio);
                                                                    if (dTongThoiGianTangCaChonTuMay4 - Convert.ToDouble(iGioiHanTC1ChonTuMay4) > 0.0)
                                                                    {
                                                                        this.DGVTinhCong.Rows[_nhanVien - 1].Cells[13].Value = Math.Round((dTongThoiGianTangCaChonTuMay4 - Convert.ToDouble(iGioiHanTC1ChonTuMay4)) * this.dTangCa2HeSo / 60.0, this.iLamTronGio);
                                                                    }
                                                                    this.DGVTinhCong.Rows[_nhanVien - 1].Cells[14].Value = "0";
                                                                    this.DGVTinhCong.Rows[_nhanVien - 1].Cells[15].Value = "0";
                                                                }
                                                            }
                                                            if (iGioiHanTC1ChonTuMay4 != 0 && iGioiHanTC2ChonTuMay4 != 0 && iGioiHanTC3ChonTuMay4 == 0)
                                                            {
                                                                if (dTongThoiGianTangCaChonTuMay4 < Convert.ToDouble(iGioiHanTC1ChonTuMay4))
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien - 1].Cells[12].Value = Math.Round(dTongThoiGianTangCaChonTuMay4 * this.dTangCa1HeSo / 60.0, this.iLamTronGio);
                                                                    this.DGVTinhCong.Rows[_nhanVien - 1].Cells[13].Value = "0";
                                                                    this.DGVTinhCong.Rows[_nhanVien - 1].Cells[14].Value = "0";
                                                                    this.DGVTinhCong.Rows[_nhanVien - 1].Cells[15].Value = "0";
                                                                }
                                                                else
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien - 1].Cells[12].Value = Math.Round(Convert.ToDouble(iGioiHanTC1ChonTuMay4) * this.dTangCa1HeSo / 60.0, this.iLamTronGio);
                                                                    if (dTongThoiGianTangCaChonTuMay4 - Convert.ToDouble(iGioiHanTC1ChonTuMay4) < Convert.ToDouble(iGioiHanTC2ChonTuMay4))
                                                                    {
                                                                        this.DGVTinhCong.Rows[_nhanVien - 1].Cells[13].Value = Math.Round((dTongThoiGianTangCaChonTuMay4 - Convert.ToDouble(iGioiHanTC1ChonTuMay4)) * this.dTangCa2HeSo / 60.0, this.iLamTronGio);
                                                                        this.DGVTinhCong.Rows[_nhanVien - 1].Cells[14].Value = "0";
                                                                        this.DGVTinhCong.Rows[_nhanVien - 1].Cells[15].Value = "0";
                                                                    }
                                                                    else
                                                                    {
                                                                        this.DGVTinhCong.Rows[_nhanVien - 1].Cells[12].Value = Math.Round(Convert.ToDouble(iGioiHanTC1ChonTuMay4) * this.dTangCa1HeSo / 60.0, this.iLamTronGio);
                                                                        this.DGVTinhCong.Rows[_nhanVien - 1].Cells[13].Value = Math.Round(Convert.ToDouble(iGioiHanTC2ChonTuMay4) * this.dTangCa2HeSo / 60.0, this.iLamTronGio);
                                                                        this.DGVTinhCong.Rows[_nhanVien - 1].Cells[14].Value = Math.Round((dTongThoiGianTangCaChonTuMay4 - Convert.ToDouble(iGioiHanTC1ChonTuMay4) - Convert.ToDouble(iGioiHanTC2ChonTuMay4)) * this.dTangCa3HeSo / 60.0, this.iLamTronGio);
                                                                        this.DGVTinhCong.Rows[_nhanVien - 1].Cells[15].Value = "0";
                                                                    }
                                                                }
                                                            }
                                                            if (iGioiHanTC1ChonTuMay4 != 0 && iGioiHanTC2ChonTuMay4 != 0 && iGioiHanTC3ChonTuMay4 != 0 && iGioiHanTC4ChonTuMay4 != 0)
                                                            {
                                                            }
                                                        }
                                                        else
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien - 1].Cells[12].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien - 1].Cells[13].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien - 1].Cells[14].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien - 1].Cells[15].Value = "0";
                                                        }
                                                        this.DGVTinhCong.Rows[_nhanVien - 1].Cells[18].Value = this.sKHDungGio;
                                                        if (DateTimeProgress.XuatThuQuaDem((int)dt.AddDays(dem).DayOfWeek) == "1")
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien - 1].Cells[19].Value = "CN";
                                                        }
                                                        else
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien - 1].Cells[19].Value = "NT";
                                                        }
                                                        this.DGVTinhCong.Rows[_nhanVien - 1].Cells[20].Value = this.sMaChamCong;
                                                        this.DGVTinhCong.Rows[_nhanVien - 1].Cells[21].Value = this.sPhongBanTinhCong;
                                                    }
                                                    break;
                                                }
                                                continue;
                                            }
                                            dGioRaChonTuMay = Convert.ToDateTime(dateGioChamChonTuMay.ToString());
                                            this.DGVTinhCong.Rows[_nhanVien].Cells[6].Value = string.Format(this.sDinhDangThoiGian, dGioRaChonTuMay);
                                            iLanCham++;
                                            new DataTable();
                                            this._chiTietLichTrinhChoCalamViecDTO.MaLichTrinhCaLamViec = sLTCCLVNhanVien;
                                            this._chiTietLichTrinhChoCalamViecDTO.Thu = sThu;
                                            DataTable dtNhanCaChonTuMay3;
                                            dtNhanCaChonTuMay3 = this._chiTietLichTrinhChoCaLamViecBLL.ChiTietLichTrinhChoCaLamViecNhanCa(this._chiTietLichTrinhChoCalamViecDTO);
                                            int iChiTietLichTrinhChoCaLamViecChonTuMay3;
                                            iChiTietLichTrinhChoCaLamViecChonTuMay3 = 0;
                                            if (iChiTietLichTrinhChoCaLamViecChonTuMay3 >= dtNhanCaChonTuMay3.Rows.Count)
                                            {
                                                continue;
                                            }
                                            int cellChiTietLichTrinhChoCaLamViecChonTuMay3;
                                            cellChiTietLichTrinhChoCaLamViecChonTuMay3 = 3;
                                            while (true)
                                            {
                                                if (cellChiTietLichTrinhChoCaLamViecChonTuMay3 < 13)
                                                {
                                                    kiemTraVao = 0;
                                                    kiemTraRa = 0;
                                                    this.sChonTuMayMaCaLamViec = dtNhanCaChonTuMay3.Rows[iChiTietLichTrinhChoCaLamViecChonTuMay3][cellChiTietLichTrinhChoCaLamViecChonTuMay3].ToString();
                                                    new DataTable();
                                                    DataTable dtChonTuMayCa3;
                                                    dtChonTuMayCa3 = this._caLamViecBLL.CaLamViecGetByMaCaLamViec(sChonTuMayMaCaLamViec);
                                                    int iChonTuMayCa3;
                                                    iChonTuMayCa3 = 0;
                                                    while (iChonTuMayCa3 < dtChonTuMayCa3.Rows.Count)
                                                    {
                                                        this.sChonTuMayTenCaLamViec = dtChonTuMayCa3.Rows[iChonTuMayCa3]["CaLamViec"].ToString();
                                                        DateTime dBatDauVaoChonTuMayB3;
                                                        dBatDauVaoChonTuMayB3 = Convert.ToDateTime(sNgayCham + " " + string.Format("{0:T}", Convert.ToDateTime(dtChonTuMayCa3.Rows[iChonTuMayCa3]["BatDauVao"].ToString())));
                                                        DateTime dKetThucVaoChonTuMayB3;
                                                        dKetThucVaoChonTuMayB3 = Convert.ToDateTime(sNgayCham + " " + string.Format("{0:T}", Convert.ToDateTime(dtChonTuMayCa3.Rows[iChonTuMayCa3]["KetThucVao"].ToString())));
                                                        string sBatDauRaChonTuMayB3;
                                                        sBatDauRaChonTuMayB3 = sNgayCham + " " + string.Format("{0:T}", Convert.ToDateTime(dtChonTuMayCa3.Rows[iChonTuMayCa3]["BatDauRa"].ToString()));
                                                        DateTime dBatDauRaChonTuMayB3;
                                                        dBatDauRaChonTuMayB3 = Convert.ToDateTime(sBatDauRaChonTuMayB3);
                                                        dBatDauRaChonTuMayB3 = ((!(sBatDauRaChonTuMayB3 == "12:01:00 AM")) ? Convert.ToDateTime(dBatDauRaChonTuMayB3) : Convert.ToDateTime(dBatDauRaChonTuMayB3.AddDays(1.0).ToString()));
                                                        string sKetThucRaChonTuMayA3;
                                                        sKetThucRaChonTuMayA3 = string.Format("{0:T}", Convert.ToDateTime(dtChonTuMayCa3.Rows[iChonTuMayCa3]["KetThucRa"].ToString()));
                                                        DateTime dKetThucRaChonTuMayB3;
                                                        dKetThucRaChonTuMayB3 = Convert.ToDateTime(sNgayCham + " " + sKetThucRaChonTuMayA3);
                                                        dKetThucRaChonTuMayB3 = ((!(sKetThucRaChonTuMayA3 == "12:01:00 AM")) ? Convert.ToDateTime(dKetThucRaChonTuMayB3) : Convert.ToDateTime(dKetThucRaChonTuMayB3.AddDays(1.0).ToString()));
                                                        if (dGioVaoChonTuMay >= dBatDauVaoChonTuMayB3 && dGioVaoChonTuMay <= dKetThucVaoChonTuMayB3)
                                                        {
                                                            kiemTraVao++;
                                                        }
                                                        if (dGioRaChonTuMay >= dBatDauRaChonTuMayB3 && dGioRaChonTuMay <= dKetThucRaChonTuMayB3)
                                                        {
                                                            kiemTraRa++;
                                                        }
                                                        if (kiemTraVao != 1 || kiemTraRa != 1)
                                                        {
                                                            iChonTuMayCa3++;
                                                            continue;
                                                        }
                                                        goto IL_3429;
                                                    }
                                                    if (!(this.sChonTuMayMaCaLamViec == ""))
                                                    {
                                                        cellChiTietLichTrinhChoCaLamViecChonTuMay3++;
                                                        continue;
                                                    }
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[4].Value = dt_ca.Rows.Cast<DataRow>().Where(x => x["MaChamCong"].ToString() == int.Parse(sMaNhanVien.Remove(0, 2)).ToString()).Select(x => x["D" + dtDinhDang.Day]);
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[11].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[16].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[17].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[18].Value = this.sKHVang;
                                                    if (DateTimeProgress.XuatIDThu((int)dt.AddDays(dem).DayOfWeek) == "0")
                                                    {
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[19].Value = "CN";
                                                    }
                                                    else
                                                    {
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[19].Value = "NT";
                                                    }
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[20].Value = this.sMaChamCong;
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[21].Value = this.sPhongBanTinhCong;
                                                    break;
                                                }
                                                goto IL_3429;
                                            IL_3429:
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[4].Value = this.sChonTuMayTenCaLamViec;
                                                new DataTable();
                                                DataTable dtCaLamViecChonTuMay3;
                                                dtCaLamViecChonTuMay3 = this._caLamViecBLL.CaLamViecGetByMaCaLamViec(sChonTuMayMaCaLamViec);
                                                for (int iCaLamViecChonTuMay3 = 0; iCaLamViecChonTuMay3 < dtCaLamViecChonTuMay3.Rows.Count; iCaLamViecChonTuMay3++)
                                                {
                                                    string sGiayGioVao8;
                                                    sGiayGioVao8 = dGioVaoChonTuMay.Second.ToString();
                                                    string sGiayGioRa8;
                                                    sGiayGioRa8 = dGioRaChonTuMay.Second.ToString();
                                                    DateTime dGioVaoKhaiBaoChonTuMayB3;
                                                    dGioVaoKhaiBaoChonTuMayB3 = Convert.ToDateTime(sNgayCham + " " + string.Format("{0:T}", Convert.ToDateTime(dtCaLamViecChonTuMay3.Rows[iCaLamViecChonTuMay3]["GioVaoLamViec"].ToString())).Replace("00 ", sGiayGioVao8 + " "));
                                                    DateTime dGioRaKhaiBaoChonTuMayB3;
                                                    dGioRaKhaiBaoChonTuMayB3 = Convert.ToDateTime(sNgayCham + " " + string.Format("{0:T}", Convert.ToDateTime(dtCaLamViecChonTuMay3.Rows[iCaLamViecChonTuMay3]["GioKetThucLamViec"].ToString())).Replace("00 ", sGiayGioRa8 + " "));
                                                    string sTruGioDiTre6;
                                                    sTruGioDiTre6 = dtCaLamViecChonTuMay3.Rows[iCaLamViecChonTuMay3]["TruGioDiTre"].ToString();
                                                    string sBatDauTinhDiTre6;
                                                    sBatDauTinhDiTre6 = dtCaLamViecChonTuMay3.Rows[iCaLamViecChonTuMay3]["BatDauTinhDiTre"].ToString();
                                                    int iChoPhepDiTre5;
                                                    iChoPhepDiTre5 = Convert.ToInt32(dtCaLamViecChonTuMay3.Rows[iCaLamViecChonTuMay3]["ChoPhepDiTre"].ToString());
                                                    string sPhutTre5;
                                                    sPhutTre5 = Convert.ToInt32((dGioVaoChonTuMay - dGioVaoKhaiBaoChonTuMayB3).TotalMinutes).ToString();
                                                    if (sTruGioDiTre6 == "True")
                                                    {
                                                        if (Convert.ToInt32(sPhutTre5) < 0)
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = "0";
                                                        }
                                                        else
                                                        {
                                                            int iPhutTre5;
                                                            iPhutTre5 = Convert.ToInt32(sPhutTre5) - iChoPhepDiTre5;
                                                            if (sBatDauTinhDiTre6 == "True")
                                                            {
                                                                if (iPhutTre5 < 1)
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = "0";
                                                                }
                                                                else
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = iPhutTre5.ToString();
                                                                }
                                                            }
                                                            else if (iPhutTre5 < 1)
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = "0";
                                                            }
                                                            else
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = sPhutTre5;
                                                            }
                                                        }
                                                    }
                                                    else
                                                    {
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = "0";
                                                    }
                                                    string sTruGioVeSom6;
                                                    sTruGioVeSom6 = dtCaLamViecChonTuMay3.Rows[iCaLamViecChonTuMay3]["TruGioVeSom"].ToString();
                                                    string sBatDauTinhVeSom6;
                                                    sBatDauTinhVeSom6 = dtCaLamViecChonTuMay3.Rows[iCaLamViecChonTuMay3]["BatDauTinhVeSom"].ToString();
                                                    int iChoPhepVeSom5;
                                                    iChoPhepVeSom5 = Convert.ToInt32(dtCaLamViecChonTuMay3.Rows[iCaLamViecChonTuMay3]["ChoPhepVeSom"].ToString());
                                                    string sPhutVeSom5;
                                                    sPhutVeSom5 = Convert.ToInt32((dGioRaKhaiBaoChonTuMayB3 - dGioRaChonTuMay).TotalMinutes).ToString();
                                                    if (sTruGioVeSom6 == "True")
                                                    {
                                                        if (Convert.ToInt32(sPhutVeSom5) < 0)
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = "0";
                                                        }
                                                        else
                                                        {
                                                            int iPhutVeSom5;
                                                            iPhutVeSom5 = Convert.ToInt32(sPhutVeSom5) - iChoPhepVeSom5;
                                                            if (iPhutVeSom5 < 1)
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = "0";
                                                            }
                                                            else if (sBatDauTinhVeSom6 == "True")
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = iPhutVeSom5.ToString();
                                                            }
                                                            else
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = sPhutVeSom5;
                                                            }
                                                        }
                                                    }
                                                    else
                                                    {
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = "0";
                                                    }
                                                    string sVeTre5;
                                                    sVeTre5 = Convert.ToInt32((dGioRaChonTuMay - dGioRaKhaiBaoChonTuMayB3).TotalMinutes).ToString();
                                                    if (Convert.ToInt32(sVeTre5) > 0)
                                                    {
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[11].Value = sVeTre5;
                                                    }
                                                    else
                                                    {
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[11].Value = "0";
                                                    }
                                                    double dGio5;
                                                    dGio5 = Math.Round(Convert.ToDouble(Convert.ToSingle(dtCaLamViecChonTuMay3.Rows[iCaLamViecChonTuMay3]["TongGioTrongCaLamViec"]) * 60f - (float)(Convert.ToInt32(this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value.ToString()) + Convert.ToInt32(this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value))) / 60.0, this.iLamTronGio);
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = dGio5.ToString();
                                                    double iGio5;
                                                    iGio5 = Convert.ToDouble(dtCaLamViecChonTuMay3.Rows[iCaLamViecChonTuMay3]["TongGioTrongCaLamViec"].ToString());
                                                    double dCongTinh5;
                                                    dCongTinh5 = Convert.ToDouble(dtCaLamViecChonTuMay3.Rows[iCaLamViecChonTuMay3]["CongTinh"].ToString());
                                                    double dCong5;
                                                    dCong5 = Math.Round(dGio5 * dCongTinh5 / iGio5, this.iLamTronCong);
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = dCong5.ToString();
                                                    string sTangCaTruocGioLamViec3;
                                                    sTangCaTruocGioLamViec3 = dtCaLamViecChonTuMay3.Rows[iCaLamViecChonTuMay3]["TangCaTruocGioLamViec"].ToString();
                                                    string sTangCaSauGioLamViec3;
                                                    sTangCaSauGioLamViec3 = dtCaLamViecChonTuMay3.Rows[iCaLamViecChonTuMay3]["TangCaSauGioLamViec"].ToString();
                                                    if (sTangCaTruocGioLamViec3 == "False" && sTangCaSauGioLamViec3 == "False")
                                                    {
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                    }
                                                    string sXemCaNayLaTangCa3;
                                                    sXemCaNayLaTangCa3 = dtCaLamViecChonTuMay3.Rows[iCaLamViecChonTuMay3]["XemCaNayLaTangCa"].ToString();
                                                    int iTangCaMuc3;
                                                    iTangCaMuc3 = Convert.ToInt32(dtCaLamViecChonTuMay3.Rows[iCaLamViecChonTuMay3]["TangCaMuc"].ToString());
                                                    if (sXemCaNayLaTangCa3 == "True")
                                                    {
                                                        if (iTangCaMuc3 == 1)
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = dGio5.ToString();
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                        }
                                                        if (iTangCaMuc3 == 2)
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = dGio5.ToString();
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                        }
                                                        if (iTangCaMuc3 == 3)
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = dGio5.ToString();
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                        }
                                                        if (iTangCaMuc3 == 4)
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = dGio5.ToString();
                                                        }
                                                    }
                                                    string sChoPhepTangCaTruocGioLamViecChonTuMay3;
                                                    sChoPhepTangCaTruocGioLamViecChonTuMay3 = dtCaLamViecChonTuMay3.Rows[iCaLamViecChonTuMay3]["TangCaTruocGioLamViec"].ToString();
                                                    int iPhutTangCaTruocGioLamViecChonTuMay3;
                                                    iPhutTangCaTruocGioLamViecChonTuMay3 = Convert.ToInt32(dtCaLamViecChonTuMay3.Rows[iCaLamViecChonTuMay3]["SoPhutTangCaTruocGioLamViec"].ToString());
                                                    int iPhutTangCaTruocGioLamViecDatDen7;
                                                    iPhutTangCaTruocGioLamViecDatDen7 = Convert.ToInt32(dtCaLamViecChonTuMay3.Rows[iCaLamViecChonTuMay3]["TangCaTruocGioLamViecDatDen"].ToString());
                                                    int iPhutTruTangCaTruoc7;
                                                    iPhutTruTangCaTruoc7 = Convert.ToInt32(dtCaLamViecChonTuMay3.Rows[iCaLamViecChonTuMay3]["PhutTruTangCaTruoc"].ToString());
                                                    string sChoPhepTangCaSauGioLamViecChonTuMay3;
                                                    sChoPhepTangCaSauGioLamViecChonTuMay3 = dtCaLamViecChonTuMay3.Rows[iCaLamViecChonTuMay3]["TangCaSauGioLamViec"].ToString();
                                                    int iPhutTangCaSauGioLamViecChonTuMay3;
                                                    iPhutTangCaSauGioLamViecChonTuMay3 = Convert.ToInt32(dtCaLamViecChonTuMay3.Rows[iCaLamViecChonTuMay3]["SoPhutTangCaSauGioLamViec"].ToString());
                                                    int iPhutTangCaSauGioLamViecDatDen7;
                                                    iPhutTangCaSauGioLamViecDatDen7 = Convert.ToInt32(dtCaLamViecChonTuMay3.Rows[iCaLamViecChonTuMay3]["TangCaSauGioLamViecDatDen"].ToString());
                                                    int iPhutTruTangCaSau7;
                                                    iPhutTruTangCaSau7 = Convert.ToInt32(dtCaLamViecChonTuMay3.Rows[iCaLamViecChonTuMay3]["PhutTruTangCaSau"].ToString());
                                                    int iGioiHanTC1ChonTuMay3;
                                                    iGioiHanTC1ChonTuMay3 = Convert.ToInt32(dtCaLamViecChonTuMay3.Rows[iCaLamViecChonTuMay3]["GioiHanTangCa1"].ToString());
                                                    int iGioiHanTC2ChonTuMay3;
                                                    iGioiHanTC2ChonTuMay3 = Convert.ToInt32(dtCaLamViecChonTuMay3.Rows[iCaLamViecChonTuMay3]["GioiHanTangCa2"].ToString());
                                                    int iGioiHanTC3ChonTuMay3;
                                                    iGioiHanTC3ChonTuMay3 = Convert.ToInt32(dtCaLamViecChonTuMay3.Rows[iCaLamViecChonTuMay3]["GioiHanTangCa3"].ToString());
                                                    int iGioiHanTC4ChonTuMay3;
                                                    iGioiHanTC4ChonTuMay3 = Convert.ToInt32(dtCaLamViecChonTuMay3.Rows[iCaLamViecChonTuMay3]["GioiHanTangCa4"].ToString());
                                                    int iTongGioTangCaSauChonTuMay3;
                                                    iTongGioTangCaSauChonTuMay3 = 0;
                                                    int iTongGioTangCaTruocChonTuMay3;
                                                    iTongGioTangCaTruocChonTuMay3 = 0;
                                                    if (sChoPhepTangCaTruocGioLamViecChonTuMay3 == "False" && sChoPhepTangCaSauGioLamViecChonTuMay3 == "False")
                                                    {
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                    }
                                                    else
                                                    {
                                                        if (sChoPhepTangCaTruocGioLamViecChonTuMay3 == "True")
                                                        {
                                                            int iThoiGianTruocGioLamChonTuMay3;
                                                            iThoiGianTruocGioLamChonTuMay3 = Convert.ToInt32(Convert.ToInt32((dGioVaoKhaiBaoChonTuMayB3 - dGioVaoChonTuMay).TotalMinutes).ToString());
                                                            if (iThoiGianTruocGioLamChonTuMay3 > 0 && iThoiGianTruocGioLamChonTuMay3 > iPhutTangCaTruocGioLamViecChonTuMay3 && iThoiGianTruocGioLamChonTuMay3 > iPhutTangCaTruocGioLamViecDatDen7)
                                                            {
                                                                iTongGioTangCaTruocChonTuMay3 = iThoiGianTruocGioLamChonTuMay3 - iPhutTruTangCaTruoc7;
                                                            }
                                                        }
                                                        if (sChoPhepTangCaSauGioLamViecChonTuMay3 == "True")
                                                        {
                                                            int iThoiGianSauGioLamViecChonTuMay3;
                                                            iThoiGianSauGioLamViecChonTuMay3 = Convert.ToInt32(Convert.ToInt32((dGioRaChonTuMay - dGioRaKhaiBaoChonTuMayB3).TotalMinutes).ToString());
                                                            if (iThoiGianSauGioLamViecChonTuMay3 > 0 && iThoiGianSauGioLamViecChonTuMay3 > iPhutTangCaSauGioLamViecChonTuMay3 && iThoiGianSauGioLamViecChonTuMay3 > iPhutTangCaSauGioLamViecDatDen7)
                                                            {
                                                                iTongGioTangCaSauChonTuMay3 = iThoiGianSauGioLamViecChonTuMay3 - iPhutTruTangCaSau7;
                                                            }
                                                        }
                                                    }
                                                    double dTongThoiGianTangCaChonTuMay3;
                                                    dTongThoiGianTangCaChonTuMay3 = Convert.ToDouble(iTongGioTangCaTruocChonTuMay3 + iTongGioTangCaSauChonTuMay3);
                                                    if (dTongThoiGianTangCaChonTuMay3 > 0.0)
                                                    {
                                                        if (iGioiHanTC1ChonTuMay3 == 0)
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = Math.Round(dTongThoiGianTangCaChonTuMay3 * this.dTangCa1HeSo / 60.0, this.iLamTronGio);
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                        }
                                                        if (iGioiHanTC1ChonTuMay3 != 0 && iGioiHanTC2ChonTuMay3 == 0)
                                                        {
                                                            if (dTongThoiGianTangCaChonTuMay3 < Convert.ToDouble(iGioiHanTC1ChonTuMay3))
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = Math.Round(dTongThoiGianTangCaChonTuMay3 * this.dTangCa1HeSo / 60.0, this.iLamTronGio);
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                            }
                                                            else
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = Math.Round(Convert.ToDouble(iGioiHanTC1ChonTuMay3) / 60.0 * this.dTangCa1HeSo, this.iLamTronGio);
                                                                if (dTongThoiGianTangCaChonTuMay3 - Convert.ToDouble(iGioiHanTC1ChonTuMay3) > 0.0)
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = Math.Round((dTongThoiGianTangCaChonTuMay3 - Convert.ToDouble(iGioiHanTC1ChonTuMay3)) * this.dTangCa2HeSo / 60.0, this.iLamTronGio);
                                                                }
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                            }
                                                        }
                                                        if (iGioiHanTC1ChonTuMay3 != 0 && iGioiHanTC2ChonTuMay3 != 0 && iGioiHanTC3ChonTuMay3 == 0)
                                                        {
                                                            if (dTongThoiGianTangCaChonTuMay3 < Convert.ToDouble(iGioiHanTC1ChonTuMay3))
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = Math.Round(dTongThoiGianTangCaChonTuMay3 * this.dTangCa1HeSo / 60.0, this.iLamTronGio);
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                            }
                                                            else
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = Math.Round(Convert.ToDouble(iGioiHanTC1ChonTuMay3) * this.dTangCa1HeSo / 60.0, this.iLamTronGio);
                                                                if (dTongThoiGianTangCaChonTuMay3 - Convert.ToDouble(iGioiHanTC1ChonTuMay3) < Convert.ToDouble(iGioiHanTC2ChonTuMay3))
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = Math.Round((dTongThoiGianTangCaChonTuMay3 - Convert.ToDouble(iGioiHanTC1ChonTuMay3)) * this.dTangCa2HeSo / 60.0, this.iLamTronGio);
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                                }
                                                                else
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = Math.Round(Convert.ToDouble(iGioiHanTC1ChonTuMay3) * this.dTangCa1HeSo / 60.0, this.iLamTronGio);
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = Math.Round(Convert.ToDouble(iGioiHanTC2ChonTuMay3) * this.dTangCa2HeSo / 60.0, this.iLamTronGio);
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = Math.Round((dTongThoiGianTangCaChonTuMay3 - Convert.ToDouble(iGioiHanTC1ChonTuMay3) - Convert.ToDouble(iGioiHanTC2ChonTuMay3)) * this.dTangCa3HeSo / 60.0, this.iLamTronGio);
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                                }
                                                            }
                                                        }
                                                        if (iGioiHanTC1ChonTuMay3 != 0 && iGioiHanTC2ChonTuMay3 != 0 && iGioiHanTC3ChonTuMay3 != 0 && iGioiHanTC4ChonTuMay3 != 0)
                                                        {
                                                        }
                                                    }
                                                    else
                                                    {
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                    }
                                                    string sTongGio3;
                                                    sTongGio3 = Math.Round(Convert.ToDouble(Convert.ToInt32((dGioRaChonTuMay - dGioVaoChonTuMay).TotalMinutes).ToString()) / 60.0, this.iLamTronGio).ToString();
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[16].Value = sTongGio3;
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[17].Value = dtCaLamViecChonTuMay3.Rows[iCaLamViecChonTuMay3]["CongTinh"].ToString();
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[18].Value = this.sKHDungGio;
                                                    if (DateTimeProgress.XuatIDThu((int)dt.AddDays(dem).DayOfWeek) == "0")
                                                    {
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[19].Value = "CN";
                                                    }
                                                    else
                                                    {
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[19].Value = "NT";
                                                    }
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[20].Value = this.sMaChamCong;
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[21].Value = this.sPhongBanTinhCong;
                                                }
                                                break;
                                            }
                                            continue;
                                        }
                                        dGioRaChonTuMay = Convert.ToDateTime(dateGioChamChonTuMay.ToString());
                                        this.DGVTinhCong.Rows[_nhanVien].Cells[6].Value = string.Format(this.sDinhDangThoiGian, dGioRaChonTuMay);
                                        iLanCham++;
                                        new DataTable();
                                        this._chiTietLichTrinhChoCalamViecDTO.MaLichTrinhCaLamViec = sLTCCLVNhanVien;
                                        this._chiTietLichTrinhChoCalamViecDTO.Thu = sThu;
                                        DataTable dtNhanCaChonTuMay2;
                                        dtNhanCaChonTuMay2 = this._chiTietLichTrinhChoCaLamViecBLL.ChiTietLichTrinhChoCaLamViecNhanCa(this._chiTietLichTrinhChoCalamViecDTO);
                                        int iChiTietLichTrinhChoCaLamViecChonTuMay2;
                                        iChiTietLichTrinhChoCaLamViecChonTuMay2 = 0;
                                        if (iChiTietLichTrinhChoCaLamViecChonTuMay2 >= dtNhanCaChonTuMay2.Rows.Count)
                                        {
                                            continue;
                                        }
                                        int cellChiTietLichTrinhChoCaLamViecChonTuMay2;
                                        cellChiTietLichTrinhChoCaLamViecChonTuMay2 = 3;
                                        while (true)
                                        {
                                            if (cellChiTietLichTrinhChoCaLamViecChonTuMay2 < 13)
                                            {
                                                kiemTraVao = 0;
                                                kiemTraRa = 0;
                                                this.sChonTuMayMaCaLamViec = dtNhanCaChonTuMay2.Rows[iChiTietLichTrinhChoCaLamViecChonTuMay2][cellChiTietLichTrinhChoCaLamViecChonTuMay2].ToString();
                                                new DataTable();
                                                DataTable dtChonTuMayCa2;
                                                dtChonTuMayCa2 = this._caLamViecBLL.CaLamViecGetByMaCaLamViec(sChonTuMayMaCaLamViec);
                                                int iChonTuMayCa2;
                                                iChonTuMayCa2 = 0;
                                                while (iChonTuMayCa2 < dtChonTuMayCa2.Rows.Count)
                                                {
                                                    this.sChonTuMayTenCaLamViec = dtChonTuMayCa2.Rows[iChonTuMayCa2]["CaLamViec"].ToString();
                                                    DateTime dBatDauVaoChonTuMayB2;
                                                    dBatDauVaoChonTuMayB2 = Convert.ToDateTime(sNgayCham + " " + string.Format("{0:T}", Convert.ToDateTime(dtChonTuMayCa2.Rows[iChonTuMayCa2]["BatDauVao"].ToString())));
                                                    DateTime dKetThucVaoChonTuMayB2;
                                                    dKetThucVaoChonTuMayB2 = Convert.ToDateTime(sNgayCham + " " + string.Format("{0:T}", Convert.ToDateTime(dtChonTuMayCa2.Rows[iChonTuMayCa2]["KetThucVao"].ToString())));
                                                    string sBatDauRaChonTuMayB2;
                                                    sBatDauRaChonTuMayB2 = sNgayCham + " " + string.Format("{0:T}", Convert.ToDateTime(dtChonTuMayCa2.Rows[iChonTuMayCa2]["BatDauRa"].ToString()));
                                                    DateTime dBatDauRaChonTuMayB2;
                                                    dBatDauRaChonTuMayB2 = Convert.ToDateTime(sBatDauRaChonTuMayB2);
                                                    dBatDauRaChonTuMayB2 = ((!(sBatDauRaChonTuMayB2 == "12:01:00 AM")) ? Convert.ToDateTime(dBatDauRaChonTuMayB2) : Convert.ToDateTime(dBatDauRaChonTuMayB2.AddDays(1.0).ToString()));
                                                    string sKetThucRaChonTuMayA2;
                                                    sKetThucRaChonTuMayA2 = string.Format("{0:T}", Convert.ToDateTime(dtChonTuMayCa2.Rows[iChonTuMayCa2]["KetThucRa"].ToString()));
                                                    DateTime dKetThucRaChonTuMayB2;
                                                    dKetThucRaChonTuMayB2 = Convert.ToDateTime(sNgayCham + " " + sKetThucRaChonTuMayA2);
                                                    dKetThucRaChonTuMayB2 = ((!(sKetThucRaChonTuMayA2 == "12:01:00 AM")) ? Convert.ToDateTime(dKetThucRaChonTuMayB2) : Convert.ToDateTime(dKetThucRaChonTuMayB2.AddDays(1.0).ToString()));
                                                    if (dGioVaoChonTuMay >= dBatDauVaoChonTuMayB2 && dGioVaoChonTuMay <= dKetThucVaoChonTuMayB2)
                                                    {
                                                        kiemTraVao++;
                                                    }
                                                    if (dGioRaChonTuMay >= dBatDauRaChonTuMayB2 && dGioRaChonTuMay <= dKetThucRaChonTuMayB2)
                                                    {
                                                        kiemTraRa++;
                                                    }
                                                    if (kiemTraVao != 1 || kiemTraRa != 1)
                                                    {
                                                        iChonTuMayCa2++;
                                                        continue;
                                                    }
                                                    goto IL_518f;
                                                }
                                                if (!(this.sChonTuMayMaCaLamViec == ""))
                                                {
                                                    cellChiTietLichTrinhChoCaLamViecChonTuMay2++;
                                                    continue;
                                                }
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[4].Value = ca;
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[11].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[16].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[17].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[18].Value = this.sKHVang;
                                                break;
                                            }
                                            goto IL_518f;
                                        IL_518f:
                                            this.DGVTinhCong.Rows[_nhanVien].Cells[4].Value = this.sChonTuMayTenCaLamViec;
                                            new DataTable();
                                            DataTable dtCaLamViecChonTuMay2;
                                            dtCaLamViecChonTuMay2 = this._caLamViecBLL.CaLamViecGetByMaCaLamViec(sChonTuMayMaCaLamViec);
                                            for (int iCaLamViecChonTuMay2 = 0; iCaLamViecChonTuMay2 < dtCaLamViecChonTuMay2.Rows.Count; iCaLamViecChonTuMay2++)
                                            {
                                                string sGiayGioVao6;
                                                sGiayGioVao6 = dGioVaoChonTuMay.Second.ToString();
                                                string sGiayGioRa6;
                                                sGiayGioRa6 = dGioRaChonTuMay.Second.ToString();
                                                DateTime dGioVaoKhaiBaoChonTuMayB2;
                                                dGioVaoKhaiBaoChonTuMayB2 = Convert.ToDateTime(sNgayCham + " " + string.Format("{0:T}", Convert.ToDateTime(dtCaLamViecChonTuMay2.Rows[iCaLamViecChonTuMay2]["GioVaoLamViec"].ToString())).Replace("00 ", sGiayGioVao6 + " "));
                                                DateTime dGioRaKhaiBaoChonTuMayB2;
                                                dGioRaKhaiBaoChonTuMayB2 = Convert.ToDateTime(sNgayCham + " " + string.Format("{0:T}", Convert.ToDateTime(dtCaLamViecChonTuMay2.Rows[iCaLamViecChonTuMay2]["GioKetThucLamViec"].ToString())).Replace("00 ", sGiayGioRa6 + " "));
                                                string sTruGioDiTre4;
                                                sTruGioDiTre4 = dtCaLamViecChonTuMay2.Rows[iCaLamViecChonTuMay2]["TruGioDiTre"].ToString();
                                                string sBatDauTinhDiTre4;
                                                sBatDauTinhDiTre4 = dtCaLamViecChonTuMay2.Rows[iCaLamViecChonTuMay2]["BatDauTinhDiTre"].ToString();
                                                int iChoPhepDiTre4;
                                                iChoPhepDiTre4 = Convert.ToInt32(dtCaLamViecChonTuMay2.Rows[iCaLamViecChonTuMay2]["ChoPhepDiTre"].ToString());
                                                string sPhutTre4;
                                                sPhutTre4 = Convert.ToInt32((dGioVaoChonTuMay - dGioVaoKhaiBaoChonTuMayB2).TotalMinutes).ToString();
                                                if (sTruGioDiTre4 == "True")
                                                {
                                                    if (Convert.ToInt32(sPhutTre4) < 0)
                                                    {
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = "0";
                                                    }
                                                    else
                                                    {
                                                        int iPhutTre4;
                                                        iPhutTre4 = Convert.ToInt32(sPhutTre4) - iChoPhepDiTre4;
                                                        if (sBatDauTinhDiTre4 == "True")
                                                        {
                                                            if (iPhutTre4 < 1)
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = "0";
                                                            }
                                                            else
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = iPhutTre4.ToString();
                                                            }
                                                        }
                                                        else if (iPhutTre4 < 1)
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = "0";
                                                        }
                                                        else
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = sPhutTre4;
                                                        }
                                                    }
                                                }
                                                else
                                                {
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = "0";
                                                }
                                                string sTruGioVeSom4;
                                                sTruGioVeSom4 = dtCaLamViecChonTuMay2.Rows[iCaLamViecChonTuMay2]["TruGioVeSom"].ToString();
                                                string sBatDauTinhVeSom4;
                                                sBatDauTinhVeSom4 = dtCaLamViecChonTuMay2.Rows[iCaLamViecChonTuMay2]["BatDauTinhVeSom"].ToString();
                                                int iChoPhepVeSom4;
                                                iChoPhepVeSom4 = Convert.ToInt32(dtCaLamViecChonTuMay2.Rows[iCaLamViecChonTuMay2]["ChoPhepVeSom"].ToString());
                                                string sPhutVeSom4;
                                                sPhutVeSom4 = Convert.ToInt32((dGioRaKhaiBaoChonTuMayB2 - dGioRaChonTuMay).TotalMinutes).ToString();
                                                if (sTruGioVeSom4 == "True")
                                                {
                                                    if (Convert.ToInt32(sPhutVeSom4) < 0)
                                                    {
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = "0";
                                                    }
                                                    else
                                                    {
                                                        int iPhutVeSom4;
                                                        iPhutVeSom4 = Convert.ToInt32(sPhutVeSom4) - iChoPhepVeSom4;
                                                        if (iPhutVeSom4 < 1)
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = "0";
                                                        }
                                                        else if (sBatDauTinhVeSom4 == "True")
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = iPhutVeSom4.ToString();
                                                        }
                                                        else
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = sPhutVeSom4;
                                                        }
                                                    }
                                                }
                                                else
                                                {
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = "0";
                                                }
                                                string sVeTre4;
                                                sVeTre4 = Convert.ToInt32((dGioRaChonTuMay - dGioRaKhaiBaoChonTuMayB2).TotalMinutes).ToString();
                                                if (Convert.ToInt32(sVeTre4) > 0)
                                                {
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[11].Value = sVeTre4;
                                                }
                                                else
                                                {
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[11].Value = "0";
                                                }
                                                double dGio4;
                                                dGio4 = Math.Round(Convert.ToDouble(Convert.ToSingle(dtCaLamViecChonTuMay2.Rows[iCaLamViecChonTuMay2]["TongGioTrongCaLamViec"]) * 60f - (float)(Convert.ToInt32(this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value.ToString()) + Convert.ToInt32(this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value))) / 60.0, this.iLamTronGio);
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = dGio4.ToString();
                                                double iGio4;
                                                iGio4 = Convert.ToDouble(dtCaLamViecChonTuMay2.Rows[iCaLamViecChonTuMay2]["TongGioTrongCaLamViec"].ToString());
                                                double dCongTinh4;
                                                dCongTinh4 = Convert.ToDouble(dtCaLamViecChonTuMay2.Rows[iCaLamViecChonTuMay2]["CongTinh"].ToString());
                                                double dCong4;
                                                dCong4 = Math.Round(dGio4 * dCongTinh4 / iGio4, this.iLamTronCong);
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = dCong4.ToString();
                                                string sTangCaTruocGioLamViec2;
                                                sTangCaTruocGioLamViec2 = dtCaLamViecChonTuMay2.Rows[iCaLamViecChonTuMay2]["TangCaTruocGioLamViec"].ToString();
                                                string sTangCaSauGioLamViec2;
                                                sTangCaSauGioLamViec2 = dtCaLamViecChonTuMay2.Rows[iCaLamViecChonTuMay2]["TangCaSauGioLamViec"].ToString();
                                                if (sTangCaTruocGioLamViec2 == "False" && sTangCaSauGioLamViec2 == "False")
                                                {
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                }
                                                string sXemCaNayLaTangCa2;
                                                sXemCaNayLaTangCa2 = dtCaLamViecChonTuMay2.Rows[iCaLamViecChonTuMay2]["XemCaNayLaTangCa"].ToString();
                                                int iTangCaMuc2;
                                                iTangCaMuc2 = Convert.ToInt32(dtCaLamViecChonTuMay2.Rows[iCaLamViecChonTuMay2]["TangCaMuc"].ToString());
                                                if (sXemCaNayLaTangCa2 == "True")
                                                {
                                                    if (iTangCaMuc2 == 1)
                                                    {
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = dGio4.ToString();
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                    }
                                                    if (iTangCaMuc2 == 2)
                                                    {
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = dGio4.ToString();
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                    }
                                                    if (iTangCaMuc2 == 3)
                                                    {
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = dGio4.ToString();
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                    }
                                                    if (iTangCaMuc2 == 4)
                                                    {
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = dGio4.ToString();
                                                    }
                                                }
                                                string sChoPhepTangCaTruocGioLamViecChonTuMay2;
                                                sChoPhepTangCaTruocGioLamViecChonTuMay2 = dtCaLamViecChonTuMay2.Rows[iCaLamViecChonTuMay2]["TangCaTruocGioLamViec"].ToString();
                                                int iPhutTangCaTruocGioLamViecChonTuMay2;
                                                iPhutTangCaTruocGioLamViecChonTuMay2 = Convert.ToInt32(dtCaLamViecChonTuMay2.Rows[iCaLamViecChonTuMay2]["SoPhutTangCaTruocGioLamViec"].ToString());
                                                int iPhutTangCaTruocGioLamViecDatDen5;
                                                iPhutTangCaTruocGioLamViecDatDen5 = Convert.ToInt32(dtCaLamViecChonTuMay2.Rows[iCaLamViecChonTuMay2]["TangCaTruocGioLamViecDatDen"].ToString());
                                                int iPhutTruTangCaTruoc5;
                                                iPhutTruTangCaTruoc5 = Convert.ToInt32(dtCaLamViecChonTuMay2.Rows[iCaLamViecChonTuMay2]["PhutTruTangCaTruoc"].ToString());
                                                string sChoPhepTangCaSauGioLamViecChonTuMay2;
                                                sChoPhepTangCaSauGioLamViecChonTuMay2 = dtCaLamViecChonTuMay2.Rows[iCaLamViecChonTuMay2]["TangCaSauGioLamViec"].ToString();
                                                int iPhutTangCaSauGioLamViecChonTuMay2;
                                                iPhutTangCaSauGioLamViecChonTuMay2 = Convert.ToInt32(dtCaLamViecChonTuMay2.Rows[iCaLamViecChonTuMay2]["SoPhutTangCaSauGioLamViec"].ToString());
                                                int iPhutTangCaSauGioLamViecDatDen5;
                                                iPhutTangCaSauGioLamViecDatDen5 = Convert.ToInt32(dtCaLamViecChonTuMay2.Rows[iCaLamViecChonTuMay2]["TangCaSauGioLamViecDatDen"].ToString());
                                                int iPhutTruTangCaSau5;
                                                iPhutTruTangCaSau5 = Convert.ToInt32(dtCaLamViecChonTuMay2.Rows[iCaLamViecChonTuMay2]["PhutTruTangCaSau"].ToString());
                                                int iGioiHanTC1ChonTuMay2;
                                                iGioiHanTC1ChonTuMay2 = Convert.ToInt32(dtCaLamViecChonTuMay2.Rows[iCaLamViecChonTuMay2]["GioiHanTangCa1"].ToString());
                                                int iGioiHanTC2ChonTuMay2;
                                                iGioiHanTC2ChonTuMay2 = Convert.ToInt32(dtCaLamViecChonTuMay2.Rows[iCaLamViecChonTuMay2]["GioiHanTangCa2"].ToString());
                                                int iGioiHanTC3ChonTuMay2;
                                                iGioiHanTC3ChonTuMay2 = Convert.ToInt32(dtCaLamViecChonTuMay2.Rows[iCaLamViecChonTuMay2]["GioiHanTangCa3"].ToString());
                                                int iGioiHanTC4ChonTuMay2;
                                                iGioiHanTC4ChonTuMay2 = Convert.ToInt32(dtCaLamViecChonTuMay2.Rows[iCaLamViecChonTuMay2]["GioiHanTangCa4"].ToString());
                                                int iTongGioTangCaSauChonTuMay2;
                                                iTongGioTangCaSauChonTuMay2 = 0;
                                                int iTongGioTangCaTruocChonTuMay2;
                                                iTongGioTangCaTruocChonTuMay2 = 0;
                                                if (sChoPhepTangCaTruocGioLamViecChonTuMay2 == "False" && sChoPhepTangCaSauGioLamViecChonTuMay2 == "False")
                                                {
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                }
                                                else
                                                {
                                                    if (sChoPhepTangCaTruocGioLamViecChonTuMay2 == "True")
                                                    {
                                                        int iThoiGianTruocGioLamChonTuMay2;
                                                        iThoiGianTruocGioLamChonTuMay2 = Convert.ToInt32(Convert.ToInt32((dGioVaoKhaiBaoChonTuMayB2 - dGioVaoChonTuMay).TotalMinutes).ToString());
                                                        if (iThoiGianTruocGioLamChonTuMay2 > 0 && iThoiGianTruocGioLamChonTuMay2 > iPhutTangCaTruocGioLamViecChonTuMay2 && iThoiGianTruocGioLamChonTuMay2 > iPhutTangCaTruocGioLamViecDatDen5)
                                                        {
                                                            iTongGioTangCaTruocChonTuMay2 = iThoiGianTruocGioLamChonTuMay2 - iPhutTruTangCaTruoc5;
                                                        }
                                                    }
                                                    if (sChoPhepTangCaSauGioLamViecChonTuMay2 == "True")
                                                    {
                                                        int iThoiGianSauGioLamViecChonTuMay2;
                                                        iThoiGianSauGioLamViecChonTuMay2 = Convert.ToInt32(Convert.ToInt32((dGioRaChonTuMay - dGioRaKhaiBaoChonTuMayB2).TotalMinutes).ToString());
                                                        if (iThoiGianSauGioLamViecChonTuMay2 > 0 && iThoiGianSauGioLamViecChonTuMay2 > iPhutTangCaSauGioLamViecChonTuMay2 && iThoiGianSauGioLamViecChonTuMay2 > iPhutTangCaSauGioLamViecDatDen5)
                                                        {
                                                            iTongGioTangCaSauChonTuMay2 = iThoiGianSauGioLamViecChonTuMay2 - iPhutTruTangCaSau5;
                                                        }
                                                    }
                                                }
                                                double dTongThoiGianTangCaChonTuMay2;
                                                dTongThoiGianTangCaChonTuMay2 = Convert.ToDouble(iTongGioTangCaTruocChonTuMay2 + iTongGioTangCaSauChonTuMay2);
                                                if (dTongThoiGianTangCaChonTuMay2 > 0.0)
                                                {
                                                    if (iGioiHanTC1ChonTuMay2 == 0)
                                                    {
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = Math.Round(dTongThoiGianTangCaChonTuMay2 * this.dTangCa1HeSo / 60.0, this.iLamTronGio);
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                    }
                                                    if (iGioiHanTC1ChonTuMay2 != 0 && iGioiHanTC2ChonTuMay2 == 0)
                                                    {
                                                        if (dTongThoiGianTangCaChonTuMay2 < Convert.ToDouble(iGioiHanTC1ChonTuMay2))
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = Math.Round(dTongThoiGianTangCaChonTuMay2 * this.dTangCa1HeSo / 60.0, this.iLamTronGio);
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                        }
                                                        else
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = Math.Round(Convert.ToDouble(iGioiHanTC1ChonTuMay2) / 60.0 * this.dTangCa1HeSo, this.iLamTronGio);
                                                            if (dTongThoiGianTangCaChonTuMay2 - Convert.ToDouble(iGioiHanTC1ChonTuMay2) > 0.0)
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = Math.Round((dTongThoiGianTangCaChonTuMay2 - Convert.ToDouble(iGioiHanTC1ChonTuMay2)) * this.dTangCa2HeSo / 60.0, this.iLamTronGio);
                                                            }
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                        }
                                                    }
                                                    if (iGioiHanTC1ChonTuMay2 != 0 && iGioiHanTC2ChonTuMay2 != 0 && iGioiHanTC3ChonTuMay2 == 0)
                                                    {
                                                        if (dTongThoiGianTangCaChonTuMay2 < Convert.ToDouble(iGioiHanTC1ChonTuMay2))
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = Math.Round(dTongThoiGianTangCaChonTuMay2 * this.dTangCa1HeSo / 60.0, this.iLamTronGio);
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                        }
                                                        else
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = Math.Round(Convert.ToDouble(iGioiHanTC1ChonTuMay2) * this.dTangCa1HeSo / 60.0, this.iLamTronGio);
                                                            if (dTongThoiGianTangCaChonTuMay2 - Convert.ToDouble(iGioiHanTC1ChonTuMay2) < Convert.ToDouble(iGioiHanTC2ChonTuMay2))
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = Math.Round((dTongThoiGianTangCaChonTuMay2 - Convert.ToDouble(iGioiHanTC1ChonTuMay2)) * this.dTangCa2HeSo / 60.0, this.iLamTronGio);
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                            }
                                                            else
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = Math.Round(Convert.ToDouble(iGioiHanTC1ChonTuMay2) * this.dTangCa1HeSo / 60.0, this.iLamTronGio);
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = Math.Round(Convert.ToDouble(iGioiHanTC2ChonTuMay2) * this.dTangCa2HeSo / 60.0, this.iLamTronGio);
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = Math.Round((dTongThoiGianTangCaChonTuMay2 - Convert.ToDouble(iGioiHanTC1ChonTuMay2) - Convert.ToDouble(iGioiHanTC2ChonTuMay2)) * this.dTangCa3HeSo / 60.0, this.iLamTronGio);
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                            }
                                                        }
                                                    }
                                                    if (iGioiHanTC1ChonTuMay2 != 0 && iGioiHanTC2ChonTuMay2 != 0 && iGioiHanTC3ChonTuMay2 != 0 && iGioiHanTC4ChonTuMay2 != 0)
                                                    {
                                                    }
                                                }
                                                else
                                                {
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                }
                                                string sTongGio2;
                                                sTongGio2 = Math.Round(Convert.ToDouble(Convert.ToInt32((dGioRaChonTuMay - dGioVaoChonTuMay).TotalMinutes).ToString()) / 60.0, this.iLamTronGio).ToString();
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[16].Value = sTongGio2;
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[17].Value = dtCaLamViecChonTuMay2.Rows[iCaLamViecChonTuMay2]["CongTinh"].ToString();
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[18].Value = this.sKHDungGio;
                                                if (DateTimeProgress.XuatIDThu((int)dt.AddDays(dem).DayOfWeek) == "0")
                                                {
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[19].Value = "CN";
                                                }
                                                else
                                                {
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[19].Value = "NT";
                                                }
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[20].Value = this.sMaChamCong;
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[21].Value = this.sPhongBanTinhCong;
                                            }
                                            break;
                                        }
                                        continue;
                                    }
                                    switch (iKiemTraB)
                                    {
                                        case 1:
                                            {
                                                DateTime dGioRaChonTuMay;
                                                dGioRaChonTuMay = Convert.ToDateTime(dateGioChamChonTuMay.ToString());
                                                this.DGVTinhCong.Rows[addChonTuMay].Cells[6].Value = string.Format(this.sDinhDangThoiGian, dGioRaChonTuMay);
                                                iKiemTraB = 0;
                                                new DataTable();
                                                this._chiTietLichTrinhChoCalamViecDTO.MaLichTrinhCaLamViec = sLTCCLVNhanVien;
                                                this._chiTietLichTrinhChoCalamViecDTO.Thu = sThu;
                                                DataTable dtNhanCaChonTuMay;
                                                dtNhanCaChonTuMay = this._chiTietLichTrinhChoCaLamViecBLL.ChiTietLichTrinhChoCaLamViecNhanCa(this._chiTietLichTrinhChoCalamViecDTO);
                                                int iChiTietLichTrinhChoCaLamViecChonTuMay;
                                                iChiTietLichTrinhChoCaLamViecChonTuMay = 0;
                                                if (iChiTietLichTrinhChoCaLamViecChonTuMay >= dtNhanCaChonTuMay.Rows.Count)
                                                {
                                                    continue;
                                                }
                                                int cellChiTietLichTrinhChoCaLamViecChonTuMay;
                                                cellChiTietLichTrinhChoCaLamViecChonTuMay = 3;
                                                while (true)
                                                {
                                                    if (cellChiTietLichTrinhChoCaLamViecChonTuMay < 13)
                                                    {
                                                        kiemTraVao = 0;
                                                        kiemTraRa = 0;
                                                        this.sChonTuMayMaCaLamViec = dtNhanCaChonTuMay.Rows[iChiTietLichTrinhChoCaLamViecChonTuMay][cellChiTietLichTrinhChoCaLamViecChonTuMay].ToString();
                                                        new DataTable();
                                                        DataTable dtChonTuMayCa1;
                                                        dtChonTuMayCa1 = this._caLamViecBLL.CaLamViecGetByMaCaLamViec(sChonTuMayMaCaLamViec);
                                                        int iChonTuMayCa1;
                                                        iChonTuMayCa1 = 0;
                                                        while (iChonTuMayCa1 < dtChonTuMayCa1.Rows.Count)
                                                        {
                                                            this.sChonTuMayTenCaLamViec = dtChonTuMayCa1.Rows[iChonTuMayCa1]["CaLamViec"].ToString();
                                                            DateTime dBatDauVaoChonTuMayB;
                                                            dBatDauVaoChonTuMayB = Convert.ToDateTime(sNgayCham + " " + string.Format("{0:T}", Convert.ToDateTime(dtChonTuMayCa1.Rows[iChonTuMayCa1]["BatDauVao"].ToString())));
                                                            DateTime dKetThucVaoChonTuMayB;
                                                            dKetThucVaoChonTuMayB = Convert.ToDateTime(sNgayCham + " " + string.Format("{0:T}", Convert.ToDateTime(dtChonTuMayCa1.Rows[iChonTuMayCa1]["KetThucVao"].ToString())));
                                                            string sBatDauRaChonTuMayB;
                                                            sBatDauRaChonTuMayB = sNgayCham + " " + string.Format("{0:T}", Convert.ToDateTime(dtChonTuMayCa1.Rows[iChonTuMayCa1]["BatDauRa"].ToString()));
                                                            DateTime dBatDauRaChonTuMayB;
                                                            dBatDauRaChonTuMayB = Convert.ToDateTime(sBatDauRaChonTuMayB);
                                                            dBatDauRaChonTuMayB = ((!(sBatDauRaChonTuMayB == "12:01:00 AM")) ? Convert.ToDateTime(dBatDauRaChonTuMayB) : Convert.ToDateTime(dBatDauRaChonTuMayB.AddDays(1.0).ToString()));
                                                            string sKetThucRaChonTuMayA;
                                                            sKetThucRaChonTuMayA = string.Format("{0:T}", Convert.ToDateTime(dtChonTuMayCa1.Rows[iChonTuMayCa1]["KetThucRa"].ToString()));
                                                            DateTime dKetThucRaChonTuMayB;
                                                            dKetThucRaChonTuMayB = Convert.ToDateTime(sNgayCham + " " + sKetThucRaChonTuMayA);
                                                            dKetThucRaChonTuMayB = ((!(sKetThucRaChonTuMayA == "12:01:00 AM")) ? Convert.ToDateTime(dKetThucRaChonTuMayB) : Convert.ToDateTime(dKetThucRaChonTuMayB.AddDays(1.0).ToString()));
                                                            if (dGioVaoChonTuMay >= dBatDauVaoChonTuMayB && dGioVaoChonTuMay <= dKetThucVaoChonTuMayB)
                                                            {
                                                                kiemTraVao++;
                                                            }
                                                            if (dGioRaChonTuMay >= dBatDauRaChonTuMayB && dGioRaChonTuMay <= dKetThucRaChonTuMayB)
                                                            {
                                                                kiemTraRa++;
                                                            }
                                                            if (kiemTraVao != 1 || kiemTraRa != 1)
                                                            {
                                                                iChonTuMayCa1++;
                                                                continue;
                                                            }
                                                            goto IL_6f90;
                                                        }
                                                        if (!(this.sChonTuMayMaCaLamViec == ""))
                                                        {
                                                            cellChiTietLichTrinhChoCaLamViecChonTuMay++;
                                                            continue;
                                                        }
                                                        this.DGVTinhCong.Rows[addChonTuMay].Cells[4].Value = ca;
                                                        this.DGVTinhCong.Rows[addChonTuMay].Cells[7].Value = "0";
                                                        this.DGVTinhCong.Rows[addChonTuMay].Cells[8].Value = "0";
                                                        this.DGVTinhCong.Rows[addChonTuMay].Cells[9].Value = "0";
                                                        this.DGVTinhCong.Rows[addChonTuMay].Cells[10].Value = "0";
                                                        this.DGVTinhCong.Rows[addChonTuMay].Cells[11].Value = "0";
                                                        this.DGVTinhCong.Rows[addChonTuMay].Cells[12].Value = "0";
                                                        this.DGVTinhCong.Rows[addChonTuMay].Cells[13].Value = "0";
                                                        this.DGVTinhCong.Rows[addChonTuMay].Cells[14].Value = "0";
                                                        this.DGVTinhCong.Rows[addChonTuMay].Cells[15].Value = "0";
                                                        this.DGVTinhCong.Rows[addChonTuMay].Cells[16].Value = "0";
                                                        this.DGVTinhCong.Rows[addChonTuMay].Cells[17].Value = "0";
                                                        this.DGVTinhCong.Rows[addChonTuMay].Cells[18].Value = this.sKHVang;
                                                        break;
                                                    }
                                                    goto IL_6f90;
                                                IL_6f90:
                                                    this.DGVTinhCong.Rows[addChonTuMay].Cells[4].Value = this.sChonTuMayTenCaLamViec;
                                                    new DataTable();
                                                    DataTable dtCaLamViecChonTuMay;
                                                    dtCaLamViecChonTuMay = this._caLamViecBLL.CaLamViecGetByMaCaLamViec(sChonTuMayMaCaLamViec);
                                                    for (int iCaLamViecChonTuMay = 0; iCaLamViecChonTuMay < dtCaLamViecChonTuMay.Rows.Count; iCaLamViecChonTuMay++)
                                                    {
                                                        string sGiayGioVao2;
                                                        sGiayGioVao2 = dGioVaoChonTuMay.Second.ToString();
                                                        string sGiayGioRa2;
                                                        sGiayGioRa2 = dGioRaChonTuMay.Second.ToString();
                                                        DateTime dGioVaoKhaiBaoChonTuMayB;
                                                        dGioVaoKhaiBaoChonTuMayB = Convert.ToDateTime(sNgayCham + " " + string.Format("{0:T}", Convert.ToDateTime(dtCaLamViecChonTuMay.Rows[iCaLamViecChonTuMay]["GioVaoLamViec"].ToString())).Replace("00 ", sGiayGioVao2 + " "));
                                                        DateTime dGioRaKhaiBaoChonTuMayB;
                                                        dGioRaKhaiBaoChonTuMayB = Convert.ToDateTime(sNgayCham + " " + string.Format("{0:T}", Convert.ToDateTime(dtCaLamViecChonTuMay.Rows[iCaLamViecChonTuMay]["GioKetThucLamViec"].ToString())).Replace("00 ", sGiayGioRa2 + " "));
                                                        string sTruGioDiTre2;
                                                        sTruGioDiTre2 = dtCaLamViecChonTuMay.Rows[iCaLamViecChonTuMay]["TruGioDiTre"].ToString();
                                                        string sBatDauTinhDiTre2;
                                                        sBatDauTinhDiTre2 = dtCaLamViecChonTuMay.Rows[iCaLamViecChonTuMay]["BatDauTinhDiTre"].ToString();
                                                        int iChoPhepDiTre2;
                                                        iChoPhepDiTre2 = Convert.ToInt32(dtCaLamViecChonTuMay.Rows[iCaLamViecChonTuMay]["ChoPhepDiTre"].ToString());
                                                        string sPhutTre2;
                                                        sPhutTre2 = Convert.ToInt32((dGioVaoChonTuMay - dGioVaoKhaiBaoChonTuMayB).TotalMinutes).ToString();
                                                        if (sTruGioDiTre2 == "True")
                                                        {
                                                            if (Convert.ToInt32(sPhutTre2) < 0)
                                                            {
                                                                this.DGVTinhCong.Rows[addChonTuMay].Cells[9].Value = "0";
                                                            }
                                                            else
                                                            {
                                                                int iPhutTre2;
                                                                iPhutTre2 = Convert.ToInt32(sPhutTre2) - iChoPhepDiTre2;
                                                                if (sBatDauTinhDiTre2 == "True")
                                                                {
                                                                    if (iPhutTre2 < 1)
                                                                    {
                                                                        this.DGVTinhCong.Rows[addChonTuMay].Cells[9].Value = "0";
                                                                    }
                                                                    else
                                                                    {
                                                                        this.DGVTinhCong.Rows[addChonTuMay].Cells[9].Value = iPhutTre2.ToString();
                                                                    }
                                                                }
                                                                else if (iPhutTre2 < 1)
                                                                {
                                                                    this.DGVTinhCong.Rows[addChonTuMay].Cells[9].Value = "0";
                                                                }
                                                                else
                                                                {
                                                                    this.DGVTinhCong.Rows[addChonTuMay].Cells[9].Value = sPhutTre2;
                                                                }
                                                            }
                                                        }
                                                        else
                                                        {
                                                            this.DGVTinhCong.Rows[addChonTuMay].Cells[9].Value = "0";
                                                        }
                                                        string sTruGioVeSom2;
                                                        sTruGioVeSom2 = dtCaLamViecChonTuMay.Rows[iCaLamViecChonTuMay]["TruGioVeSom"].ToString();
                                                        string sBatDauTinhVeSom2;
                                                        sBatDauTinhVeSom2 = dtCaLamViecChonTuMay.Rows[iCaLamViecChonTuMay]["BatDauTinhVeSom"].ToString();
                                                        int iChoPhepVeSom2;
                                                        iChoPhepVeSom2 = Convert.ToInt32(dtCaLamViecChonTuMay.Rows[iCaLamViecChonTuMay]["ChoPhepVeSom"].ToString());
                                                        string sPhutVeSom2;
                                                        sPhutVeSom2 = Convert.ToInt32((dGioRaKhaiBaoChonTuMayB - dGioRaChonTuMay).TotalMinutes).ToString();
                                                        if (sTruGioVeSom2 == "True")
                                                        {
                                                            if (Convert.ToInt32(sPhutVeSom2) < 0)
                                                            {
                                                                this.DGVTinhCong.Rows[addChonTuMay].Cells[10].Value = "0";
                                                            }
                                                            else
                                                            {
                                                                int iPhutVeSom2;
                                                                iPhutVeSom2 = Convert.ToInt32(sPhutVeSom2) - iChoPhepVeSom2;
                                                                if (iPhutVeSom2 < 1)
                                                                {
                                                                    this.DGVTinhCong.Rows[addChonTuMay].Cells[10].Value = "0";
                                                                }
                                                                else if (sBatDauTinhVeSom2 == "True")
                                                                {
                                                                    this.DGVTinhCong.Rows[addChonTuMay].Cells[10].Value = iPhutVeSom2.ToString();
                                                                }
                                                                else
                                                                {
                                                                    this.DGVTinhCong.Rows[addChonTuMay].Cells[10].Value = sPhutVeSom2;
                                                                }
                                                            }
                                                        }
                                                        else
                                                        {
                                                            this.DGVTinhCong.Rows[addChonTuMay].Cells[10].Value = "0";
                                                        }
                                                        string sVeTre2;
                                                        sVeTre2 = Convert.ToInt32((dGioRaChonTuMay - dGioRaKhaiBaoChonTuMayB).TotalMinutes).ToString();
                                                        if (Convert.ToInt32(sVeTre2) > 0)
                                                        {
                                                            this.DGVTinhCong.Rows[addChonTuMay].Cells[11].Value = sVeTre2;
                                                        }
                                                        else
                                                        {
                                                            this.DGVTinhCong.Rows[addChonTuMay].Cells[11].Value = "0";
                                                        }
                                                        double dGio2;
                                                        dGio2 = Math.Round(Convert.ToDouble(Convert.ToSingle(dtCaLamViecChonTuMay.Rows[iCaLamViecChonTuMay]["TongGioTrongCaLamViec"]) * 60f - (float)(Convert.ToInt32(this.DGVTinhCong.Rows[addChonTuMay].Cells[9].Value.ToString()) + Convert.ToInt32(this.DGVTinhCong.Rows[addChonTuMay].Cells[10].Value))) / 60.0, this.iLamTronGio);
                                                        this.DGVTinhCong.Rows[addChonTuMay].Cells[8].Value = dGio2.ToString();
                                                        double iGio2;
                                                        iGio2 = Convert.ToDouble(dtCaLamViecChonTuMay.Rows[iCaLamViecChonTuMay]["TongGioTrongCaLamViec"].ToString());
                                                        double dCongTinh2;
                                                        dCongTinh2 = Convert.ToDouble(dtCaLamViecChonTuMay.Rows[iCaLamViecChonTuMay]["CongTinh"].ToString());
                                                        double dCong2;
                                                        dCong2 = Math.Round(dGio2 * dCongTinh2 / iGio2, this.iLamTronCong);
                                                        this.DGVTinhCong.Rows[addChonTuMay].Cells[7].Value = dCong2.ToString();
                                                        string sTangCaTruocGioLamViec;
                                                        sTangCaTruocGioLamViec = dtCaLamViecChonTuMay.Rows[iCaLamViecChonTuMay]["TangCaTruocGioLamViec"].ToString();
                                                        string sTangCaSauGioLamViec;
                                                        sTangCaSauGioLamViec = dtCaLamViecChonTuMay.Rows[iCaLamViecChonTuMay]["TangCaSauGioLamViec"].ToString();
                                                        if (sTangCaTruocGioLamViec == "False" && sTangCaSauGioLamViec == "False")
                                                        {
                                                            this.DGVTinhCong.Rows[addChonTuMay].Cells[12].Value = "0";
                                                            this.DGVTinhCong.Rows[addChonTuMay].Cells[13].Value = "0";
                                                            this.DGVTinhCong.Rows[addChonTuMay].Cells[14].Value = "0";
                                                            this.DGVTinhCong.Rows[addChonTuMay].Cells[15].Value = "0";
                                                        }
                                                        string sXemCaNayLaTangCa;
                                                        sXemCaNayLaTangCa = dtCaLamViecChonTuMay.Rows[iCaLamViecChonTuMay]["XemCaNayLaTangCa"].ToString();
                                                        int iTangCaMuc;
                                                        iTangCaMuc = Convert.ToInt32(dtCaLamViecChonTuMay.Rows[iCaLamViecChonTuMay]["TangCaMuc"].ToString());
                                                        if (sXemCaNayLaTangCa == "True")
                                                        {
                                                            if (iTangCaMuc == 1)
                                                            {
                                                                this.DGVTinhCong.Rows[addChonTuMay].Cells[7].Value = "0";
                                                                this.DGVTinhCong.Rows[addChonTuMay].Cells[8].Value = "0";
                                                                this.DGVTinhCong.Rows[addChonTuMay].Cells[12].Value = dGio2.ToString();
                                                                this.DGVTinhCong.Rows[addChonTuMay].Cells[13].Value = "0";
                                                                this.DGVTinhCong.Rows[addChonTuMay].Cells[14].Value = "0";
                                                                this.DGVTinhCong.Rows[addChonTuMay].Cells[15].Value = "0";
                                                            }
                                                            if (iTangCaMuc == 2)
                                                            {
                                                                this.DGVTinhCong.Rows[addChonTuMay].Cells[7].Value = "0";
                                                                this.DGVTinhCong.Rows[addChonTuMay].Cells[8].Value = "0";
                                                                this.DGVTinhCong.Rows[addChonTuMay].Cells[12].Value = "0";
                                                                this.DGVTinhCong.Rows[addChonTuMay].Cells[13].Value = dGio2.ToString();
                                                                this.DGVTinhCong.Rows[addChonTuMay].Cells[14].Value = "0";
                                                                this.DGVTinhCong.Rows[addChonTuMay].Cells[15].Value = "0";
                                                            }
                                                            if (iTangCaMuc == 3)
                                                            {
                                                                this.DGVTinhCong.Rows[addChonTuMay].Cells[7].Value = "0";
                                                                this.DGVTinhCong.Rows[addChonTuMay].Cells[8].Value = "0";
                                                                this.DGVTinhCong.Rows[addChonTuMay].Cells[12].Value = "0";
                                                                this.DGVTinhCong.Rows[addChonTuMay].Cells[13].Value = "0";
                                                                this.DGVTinhCong.Rows[addChonTuMay].Cells[14].Value = dGio2.ToString();
                                                                this.DGVTinhCong.Rows[addChonTuMay].Cells[15].Value = "0";
                                                            }
                                                            if (iTangCaMuc == 4)
                                                            {
                                                                this.DGVTinhCong.Rows[addChonTuMay].Cells[7].Value = "0";
                                                                this.DGVTinhCong.Rows[addChonTuMay].Cells[8].Value = "0";
                                                                this.DGVTinhCong.Rows[addChonTuMay].Cells[12].Value = "0";
                                                                this.DGVTinhCong.Rows[addChonTuMay].Cells[13].Value = "0";
                                                                this.DGVTinhCong.Rows[addChonTuMay].Cells[14].Value = "0";
                                                                this.DGVTinhCong.Rows[addChonTuMay].Cells[15].Value = dGio2.ToString();
                                                            }
                                                        }
                                                        string sChoPhepTangCaTruocGioLamViecChonTuMay;
                                                        sChoPhepTangCaTruocGioLamViecChonTuMay = dtCaLamViecChonTuMay.Rows[iCaLamViecChonTuMay]["TangCaTruocGioLamViec"].ToString();
                                                        int iPhutTangCaTruocGioLamViecChonTuMay;
                                                        iPhutTangCaTruocGioLamViecChonTuMay = Convert.ToInt32(dtCaLamViecChonTuMay.Rows[iCaLamViecChonTuMay]["SoPhutTangCaTruocGioLamViec"].ToString());
                                                        int iPhutTangCaTruocGioLamViecDatDen3;
                                                        iPhutTangCaTruocGioLamViecDatDen3 = Convert.ToInt32(dtCaLamViecChonTuMay.Rows[iCaLamViecChonTuMay]["TangCaTruocGioLamViecDatDen"].ToString());
                                                        int iPhutTruTangCaTruoc3;
                                                        iPhutTruTangCaTruoc3 = Convert.ToInt32(dtCaLamViecChonTuMay.Rows[iCaLamViecChonTuMay]["PhutTruTangCaTruoc"].ToString());
                                                        string sChoPhepTangCaSauGioLamViecChonTuMay;
                                                        sChoPhepTangCaSauGioLamViecChonTuMay = dtCaLamViecChonTuMay.Rows[iCaLamViecChonTuMay]["TangCaSauGioLamViec"].ToString();
                                                        int iPhutTangCaSauGioLamViecChonTuMay;
                                                        iPhutTangCaSauGioLamViecChonTuMay = Convert.ToInt32(dtCaLamViecChonTuMay.Rows[iCaLamViecChonTuMay]["SoPhutTangCaSauGioLamViec"].ToString());
                                                        int iPhutTangCaSauGioLamViecDatDen3;
                                                        iPhutTangCaSauGioLamViecDatDen3 = Convert.ToInt32(dtCaLamViecChonTuMay.Rows[iCaLamViecChonTuMay]["TangCaSauGioLamViecDatDen"].ToString());
                                                        int iPhutTruTangCaSau3;
                                                        iPhutTruTangCaSau3 = Convert.ToInt32(dtCaLamViecChonTuMay.Rows[iCaLamViecChonTuMay]["PhutTruTangCaSau"].ToString());
                                                        int iGioiHanTC1ChonTuMay;
                                                        iGioiHanTC1ChonTuMay = Convert.ToInt32(dtCaLamViecChonTuMay.Rows[iCaLamViecChonTuMay]["GioiHanTangCa1"].ToString());
                                                        int iGioiHanTC2ChonTuMay;
                                                        iGioiHanTC2ChonTuMay = Convert.ToInt32(dtCaLamViecChonTuMay.Rows[iCaLamViecChonTuMay]["GioiHanTangCa2"].ToString());
                                                        int iGioiHanTC3ChonTuMay;
                                                        iGioiHanTC3ChonTuMay = Convert.ToInt32(dtCaLamViecChonTuMay.Rows[iCaLamViecChonTuMay]["GioiHanTangCa3"].ToString());
                                                        int iGioiHanTC4ChonTuMay;
                                                        iGioiHanTC4ChonTuMay = Convert.ToInt32(dtCaLamViecChonTuMay.Rows[iCaLamViecChonTuMay]["GioiHanTangCa4"].ToString());
                                                        int iTongGioTangCaSauChonTuMay;
                                                        iTongGioTangCaSauChonTuMay = 0;
                                                        int iTongGioTangCaTruocChonTuMay;
                                                        iTongGioTangCaTruocChonTuMay = 0;
                                                        if (sChoPhepTangCaTruocGioLamViecChonTuMay == "False" && sChoPhepTangCaSauGioLamViecChonTuMay == "False")
                                                        {
                                                            this.DGVTinhCong.Rows[addChonTuMay].Cells[12].Value = "0";
                                                            this.DGVTinhCong.Rows[addChonTuMay].Cells[13].Value = "0";
                                                            this.DGVTinhCong.Rows[addChonTuMay].Cells[14].Value = "0";
                                                            this.DGVTinhCong.Rows[addChonTuMay].Cells[15].Value = "0";
                                                        }
                                                        else
                                                        {
                                                            if (sChoPhepTangCaTruocGioLamViecChonTuMay == "True")
                                                            {
                                                                int iThoiGianTruocGioLamChonTuMay;
                                                                iThoiGianTruocGioLamChonTuMay = Convert.ToInt32(Convert.ToInt32((dGioVaoKhaiBaoChonTuMayB - dGioVaoChonTuMay).TotalMinutes).ToString());
                                                                if (iThoiGianTruocGioLamChonTuMay > 0 && iThoiGianTruocGioLamChonTuMay > iPhutTangCaTruocGioLamViecChonTuMay && iThoiGianTruocGioLamChonTuMay > iPhutTangCaTruocGioLamViecDatDen3)
                                                                {
                                                                    iTongGioTangCaTruocChonTuMay = iThoiGianTruocGioLamChonTuMay - iPhutTruTangCaTruoc3;
                                                                }
                                                            }
                                                            if (sChoPhepTangCaSauGioLamViecChonTuMay == "True")
                                                            {
                                                                int iThoiGianSauGioLamViecChonTuMay;
                                                                iThoiGianSauGioLamViecChonTuMay = Convert.ToInt32(Convert.ToInt32((dGioRaChonTuMay - dGioRaKhaiBaoChonTuMayB).TotalMinutes).ToString());
                                                                if (iThoiGianSauGioLamViecChonTuMay > 0 && iThoiGianSauGioLamViecChonTuMay > iPhutTangCaSauGioLamViecChonTuMay && iThoiGianSauGioLamViecChonTuMay > iPhutTangCaSauGioLamViecDatDen3)
                                                                {
                                                                    iTongGioTangCaSauChonTuMay = iThoiGianSauGioLamViecChonTuMay - iPhutTruTangCaSau3;
                                                                }
                                                            }
                                                        }
                                                        double dTongThoiGianTangCaChonTuMay;
                                                        dTongThoiGianTangCaChonTuMay = Convert.ToDouble(iTongGioTangCaTruocChonTuMay + iTongGioTangCaSauChonTuMay);
                                                        if (dTongThoiGianTangCaChonTuMay > 0.0)
                                                        {
                                                            if (iGioiHanTC1ChonTuMay == 0)
                                                            {
                                                                this.DGVTinhCong.Rows[addChonTuMay].Cells[12].Value = Math.Round(dTongThoiGianTangCaChonTuMay * this.dTangCa1HeSo / 60.0, this.iLamTronGio);
                                                                this.DGVTinhCong.Rows[addChonTuMay].Cells[13].Value = "0";
                                                                this.DGVTinhCong.Rows[addChonTuMay].Cells[14].Value = "0";
                                                                this.DGVTinhCong.Rows[addChonTuMay].Cells[15].Value = "0";
                                                            }
                                                            if (iGioiHanTC1ChonTuMay != 0 && iGioiHanTC2ChonTuMay == 0)
                                                            {
                                                                if (dTongThoiGianTangCaChonTuMay < Convert.ToDouble(iGioiHanTC1ChonTuMay))
                                                                {
                                                                    this.DGVTinhCong.Rows[addChonTuMay].Cells[12].Value = Math.Round(dTongThoiGianTangCaChonTuMay * this.dTangCa1HeSo / 60.0, this.iLamTronGio);
                                                                    this.DGVTinhCong.Rows[addChonTuMay].Cells[13].Value = "0";
                                                                    this.DGVTinhCong.Rows[addChonTuMay].Cells[14].Value = "0";
                                                                    this.DGVTinhCong.Rows[addChonTuMay].Cells[15].Value = "0";
                                                                }
                                                                else
                                                                {
                                                                    this.DGVTinhCong.Rows[addChonTuMay].Cells[12].Value = Math.Round(Convert.ToDouble(iGioiHanTC1ChonTuMay) / 60.0 * this.dTangCa1HeSo, this.iLamTronGio);
                                                                    if (dTongThoiGianTangCaChonTuMay - Convert.ToDouble(iGioiHanTC1ChonTuMay) > 0.0)
                                                                    {
                                                                        this.DGVTinhCong.Rows[addChonTuMay].Cells[13].Value = Math.Round((dTongThoiGianTangCaChonTuMay - Convert.ToDouble(iGioiHanTC1ChonTuMay)) * this.dTangCa2HeSo / 60.0, this.iLamTronGio);
                                                                    }
                                                                    this.DGVTinhCong.Rows[addChonTuMay].Cells[14].Value = "0";
                                                                    this.DGVTinhCong.Rows[addChonTuMay].Cells[15].Value = "0";
                                                                }
                                                            }
                                                            if (iGioiHanTC1ChonTuMay != 0 && iGioiHanTC2ChonTuMay != 0 && iGioiHanTC3ChonTuMay == 0)
                                                            {
                                                                if (dTongThoiGianTangCaChonTuMay < Convert.ToDouble(iGioiHanTC1ChonTuMay))
                                                                {
                                                                    this.DGVTinhCong.Rows[addChonTuMay].Cells[12].Value = Math.Round(dTongThoiGianTangCaChonTuMay * this.dTangCa1HeSo / 60.0, this.iLamTronGio);
                                                                    this.DGVTinhCong.Rows[addChonTuMay].Cells[13].Value = "0";
                                                                    this.DGVTinhCong.Rows[addChonTuMay].Cells[14].Value = "0";
                                                                    this.DGVTinhCong.Rows[addChonTuMay].Cells[15].Value = "0";
                                                                }
                                                                else
                                                                {
                                                                    this.DGVTinhCong.Rows[addChonTuMay].Cells[12].Value = Math.Round(Convert.ToDouble(iGioiHanTC1ChonTuMay) * this.dTangCa1HeSo / 60.0, this.iLamTronGio);
                                                                    if (dTongThoiGianTangCaChonTuMay - Convert.ToDouble(iGioiHanTC1ChonTuMay) < Convert.ToDouble(iGioiHanTC2ChonTuMay))
                                                                    {
                                                                        this.DGVTinhCong.Rows[addChonTuMay].Cells[13].Value = Math.Round((dTongThoiGianTangCaChonTuMay - Convert.ToDouble(iGioiHanTC1ChonTuMay)) * this.dTangCa2HeSo / 60.0, this.iLamTronGio);
                                                                        this.DGVTinhCong.Rows[addChonTuMay].Cells[14].Value = "0";
                                                                        this.DGVTinhCong.Rows[addChonTuMay].Cells[15].Value = "0";
                                                                    }
                                                                    else
                                                                    {
                                                                        this.DGVTinhCong.Rows[addChonTuMay].Cells[12].Value = Math.Round(Convert.ToDouble(iGioiHanTC1ChonTuMay) * this.dTangCa1HeSo / 60.0, this.iLamTronGio);
                                                                        this.DGVTinhCong.Rows[addChonTuMay].Cells[13].Value = Math.Round(Convert.ToDouble(iGioiHanTC2ChonTuMay) * this.dTangCa2HeSo / 60.0, this.iLamTronGio);
                                                                        this.DGVTinhCong.Rows[addChonTuMay].Cells[14].Value = Math.Round((dTongThoiGianTangCaChonTuMay - Convert.ToDouble(iGioiHanTC1ChonTuMay) - Convert.ToDouble(iGioiHanTC2ChonTuMay)) * this.dTangCa3HeSo / 60.0, this.iLamTronGio);
                                                                        this.DGVTinhCong.Rows[addChonTuMay].Cells[15].Value = "0";
                                                                    }
                                                                }
                                                            }
                                                            if (iGioiHanTC1ChonTuMay != 0 && iGioiHanTC2ChonTuMay != 0 && iGioiHanTC3ChonTuMay != 0 && iGioiHanTC4ChonTuMay != 0)
                                                            {
                                                            }
                                                        }
                                                        else
                                                        {
                                                            this.DGVTinhCong.Rows[addChonTuMay].Cells[12].Value = "0";
                                                            this.DGVTinhCong.Rows[addChonTuMay].Cells[13].Value = "0";
                                                            this.DGVTinhCong.Rows[addChonTuMay].Cells[14].Value = "0";
                                                            this.DGVTinhCong.Rows[addChonTuMay].Cells[15].Value = "0";
                                                        }
                                                        string sTongGio;
                                                        sTongGio = Math.Round(Convert.ToDouble(Convert.ToInt32((dGioRaChonTuMay - dGioVaoChonTuMay).TotalMinutes).ToString()) / 60.0, this.iLamTronGio).ToString();
                                                        this.DGVTinhCong.Rows[addChonTuMay].Cells[16].Value = sTongGio;
                                                        this.DGVTinhCong.Rows[addChonTuMay].Cells[17].Value = dtCaLamViecChonTuMay.Rows[iCaLamViecChonTuMay]["CongTinh"].ToString();
                                                        this.DGVTinhCong.Rows[addChonTuMay].Cells[18].Value = this.sKHDungGio;
                                                        if (DateTimeProgress.XuatIDThu((int)dt.AddDays(dem).DayOfWeek) == "0")
                                                        {
                                                            this.DGVTinhCong.Rows[addChonTuMay].Cells[19].Value = "CN";
                                                        }
                                                        else
                                                        {
                                                            this.DGVTinhCong.Rows[addChonTuMay].Cells[19].Value = "NT";
                                                        }
                                                        this.DGVTinhCong.Rows[addChonTuMay].Cells[20].Value = this.sMaChamCong;
                                                        this.DGVTinhCong.Rows[addChonTuMay].Cells[21].Value = this.sPhongBanTinhCong;
                                                    }
                                                    break;
                                                }
                                                continue;
                                            }
                                        case 0:
                                            {
                                                int addChonTuMayB;
                                                addChonTuMayB = this.DGVTinhCong.Rows.Add();
                                                DateTime dGioRaChonTuMay;
                                                dGioRaChonTuMay = Convert.ToDateTime(dateGioChamChonTuMay.ToString());
                                                this.DGVTinhCong.Rows[addChonTuMayB].Cells[6].Value = string.Format(this.sDinhDangThoiGian, dGioRaChonTuMay);
                                                this.DGVTinhCong.Rows[addChonTuMayB].Cells[0].Value = this.sMaNhanVien;
                                                this.DGVTinhCong.Rows[addChonTuMayB].Cells[1].Value = this.sTenNhanVien;
                                                this.DGVTinhCong.Rows[addChonTuMayB].Cells[2].Value = this.DGVTinhCong.Rows[_nhanVien].Cells[2].Value.ToString();
                                                this.DGVTinhCong.Rows[addChonTuMayB].Cells[4].Value = dt_ca.Rows.Cast<DataRow>().Where(x => x["MaChamCong"].ToString() == int.Parse(sMaNhanVien.Remove(0, 2)).ToString()).Select(x => x["D" + dtDinhDang.Day]);
                                                this.DGVTinhCong.Rows[addChonTuMayB].Cells[7].Value = "0";
                                                this.DGVTinhCong.Rows[addChonTuMayB].Cells[8].Value = "0";
                                                this.DGVTinhCong.Rows[addChonTuMayB].Cells[3].Value = DateTimeProgress.XuatThuTinhCong((int)dt.AddDays(dem).DayOfWeek);
                                                this.DGVTinhCong.Rows[addChonTuMayB].Cells[17].Value = "0";
                                                this.DGVTinhCong.Rows[addChonTuMayB].Cells[18].Value = this.sKHVang;
                                                if (DateTimeProgress.XuatIDThu((int)dt.AddDays(dem).DayOfWeek) == "0")
                                                {
                                                    this.DGVTinhCong.Rows[addChonTuMayB].Cells[19].Value = "CN";
                                                }
                                                else
                                                {
                                                    this.DGVTinhCong.Rows[addChonTuMayB].Cells[19].Value = "NT";
                                                }
                                                this.DGVTinhCong.Rows[addChonTuMayB].Cells[20].Value = this.sMaChamCong;
                                                this.DGVTinhCong.Rows[addChonTuMayB].Cells[21].Value = this.sPhongBanTinhCong;
                                                break;
                                            }
                                    }
                                }
                                iLanCham++;
                            }
                            if (iLanCham == 1)
                            {
                                this.DGVTinhCong.Rows[_nhanVien].Cells[0].Value = this.sMaNhanVien;
                                this.DGVTinhCong.Rows[_nhanVien].Cells[1].Value = this.sTenNhanVien;
                                this.DGVTinhCong.Rows[_nhanVien].Cells[2].Value = this.DGVTinhCong.Rows[_nhanVien].Cells[2].Value.ToString();
                                this.DGVTinhCong.Rows[_nhanVien].Cells[3].Value = DateTimeProgress.XuatThuTinhCong((int)dt.AddDays(dem).DayOfWeek);
                                this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = "0";
                                this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = "0";
                                this.DGVTinhCong.Rows[_nhanVien].Cells[17].Value = "0";
                                this.DGVTinhCong.Rows[_nhanVien].Cells[18].Value = this.sKHVang;
                                if (DateTimeProgress.XuatIDThu((int)dt.AddDays(dem).DayOfWeek) == "0")
                                {
                                    this.DGVTinhCong.Rows[_nhanVien].Cells[19].Value = "CN";
                                }
                                else
                                {
                                    this.DGVTinhCong.Rows[_nhanVien].Cells[19].Value = "NT";
                                }
                                this.DGVTinhCong.Rows[_nhanVien].Cells[20].Value = this.sMaChamCong;
                                this.DGVTinhCong.Rows[_nhanVien].Cells[21].Value = this.sPhongBanTinhCong;
                            }
                        }
                        if (iChonLichTrinh == 2)
                        {
                            int iKiemTraLanChamTuDongKhongQuaDemLichTrinhVaoRa;
                            iKiemTraLanChamTuDongKhongQuaDemLichTrinhVaoRa = 0;
                            int iKiemTraLanChamKhoangCachTuDongKhongQuaDemLichTrinhVaoRa;
                            iKiemTraLanChamKhoangCachTuDongKhongQuaDemLichTrinhVaoRa = 0;
                            int iKiemTraDuLieuTuDong;
                            iKiemTraDuLieuTuDong = 0;
                            int iKiemTraLanCham;
                            iKiemTraLanCham = 0;
                            int addTuDong;
                            addTuDong = 1;
                            DateTime dGioVaoTuDong;
                            dGioVaoTuDong = default(DateTime);
                            DateTime dGioRaTuDong;
                            dGioRaTuDong = default(DateTime);
                            DateTime dGioVaoTuDongKhongQuaDemLichTrinhVaoRa;
                            dGioVaoTuDongKhongQuaDemLichTrinhVaoRa = default(DateTime);
                            DateTime dGioRaTuDongKhongQuaDemLichTrinhVaoRa;
                            dGioRaTuDongKhongQuaDemLichTrinhVaoRa = default(DateTime);
                            new DataTable();
                            DataTable dtTuDong;
                            dtTuDong = this._checkInOutBLL.getCheckInOutByMaChamCongAndNgayCham(Convert.ToInt32(this.sMaChamCong), Convert.ToDateTime(Convert.ToDateTime(this.DGVTinhCong.Rows[_nhanVien].Cells[2].Value.ToString())));
                            for (int iTuDong = 0; iTuDong < dtTuDong.Rows.Count; iTuDong++)
                            {
                                iKiemTraLanChamTuDongKhongQuaDemLichTrinhVaoRa++;
                                if (iKiemTraLanChamTuDongKhongQuaDemLichTrinhVaoRa == 1)
                                {
                                    dGioVaoTuDongKhongQuaDemLichTrinhVaoRa = Convert.ToDateTime(dtTuDong.Rows[iTuDong]["GioCham"].ToString());
                                    if (dtTuDong.Rows.Count > 2 && iKiemTraLanChamKhoangCachTuDongKhongQuaDemLichTrinhVaoRa == 3)
                                    {
                                        if (Convert.ToInt32(Convert.ToInt32((dGioVaoTuDongKhongQuaDemLichTrinhVaoRa - dGioRaTuDongKhongQuaDemLichTrinhVaoRa).TotalMinutes).ToString()) < iKhoangCachGiuaHaiCapVaoRa)
                                        {
                                            iKiemTraLanChamTuDongKhongQuaDemLichTrinhVaoRa = 0;
                                            continue;
                                        }
                                        iKiemTraLanChamTuDongKhongQuaDemLichTrinhVaoRa = 1;
                                    }
                                }
                                if (iKiemTraLanChamTuDongKhongQuaDemLichTrinhVaoRa == 2)
                                {
                                    dGioRaTuDongKhongQuaDemLichTrinhVaoRa = Convert.ToDateTime(dtTuDong.Rows[iTuDong]["GioCham"].ToString());
                                    if (Convert.ToInt32(Convert.ToInt32((dGioRaTuDongKhongQuaDemLichTrinhVaoRa - dGioVaoTuDongKhongQuaDemLichTrinhVaoRa).TotalMinutes).ToString()) < iThoiGianNhoNhat)
                                    {
                                        iKiemTraLanChamTuDongKhongQuaDemLichTrinhVaoRa = 1;
                                        continue;
                                    }
                                    iKiemTraLanChamTuDongKhongQuaDemLichTrinhVaoRa = 0;
                                    iKiemTraLanChamKhoangCachTuDongKhongQuaDemLichTrinhVaoRa = 3;
                                }
                                iKiemTraDuLieuTuDong = 1;
                                iKiemTraLanCham++;
                                if (iKiemTraLanCham == 1)
                                {
                                    dGioVaoTuDong = Convert.ToDateTime(dtTuDong.Rows[iTuDong]["GioCham"].ToString());
                                    this.DGVTinhCong.Rows[_nhanVien].Cells[5].Value = string.Format(this.sDinhDangThoiGian, dGioVaoTuDong);
                                    this.DGVTinhCong.Rows[_nhanVien].Cells[0].Value = this.sMaNhanVien;
                                    this.DGVTinhCong.Rows[_nhanVien].Cells[1].Value = this.sTenNhanVien;
                                    this.DGVTinhCong.Rows[_nhanVien].Cells[2].Value = this.DGVTinhCong.Rows[_nhanVien].Cells[2].Value.ToString();
                                    this.DGVTinhCong.Rows[_nhanVien].Cells[3].Value = DateTimeProgress.XuatThuTinhCong((int)dt.AddDays(dem).DayOfWeek);
                                    new DataTable();
                                    this._chiTietLichTrinhChoCalamViecDTO.MaLichTrinhCaLamViec = sLTCCLVNhanVien;
                                    this._chiTietLichTrinhChoCalamViecDTO.Thu = sThu;
                                    DataTable dtNhanCaTuDongKhongQuaDem;
                                    dtNhanCaTuDongKhongQuaDem = this._chiTietLichTrinhChoCaLamViecBLL.ChiTietLichTrinhChoCaLamViecNhanCa(this._chiTietLichTrinhChoCalamViecDTO);
                                    int iChiTietLichTrinhChoCaLamViecTuDongKhongQuaDem;
                                    iChiTietLichTrinhChoCaLamViecTuDongKhongQuaDem = 0;
                                    if (iChiTietLichTrinhChoCaLamViecTuDongKhongQuaDem < dtNhanCaTuDongKhongQuaDem.Rows.Count)
                                    {
                                        int cellChiTietLichTrinhChoCaLamViecTuDongKhongQuaDem;
                                        cellChiTietLichTrinhChoCaLamViecTuDongKhongQuaDem = 3;
                                        while (true)
                                        {
                                            if (cellChiTietLichTrinhChoCaLamViecTuDongKhongQuaDem < 13)
                                            {
                                                kiemTraVao = 0;
                                                kiemTraRa = 0;
                                                this.sTuDongQuaDemMaCaLamViec = dtNhanCaTuDongKhongQuaDem.Rows[iChiTietLichTrinhChoCaLamViecTuDongKhongQuaDem][cellChiTietLichTrinhChoCaLamViecTuDongKhongQuaDem].ToString();
                                                new DataTable();
                                                DataTable dtTuDongQuaDemCa5;
                                                dtTuDongQuaDemCa5 = this._caLamViecBLL.CaLamViecGetByMaCaLamViec(sTuDongQuaDemMaCaLamViec);
                                                int iTuDongQuaDemCa5;
                                                iTuDongQuaDemCa5 = 0;
                                                while (iTuDongQuaDemCa5 < dtTuDongQuaDemCa5.Rows.Count)
                                                {
                                                    this.sTuDongQuaDemTenCaLamViec = dtTuDongQuaDemCa5.Rows[iTuDongQuaDemCa5]["CaLamViec"].ToString();
                                                    DateTime dBatDauVaoB5;
                                                    dBatDauVaoB5 = Convert.ToDateTime(sNgayCham + " " + string.Format("{0:T}", Convert.ToDateTime(dtTuDongQuaDemCa5.Rows[iTuDongQuaDemCa5]["BatDauVao"].ToString())));
                                                    DateTime dKetThucVaoB5;
                                                    dKetThucVaoB5 = Convert.ToDateTime(sNgayCham + " " + string.Format("{0:T}", Convert.ToDateTime(dtTuDongQuaDemCa5.Rows[iTuDongQuaDemCa5]["KetThucVao"].ToString())));
                                                    DateTime dBatDauRaB5;
                                                    dBatDauRaB5 = Convert.ToDateTime(sNgayCham + " " + string.Format("{0:T}", Convert.ToDateTime(dtTuDongQuaDemCa5.Rows[iTuDongQuaDemCa5]["BatDauRa"].ToString())));
                                                    DateTime dKetThucRaB5;
                                                    dKetThucRaB5 = Convert.ToDateTime(sNgayCham + " " + string.Format("{0:T}", Convert.ToDateTime(dtTuDongQuaDemCa5.Rows[iTuDongQuaDemCa5]["KetThucRa"].ToString())));
                                                    if (dGioVaoTuDong >= dBatDauVaoB5 && dGioVaoTuDong <= dKetThucVaoB5)
                                                    {
                                                        kiemTraVao++;
                                                    }
                                                    if (dGioVaoTuDong >= dBatDauRaB5 && dGioVaoTuDong <= dKetThucRaB5)
                                                    {
                                                        kiemTraRa++;
                                                    }
                                                    if ((kiemTraVao != 1 || kiemTraRa != 0) && (kiemTraVao != 0 || kiemTraRa != 1))
                                                    {
                                                        iTuDongQuaDemCa5++;
                                                        continue;
                                                    }
                                                    goto IL_9714;
                                                }
                                                if (!(this.sTuDongQuaDemMaCaLamViec == ""))
                                                {
                                                    cellChiTietLichTrinhChoCaLamViecTuDongKhongQuaDem++;
                                                    continue;
                                                }
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[4].Value = ca;
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[11].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[16].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[17].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[18].Value = this.sKHVang;
                                                if (DateTimeProgress.XuatIDThu((int)dt.AddDays(dem).DayOfWeek) == "0")
                                                {
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[19].Value = "CN";
                                                }
                                                else
                                                {
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[19].Value = "NT";
                                                }
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[20].Value = this.sMaChamCong;
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[21].Value = this.sPhongBanTinhCong;
                                                break;
                                            }
                                            goto IL_9714;
                                        IL_9714:
                                            this.DGVTinhCong.Rows[_nhanVien].Cells[4].Value = this.sTuDongQuaDemTenCaLamViec;
                                            new DataTable();
                                            DataTable dtCaLamViecFiloChamMotLan;
                                            dtCaLamViecFiloChamMotLan = this._caLamViecBLL.CaLamViecGetByMaCaLamViec(sTuDongQuaDemMaCaLamViec);
                                            for (int iCaLamViecFiLoChamMotLan = 0; iCaLamViecFiLoChamMotLan < dtCaLamViecFiloChamMotLan.Rows.Count; iCaLamViecFiLoChamMotLan++)
                                            {
                                                string sGiayGioVao13;
                                                sGiayGioVao13 = dGioVaoTuDong.Second.ToString();
                                                DateTime dGioVaoKhaiBaoFiloB;
                                                dGioVaoKhaiBaoFiloB = Convert.ToDateTime(sNgayCham + " " + string.Format("{0:T}", Convert.ToDateTime(dtCaLamViecFiloChamMotLan.Rows[iCaLamViecFiLoChamMotLan]["GioVaoLamViec"].ToString())).Replace("00 ", sGiayGioVao13 + " "));
                                                if (Convert.ToInt32(dtCaLamViecFiloChamMotLan.Rows[iCaLamViecFiLoChamMotLan]["KhongCoGioRa"].ToString()) == 0)
                                                {
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[16].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[17].Value = "0";
                                                }
                                                else if (kiemTraVao != 0)
                                                {
                                                    string sTruGioDiTre11;
                                                    sTruGioDiTre11 = dtCaLamViecFiloChamMotLan.Rows[iCaLamViecFiLoChamMotLan]["TruGioDiTre"].ToString();
                                                    string sBatDauTinhDiTre11;
                                                    sBatDauTinhDiTre11 = dtCaLamViecFiloChamMotLan.Rows[iCaLamViecFiLoChamMotLan]["BatDauTinhDiTre"].ToString();
                                                    int iChoPhepDiTre8;
                                                    iChoPhepDiTre8 = Convert.ToInt32(dtCaLamViecFiloChamMotLan.Rows[iCaLamViecFiLoChamMotLan]["ChoPhepDiTre"].ToString());
                                                    string sPhutTre8;
                                                    sPhutTre8 = Convert.ToInt32((dGioVaoTuDong - dGioVaoKhaiBaoFiloB).TotalMinutes).ToString();
                                                    if (sTruGioDiTre11 == "True")
                                                    {
                                                        if (Convert.ToInt32(sPhutTre8) < 0)
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = "0";
                                                        }
                                                        else
                                                        {
                                                            int iPhutTre8;
                                                            iPhutTre8 = Convert.ToInt32(sPhutTre8) - iChoPhepDiTre8;
                                                            if (sBatDauTinhDiTre11 == "True")
                                                            {
                                                                if (iPhutTre8 < 1)
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = "0";
                                                                }
                                                                else
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = iPhutTre8.ToString();
                                                                }
                                                            }
                                                            else if (iPhutTre8 < 1)
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = "0";
                                                            }
                                                            else
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = sPhutTre8;
                                                            }
                                                        }
                                                    }
                                                    else
                                                    {
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = "0";
                                                    }
                                                    double dGioChamMotLan;
                                                    dGioChamMotLan = Math.Round((Convert.ToDouble(dtCaLamViecFiloChamMotLan.Rows[iCaLamViecFiLoChamMotLan]["KhongCoGioRa"].ToString()) - Convert.ToDouble(this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value.ToString())) / 60.0, this.iLamTronGio);
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = dGioChamMotLan.ToString();
                                                    Math.Round(Convert.ToDouble(dtCaLamViecFiloChamMotLan.Rows[iCaLamViecFiLoChamMotLan]["KhongCoGioRa"].ToString()) / 60.0, 2);
                                                    double dCongChamMotLan;
                                                    dCongChamMotLan = Math.Round(dGioChamMotLan * Convert.ToDouble(dtCaLamViecFiloChamMotLan.Rows[iCaLamViecFiLoChamMotLan]["CongTinh"].ToString()) / Convert.ToDouble(dtCaLamViecFiloChamMotLan.Rows[iCaLamViecFiLoChamMotLan]["TongGioTrongCaLamViec"].ToString()), this.iLamTronCong);
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = dCongChamMotLan.ToString();
                                                }
                                                if (Convert.ToInt32(dtCaLamViecFiloChamMotLan.Rows[iCaLamViecFiLoChamMotLan]["KhongCoGioVao"].ToString()) == 0)
                                                {
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[16].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[17].Value = "0";
                                                }
                                                else if (kiemTraRa != 0)
                                                {
                                                    string sTruGioVeSom11;
                                                    sTruGioVeSom11 = dtCaLamViecFiloChamMotLan.Rows[iCaLamViecFiLoChamMotLan]["TruGioVeSom"].ToString();
                                                    string sBatDauTinhVeSom11;
                                                    sBatDauTinhVeSom11 = dtCaLamViecFiloChamMotLan.Rows[iCaLamViecFiLoChamMotLan]["BatDauTinhVeSom"].ToString();
                                                    int iChoPhepVeSom8;
                                                    iChoPhepVeSom8 = Convert.ToInt32(dtCaLamViecFiloChamMotLan.Rows[iCaLamViecFiLoChamMotLan]["ChoPhepVeSom"].ToString());
                                                    string sGiayGioRa14;
                                                    sGiayGioRa14 = dGioVaoTuDong.Second.ToString();
                                                    string sPhutVeSom8;
                                                    sPhutVeSom8 = Convert.ToInt32((Convert.ToDateTime(sNgayCham + " " + string.Format("{0:T}", Convert.ToDateTime(dtCaLamViecFiloChamMotLan.Rows[iCaLamViecFiLoChamMotLan]["GioKetThucLamViec"].ToString())).Replace("00 ", sGiayGioRa14 + " ")) - dGioVaoTuDong).TotalMinutes).ToString();
                                                    if (sTruGioVeSom11 == "True")
                                                    {
                                                        if (Convert.ToInt32(sPhutVeSom8) < 0)
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = "0";
                                                        }
                                                        else
                                                        {
                                                            int iPhutVeSom8;
                                                            iPhutVeSom8 = Convert.ToInt32(sPhutVeSom8) - iChoPhepVeSom8;
                                                            if (iPhutVeSom8 < 1)
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = "0";
                                                            }
                                                            else if (sBatDauTinhVeSom11 == "True")
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = iPhutVeSom8.ToString();
                                                            }
                                                            else
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = sPhutVeSom8;
                                                            }
                                                        }
                                                    }
                                                    else
                                                    {
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = "0";
                                                    }
                                                    double dGioChamMotLan2;
                                                    dGioChamMotLan2 = Math.Round((Convert.ToDouble(dtCaLamViecFiloChamMotLan.Rows[iCaLamViecFiLoChamMotLan]["KhongCoGioVao"].ToString()) - Convert.ToDouble(this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value.ToString())) / 60.0, this.iLamTronGio);
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = dGioChamMotLan2.ToString();
                                                    Math.Round(Convert.ToDouble(dtCaLamViecFiloChamMotLan.Rows[iCaLamViecFiLoChamMotLan]["KhongCoGioRa"].ToString()) / 60.0, 2);
                                                    double dCongChamMotLan2;
                                                    dCongChamMotLan2 = Math.Round(dGioChamMotLan2 * Convert.ToDouble(dtCaLamViecFiloChamMotLan.Rows[iCaLamViecFiLoChamMotLan]["CongTinh"].ToString()) / Convert.ToDouble(dtCaLamViecFiloChamMotLan.Rows[iCaLamViecFiLoChamMotLan]["TongGioTrongCaLamViec"].ToString()), this.iLamTronCong);
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = dCongChamMotLan2.ToString();
                                                }
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[11].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[16].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[17].Value = dtCaLamViecFiloChamMotLan.Rows[iCaLamViecFiLoChamMotLan]["CongTinh"].ToString();
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[18].Value = this.sKHThieuGioRa;
                                                if (DateTimeProgress.XuatIDThu((int)dt.AddDays(dem).DayOfWeek) == "0")
                                                {
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[19].Value = "CN";
                                                }
                                                else
                                                {
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[19].Value = "NT";
                                                }
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[20].Value = this.sMaChamCong;
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[21].Value = this.sPhongBanTinhCong;
                                            }
                                            break;
                                        }
                                    }
                                    _ = dtTuDong.Rows.Count;
                                }
                                if (iKiemTraLanCham == 2)
                                {
                                    dGioRaTuDong = Convert.ToDateTime(dtTuDong.Rows[iTuDong]["GioCham"].ToString());
                                    Convert.ToInt32((dGioRaTuDong - dGioVaoTuDong).TotalMinutes);
                                    if (Convert.ToInt32(Convert.ToInt32((dGioRaTuDongKhongQuaDemLichTrinhVaoRa - dGioVaoTuDongKhongQuaDemLichTrinhVaoRa).TotalMinutes).ToString()) > iThoiGianLonNhat)
                                    {
                                        int addTuDongKhongQuaDemThoiGianLonNhat;
                                        addTuDongKhongQuaDemThoiGianLonNhat = this.DGVTinhCong.Rows.Add();
                                        this.DGVTinhCong.Rows[addTuDongKhongQuaDemThoiGianLonNhat].Cells[0].Value = this.sMaNhanVien;
                                        this.DGVTinhCong.Rows[addTuDongKhongQuaDemThoiGianLonNhat].Cells[1].Value = this.sTenNhanVien;
                                        this.DGVTinhCong.Rows[addTuDongKhongQuaDemThoiGianLonNhat].Cells[2].Value = this.DGVTinhCong.Rows[_nhanVien].Cells[2].Value.ToString();
                                        this.DGVTinhCong.Rows[addTuDongKhongQuaDemThoiGianLonNhat].Cells[3].Value = DateTimeProgress.XuatThuTinhCong((int)dt.AddDays(dem).DayOfWeek);
                                        this.DGVTinhCong.Rows[addTuDongKhongQuaDemThoiGianLonNhat].Cells[4].Value = ca;
                                        this.DGVTinhCong.Rows[addTuDongKhongQuaDemThoiGianLonNhat].Cells[6].Value = string.Format(this.sDinhDangThoiGian, dGioRaTuDong);
                                        this.DGVTinhCong.Rows[addTuDongKhongQuaDemThoiGianLonNhat].Cells[7].Value = "0";
                                        this.DGVTinhCong.Rows[addTuDongKhongQuaDemThoiGianLonNhat].Cells[8].Value = "0";
                                        this.DGVTinhCong.Rows[addTuDongKhongQuaDemThoiGianLonNhat].Cells[9].Value = "0";
                                        this.DGVTinhCong.Rows[addTuDongKhongQuaDemThoiGianLonNhat].Cells[10].Value = "0";
                                        this.DGVTinhCong.Rows[addTuDongKhongQuaDemThoiGianLonNhat].Cells[11].Value = "0";
                                        this.DGVTinhCong.Rows[addTuDongKhongQuaDemThoiGianLonNhat].Cells[12].Value = "0";
                                        this.DGVTinhCong.Rows[addTuDongKhongQuaDemThoiGianLonNhat].Cells[13].Value = "0";
                                        this.DGVTinhCong.Rows[addTuDongKhongQuaDemThoiGianLonNhat].Cells[14].Value = "0";
                                        this.DGVTinhCong.Rows[addTuDongKhongQuaDemThoiGianLonNhat].Cells[15].Value = "0";
                                        this.DGVTinhCong.Rows[addTuDongKhongQuaDemThoiGianLonNhat].Cells[16].Value = "0";
                                        this.DGVTinhCong.Rows[addTuDongKhongQuaDemThoiGianLonNhat].Cells[17].Value = "0";
                                        this.DGVTinhCong.Rows[addTuDongKhongQuaDemThoiGianLonNhat].Cells[18].Value = this.sKHVang;
                                        if (DateTimeProgress.XuatIDThu((int)dt.AddDays(dem).DayOfWeek) == "0")
                                        {
                                            this.DGVTinhCong.Rows[addTuDongKhongQuaDemThoiGianLonNhat].Cells[19].Value = "CN";
                                        }
                                        else
                                        {
                                            this.DGVTinhCong.Rows[addTuDongKhongQuaDemThoiGianLonNhat].Cells[19].Value = "NT";
                                        }
                                        this.DGVTinhCong.Rows[addTuDongKhongQuaDemThoiGianLonNhat].Cells[20].Value = this.sMaChamCong;
                                        this.DGVTinhCong.Rows[addTuDongKhongQuaDemThoiGianLonNhat].Cells[21].Value = this.sPhongBanTinhCong;
                                    }
                                    else
                                    {
                                        this.DGVTinhCong.Rows[_nhanVien].Cells[6].Value = string.Format(this.sDinhDangThoiGian, dGioRaTuDong);
                                        new DataTable();
                                        this._chiTietLichTrinhChoCalamViecDTO.MaLichTrinhCaLamViec = sLTCCLVNhanVien;
                                        this._chiTietLichTrinhChoCalamViecDTO.Thu = sThu;
                                        DataTable dtNhanCaTuDongKhongQuaDem2;
                                        dtNhanCaTuDongKhongQuaDem2 = this._chiTietLichTrinhChoCaLamViecBLL.ChiTietLichTrinhChoCaLamViecNhanCa(this._chiTietLichTrinhChoCalamViecDTO);
                                        int iChiTietLichTrinhChoCaLamViecTuDongKhongQuaDem2;
                                        iChiTietLichTrinhChoCaLamViecTuDongKhongQuaDem2 = 0;
                                        if (iChiTietLichTrinhChoCaLamViecTuDongKhongQuaDem2 < dtNhanCaTuDongKhongQuaDem2.Rows.Count)
                                        {
                                            int cellChiTietLichTrinhChoCaLamViecTuDongKhongQuaDem2;
                                            cellChiTietLichTrinhChoCaLamViecTuDongKhongQuaDem2 = 3;
                                            while (true)
                                            {
                                                if (cellChiTietLichTrinhChoCaLamViecTuDongKhongQuaDem2 < 13)
                                                {
                                                    kiemTraVao = 0;
                                                    kiemTraRa = 0;
                                                    this.sTuDongQuaDemMaCaLamViec = dtNhanCaTuDongKhongQuaDem2.Rows[iChiTietLichTrinhChoCaLamViecTuDongKhongQuaDem2][cellChiTietLichTrinhChoCaLamViecTuDongKhongQuaDem2].ToString();
                                                    new DataTable();
                                                    DataTable dtTuDongQuaDemCa7;
                                                    dtTuDongQuaDemCa7 = this._caLamViecBLL.CaLamViecGetByMaCaLamViec(sTuDongQuaDemMaCaLamViec);
                                                    int iTuDongQuaDemCa7;
                                                    iTuDongQuaDemCa7 = 0;
                                                    while (iTuDongQuaDemCa7 < dtTuDongQuaDemCa7.Rows.Count)
                                                    {
                                                        string sGiayGioVao16;
                                                        sGiayGioVao16 = dGioVaoTuDong.Second.ToString();
                                                        string sGiayGioRa16;
                                                        sGiayGioRa16 = dGioRaTuDong.Second.ToString();
                                                        this.sTuDongQuaDemTenCaLamViec = dtTuDongQuaDemCa7.Rows[iTuDongQuaDemCa7]["CaLamViec"].ToString();
                                                        DateTime dBatDauVaoB7;
                                                        dBatDauVaoB7 = Convert.ToDateTime(sNgayCham + " " + string.Format("{0:T}", Convert.ToDateTime(dtTuDongQuaDemCa7.Rows[iTuDongQuaDemCa7]["BatDauVao"].ToString())).Replace("00 ", sGiayGioVao16 + " "));
                                                        DateTime dKetThucVaoB7;
                                                        dKetThucVaoB7 = Convert.ToDateTime(sNgayCham + " " + string.Format("{0:T}", Convert.ToDateTime(dtTuDongQuaDemCa7.Rows[iTuDongQuaDemCa7]["KetThucVao"].ToString())).Replace("00 ", sGiayGioVao16 + " "));
                                                        DateTime dBatDauRaB8;
                                                        dBatDauRaB8 = Convert.ToDateTime(sNgayCham + " " + string.Format("{0:T}", Convert.ToDateTime(dtTuDongQuaDemCa7.Rows[iTuDongQuaDemCa7]["BatDauRa"].ToString())).Replace("00 ", sGiayGioRa16 + " "));
                                                        DateTime dKetThucRaB8;
                                                        dKetThucRaB8 = Convert.ToDateTime(sNgayCham + " " + string.Format("{0:T}", Convert.ToDateTime(dtTuDongQuaDemCa7.Rows[iTuDongQuaDemCa7]["KetThucRa"].ToString())).Replace("00 ", sGiayGioRa16 + " "));
                                                        if (dtTuDongQuaDemCa7.Rows[iTuDongQuaDemCa7]["TinhBuTru"].ToString() == "True")
                                                        {
                                                            iTinhBuTru++;
                                                        }
                                                        if (dGioVaoTuDong >= dBatDauVaoB7 && dGioVaoTuDong <= dKetThucVaoB7)
                                                        {
                                                            kiemTraVao++;
                                                        }
                                                        if (dGioRaTuDong >= dBatDauRaB8 && dGioRaTuDong <= dKetThucRaB8)
                                                        {
                                                            kiemTraRa++;
                                                        }
                                                        if (kiemTraVao != 1 || kiemTraRa != 1)
                                                        {
                                                            iTuDongQuaDemCa7++;
                                                            continue;
                                                        }
                                                        goto IL_af91;
                                                    }
                                                    if (!(this.sTuDongQuaDemMaCaLamViec == ""))
                                                    {
                                                        cellChiTietLichTrinhChoCaLamViecTuDongKhongQuaDem2++;
                                                        continue;
                                                    }
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[4].Value = ca;
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[11].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[16].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[17].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[18].Value = this.sKHVang;
                                                    if (DateTimeProgress.XuatIDThu((int)dt.AddDays(dem).DayOfWeek) == "0")
                                                    {
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[19].Value = "CN";
                                                    }
                                                    else
                                                    {
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[19].Value = "NT";
                                                    }
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[20].Value = this.sMaChamCong;
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[21].Value = this.sPhongBanTinhCong;
                                                    break;
                                                }
                                                goto IL_af91;
                                            IL_af91:
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[4].Value = this.sTuDongQuaDemTenCaLamViec;
                                                new DataTable();
                                                DataTable dtCaLamViecTuDongKhongQuaDem;
                                                dtCaLamViecTuDongKhongQuaDem = this._caLamViecBLL.CaLamViecGetByMaCaLamViec(sTuDongQuaDemMaCaLamViec);
                                                for (int iCaLamViecTuDongKhongQuaDem = 0; iCaLamViecTuDongKhongQuaDem < dtCaLamViecTuDongKhongQuaDem.Rows.Count; iCaLamViecTuDongKhongQuaDem++)
                                                {
                                                    string sGiayGioVao17;
                                                    sGiayGioVao17 = dGioVaoTuDong.Second.ToString();
                                                    string sGiayGioRa17;
                                                    sGiayGioRa17 = dGioRaTuDong.Second.ToString();
                                                    DateTime dGioVaoKhaiBaoTuDongKhongQuaDemB;
                                                    dGioVaoKhaiBaoTuDongKhongQuaDemB = Convert.ToDateTime(sNgayCham + " " + string.Format("{0:T}", Convert.ToDateTime(dtCaLamViecTuDongKhongQuaDem.Rows[iCaLamViecTuDongKhongQuaDem]["GioVaoLamViec"].ToString())).Replace("00 ", sGiayGioVao17 + " "));
                                                    DateTime dGioRaKhaiBaoTuDongKhongQuaDemB;
                                                    dGioRaKhaiBaoTuDongKhongQuaDemB = Convert.ToDateTime(sNgayCham + " " + string.Format("{0:T}", Convert.ToDateTime(dtCaLamViecTuDongKhongQuaDem.Rows[iCaLamViecTuDongKhongQuaDem]["GioKetThucLamViec"].ToString())).Replace("00 ", sGiayGioRa17 + " "));
                                                    string sXemCaNayLaTangCa4;
                                                    sXemCaNayLaTangCa4 = dtCaLamViecTuDongKhongQuaDem.Rows[iCaLamViecTuDongKhongQuaDem]["XemCaNayLaTangCa"].ToString();
                                                    int iTangCaMuc4;
                                                    iTangCaMuc4 = Convert.ToInt32(dtCaLamViecTuDongKhongQuaDem.Rows[iCaLamViecTuDongKhongQuaDem]["TangCaMuc"].ToString());
                                                    string sXemChuNhatLaTangCa;
                                                    sXemChuNhatLaTangCa = dtCaLamViecTuDongKhongQuaDem.Rows[iCaLamViecTuDongKhongQuaDem]["XemCuoiTuanLaTangCa"].ToString();
                                                    int iTangCaChuNhatMuc;
                                                    iTangCaChuNhatMuc = Convert.ToInt32(dtCaLamViecTuDongKhongQuaDem.Rows[iCaLamViecTuDongKhongQuaDem]["TangCaCuoiTuanMuc"].ToString());
                                                    if (sXemCaNayLaTangCa4 == "True")
                                                    {
                                                        dtCaLamViecTuDongKhongQuaDem.Rows[iCaLamViecTuDongKhongQuaDem]["TruGioDiTre"].ToString();
                                                        dtCaLamViecTuDongKhongQuaDem.Rows[iCaLamViecTuDongKhongQuaDem]["BatDauTinhDiTre"].ToString();
                                                        Convert.ToInt32(dtCaLamViecTuDongKhongQuaDem.Rows[iCaLamViecTuDongKhongQuaDem]["ChoPhepDiTre"].ToString());
                                                        string sPhutTre14;
                                                        sPhutTre14 = Convert.ToInt32((dGioVaoTuDong - dGioVaoKhaiBaoTuDongKhongQuaDemB).TotalMinutes).ToString();
                                                        if (Convert.ToInt32(sPhutTre14) < 0)
                                                        {
                                                            sPhutTre14 = "0";
                                                        }
                                                        dtCaLamViecTuDongKhongQuaDem.Rows[iCaLamViecTuDongKhongQuaDem]["TruGioVeSom"].ToString();
                                                        dtCaLamViecTuDongKhongQuaDem.Rows[iCaLamViecTuDongKhongQuaDem]["BatDauTinhVeSom"].ToString();
                                                        Convert.ToInt32(dtCaLamViecTuDongKhongQuaDem.Rows[iCaLamViecTuDongKhongQuaDem]["ChoPhepVeSom"].ToString());
                                                        string sPhutVeSom14;
                                                        sPhutVeSom14 = Convert.ToInt32((dGioRaKhaiBaoTuDongKhongQuaDemB - dGioRaTuDong).TotalMinutes).ToString();
                                                        if (Convert.ToInt32(sPhutVeSom14) < 0)
                                                        {
                                                            sPhutVeSom14 = "0";
                                                        }
                                                        double dTongGioTangCaTuDongKhongQuaDem;
                                                        dTongGioTangCaTuDongKhongQuaDem = Math.Round((Convert.ToDouble(dtCaLamViecTuDongKhongQuaDem.Rows[iCaLamViecTuDongKhongQuaDem]["TongGioTrongCaLamViec"]) * 60.0 - (Convert.ToDouble(sPhutTre14) + Convert.ToDouble(sPhutVeSom14))) / 60.0, this.iLamTronGio);
                                                        if (iTangCaMuc4 == 1)
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = dTongGioTangCaTuDongKhongQuaDem * this.dTangCa1HeSo;
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[18].Value = this.sKHDungGio;
                                                        }
                                                        if (iTangCaMuc4 == 2)
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = dTongGioTangCaTuDongKhongQuaDem * this.dTangCa2HeSo;
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[18].Value = this.sKHDungGio;
                                                        }
                                                        if (iTangCaMuc4 == 3)
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = dTongGioTangCaTuDongKhongQuaDem * this.dTangCa3HeSo;
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[18].Value = this.sKHDungGio;
                                                        }
                                                        if (iTangCaMuc4 == 4)
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = dTongGioTangCaTuDongKhongQuaDem * this.dTangCa4HeSo;
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[18].Value = this.sKHDungGio;
                                                        }
                                                        continue;
                                                    }
                                                    if (DateTimeProgress.XuatIDThu((int)dt.AddDays(dem).DayOfWeek) == "0")
                                                    {
                                                        if (sXemChuNhatLaTangCa == "True")
                                                        {
                                                            dtCaLamViecTuDongKhongQuaDem.Rows[iCaLamViecTuDongKhongQuaDem]["TruGioDiTre"].ToString();
                                                            dtCaLamViecTuDongKhongQuaDem.Rows[iCaLamViecTuDongKhongQuaDem]["BatDauTinhDiTre"].ToString();
                                                            Convert.ToInt32(dtCaLamViecTuDongKhongQuaDem.Rows[iCaLamViecTuDongKhongQuaDem]["ChoPhepDiTre"].ToString());
                                                            string sPhutTre12;
                                                            sPhutTre12 = Convert.ToInt32((dGioVaoTuDong - dGioVaoKhaiBaoTuDongKhongQuaDemB).TotalMinutes).ToString();
                                                            if (Convert.ToInt32(sPhutTre12) < 0)
                                                            {
                                                                sPhutTre12 = "0";
                                                            }
                                                            dtCaLamViecTuDongKhongQuaDem.Rows[iCaLamViecTuDongKhongQuaDem]["TruGioVeSom"].ToString();
                                                            dtCaLamViecTuDongKhongQuaDem.Rows[iCaLamViecTuDongKhongQuaDem]["BatDauTinhVeSom"].ToString();
                                                            Convert.ToInt32(dtCaLamViecTuDongKhongQuaDem.Rows[iCaLamViecTuDongKhongQuaDem]["ChoPhepVeSom"].ToString());
                                                            string sPhutVeSom13;
                                                            sPhutVeSom13 = Convert.ToInt32((dGioRaKhaiBaoTuDongKhongQuaDemB - dGioRaTuDong).TotalMinutes).ToString();
                                                            if (Convert.ToInt32(sPhutVeSom13) < 0)
                                                            {
                                                                sPhutVeSom13 = "0";
                                                            }
                                                            double dTongGioTangCaTuDongKhongQuaDemA;
                                                            dTongGioTangCaTuDongKhongQuaDemA = Math.Round((Convert.ToDouble(dtCaLamViecTuDongKhongQuaDem.Rows[iCaLamViecTuDongKhongQuaDem]["TongGioTrongCaLamViec"]) * 60.0 - (Convert.ToDouble(sPhutTre12) + Convert.ToDouble(sPhutVeSom13))) / 60.0, this.iLamTronGio);
                                                            if (iTangCaChuNhatMuc == 1)
                                                            {
                                                                if (dTongGioTangCaTuDongKhongQuaDemA <= 3.0)
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = dTongGioTangCaTuDongKhongQuaDemA * this.dTangCaChuNhatHeSo;
                                                                }
                                                                else
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = 3.0 * this.dTangCaChuNhatHeSo;
                                                                }
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[18].Value = this.sKHDungGio;
                                                            }
                                                            if (iTangCaChuNhatMuc == 2)
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = dTongGioTangCaTuDongKhongQuaDemA * this.dTangCaChuNhatHeSo;
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[18].Value = this.sKHDungGio;
                                                            }
                                                            if (iTangCaChuNhatMuc == 3)
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = dTongGioTangCaTuDongKhongQuaDemA * this.dTangCaChuNhatHeSo;
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[18].Value = this.sKHDungGio;
                                                            }
                                                            if (iTangCaChuNhatMuc == 4)
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = dTongGioTangCaTuDongKhongQuaDemA * this.dTangCaChuNhatHeSo;
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[18].Value = this.sKHDungGio;
                                                            }
                                                            continue;
                                                        }
                                                        string sTruGioDiTre14;
                                                        sTruGioDiTre14 = dtCaLamViecTuDongKhongQuaDem.Rows[iCaLamViecTuDongKhongQuaDem]["TruGioDiTre"].ToString();
                                                        string sBatDauTinhDiTre14;
                                                        sBatDauTinhDiTre14 = dtCaLamViecTuDongKhongQuaDem.Rows[iCaLamViecTuDongKhongQuaDem]["BatDauTinhDiTre"].ToString();
                                                        int iChoPhepDiTre11;
                                                        iChoPhepDiTre11 = Convert.ToInt32(dtCaLamViecTuDongKhongQuaDem.Rows[iCaLamViecTuDongKhongQuaDem]["ChoPhepDiTre"].ToString());
                                                        string sPhutTre11;
                                                        sPhutTre11 = Convert.ToInt32((dGioVaoTuDong - dGioVaoKhaiBaoTuDongKhongQuaDemB).TotalMinutes).ToString();
                                                        if (sTruGioDiTre14 == "True")
                                                        {
                                                            if (Convert.ToInt32(sPhutTre11) < 0)
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = "0";
                                                            }
                                                            else
                                                            {
                                                                int iPhutTre11;
                                                                iPhutTre11 = Convert.ToInt32(sPhutTre11) - iChoPhepDiTre11;
                                                                if (sBatDauTinhDiTre14 == "True")
                                                                {
                                                                    if (iPhutTre11 < 1)
                                                                    {
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = "0";
                                                                    }
                                                                    else
                                                                    {
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = iPhutTre11.ToString();
                                                                    }
                                                                }
                                                                else if (iPhutTre11 < 1)
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = "0";
                                                                }
                                                                else
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = sPhutTre11;
                                                                }
                                                            }
                                                        }
                                                        else
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = "0";
                                                        }
                                                        string sTruGioVeSom14;
                                                        sTruGioVeSom14 = dtCaLamViecTuDongKhongQuaDem.Rows[iCaLamViecTuDongKhongQuaDem]["TruGioVeSom"].ToString();
                                                        string sBatDauTinhVeSom14;
                                                        sBatDauTinhVeSom14 = dtCaLamViecTuDongKhongQuaDem.Rows[iCaLamViecTuDongKhongQuaDem]["BatDauTinhVeSom"].ToString();
                                                        int iChoPhepVeSom11;
                                                        iChoPhepVeSom11 = Convert.ToInt32(dtCaLamViecTuDongKhongQuaDem.Rows[iCaLamViecTuDongKhongQuaDem]["ChoPhepVeSom"].ToString());
                                                        string sPhutVeSom11;
                                                        sPhutVeSom11 = Convert.ToInt32((dGioRaKhaiBaoTuDongKhongQuaDemB - dGioRaTuDong).TotalMinutes).ToString();
                                                        if (sTruGioVeSom14 == "True")
                                                        {
                                                            if (Convert.ToInt32(sPhutVeSom11) < 0)
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = "0";
                                                            }
                                                            else
                                                            {
                                                                int iPhutVeSom11;
                                                                iPhutVeSom11 = Convert.ToInt32(sPhutVeSom11) - iChoPhepVeSom11;
                                                                if (iPhutVeSom11 < 1)
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = "0";
                                                                }
                                                                else if (sBatDauTinhVeSom14 == "True")
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = iPhutVeSom11.ToString();
                                                                }
                                                                else
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = sPhutVeSom11;
                                                                }
                                                            }
                                                        }
                                                        else
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = "0";
                                                        }
                                                        string sVeTre10;
                                                        sVeTre10 = Convert.ToInt32((dGioRaTuDong - dGioRaKhaiBaoTuDongKhongQuaDemB).TotalMinutes).ToString();
                                                        if (Convert.ToInt32(sVeTre10) > 0)
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[11].Value = sVeTre10;
                                                        }
                                                        else
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[11].Value = "0";
                                                        }
                                                        double dGio10;
                                                        dGio10 = Math.Round(Convert.ToDouble(Convert.ToSingle(dtCaLamViecTuDongKhongQuaDem.Rows[iCaLamViecTuDongKhongQuaDem]["TongGioTrongCaLamViec"]) * 60f - (float)(Convert.ToInt32(this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value.ToString()) + Convert.ToInt32(this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value))) / 60.0, this.iLamTronGio);
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = dGio10 * this.dTangCaChuNhatHeSo;
                                                        double iGio10;
                                                        iGio10 = Convert.ToDouble(dtCaLamViecTuDongKhongQuaDem.Rows[iCaLamViecTuDongKhongQuaDem]["TongGioTrongCaLamViec"].ToString());
                                                        double dCong10;
                                                        dCong10 = Math.Round(dGio10 * Convert.ToDouble(dtCaLamViecTuDongKhongQuaDem.Rows[iCaLamViecTuDongKhongQuaDem]["CongTinh"].ToString()) / iGio10, this.iLamTronCong);
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = dCong10 * this.dTangCaChuNhatHeSo;
                                                        double dTongGioThucTeTuDongKhongQuaDem2;
                                                        dTongGioThucTeTuDongKhongQuaDem2 = Math.Round(Convert.ToDouble(Convert.ToInt32((dGioRaTuDong - dGioVaoTuDong).TotalMinutes).ToString()) / 60.0, this.iLamTronGio);
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[16].Value = dTongGioThucTeTuDongKhongQuaDem2 * this.dTangCaChuNhatHeSo;
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[17].Value = Convert.ToDouble(dtCaLamViecTuDongKhongQuaDem.Rows[iCaLamViecTuDongKhongQuaDem]["CongTinh"].ToString()) * this.dTangCaChuNhatHeSo;
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[18].Value = this.sKHDungGio;
                                                        string sChoPhepTangCaTruocGioLamViecTuDongKhongQuaDem2;
                                                        sChoPhepTangCaTruocGioLamViecTuDongKhongQuaDem2 = dtCaLamViecTuDongKhongQuaDem.Rows[iCaLamViecTuDongKhongQuaDem]["TangCaTruocGioLamViec"].ToString();
                                                        int iPhutTangCaTruocGioLamViecTuDongKhongQuaDem2;
                                                        iPhutTangCaTruocGioLamViecTuDongKhongQuaDem2 = Convert.ToInt32(dtCaLamViecTuDongKhongQuaDem.Rows[iCaLamViecTuDongKhongQuaDem]["SoPhutTangCaTruocGioLamViec"].ToString());
                                                        int iPhutTangCaTruocGioLamViecDatDen13;
                                                        iPhutTangCaTruocGioLamViecDatDen13 = Convert.ToInt32(dtCaLamViecTuDongKhongQuaDem.Rows[iCaLamViecTuDongKhongQuaDem]["TangCaTruocGioLamViecDatDen"].ToString());
                                                        int iPhutTruTangCaTruoc13;
                                                        iPhutTruTangCaTruoc13 = Convert.ToInt32(dtCaLamViecTuDongKhongQuaDem.Rows[iCaLamViecTuDongKhongQuaDem]["PhutTruTangCaTruoc"].ToString());
                                                        string sChoPhepTangCaSauGioLamViecTuDongKhongQuaDem2;
                                                        sChoPhepTangCaSauGioLamViecTuDongKhongQuaDem2 = dtCaLamViecTuDongKhongQuaDem.Rows[iCaLamViecTuDongKhongQuaDem]["TangCaSauGioLamViec"].ToString();
                                                        int iPhutTangCaSauGioLamViecTuDongKhongQuaDem2;
                                                        iPhutTangCaSauGioLamViecTuDongKhongQuaDem2 = Convert.ToInt32(dtCaLamViecTuDongKhongQuaDem.Rows[iCaLamViecTuDongKhongQuaDem]["SoPhutTangCaSauGioLamViec"].ToString());
                                                        int iPhutTangCaSauGioLamViecDatDen13;
                                                        iPhutTangCaSauGioLamViecDatDen13 = Convert.ToInt32(dtCaLamViecTuDongKhongQuaDem.Rows[iCaLamViecTuDongKhongQuaDem]["TangCaSauGioLamViecDatDen"].ToString());
                                                        int iPhutTruTangCaSau13;
                                                        iPhutTruTangCaSau13 = Convert.ToInt32(dtCaLamViecTuDongKhongQuaDem.Rows[iCaLamViecTuDongKhongQuaDem]["PhutTruTangCaSau"].ToString());
                                                        int iGioiHanTC1TuDongKhongQuaDem2;
                                                        iGioiHanTC1TuDongKhongQuaDem2 = Convert.ToInt32(dtCaLamViecTuDongKhongQuaDem.Rows[iCaLamViecTuDongKhongQuaDem]["GioiHanTangCa1"].ToString());
                                                        int iGioiHanTC2TuDongKhongQuaDem2;
                                                        iGioiHanTC2TuDongKhongQuaDem2 = Convert.ToInt32(dtCaLamViecTuDongKhongQuaDem.Rows[iCaLamViecTuDongKhongQuaDem]["GioiHanTangCa2"].ToString());
                                                        int iGioiHanTC3TuDongKhongQuaDem2;
                                                        iGioiHanTC3TuDongKhongQuaDem2 = Convert.ToInt32(dtCaLamViecTuDongKhongQuaDem.Rows[iCaLamViecTuDongKhongQuaDem]["GioiHanTangCa3"].ToString());
                                                        int iGioiHanTC4TuDongKhongQuaDem2;
                                                        iGioiHanTC4TuDongKhongQuaDem2 = Convert.ToInt32(dtCaLamViecTuDongKhongQuaDem.Rows[iCaLamViecTuDongKhongQuaDem]["GioiHanTangCa4"].ToString());
                                                        int iTongGioTangCaSauTuDongKhongQuaDem2;
                                                        iTongGioTangCaSauTuDongKhongQuaDem2 = 0;
                                                        int iTongGioTangCaTruocTuDongKhongQuaDem2;
                                                        iTongGioTangCaTruocTuDongKhongQuaDem2 = 0;
                                                        if (sChoPhepTangCaTruocGioLamViecTuDongKhongQuaDem2 == "False" && sChoPhepTangCaSauGioLamViecTuDongKhongQuaDem2 == "False")
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                        }
                                                        else
                                                        {
                                                            if (sChoPhepTangCaTruocGioLamViecTuDongKhongQuaDem2 == "True")
                                                            {
                                                                int iThoiGianTruocGioLamTuDongKhongQuaDem2;
                                                                iThoiGianTruocGioLamTuDongKhongQuaDem2 = Convert.ToInt32(Convert.ToInt32((dGioVaoKhaiBaoTuDongKhongQuaDemB - dGioVaoTuDong).TotalMinutes).ToString());
                                                                if (iThoiGianTruocGioLamTuDongKhongQuaDem2 > 0 && iThoiGianTruocGioLamTuDongKhongQuaDem2 > iPhutTangCaTruocGioLamViecTuDongKhongQuaDem2 && iThoiGianTruocGioLamTuDongKhongQuaDem2 > iPhutTangCaTruocGioLamViecDatDen13)
                                                                {
                                                                    iTongGioTangCaTruocTuDongKhongQuaDem2 = iThoiGianTruocGioLamTuDongKhongQuaDem2 - iPhutTruTangCaTruoc13;
                                                                }
                                                            }
                                                            if (sChoPhepTangCaSauGioLamViecTuDongKhongQuaDem2 == "True")
                                                            {
                                                                int iThoiGianSauGioLamViecTuDongKhongQuaDem2;
                                                                iThoiGianSauGioLamViecTuDongKhongQuaDem2 = Convert.ToInt32(Convert.ToInt32((dGioRaTuDong - dGioRaKhaiBaoTuDongKhongQuaDemB).TotalMinutes).ToString());
                                                                if (iThoiGianSauGioLamViecTuDongKhongQuaDem2 > 0 && iThoiGianSauGioLamViecTuDongKhongQuaDem2 > iPhutTangCaSauGioLamViecTuDongKhongQuaDem2)
                                                                {
                                                                    iTongGioTangCaSauTuDongKhongQuaDem2 = ((iThoiGianSauGioLamViecTuDongKhongQuaDem2 < iPhutTangCaSauGioLamViecDatDen13) ? iThoiGianSauGioLamViecTuDongKhongQuaDem2 : (iThoiGianSauGioLamViecTuDongKhongQuaDem2 - iPhutTruTangCaSau13));
                                                                }
                                                            }
                                                        }
                                                        double dTongThoiGianTangCaTuDongKhongQuaDem2;
                                                        dTongThoiGianTangCaTuDongKhongQuaDem2 = Convert.ToDouble(iTongGioTangCaTruocTuDongKhongQuaDem2 + iTongGioTangCaSauTuDongKhongQuaDem2);
                                                        if (dTongThoiGianTangCaTuDongKhongQuaDem2 > 0.0)
                                                        {
                                                            if (iGioiHanTC1TuDongKhongQuaDem2 == 0)
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = Math.Round(dTongThoiGianTangCaTuDongKhongQuaDem2 * this.dTangCa1HeSo / 60.0, this.iLamTronGio);
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                            }
                                                            if (iGioiHanTC1TuDongKhongQuaDem2 != 0 && iGioiHanTC2TuDongKhongQuaDem2 == 0)
                                                            {
                                                                if (dTongThoiGianTangCaTuDongKhongQuaDem2 < Convert.ToDouble(iGioiHanTC1TuDongKhongQuaDem2))
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = Math.Round(dTongThoiGianTangCaTuDongKhongQuaDem2 * this.dTangCa1HeSo / 60.0, this.iLamTronGio);
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                                }
                                                                else
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = Math.Round(Convert.ToDouble(iGioiHanTC1TuDongKhongQuaDem2) / 60.0 * this.dTangCa1HeSo, this.iLamTronGio);
                                                                    if (dTongThoiGianTangCaTuDongKhongQuaDem2 - Convert.ToDouble(iGioiHanTC1TuDongKhongQuaDem2) > 0.0)
                                                                    {
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = Math.Round((dTongThoiGianTangCaTuDongKhongQuaDem2 - Convert.ToDouble(iGioiHanTC1TuDongKhongQuaDem2)) * this.dTangCa2HeSo / 60.0, this.iLamTronGio);
                                                                    }
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                                }
                                                            }
                                                            if (iGioiHanTC1TuDongKhongQuaDem2 != 0 && iGioiHanTC2TuDongKhongQuaDem2 != 0 && iGioiHanTC3TuDongKhongQuaDem2 == 0)
                                                            {
                                                                if (dTongThoiGianTangCaTuDongKhongQuaDem2 < Convert.ToDouble(iGioiHanTC1TuDongKhongQuaDem2))
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = Math.Round(dTongThoiGianTangCaTuDongKhongQuaDem2 * this.dTangCa1HeSo / 60.0, this.iLamTronGio);
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                                }
                                                                else
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = Math.Round(Convert.ToDouble(iGioiHanTC1TuDongKhongQuaDem2) * this.dTangCa1HeSo / 60.0, this.iLamTronGio);
                                                                    if (dTongThoiGianTangCaTuDongKhongQuaDem2 - Convert.ToDouble(iGioiHanTC1TuDongKhongQuaDem2) < Convert.ToDouble(iGioiHanTC2TuDongKhongQuaDem2))
                                                                    {
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = Math.Round((dTongThoiGianTangCaTuDongKhongQuaDem2 - Convert.ToDouble(iGioiHanTC1TuDongKhongQuaDem2)) * this.dTangCa2HeSo / 60.0, this.iLamTronGio);
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                                    }
                                                                    else
                                                                    {
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = Math.Round(Convert.ToDouble(iGioiHanTC1TuDongKhongQuaDem2) * this.dTangCa1HeSo / 60.0, this.iLamTronGio);
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = Math.Round(Convert.ToDouble(iGioiHanTC2TuDongKhongQuaDem2) * this.dTangCa2HeSo / 60.0, this.iLamTronGio);
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = Math.Round((dTongThoiGianTangCaTuDongKhongQuaDem2 - Convert.ToDouble(iGioiHanTC1TuDongKhongQuaDem2) - Convert.ToDouble(iGioiHanTC2TuDongKhongQuaDem2)) * this.dTangCa3HeSo / 60.0, this.iLamTronGio);
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                                    }
                                                                }
                                                            }
                                                            if (iGioiHanTC1TuDongKhongQuaDem2 != 0 && iGioiHanTC2TuDongKhongQuaDem2 != 0 && iGioiHanTC3TuDongKhongQuaDem2 != 0 && iGioiHanTC4TuDongKhongQuaDem2 != 0)
                                                            {
                                                            }
                                                        }
                                                        else
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                        }
                                                        continue;
                                                    }
                                                    string sTruGioDiTre12;
                                                    sTruGioDiTre12 = dtCaLamViecTuDongKhongQuaDem.Rows[iCaLamViecTuDongKhongQuaDem]["TruGioDiTre"].ToString();
                                                    string sBatDauTinhDiTre12;
                                                    sBatDauTinhDiTre12 = dtCaLamViecTuDongKhongQuaDem.Rows[iCaLamViecTuDongKhongQuaDem]["BatDauTinhDiTre"].ToString();
                                                    int iChoPhepDiTre9;
                                                    iChoPhepDiTre9 = Convert.ToInt32(dtCaLamViecTuDongKhongQuaDem.Rows[iCaLamViecTuDongKhongQuaDem]["ChoPhepDiTre"].ToString());
                                                    string sPhutTre9;
                                                    sPhutTre9 = Convert.ToInt32((dGioVaoTuDong - dGioVaoKhaiBaoTuDongKhongQuaDemB).TotalMinutes).ToString();
                                                    if (sTruGioDiTre12 == "True")
                                                    {
                                                        if (Convert.ToInt32(sPhutTre9) < 0)
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = "0";
                                                        }
                                                        else
                                                        {
                                                            int iPhutTre9;
                                                            iPhutTre9 = Convert.ToInt32(sPhutTre9) - iChoPhepDiTre9;
                                                            if (sBatDauTinhDiTre12 == "True")
                                                            {
                                                                if (iPhutTre9 < 1)
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = "0";
                                                                }
                                                                else
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[5].Style.BackColor = Color.Lime;
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = iPhutTre9.ToString();
                                                                }
                                                            }
                                                            else if (iPhutTre9 < 1)
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = "0";
                                                            }
                                                            else
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = sPhutTre9;
                                                            }
                                                        }
                                                    }
                                                    else
                                                    {
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = "0";
                                                    }
                                                    string sTruGioVeSom12;
                                                    sTruGioVeSom12 = dtCaLamViecTuDongKhongQuaDem.Rows[iCaLamViecTuDongKhongQuaDem]["TruGioVeSom"].ToString();
                                                    string sBatDauTinhVeSom12;
                                                    sBatDauTinhVeSom12 = dtCaLamViecTuDongKhongQuaDem.Rows[iCaLamViecTuDongKhongQuaDem]["BatDauTinhVeSom"].ToString();
                                                    int iChoPhepVeSom9;
                                                    iChoPhepVeSom9 = Convert.ToInt32(dtCaLamViecTuDongKhongQuaDem.Rows[iCaLamViecTuDongKhongQuaDem]["ChoPhepVeSom"].ToString());
                                                    string sPhutVeSom9;
                                                    sPhutVeSom9 = Convert.ToInt32((dGioRaKhaiBaoTuDongKhongQuaDemB - dGioRaTuDong).TotalMinutes).ToString();
                                                    if (sTruGioVeSom12 == "True")
                                                    {
                                                        if (Convert.ToInt32(sPhutVeSom9) < 0)
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = "0";
                                                        }
                                                        else
                                                        {
                                                            int iPhutVeSom9;
                                                            iPhutVeSom9 = Convert.ToInt32(sPhutVeSom9) - iChoPhepVeSom9;
                                                            if (iPhutVeSom9 < 1)
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = "0";
                                                            }
                                                            else
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[6].Style.BackColor = Color.Yellow;
                                                                if (sBatDauTinhVeSom12 == "True")
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = iPhutVeSom9.ToString();
                                                                }
                                                                else
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = sPhutVeSom9;
                                                                }
                                                            }
                                                        }
                                                    }
                                                    else
                                                    {
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = "0";
                                                    }
                                                    string sVeTre8;
                                                    sVeTre8 = Convert.ToInt32((dGioRaTuDong - dGioRaKhaiBaoTuDongKhongQuaDemB).TotalMinutes).ToString();
                                                    if (Convert.ToInt32(sVeTre8) > 0)
                                                    {
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[11].Value = sVeTre8;
                                                    }
                                                    else
                                                    {
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[11].Value = "0";
                                                    }
                                                    double dGio8;
                                                    dGio8 = Math.Round(Convert.ToDouble(Convert.ToSingle(dtCaLamViecTuDongKhongQuaDem.Rows[iCaLamViecTuDongKhongQuaDem]["TongGioTrongCaLamViec"]) * 60f - (float)(Convert.ToInt32(this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value.ToString()) + Convert.ToInt32(this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value))) / 60.0, this.iLamTronGio);
                                                    double dTongGioTrongCa;
                                                    dTongGioTrongCa = Convert.ToDouble(dtCaLamViecTuDongKhongQuaDem.Rows[iCaLamViecTuDongKhongQuaDem]["TongGioTrongCaLamViec"].ToString());
                                                    if (iTinhBuTru != 0 && Convert.ToInt32(this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value) > 0 && Convert.ToInt32(this.DGVTinhCong.Rows[_nhanVien].Cells[11].Value) > 0)
                                                    {
                                                        int iVeTre;
                                                        iVeTre = Convert.ToInt32(this.DGVTinhCong.Rows[_nhanVien].Cells[11].Value);
                                                        dGio8 = Math.Round(dGio8 + Convert.ToDouble(iVeTre) / 60.0, 2);
                                                        if (dGio8 > dTongGioTrongCa)
                                                        {
                                                            iVeTre -= Convert.ToInt32(this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value);
                                                            dGio8 = dTongGioTrongCa;
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[11].Value = iVeTre;
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = dGio8.ToString();
                                                        }
                                                        else
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = dGio8.ToString();
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = Convert.ToInt32(sPhutTre9) - iVeTre;
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[11].Value = "0";
                                                        }
                                                    }
                                                    else
                                                    {
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = dGio8.ToString();
                                                    }
                                                    double iGio9;
                                                    iGio9 = Convert.ToDouble(dtCaLamViecTuDongKhongQuaDem.Rows[iCaLamViecTuDongKhongQuaDem]["TongGioTrongCaLamViec"].ToString());
                                                    double dCongTinh9;
                                                    dCongTinh9 = Convert.ToDouble(dtCaLamViecTuDongKhongQuaDem.Rows[iCaLamViecTuDongKhongQuaDem]["CongTinh"].ToString());
                                                    double dCong9;
                                                    dCong9 = Math.Round(dGio8 * dCongTinh9 / iGio9, this.iLamTronCong);
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = dCong9.ToString();
                                                    double dTongGioThucTeTuDongKhongQuaDem;
                                                    dTongGioThucTeTuDongKhongQuaDem = Math.Round(Convert.ToDouble(Convert.ToInt32((dGioRaTuDong - dGioVaoTuDong).TotalMinutes).ToString()) / 60.0, this.iLamTronGio);
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[16].Value = dTongGioThucTeTuDongKhongQuaDem.ToString();
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[17].Value = dtCaLamViecTuDongKhongQuaDem.Rows[iCaLamViecTuDongKhongQuaDem]["CongTinh"].ToString();
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[18].Value = this.sKHDungGio;
                                                    string sChoPhepTangCaTruocGioLamViecTuDongKhongQuaDem;
                                                    sChoPhepTangCaTruocGioLamViecTuDongKhongQuaDem = dtCaLamViecTuDongKhongQuaDem.Rows[iCaLamViecTuDongKhongQuaDem]["TangCaTruocGioLamViec"].ToString();
                                                    int iPhutTangCaTruocGioLamViecTuDongKhongQuaDem;
                                                    iPhutTangCaTruocGioLamViecTuDongKhongQuaDem = Convert.ToInt32(dtCaLamViecTuDongKhongQuaDem.Rows[iCaLamViecTuDongKhongQuaDem]["SoPhutTangCaTruocGioLamViec"].ToString());
                                                    int iPhutTangCaTruocGioLamViecDatDen12;
                                                    iPhutTangCaTruocGioLamViecDatDen12 = Convert.ToInt32(dtCaLamViecTuDongKhongQuaDem.Rows[iCaLamViecTuDongKhongQuaDem]["TangCaTruocGioLamViecDatDen"].ToString());
                                                    int iPhutTruTangCaTruoc12;
                                                    iPhutTruTangCaTruoc12 = Convert.ToInt32(dtCaLamViecTuDongKhongQuaDem.Rows[iCaLamViecTuDongKhongQuaDem]["PhutTruTangCaTruoc"].ToString());
                                                    string sChoPhepTangCaSauGioLamViecTuDongKhongQuaDem;
                                                    sChoPhepTangCaSauGioLamViecTuDongKhongQuaDem = dtCaLamViecTuDongKhongQuaDem.Rows[iCaLamViecTuDongKhongQuaDem]["TangCaSauGioLamViec"].ToString();
                                                    int iPhutTangCaSauGioLamViecTuDongKhongQuaDem;
                                                    iPhutTangCaSauGioLamViecTuDongKhongQuaDem = Convert.ToInt32(dtCaLamViecTuDongKhongQuaDem.Rows[iCaLamViecTuDongKhongQuaDem]["SoPhutTangCaSauGioLamViec"].ToString());
                                                    int iPhutTangCaSauGioLamViecDatDen12;
                                                    iPhutTangCaSauGioLamViecDatDen12 = Convert.ToInt32(dtCaLamViecTuDongKhongQuaDem.Rows[iCaLamViecTuDongKhongQuaDem]["TangCaSauGioLamViecDatDen"].ToString());
                                                    int iPhutTruTangCaSau12;
                                                    iPhutTruTangCaSau12 = Convert.ToInt32(dtCaLamViecTuDongKhongQuaDem.Rows[iCaLamViecTuDongKhongQuaDem]["PhutTruTangCaSau"].ToString());
                                                    int iGioiHanTC1TuDongKhongQuaDem;
                                                    iGioiHanTC1TuDongKhongQuaDem = Convert.ToInt32(dtCaLamViecTuDongKhongQuaDem.Rows[iCaLamViecTuDongKhongQuaDem]["GioiHanTangCa1"].ToString());
                                                    int iGioiHanTC2TuDongKhongQuaDem;
                                                    iGioiHanTC2TuDongKhongQuaDem = Convert.ToInt32(dtCaLamViecTuDongKhongQuaDem.Rows[iCaLamViecTuDongKhongQuaDem]["GioiHanTangCa2"].ToString());
                                                    int iGioiHanTC3TuDongKhongQuaDem;
                                                    iGioiHanTC3TuDongKhongQuaDem = Convert.ToInt32(dtCaLamViecTuDongKhongQuaDem.Rows[iCaLamViecTuDongKhongQuaDem]["GioiHanTangCa3"].ToString());
                                                    int iGioiHanTC4TuDongKhongQuaDem;
                                                    iGioiHanTC4TuDongKhongQuaDem = Convert.ToInt32(dtCaLamViecTuDongKhongQuaDem.Rows[iCaLamViecTuDongKhongQuaDem]["GioiHanTangCa4"].ToString());
                                                    int iTongGioTangCaSauTuDongKhongQuaDem;
                                                    iTongGioTangCaSauTuDongKhongQuaDem = 0;
                                                    int iTongGioTangCaTruocTuDongKhongQuaDem;
                                                    iTongGioTangCaTruocTuDongKhongQuaDem = 0;
                                                    if (sChoPhepTangCaTruocGioLamViecTuDongKhongQuaDem == "False" && sChoPhepTangCaSauGioLamViecTuDongKhongQuaDem == "False")
                                                    {
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                    }
                                                    else
                                                    {
                                                        if (sChoPhepTangCaTruocGioLamViecTuDongKhongQuaDem == "True")
                                                        {
                                                            int iThoiGianTruocGioLamTuDongKhongQuaDem;
                                                            iThoiGianTruocGioLamTuDongKhongQuaDem = Convert.ToInt32(Convert.ToInt32((dGioVaoKhaiBaoTuDongKhongQuaDemB - dGioVaoTuDong).TotalMinutes).ToString());
                                                            if (iThoiGianTruocGioLamTuDongKhongQuaDem > 0 && iThoiGianTruocGioLamTuDongKhongQuaDem > iPhutTangCaTruocGioLamViecTuDongKhongQuaDem && iThoiGianTruocGioLamTuDongKhongQuaDem > iPhutTangCaTruocGioLamViecDatDen12)
                                                            {
                                                                iTongGioTangCaTruocTuDongKhongQuaDem = iThoiGianTruocGioLamTuDongKhongQuaDem - iPhutTruTangCaTruoc12;
                                                            }
                                                        }
                                                        if (sChoPhepTangCaSauGioLamViecTuDongKhongQuaDem == "True")
                                                        {
                                                            int iThoiGianSauGioLamViecTuDongKhongQuaDem;
                                                            iThoiGianSauGioLamViecTuDongKhongQuaDem = Convert.ToInt32(this.DGVTinhCong.Rows[_nhanVien].Cells[11].Value);
                                                            if (iThoiGianSauGioLamViecTuDongKhongQuaDem > 0 && iThoiGianSauGioLamViecTuDongKhongQuaDem > iPhutTangCaSauGioLamViecTuDongKhongQuaDem)
                                                            {
                                                                iTongGioTangCaSauTuDongKhongQuaDem = ((iThoiGianSauGioLamViecTuDongKhongQuaDem < iPhutTangCaSauGioLamViecDatDen12) ? iThoiGianSauGioLamViecTuDongKhongQuaDem : (iThoiGianSauGioLamViecTuDongKhongQuaDem - iPhutTruTangCaSau12));
                                                            }
                                                        }
                                                    }
                                                    double dTongThoiGianTangCaTuDongKhongQuaDem;
                                                    dTongThoiGianTangCaTuDongKhongQuaDem = Convert.ToDouble(iTongGioTangCaTruocTuDongKhongQuaDem + iTongGioTangCaSauTuDongKhongQuaDem);
                                                    if (dTongThoiGianTangCaTuDongKhongQuaDem > 0.0)
                                                    {
                                                        if (iGioiHanTC1TuDongKhongQuaDem == 0)
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = Math.Round(dTongThoiGianTangCaTuDongKhongQuaDem * this.dTangCa1HeSo / 60.0, this.iLamTronGio);
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                        }
                                                        if (iGioiHanTC1TuDongKhongQuaDem != 0 && iGioiHanTC2TuDongKhongQuaDem == 0)
                                                        {
                                                            if (dTongThoiGianTangCaTuDongKhongQuaDem < Convert.ToDouble(iGioiHanTC1TuDongKhongQuaDem))
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = Math.Round(dTongThoiGianTangCaTuDongKhongQuaDem * this.dTangCa1HeSo / 60.0, this.iLamTronGio);
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                            }
                                                            else
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = Math.Round(Convert.ToDouble(iGioiHanTC1TuDongKhongQuaDem) / 60.0 * this.dTangCa1HeSo, this.iLamTronGio);
                                                                if (dTongThoiGianTangCaTuDongKhongQuaDem - Convert.ToDouble(iGioiHanTC1TuDongKhongQuaDem) > 0.0)
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = Math.Round((dTongThoiGianTangCaTuDongKhongQuaDem - Convert.ToDouble(iGioiHanTC1TuDongKhongQuaDem)) * this.dTangCa2HeSo / 60.0, this.iLamTronGio);
                                                                }
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                            }
                                                        }
                                                        if (iGioiHanTC1TuDongKhongQuaDem != 0 && iGioiHanTC2TuDongKhongQuaDem != 0 && iGioiHanTC3TuDongKhongQuaDem == 0)
                                                        {
                                                            if (dTongThoiGianTangCaTuDongKhongQuaDem < Convert.ToDouble(iGioiHanTC1TuDongKhongQuaDem))
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = Math.Round(dTongThoiGianTangCaTuDongKhongQuaDem * this.dTangCa1HeSo / 60.0, this.iLamTronGio);
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                            }
                                                            else
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = Math.Round(Convert.ToDouble(iGioiHanTC1TuDongKhongQuaDem) * this.dTangCa1HeSo / 60.0, this.iLamTronGio);
                                                                if (dTongThoiGianTangCaTuDongKhongQuaDem - Convert.ToDouble(iGioiHanTC1TuDongKhongQuaDem) < Convert.ToDouble(iGioiHanTC2TuDongKhongQuaDem))
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = Math.Round((dTongThoiGianTangCaTuDongKhongQuaDem - Convert.ToDouble(iGioiHanTC1TuDongKhongQuaDem)) * this.dTangCa2HeSo / 60.0, this.iLamTronGio);
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                                }
                                                                else
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = Math.Round(Convert.ToDouble(iGioiHanTC1TuDongKhongQuaDem) * this.dTangCa1HeSo / 60.0, this.iLamTronGio);
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = Math.Round(Convert.ToDouble(iGioiHanTC2TuDongKhongQuaDem) * this.dTangCa2HeSo / 60.0, this.iLamTronGio);
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = Math.Round((dTongThoiGianTangCaTuDongKhongQuaDem - Convert.ToDouble(iGioiHanTC1TuDongKhongQuaDem) - Convert.ToDouble(iGioiHanTC2TuDongKhongQuaDem)) * this.dTangCa3HeSo / 60.0, this.iLamTronGio);
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                                }
                                                            }
                                                        }
                                                        if (iGioiHanTC1TuDongKhongQuaDem != 0 && iGioiHanTC2TuDongKhongQuaDem != 0 && iGioiHanTC3TuDongKhongQuaDem != 0 && iGioiHanTC4TuDongKhongQuaDem != 0)
                                                        {
                                                        }
                                                    }
                                                    else
                                                    {
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                    }
                                                }
                                                if (DateTimeProgress.XuatIDThu((int)dt.AddDays(dem).DayOfWeek) == "0")
                                                {
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[19].Value = "CN";
                                                }
                                                else
                                                {
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[19].Value = "NT";
                                                }
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[20].Value = this.sMaChamCong;
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[21].Value = this.sPhongBanTinhCong;
                                                break;
                                            }
                                        }
                                    }
                                }
                                if (iKiemTraLanCham <= 2)
                                {
                                    continue;
                                }
                                if (iKiemTraLanCham % 2 != 0)
                                {
                                    addTuDong = this.DGVTinhCong.Rows.Add();
                                    dGioVaoTuDong = Convert.ToDateTime(dtTuDong.Rows[iTuDong]["GioCham"].ToString());
                                    this.DGVTinhCong.Rows[addTuDong].Cells[5].Value = string.Format(this.sDinhDangThoiGian, dGioVaoTuDong);
                                    this.DGVTinhCong.Rows[addTuDong].Cells[0].Value = this.sMaNhanVien;
                                    this.DGVTinhCong.Rows[addTuDong].Cells[1].Value = this.sTenNhanVien;
                                    this.DGVTinhCong.Rows[addTuDong].Cells[2].Value = this.DGVTinhCong.Rows[_nhanVien].Cells[2].Value.ToString();
                                    this.DGVTinhCong.Rows[addTuDong].Cells[3].Value = DateTimeProgress.XuatThuTinhCong((int)dt.AddDays(dem).DayOfWeek);
                                    this.DGVTinhCong.Rows[addTuDong].Cells[4].Value = ca;
                                    this.DGVTinhCong.Rows[addTuDong].Cells[7].Value = "0";
                                    this.DGVTinhCong.Rows[addTuDong].Cells[8].Value = "0";
                                    this.DGVTinhCong.Rows[addTuDong].Cells[9].Value = "0";
                                    this.DGVTinhCong.Rows[addTuDong].Cells[10].Value = "0";
                                    this.DGVTinhCong.Rows[addTuDong].Cells[11].Value = "0";
                                    this.DGVTinhCong.Rows[addTuDong].Cells[12].Value = "0";
                                    this.DGVTinhCong.Rows[addTuDong].Cells[13].Value = "0";
                                    this.DGVTinhCong.Rows[addTuDong].Cells[14].Value = "0";
                                    this.DGVTinhCong.Rows[addTuDong].Cells[15].Value = "0";
                                    this.DGVTinhCong.Rows[addTuDong].Cells[16].Value = "0";
                                    this.DGVTinhCong.Rows[addTuDong].Cells[17].Value = "0";
                                    this.DGVTinhCong.Rows[addTuDong].Cells[18].Value = this.sKHVang;
                                    if (DateTimeProgress.XuatIDThu((int)dt.AddDays(dem).DayOfWeek) == "0")
                                    {
                                        this.DGVTinhCong.Rows[addTuDong].Cells[19].Value = "CN";
                                    }
                                    else
                                    {
                                        this.DGVTinhCong.Rows[addTuDong].Cells[19].Value = "NT";
                                    }
                                    this.DGVTinhCong.Rows[addTuDong].Cells[20].Value = this.sMaChamCong;
                                    this.DGVTinhCong.Rows[addTuDong].Cells[21].Value = this.sPhongBanTinhCong;
                                    if (iKiemTraLanCham != dtTuDong.Rows.Count)
                                    {
                                        continue;
                                    }
                                    new DataTable();
                                    this._chiTietLichTrinhChoCalamViecDTO.MaLichTrinhCaLamViec = sLTCCLVNhanVien;
                                    this._chiTietLichTrinhChoCalamViecDTO.Thu = sThu;
                                    DataTable dtNhanCaTuDongKhongQuaDem4;
                                    dtNhanCaTuDongKhongQuaDem4 = this._chiTietLichTrinhChoCaLamViecBLL.ChiTietLichTrinhChoCaLamViecNhanCa(this._chiTietLichTrinhChoCalamViecDTO);
                                    int iChiTietLichTrinhChoCaLamViecTuDongKhongQuaDem4;
                                    iChiTietLichTrinhChoCaLamViecTuDongKhongQuaDem4 = 0;
                                    if (iChiTietLichTrinhChoCaLamViecTuDongKhongQuaDem4 >= dtNhanCaTuDongKhongQuaDem4.Rows.Count)
                                    {
                                        continue;
                                    }
                                    for (int cellChiTietLichTrinhChoCaLamViecTuDongKhongQuaDem4 = 3; cellChiTietLichTrinhChoCaLamViecTuDongKhongQuaDem4 < 13; cellChiTietLichTrinhChoCaLamViecTuDongKhongQuaDem4++)
                                    {
                                        kiemTraVao = 0;
                                        kiemTraRa = 0;
                                        this.sTuDongQuaDemMaCaLamViec = dtNhanCaTuDongKhongQuaDem4.Rows[iChiTietLichTrinhChoCaLamViecTuDongKhongQuaDem4][cellChiTietLichTrinhChoCaLamViecTuDongKhongQuaDem4].ToString();
                                        new DataTable();
                                        DataTable dtTuDongQuaDemCa10;
                                        dtTuDongQuaDemCa10 = this._caLamViecBLL.CaLamViecGetByMaCaLamViec(sTuDongQuaDemMaCaLamViec);
                                        for (int iTuDongQuaDemCa10 = 0; iTuDongQuaDemCa10 < dtTuDongQuaDemCa10.Rows.Count; iTuDongQuaDemCa10++)
                                        {
                                            this.sTuDongQuaDemTenCaLamViec = dtTuDongQuaDemCa10.Rows[iTuDongQuaDemCa10]["CaLamViec"].ToString();
                                            DateTime dBatDauVaoB10;
                                            dBatDauVaoB10 = Convert.ToDateTime(sNgayCham + " " + string.Format("{0:T}", Convert.ToDateTime(dtTuDongQuaDemCa10.Rows[iTuDongQuaDemCa10]["BatDauVao"].ToString())));
                                            DateTime dKetThucVaoB10;
                                            dKetThucVaoB10 = Convert.ToDateTime(sNgayCham + " " + string.Format("{0:T}", Convert.ToDateTime(dtTuDongQuaDemCa10.Rows[iTuDongQuaDemCa10]["KetThucVao"].ToString())));
                                            DateTime dBatDauRaB10;
                                            dBatDauRaB10 = Convert.ToDateTime(sNgayCham + " " + string.Format("{0:T}", Convert.ToDateTime(dtTuDongQuaDemCa10.Rows[iTuDongQuaDemCa10]["BatDauRa"].ToString())));
                                            DateTime dKetThucRaB10;
                                            dKetThucRaB10 = Convert.ToDateTime(sNgayCham + " " + string.Format("{0:T}", Convert.ToDateTime(dtTuDongQuaDemCa10.Rows[iTuDongQuaDemCa10]["KetThucRa"].ToString())));
                                            if (dGioVaoTuDong >= dBatDauVaoB10 && dGioVaoTuDong <= dKetThucVaoB10)
                                            {
                                                kiemTraVao++;
                                            }
                                            if (dGioRaTuDong >= dBatDauRaB10 && dGioRaTuDong <= dKetThucRaB10)
                                            {
                                                kiemTraRa++;
                                            }
                                            if (kiemTraVao == 1 && kiemTraRa == 0)
                                            {
                                                goto end_IL_eb5a;
                                            }
                                        }
                                        continue;
                                    end_IL_eb5a:
                                        break;
                                    }
                                    this.DGVTinhCong.Rows[addTuDong].Cells[4].Value = this.sTuDongQuaDemTenCaLamViec;
                                    this.DGVTinhCong.Rows[addTuDong].Cells[7].Value = "0";
                                    this.DGVTinhCong.Rows[addTuDong].Cells[8].Value = "0";
                                    this.DGVTinhCong.Rows[addTuDong].Cells[9].Value = "0";
                                    this.DGVTinhCong.Rows[addTuDong].Cells[10].Value = "0";
                                    this.DGVTinhCong.Rows[addTuDong].Cells[11].Value = "0";
                                    this.DGVTinhCong.Rows[addTuDong].Cells[12].Value = "0";
                                    this.DGVTinhCong.Rows[addTuDong].Cells[13].Value = "0";
                                    this.DGVTinhCong.Rows[addTuDong].Cells[14].Value = "0";
                                    this.DGVTinhCong.Rows[addTuDong].Cells[15].Value = "0";
                                    this.DGVTinhCong.Rows[addTuDong].Cells[16].Value = "0";
                                    this.DGVTinhCong.Rows[addTuDong].Cells[17].Value = "0";
                                    this.DGVTinhCong.Rows[addTuDong].Cells[18].Value = this.sKHThieuGioRa;
                                    if (DateTimeProgress.XuatIDThu((int)dt.AddDays(dem).DayOfWeek) == "0")
                                    {
                                        this.DGVTinhCong.Rows[addTuDong].Cells[19].Value = "CN";
                                    }
                                    else
                                    {
                                        this.DGVTinhCong.Rows[addTuDong].Cells[19].Value = "NT";
                                    }
                                    this.DGVTinhCong.Rows[addTuDong].Cells[20].Value = this.sMaChamCong;
                                    this.DGVTinhCong.Rows[addTuDong].Cells[21].Value = this.sPhongBanTinhCong;
                                    continue;
                                }
                                dGioRaTuDong = Convert.ToDateTime(dtTuDong.Rows[iTuDong]["GioCham"].ToString());
                                Convert.ToInt32((dGioRaTuDong - dGioVaoTuDong).TotalMinutes);
                                if (Convert.ToInt32(Convert.ToInt32((dGioRaTuDongKhongQuaDemLichTrinhVaoRa - dGioVaoTuDongKhongQuaDemLichTrinhVaoRa).TotalMinutes).ToString()) > iThoiGianLonNhat)
                                {
                                    int addTuDongKhongQuaDemThoiGianLonNhat2;
                                    addTuDongKhongQuaDemThoiGianLonNhat2 = this.DGVTinhCong.Rows.Add();
                                    this.DGVTinhCong.Rows[addTuDongKhongQuaDemThoiGianLonNhat2].Cells[0].Value = this.sMaNhanVien;
                                    this.DGVTinhCong.Rows[addTuDongKhongQuaDemThoiGianLonNhat2].Cells[1].Value = this.sTenNhanVien;
                                    this.DGVTinhCong.Rows[addTuDongKhongQuaDemThoiGianLonNhat2].Cells[2].Value = this.DGVTinhCong.Rows[_nhanVien].Cells[2].Value.ToString();
                                    this.DGVTinhCong.Rows[addTuDongKhongQuaDemThoiGianLonNhat2].Cells[3].Value = DateTimeProgress.XuatThuTinhCong((int)dt.AddDays(dem).DayOfWeek);
                                    this.DGVTinhCong.Rows[addTuDongKhongQuaDemThoiGianLonNhat2].Cells[4].Value = ca;
                                    this.DGVTinhCong.Rows[addTuDongKhongQuaDemThoiGianLonNhat2].Cells[6].Value = string.Format(this.sDinhDangThoiGian, dGioRaTuDong);
                                    this.DGVTinhCong.Rows[addTuDongKhongQuaDemThoiGianLonNhat2].Cells[7].Value = "0";
                                    this.DGVTinhCong.Rows[addTuDongKhongQuaDemThoiGianLonNhat2].Cells[8].Value = "0";
                                    this.DGVTinhCong.Rows[addTuDongKhongQuaDemThoiGianLonNhat2].Cells[9].Value = "0";
                                    this.DGVTinhCong.Rows[addTuDongKhongQuaDemThoiGianLonNhat2].Cells[10].Value = "0";
                                    this.DGVTinhCong.Rows[addTuDongKhongQuaDemThoiGianLonNhat2].Cells[11].Value = "0";
                                    this.DGVTinhCong.Rows[addTuDongKhongQuaDemThoiGianLonNhat2].Cells[12].Value = "0";
                                    this.DGVTinhCong.Rows[addTuDongKhongQuaDemThoiGianLonNhat2].Cells[13].Value = "0";
                                    this.DGVTinhCong.Rows[addTuDongKhongQuaDemThoiGianLonNhat2].Cells[14].Value = "0";
                                    this.DGVTinhCong.Rows[addTuDongKhongQuaDemThoiGianLonNhat2].Cells[15].Value = "0";
                                    this.DGVTinhCong.Rows[addTuDongKhongQuaDemThoiGianLonNhat2].Cells[16].Value = "0";
                                    this.DGVTinhCong.Rows[addTuDongKhongQuaDemThoiGianLonNhat2].Cells[17].Value = "0";
                                    this.DGVTinhCong.Rows[addTuDongKhongQuaDemThoiGianLonNhat2].Cells[18].Value = this.sKHVang;
                                    if (DateTimeProgress.XuatIDThu((int)dt.AddDays(dem).DayOfWeek) == "0")
                                    {
                                        this.DGVTinhCong.Rows[addTuDongKhongQuaDemThoiGianLonNhat2].Cells[19].Value = "CN";
                                    }
                                    else
                                    {
                                        this.DGVTinhCong.Rows[addTuDongKhongQuaDemThoiGianLonNhat2].Cells[19].Value = "NT";
                                    }
                                    this.DGVTinhCong.Rows[addTuDongKhongQuaDemThoiGianLonNhat2].Cells[20].Value = this.sMaChamCong;
                                    this.DGVTinhCong.Rows[addTuDongKhongQuaDemThoiGianLonNhat2].Cells[21].Value = this.sPhongBanTinhCong;
                                    continue;
                                }
                                this.DGVTinhCong.Rows[addTuDong].Cells[6].Value = string.Format(this.sDinhDangThoiGian, dGioRaTuDong);
                                new DataTable();
                                this._chiTietLichTrinhChoCalamViecDTO.MaLichTrinhCaLamViec = sLTCCLVNhanVien;
                                this._chiTietLichTrinhChoCalamViecDTO.Thu = sThu;
                                DataTable dtNhanCaTuDongKhongQuaDem3;
                                dtNhanCaTuDongKhongQuaDem3 = this._chiTietLichTrinhChoCaLamViecBLL.ChiTietLichTrinhChoCaLamViecNhanCa(this._chiTietLichTrinhChoCalamViecDTO);
                                int iChiTietLichTrinhChoCaLamViecTuDongKhongQuaDem3;
                                iChiTietLichTrinhChoCaLamViecTuDongKhongQuaDem3 = 0;
                                if (iChiTietLichTrinhChoCaLamViecTuDongKhongQuaDem3 >= dtNhanCaTuDongKhongQuaDem3.Rows.Count)
                                {
                                    continue;
                                }
                                int cellChiTietLichTrinhChoCaLamViecTuDongKhongQuaDem3;
                                cellChiTietLichTrinhChoCaLamViecTuDongKhongQuaDem3 = 3;
                                while (true)
                                {
                                    if (cellChiTietLichTrinhChoCaLamViecTuDongKhongQuaDem3 < 13)
                                    {
                                        this.sTuDongQuaDemMaCaLamViec = dtNhanCaTuDongKhongQuaDem3.Rows[iChiTietLichTrinhChoCaLamViecTuDongKhongQuaDem3][cellChiTietLichTrinhChoCaLamViecTuDongKhongQuaDem3].ToString();
                                        new DataTable();
                                        DataTable dtTuDongQuaDemCa9;
                                        dtTuDongQuaDemCa9 = this._caLamViecBLL.CaLamViecGetByMaCaLamViec(sTuDongQuaDemMaCaLamViec);
                                        int iTuDongQuaDemCa9;
                                        iTuDongQuaDemCa9 = 0;
                                        while (iTuDongQuaDemCa9 < dtTuDongQuaDemCa9.Rows.Count)
                                        {
                                            kiemTraVao = 0;
                                            kiemTraRa = 0;
                                            string sGiayGioVao21;
                                            sGiayGioVao21 = dGioVaoTuDong.Second.ToString();
                                            string sGiayGioRa21;
                                            sGiayGioRa21 = dGioRaTuDong.Second.ToString();
                                            this.sTuDongQuaDemTenCaLamViec = dtTuDongQuaDemCa9.Rows[iTuDongQuaDemCa9]["CaLamViec"].ToString();
                                            DateTime dBatDauVaoB9;
                                            dBatDauVaoB9 = Convert.ToDateTime(sNgayCham + " " + string.Format("{0:T}", Convert.ToDateTime(dtTuDongQuaDemCa9.Rows[iTuDongQuaDemCa9]["BatDauVao"].ToString())).Replace("00 ", sGiayGioVao21 + " "));
                                            DateTime dKetThucVaoB9;
                                            dKetThucVaoB9 = Convert.ToDateTime(sNgayCham + " " + string.Format("{0:T}", Convert.ToDateTime(dtTuDongQuaDemCa9.Rows[iTuDongQuaDemCa9]["KetThucVao"].ToString())).Replace("00 ", sGiayGioVao21 + " "));
                                            DateTime dBatDauRaB9;
                                            dBatDauRaB9 = Convert.ToDateTime(sNgayCham + " " + string.Format("{0:T}", Convert.ToDateTime(dtTuDongQuaDemCa9.Rows[iTuDongQuaDemCa9]["BatDauRa"].ToString())).Replace("00 ", sGiayGioRa21 + " "));
                                            DateTime dKetThucRaB9;
                                            dKetThucRaB9 = Convert.ToDateTime(sNgayCham + " " + string.Format("{0:T}", Convert.ToDateTime(dtTuDongQuaDemCa9.Rows[iTuDongQuaDemCa9]["KetThucRa"].ToString())).Replace("00 ", sGiayGioRa21 + " "));
                                            if (dtTuDongQuaDemCa9.Rows[iTuDongQuaDemCa9]["TinhBuTru"].ToString() == "True")
                                            {
                                                iTinhBuTru++;
                                            }
                                            if (dGioVaoTuDong >= dBatDauVaoB9 && dGioVaoTuDong <= dKetThucVaoB9)
                                            {
                                                kiemTraVao++;
                                            }
                                            if (dGioRaTuDong >= dBatDauRaB9 && dGioRaTuDong <= dKetThucRaB9)
                                            {
                                                kiemTraRa++;
                                            }
                                            if (kiemTraVao != 1 || kiemTraRa != 1)
                                            {
                                                iTuDongQuaDemCa9++;
                                                continue;
                                            }
                                            goto IL_f776;
                                        }
                                        if (!(this.sTuDongQuaDemMaCaLamViec == ""))
                                        {
                                            cellChiTietLichTrinhChoCaLamViecTuDongKhongQuaDem3++;
                                            continue;
                                        }
                                        this.DGVTinhCong.Rows[addTuDong].Cells[4].Value = ca;
                                        this.DGVTinhCong.Rows[addTuDong].Cells[7].Value = "0";
                                        this.DGVTinhCong.Rows[addTuDong].Cells[8].Value = "0";
                                        this.DGVTinhCong.Rows[addTuDong].Cells[9].Value = "0";
                                        this.DGVTinhCong.Rows[addTuDong].Cells[10].Value = "0";
                                        this.DGVTinhCong.Rows[addTuDong].Cells[11].Value = "0";
                                        this.DGVTinhCong.Rows[addTuDong].Cells[12].Value = "0";
                                        this.DGVTinhCong.Rows[addTuDong].Cells[13].Value = "0";
                                        this.DGVTinhCong.Rows[addTuDong].Cells[14].Value = "0";
                                        this.DGVTinhCong.Rows[addTuDong].Cells[15].Value = "0";
                                        this.DGVTinhCong.Rows[addTuDong].Cells[16].Value = "0";
                                        this.DGVTinhCong.Rows[addTuDong].Cells[17].Value = "0";
                                        this.DGVTinhCong.Rows[addTuDong].Cells[18].Value = this.sKHVang;
                                        if (DateTimeProgress.XuatIDThu((int)dt.AddDays(dem).DayOfWeek) == "0")
                                        {
                                            this.DGVTinhCong.Rows[addTuDong].Cells[19].Value = "CN";
                                        }
                                        else
                                        {
                                            this.DGVTinhCong.Rows[addTuDong].Cells[19].Value = "NT";
                                        }
                                        this.DGVTinhCong.Rows[addTuDong].Cells[20].Value = this.sMaChamCong;
                                        this.DGVTinhCong.Rows[addTuDong].Cells[21].Value = this.sPhongBanTinhCong;
                                        break;
                                    }
                                    goto IL_f776;
                                IL_f776:
                                    this.DGVTinhCong.Rows[addTuDong].Cells[4].Value = this.sTuDongQuaDemTenCaLamViec;
                                    new DataTable();
                                    DataTable dtCaLamViecTuDongKhongQuaDem2;
                                    dtCaLamViecTuDongKhongQuaDem2 = this._caLamViecBLL.CaLamViecGetByMaCaLamViec(sTuDongQuaDemMaCaLamViec);
                                    for (int iCaLamViecTuDongKhongQuaDem2 = 0; iCaLamViecTuDongKhongQuaDem2 < dtCaLamViecTuDongKhongQuaDem2.Rows.Count; iCaLamViecTuDongKhongQuaDem2++)
                                    {
                                        string sGiayGioVao22;
                                        sGiayGioVao22 = dGioVaoTuDong.Second.ToString();
                                        string sGiayGioRa22;
                                        sGiayGioRa22 = dGioRaTuDong.Second.ToString();
                                        DateTime dGioVaoKhaiBaoTuDongKhongQuaDemB2;
                                        dGioVaoKhaiBaoTuDongKhongQuaDemB2 = Convert.ToDateTime(sNgayCham + " " + string.Format("{0:T}", Convert.ToDateTime(dtCaLamViecTuDongKhongQuaDem2.Rows[iCaLamViecTuDongKhongQuaDem2]["GioVaoLamViec"].ToString())).Replace("00 ", sGiayGioVao22 + " "));
                                        DateTime dGioRaKhaiBaoTuDongKhongQuaDemB2;
                                        dGioRaKhaiBaoTuDongKhongQuaDemB2 = Convert.ToDateTime(sNgayCham + " " + string.Format("{0:T}", Convert.ToDateTime(dtCaLamViecTuDongKhongQuaDem2.Rows[iCaLamViecTuDongKhongQuaDem2]["GioKetThucLamViec"].ToString())).Replace("00 ", sGiayGioRa22 + " "));
                                        string sXemCaNayLaTangCa7;
                                        sXemCaNayLaTangCa7 = dtCaLamViecTuDongKhongQuaDem2.Rows[iCaLamViecTuDongKhongQuaDem2]["XemCaNayLaTangCa"].ToString();
                                        int iTangCaMuc7;
                                        iTangCaMuc7 = Convert.ToInt32(dtCaLamViecTuDongKhongQuaDem2.Rows[iCaLamViecTuDongKhongQuaDem2]["TangCaMuc"].ToString());
                                        string sXemChuNhatLaTangCa2;
                                        sXemChuNhatLaTangCa2 = dtCaLamViecTuDongKhongQuaDem2.Rows[iCaLamViecTuDongKhongQuaDem2]["XemCuoiTuanLaTangCa"].ToString();
                                        int iTangCaChuNhatMuc2;
                                        iTangCaChuNhatMuc2 = Convert.ToInt32(dtCaLamViecTuDongKhongQuaDem2.Rows[iCaLamViecTuDongKhongQuaDem2]["TangCaCuoiTuanMuc"].ToString());
                                        if (sXemCaNayLaTangCa7 == "True")
                                        {
                                            dtCaLamViecTuDongKhongQuaDem2.Rows[iCaLamViecTuDongKhongQuaDem2]["TruGioDiTre"].ToString();
                                            dtCaLamViecTuDongKhongQuaDem2.Rows[iCaLamViecTuDongKhongQuaDem2]["BatDauTinhDiTre"].ToString();
                                            Convert.ToInt32(dtCaLamViecTuDongKhongQuaDem2.Rows[iCaLamViecTuDongKhongQuaDem2]["ChoPhepDiTre"].ToString());
                                            string sPhutTre23;
                                            sPhutTre23 = Convert.ToInt32((dGioVaoTuDong - dGioVaoKhaiBaoTuDongKhongQuaDemB2).TotalMinutes).ToString();
                                            if (Convert.ToInt32(sPhutTre23) < 0)
                                            {
                                                sPhutTre23 = "0";
                                            }
                                            dtCaLamViecTuDongKhongQuaDem2.Rows[iCaLamViecTuDongKhongQuaDem2]["TruGioVeSom"].ToString();
                                            dtCaLamViecTuDongKhongQuaDem2.Rows[iCaLamViecTuDongKhongQuaDem2]["BatDauTinhVeSom"].ToString();
                                            Convert.ToInt32(dtCaLamViecTuDongKhongQuaDem2.Rows[iCaLamViecTuDongKhongQuaDem2]["ChoPhepVeSom"].ToString());
                                            string sPhutVeSom24;
                                            sPhutVeSom24 = Convert.ToInt32((dGioRaKhaiBaoTuDongKhongQuaDemB2 - dGioRaTuDong).TotalMinutes).ToString();
                                            if (Convert.ToInt32(sPhutVeSom24) < 0)
                                            {
                                                sPhutVeSom24 = "0";
                                            }
                                            double dTongGioTangCaTuDongKhongQuaDem2;
                                            dTongGioTangCaTuDongKhongQuaDem2 = Math.Round((Convert.ToDouble(dtCaLamViecTuDongKhongQuaDem2.Rows[iCaLamViecTuDongKhongQuaDem2]["TongGioTrongCaLamViec"]) * 60.0 - (Convert.ToDouble(sPhutTre23) + Convert.ToDouble(sPhutVeSom24))) / 60.0, this.iLamTronGio);
                                            if (iTangCaMuc7 == 1)
                                            {
                                                this.DGVTinhCong.Rows[addTuDong].Cells[7].Value = "0";
                                                this.DGVTinhCong.Rows[addTuDong].Cells[8].Value = "0";
                                                this.DGVTinhCong.Rows[addTuDong].Cells[12].Value = dTongGioTangCaTuDongKhongQuaDem2 * this.dTangCa1HeSo;
                                                this.DGVTinhCong.Rows[addTuDong].Cells[18].Value = this.sKHDungGio;
                                            }
                                            if (iTangCaMuc7 == 2)
                                            {
                                                this.DGVTinhCong.Rows[addTuDong].Cells[7].Value = "0";
                                                this.DGVTinhCong.Rows[addTuDong].Cells[8].Value = "0";
                                                Math.Round(Convert.ToDouble(Convert.ToInt32((dGioRaTuDong - dGioVaoKhaiBaoTuDongKhongQuaDemB2).TotalMinutes).ToString()) / 60.0, this.iLamTronGio);
                                                this.DGVTinhCong.Rows[addTuDong].Cells[13].Value = dTongGioTangCaTuDongKhongQuaDem2 * this.dTangCa2HeSo;
                                                this.DGVTinhCong.Rows[addTuDong].Cells[18].Value = this.sKHDungGio;
                                            }
                                            if (iTangCaMuc7 == 3)
                                            {
                                                this.DGVTinhCong.Rows[addTuDong].Cells[7].Value = "0";
                                                this.DGVTinhCong.Rows[addTuDong].Cells[8].Value = "0";
                                                Math.Round(Convert.ToDouble(Convert.ToInt32((dGioRaTuDong - dGioVaoKhaiBaoTuDongKhongQuaDemB2).TotalMinutes).ToString()) / 60.0, this.iLamTronGio);
                                                this.DGVTinhCong.Rows[addTuDong].Cells[14].Value = dTongGioTangCaTuDongKhongQuaDem2 * this.dTangCa3HeSo;
                                                this.DGVTinhCong.Rows[addTuDong].Cells[18].Value = this.sKHDungGio;
                                            }
                                            if (iTangCaMuc7 == 4)
                                            {
                                                this.DGVTinhCong.Rows[addTuDong].Cells[7].Value = "0";
                                                this.DGVTinhCong.Rows[addTuDong].Cells[8].Value = "0";
                                                Math.Round(Convert.ToDouble(Convert.ToInt32((dGioRaTuDong - dGioVaoKhaiBaoTuDongKhongQuaDemB2).TotalMinutes).ToString()) / 60.0, this.iLamTronGio);
                                                this.DGVTinhCong.Rows[addTuDong].Cells[15].Value = dTongGioTangCaTuDongKhongQuaDem2 * this.dTangCa4HeSo;
                                                this.DGVTinhCong.Rows[addTuDong].Cells[18].Value = this.sKHDungGio;
                                            }
                                            continue;
                                        }
                                        if (DateTimeProgress.XuatIDThu((int)dt.AddDays(dem).DayOfWeek) == "0")
                                        {
                                            if (sXemChuNhatLaTangCa2 == "True")
                                            {
                                                dtCaLamViecTuDongKhongQuaDem2.Rows[iCaLamViecTuDongKhongQuaDem2]["TruGioDiTre"].ToString();
                                                dtCaLamViecTuDongKhongQuaDem2.Rows[iCaLamViecTuDongKhongQuaDem2]["BatDauTinhDiTre"].ToString();
                                                Convert.ToInt32(dtCaLamViecTuDongKhongQuaDem2.Rows[iCaLamViecTuDongKhongQuaDem2]["ChoPhepDiTre"].ToString());
                                                string sPhutTre22;
                                                sPhutTre22 = Convert.ToInt32((dGioVaoTuDong - dGioVaoKhaiBaoTuDongKhongQuaDemB2).TotalMinutes).ToString();
                                                if (Convert.ToInt32(sPhutTre22) < 0)
                                                {
                                                    sPhutTre22 = "0";
                                                }
                                                dtCaLamViecTuDongKhongQuaDem2.Rows[iCaLamViecTuDongKhongQuaDem2]["TruGioVeSom"].ToString();
                                                dtCaLamViecTuDongKhongQuaDem2.Rows[iCaLamViecTuDongKhongQuaDem2]["BatDauTinhVeSom"].ToString();
                                                Convert.ToInt32(dtCaLamViecTuDongKhongQuaDem2.Rows[iCaLamViecTuDongKhongQuaDem2]["ChoPhepVeSom"].ToString());
                                                string sPhutVeSom22;
                                                sPhutVeSom22 = Convert.ToInt32((dGioRaKhaiBaoTuDongKhongQuaDemB2 - dGioRaTuDong).TotalMinutes).ToString();
                                                if (Convert.ToInt32(sPhutVeSom22) < 0)
                                                {
                                                    sPhutVeSom22 = "0";
                                                }
                                                double dTongGioTangCaTuDongKhongQuaDemA2;
                                                dTongGioTangCaTuDongKhongQuaDemA2 = Math.Round((Convert.ToDouble(dtCaLamViecTuDongKhongQuaDem2.Rows[iCaLamViecTuDongKhongQuaDem2]["TongGioTrongCaLamViec"]) * 60.0 - (Convert.ToDouble(sPhutTre22) + Convert.ToDouble(sPhutVeSom22))) / 60.0, this.iLamTronGio);
                                                if (iTangCaChuNhatMuc2 == 1)
                                                {
                                                    this.DGVTinhCong.Rows[addTuDong].Cells[7].Value = "0";
                                                    this.DGVTinhCong.Rows[addTuDong].Cells[8].Value = "0";
                                                    if (dTongGioTangCaTuDongKhongQuaDemA2 <= 3.0)
                                                    {
                                                        this.DGVTinhCong.Rows[addTuDong].Cells[12].Value = dTongGioTangCaTuDongKhongQuaDemA2 * this.dTangCaChuNhatHeSo;
                                                    }
                                                    else
                                                    {
                                                        this.DGVTinhCong.Rows[addTuDong].Cells[12].Value = 3.0 * this.dTangCaChuNhatHeSo;
                                                    }
                                                    this.DGVTinhCong.Rows[addTuDong].Cells[18].Value = this.sKHDungGio;
                                                }
                                                if (iTangCaChuNhatMuc2 == 2)
                                                {
                                                    this.DGVTinhCong.Rows[addTuDong].Cells[7].Value = "0";
                                                    this.DGVTinhCong.Rows[addTuDong].Cells[8].Value = "0";
                                                    this.DGVTinhCong.Rows[addTuDong].Cells[13].Value = dTongGioTangCaTuDongKhongQuaDemA2 * this.dTangCaChuNhatHeSo;
                                                    this.DGVTinhCong.Rows[addTuDong].Cells[18].Value = this.sKHDungGio;
                                                }
                                                if (iTangCaChuNhatMuc2 == 3)
                                                {
                                                    this.DGVTinhCong.Rows[addTuDong].Cells[7].Value = "0";
                                                    this.DGVTinhCong.Rows[addTuDong].Cells[8].Value = "0";
                                                    this.DGVTinhCong.Rows[addTuDong].Cells[14].Value = dTongGioTangCaTuDongKhongQuaDemA2 * this.dTangCaChuNhatHeSo;
                                                    this.DGVTinhCong.Rows[addTuDong].Cells[18].Value = this.sKHDungGio;
                                                }
                                                if (iTangCaChuNhatMuc2 == 4)
                                                {
                                                    this.DGVTinhCong.Rows[addTuDong].Cells[7].Value = "0";
                                                    this.DGVTinhCong.Rows[addTuDong].Cells[8].Value = "0";
                                                    this.DGVTinhCong.Rows[addTuDong].Cells[15].Value = dTongGioTangCaTuDongKhongQuaDemA2 * this.dTangCaChuNhatHeSo;
                                                    this.DGVTinhCong.Rows[addTuDong].Cells[18].Value = this.sKHDungGio;
                                                }
                                                continue;
                                            }
                                            string sTruGioDiTre17;
                                            sTruGioDiTre17 = dtCaLamViecTuDongKhongQuaDem2.Rows[iCaLamViecTuDongKhongQuaDem2]["TruGioDiTre"].ToString();
                                            string sBatDauTinhDiTre17;
                                            sBatDauTinhDiTre17 = dtCaLamViecTuDongKhongQuaDem2.Rows[iCaLamViecTuDongKhongQuaDem2]["BatDauTinhDiTre"].ToString();
                                            int iChoPhepDiTre14;
                                            iChoPhepDiTre14 = Convert.ToInt32(dtCaLamViecTuDongKhongQuaDem2.Rows[iCaLamViecTuDongKhongQuaDem2]["ChoPhepDiTre"].ToString());
                                            string sPhutTre19;
                                            sPhutTre19 = Convert.ToInt32((dGioVaoTuDong - dGioVaoKhaiBaoTuDongKhongQuaDemB2).TotalMinutes).ToString();
                                            if (sTruGioDiTre17 == "True")
                                            {
                                                if (Convert.ToInt32(sPhutTre19) < 0)
                                                {
                                                    this.DGVTinhCong.Rows[addTuDong].Cells[9].Value = "0";
                                                }
                                                else
                                                {
                                                    int iPhutTre15;
                                                    iPhutTre15 = Convert.ToInt32(sPhutTre19) - iChoPhepDiTre14;
                                                    if (sBatDauTinhDiTre17 == "True")
                                                    {
                                                        if (iPhutTre15 < 1)
                                                        {
                                                            this.DGVTinhCong.Rows[addTuDong].Cells[9].Value = "0";
                                                        }
                                                        else
                                                        {
                                                            this.DGVTinhCong.Rows[addTuDong].Cells[9].Value = iPhutTre15.ToString();
                                                        }
                                                    }
                                                    else if (iPhutTre15 < 1)
                                                    {
                                                        this.DGVTinhCong.Rows[addTuDong].Cells[9].Value = "0";
                                                    }
                                                    else
                                                    {
                                                        this.DGVTinhCong.Rows[addTuDong].Cells[9].Value = sPhutTre19;
                                                    }
                                                }
                                            }
                                            else
                                            {
                                                this.DGVTinhCong.Rows[addTuDong].Cells[9].Value = "0";
                                            }
                                            string sTruGioVeSom18;
                                            sTruGioVeSom18 = dtCaLamViecTuDongKhongQuaDem2.Rows[iCaLamViecTuDongKhongQuaDem2]["TruGioVeSom"].ToString();
                                            string sBatDauTinhVeSom18;
                                            sBatDauTinhVeSom18 = dtCaLamViecTuDongKhongQuaDem2.Rows[iCaLamViecTuDongKhongQuaDem2]["BatDauTinhVeSom"].ToString();
                                            int iChoPhepVeSom15;
                                            iChoPhepVeSom15 = Convert.ToInt32(dtCaLamViecTuDongKhongQuaDem2.Rows[iCaLamViecTuDongKhongQuaDem2]["ChoPhepVeSom"].ToString());
                                            string sPhutVeSom19;
                                            sPhutVeSom19 = Convert.ToInt32((dGioRaKhaiBaoTuDongKhongQuaDemB2 - dGioRaTuDong).TotalMinutes).ToString();
                                            if (sTruGioVeSom18 == "True")
                                            {
                                                if (Convert.ToInt32(sPhutVeSom19) < 0)
                                                {
                                                    this.DGVTinhCong.Rows[addTuDong].Cells[10].Value = "0";
                                                }
                                                else
                                                {
                                                    int iPhutVeSom15;
                                                    iPhutVeSom15 = Convert.ToInt32(sPhutVeSom19) - iChoPhepVeSom15;
                                                    if (iPhutVeSom15 < 1)
                                                    {
                                                        this.DGVTinhCong.Rows[addTuDong].Cells[10].Value = "0";
                                                    }
                                                    else if (sBatDauTinhVeSom18 == "True")
                                                    {
                                                        this.DGVTinhCong.Rows[addTuDong].Cells[10].Value = iPhutVeSom15.ToString();
                                                    }
                                                    else
                                                    {
                                                        this.DGVTinhCong.Rows[addTuDong].Cells[10].Value = sPhutVeSom19;
                                                    }
                                                }
                                            }
                                            else
                                            {
                                                this.DGVTinhCong.Rows[addTuDong].Cells[10].Value = "0";
                                            }
                                            string sVeTre14;
                                            sVeTre14 = Convert.ToInt32((dGioRaTuDong - dGioRaKhaiBaoTuDongKhongQuaDemB2).TotalMinutes).ToString();
                                            if (Convert.ToInt32(sVeTre14) > 0)
                                            {
                                                this.DGVTinhCong.Rows[addTuDong].Cells[11].Value = sVeTre14;
                                            }
                                            else
                                            {
                                                this.DGVTinhCong.Rows[addTuDong].Cells[11].Value = "0";
                                            }
                                            double dGio15;
                                            dGio15 = Math.Round(Convert.ToDouble(Convert.ToSingle(dtCaLamViecTuDongKhongQuaDem2.Rows[iCaLamViecTuDongKhongQuaDem2]["TongGioTrongCaLamViec"]) * 60f - (float)(Convert.ToInt32(this.DGVTinhCong.Rows[addTuDong].Cells[9].Value.ToString()) + Convert.ToInt32(this.DGVTinhCong.Rows[addTuDong].Cells[10].Value))) / 60.0, this.iLamTronGio);
                                            this.DGVTinhCong.Rows[addTuDong].Cells[8].Value = dGio15 * this.dTangCaChuNhatHeSo;
                                            double iGio15;
                                            iGio15 = Convert.ToDouble(dtCaLamViecTuDongKhongQuaDem2.Rows[iCaLamViecTuDongKhongQuaDem2]["TongGioTrongCaLamViec"].ToString());
                                            double dCong15;
                                            dCong15 = Math.Round(dGio15 * Convert.ToDouble(dtCaLamViecTuDongKhongQuaDem2.Rows[iCaLamViecTuDongKhongQuaDem2]["CongTinh"].ToString()) / iGio15, this.iLamTronCong);
                                            this.DGVTinhCong.Rows[addTuDong].Cells[7].Value = dCong15 * this.dTangCaChuNhatHeSo;
                                            double dTongGioThucTeTuDongKhongQuaDem4;
                                            dTongGioThucTeTuDongKhongQuaDem4 = Math.Round(Convert.ToDouble(Convert.ToInt32((dGioRaTuDong - dGioVaoTuDong).TotalMinutes).ToString()) / 60.0, this.iLamTronGio);
                                            this.DGVTinhCong.Rows[addTuDong].Cells[16].Value = dTongGioThucTeTuDongKhongQuaDem4 * this.dTangCaChuNhatHeSo;
                                            this.DGVTinhCong.Rows[addTuDong].Cells[17].Value = Convert.ToDouble(dtCaLamViecTuDongKhongQuaDem2.Rows[iCaLamViecTuDongKhongQuaDem2]["CongTinh"].ToString()) * this.dTangCaChuNhatHeSo;
                                            this.DGVTinhCong.Rows[addTuDong].Cells[18].Value = this.sKHDungGio;
                                            string sChoPhepTangCaTruocGioLamViecTuDongKhongQuaDem4;
                                            sChoPhepTangCaTruocGioLamViecTuDongKhongQuaDem4 = dtCaLamViecTuDongKhongQuaDem2.Rows[iCaLamViecTuDongKhongQuaDem2]["TangCaTruocGioLamViec"].ToString();
                                            int iPhutTangCaTruocGioLamViecTuDongKhongQuaDem4;
                                            iPhutTangCaTruocGioLamViecTuDongKhongQuaDem4 = Convert.ToInt32(dtCaLamViecTuDongKhongQuaDem2.Rows[iCaLamViecTuDongKhongQuaDem2]["SoPhutTangCaTruocGioLamViec"].ToString());
                                            int iPhutTangCaTruocGioLamViecDatDen18;
                                            iPhutTangCaTruocGioLamViecDatDen18 = Convert.ToInt32(dtCaLamViecTuDongKhongQuaDem2.Rows[iCaLamViecTuDongKhongQuaDem2]["TangCaTruocGioLamViecDatDen"].ToString());
                                            int iPhutTruTangCaTruoc18;
                                            iPhutTruTangCaTruoc18 = Convert.ToInt32(dtCaLamViecTuDongKhongQuaDem2.Rows[iCaLamViecTuDongKhongQuaDem2]["PhutTruTangCaTruoc"].ToString());
                                            string sChoPhepTangCaSauGioLamViecTuDongKhongQuaDem4;
                                            sChoPhepTangCaSauGioLamViecTuDongKhongQuaDem4 = dtCaLamViecTuDongKhongQuaDem2.Rows[iCaLamViecTuDongKhongQuaDem2]["TangCaSauGioLamViec"].ToString();
                                            int iPhutTangCaSauGioLamViecTuDongKhongQuaDem4;
                                            iPhutTangCaSauGioLamViecTuDongKhongQuaDem4 = Convert.ToInt32(dtCaLamViecTuDongKhongQuaDem2.Rows[iCaLamViecTuDongKhongQuaDem2]["SoPhutTangCaSauGioLamViec"].ToString());
                                            int iPhutTangCaSauGioLamViecDatDen18;
                                            iPhutTangCaSauGioLamViecDatDen18 = Convert.ToInt32(dtCaLamViecTuDongKhongQuaDem2.Rows[iCaLamViecTuDongKhongQuaDem2]["TangCaSauGioLamViecDatDen"].ToString());
                                            int iPhutTruTangCaSau18;
                                            iPhutTruTangCaSau18 = Convert.ToInt32(dtCaLamViecTuDongKhongQuaDem2.Rows[iCaLamViecTuDongKhongQuaDem2]["PhutTruTangCaSau"].ToString());
                                            int iGioiHanTC1TuDongKhongQuaDem4;
                                            iGioiHanTC1TuDongKhongQuaDem4 = Convert.ToInt32(dtCaLamViecTuDongKhongQuaDem2.Rows[iCaLamViecTuDongKhongQuaDem2]["GioiHanTangCa1"].ToString());
                                            int iGioiHanTC2TuDongKhongQuaDem4;
                                            iGioiHanTC2TuDongKhongQuaDem4 = Convert.ToInt32(dtCaLamViecTuDongKhongQuaDem2.Rows[iCaLamViecTuDongKhongQuaDem2]["GioiHanTangCa2"].ToString());
                                            int iGioiHanTC3TuDongKhongQuaDem4;
                                            iGioiHanTC3TuDongKhongQuaDem4 = Convert.ToInt32(dtCaLamViecTuDongKhongQuaDem2.Rows[iCaLamViecTuDongKhongQuaDem2]["GioiHanTangCa3"].ToString());
                                            int iGioiHanTC4TuDongKhongQuaDem4;
                                            iGioiHanTC4TuDongKhongQuaDem4 = Convert.ToInt32(dtCaLamViecTuDongKhongQuaDem2.Rows[iCaLamViecTuDongKhongQuaDem2]["GioiHanTangCa4"].ToString());
                                            int iTongGioTangCaSauTuDongKhongQuaDem4;
                                            iTongGioTangCaSauTuDongKhongQuaDem4 = 0;
                                            int iTongGioTangCaTruocTuDongKhongQuaDem4;
                                            iTongGioTangCaTruocTuDongKhongQuaDem4 = 0;
                                            if (sChoPhepTangCaTruocGioLamViecTuDongKhongQuaDem4 == "False" && sChoPhepTangCaSauGioLamViecTuDongKhongQuaDem4 == "False")
                                            {
                                                this.DGVTinhCong.Rows[addTuDong].Cells[12].Value = "0";
                                                this.DGVTinhCong.Rows[addTuDong].Cells[13].Value = "0";
                                                this.DGVTinhCong.Rows[addTuDong].Cells[14].Value = "0";
                                                this.DGVTinhCong.Rows[addTuDong].Cells[15].Value = "0";
                                            }
                                            else
                                            {
                                                if (sChoPhepTangCaTruocGioLamViecTuDongKhongQuaDem4 == "True")
                                                {
                                                    int iThoiGianTruocGioLamTuDongKhongQuaDem4;
                                                    iThoiGianTruocGioLamTuDongKhongQuaDem4 = Convert.ToInt32(Convert.ToInt32((dGioVaoKhaiBaoTuDongKhongQuaDemB2 - dGioVaoTuDong).TotalMinutes).ToString());
                                                    if (iThoiGianTruocGioLamTuDongKhongQuaDem4 > 0 && iThoiGianTruocGioLamTuDongKhongQuaDem4 > iPhutTangCaTruocGioLamViecTuDongKhongQuaDem4 && iThoiGianTruocGioLamTuDongKhongQuaDem4 > iPhutTangCaTruocGioLamViecDatDen18)
                                                    {
                                                        iTongGioTangCaTruocTuDongKhongQuaDem4 = iThoiGianTruocGioLamTuDongKhongQuaDem4 - iPhutTruTangCaTruoc18;
                                                    }
                                                }
                                                if (sChoPhepTangCaSauGioLamViecTuDongKhongQuaDem4 == "True")
                                                {
                                                    int iThoiGianSauGioLamViecTuDongKhongQuaDem4;
                                                    iThoiGianSauGioLamViecTuDongKhongQuaDem4 = Convert.ToInt32(Convert.ToInt32((dGioRaTuDong - dGioRaKhaiBaoTuDongKhongQuaDemB2).TotalMinutes).ToString());
                                                    if (iThoiGianSauGioLamViecTuDongKhongQuaDem4 > 0 && iThoiGianSauGioLamViecTuDongKhongQuaDem4 > iPhutTangCaSauGioLamViecTuDongKhongQuaDem4)
                                                    {
                                                        iTongGioTangCaSauTuDongKhongQuaDem4 = ((iThoiGianSauGioLamViecTuDongKhongQuaDem4 < iPhutTangCaSauGioLamViecDatDen18) ? iThoiGianSauGioLamViecTuDongKhongQuaDem4 : (iThoiGianSauGioLamViecTuDongKhongQuaDem4 - iPhutTruTangCaSau18));
                                                    }
                                                }
                                            }
                                            double dTongThoiGianTangCaTuDongKhongQuaDem4;
                                            dTongThoiGianTangCaTuDongKhongQuaDem4 = Convert.ToDouble(iTongGioTangCaTruocTuDongKhongQuaDem4 + iTongGioTangCaSauTuDongKhongQuaDem4);
                                            if (dTongThoiGianTangCaTuDongKhongQuaDem4 > 0.0)
                                            {
                                                if (iGioiHanTC1TuDongKhongQuaDem4 == 0)
                                                {
                                                    this.DGVTinhCong.Rows[addTuDong].Cells[12].Value = Math.Round(dTongThoiGianTangCaTuDongKhongQuaDem4 * this.dTangCa1HeSo / 60.0, this.iLamTronGio);
                                                    this.DGVTinhCong.Rows[addTuDong].Cells[13].Value = "0";
                                                    this.DGVTinhCong.Rows[addTuDong].Cells[14].Value = "0";
                                                    this.DGVTinhCong.Rows[addTuDong].Cells[15].Value = "0";
                                                }
                                                if (iGioiHanTC1TuDongKhongQuaDem4 != 0 && iGioiHanTC2TuDongKhongQuaDem4 == 0)
                                                {
                                                    if (dTongThoiGianTangCaTuDongKhongQuaDem4 < Convert.ToDouble(iGioiHanTC1TuDongKhongQuaDem4))
                                                    {
                                                        this.DGVTinhCong.Rows[addTuDong].Cells[12].Value = Math.Round(dTongThoiGianTangCaTuDongKhongQuaDem4 * this.dTangCa1HeSo / 60.0, this.iLamTronGio);
                                                        this.DGVTinhCong.Rows[addTuDong].Cells[13].Value = "0";
                                                        this.DGVTinhCong.Rows[addTuDong].Cells[14].Value = "0";
                                                        this.DGVTinhCong.Rows[addTuDong].Cells[15].Value = "0";
                                                    }
                                                    else
                                                    {
                                                        this.DGVTinhCong.Rows[addTuDong].Cells[12].Value = Math.Round(Convert.ToDouble(iGioiHanTC1TuDongKhongQuaDem4) / 60.0 * this.dTangCa1HeSo, this.iLamTronGio);
                                                        if (dTongThoiGianTangCaTuDongKhongQuaDem4 - Convert.ToDouble(iGioiHanTC1TuDongKhongQuaDem4) > 0.0)
                                                        {
                                                            this.DGVTinhCong.Rows[addTuDong].Cells[13].Value = Math.Round((dTongThoiGianTangCaTuDongKhongQuaDem4 - Convert.ToDouble(iGioiHanTC1TuDongKhongQuaDem4)) * this.dTangCa2HeSo / 60.0, this.iLamTronGio);
                                                        }
                                                        this.DGVTinhCong.Rows[addTuDong].Cells[14].Value = "0";
                                                        this.DGVTinhCong.Rows[addTuDong].Cells[15].Value = "0";
                                                    }
                                                }
                                                if (iGioiHanTC1TuDongKhongQuaDem4 != 0 && iGioiHanTC2TuDongKhongQuaDem4 != 0 && iGioiHanTC3TuDongKhongQuaDem4 == 0)
                                                {
                                                    if (dTongThoiGianTangCaTuDongKhongQuaDem4 < Convert.ToDouble(iGioiHanTC1TuDongKhongQuaDem4))
                                                    {
                                                        this.DGVTinhCong.Rows[addTuDong].Cells[12].Value = Math.Round(dTongThoiGianTangCaTuDongKhongQuaDem4 * this.dTangCa1HeSo / 60.0, this.iLamTronGio);
                                                        this.DGVTinhCong.Rows[addTuDong].Cells[13].Value = "0";
                                                        this.DGVTinhCong.Rows[addTuDong].Cells[14].Value = "0";
                                                        this.DGVTinhCong.Rows[addTuDong].Cells[15].Value = "0";
                                                    }
                                                    else
                                                    {
                                                        this.DGVTinhCong.Rows[addTuDong].Cells[12].Value = Math.Round(Convert.ToDouble(iGioiHanTC1TuDongKhongQuaDem4) * this.dTangCa1HeSo / 60.0, this.iLamTronGio);
                                                        if (dTongThoiGianTangCaTuDongKhongQuaDem4 - Convert.ToDouble(iGioiHanTC1TuDongKhongQuaDem4) < Convert.ToDouble(iGioiHanTC2TuDongKhongQuaDem4))
                                                        {
                                                            this.DGVTinhCong.Rows[addTuDong].Cells[13].Value = Math.Round((dTongThoiGianTangCaTuDongKhongQuaDem4 - Convert.ToDouble(iGioiHanTC1TuDongKhongQuaDem4)) * this.dTangCa2HeSo / 60.0, this.iLamTronGio);
                                                            this.DGVTinhCong.Rows[addTuDong].Cells[14].Value = "0";
                                                            this.DGVTinhCong.Rows[addTuDong].Cells[15].Value = "0";
                                                        }
                                                        else
                                                        {
                                                            this.DGVTinhCong.Rows[addTuDong].Cells[12].Value = Math.Round(Convert.ToDouble(iGioiHanTC1TuDongKhongQuaDem4) * this.dTangCa1HeSo / 60.0, this.iLamTronGio);
                                                            this.DGVTinhCong.Rows[addTuDong].Cells[13].Value = Math.Round(Convert.ToDouble(iGioiHanTC2TuDongKhongQuaDem4) * this.dTangCa2HeSo / 60.0, this.iLamTronGio);
                                                            this.DGVTinhCong.Rows[addTuDong].Cells[14].Value = Math.Round((dTongThoiGianTangCaTuDongKhongQuaDem4 - Convert.ToDouble(iGioiHanTC1TuDongKhongQuaDem4) - Convert.ToDouble(iGioiHanTC2TuDongKhongQuaDem4)) * this.dTangCa3HeSo / 60.0, this.iLamTronGio);
                                                            this.DGVTinhCong.Rows[addTuDong].Cells[15].Value = "0";
                                                        }
                                                    }
                                                }
                                                if (iGioiHanTC1TuDongKhongQuaDem4 != 0 && iGioiHanTC2TuDongKhongQuaDem4 != 0 && iGioiHanTC3TuDongKhongQuaDem4 != 0 && iGioiHanTC4TuDongKhongQuaDem4 != 0)
                                                {
                                                }
                                            }
                                            else
                                            {
                                                this.DGVTinhCong.Rows[addTuDong].Cells[12].Value = "0";
                                                this.DGVTinhCong.Rows[addTuDong].Cells[13].Value = "0";
                                                this.DGVTinhCong.Rows[addTuDong].Cells[14].Value = "0";
                                                this.DGVTinhCong.Rows[addTuDong].Cells[15].Value = "0";
                                            }
                                            continue;
                                        }
                                        string sTruGioDiTre16;
                                        sTruGioDiTre16 = dtCaLamViecTuDongKhongQuaDem2.Rows[iCaLamViecTuDongKhongQuaDem2]["TruGioDiTre"].ToString();
                                        string sBatDauTinhDiTre16;
                                        sBatDauTinhDiTre16 = dtCaLamViecTuDongKhongQuaDem2.Rows[iCaLamViecTuDongKhongQuaDem2]["BatDauTinhDiTre"].ToString();
                                        int iChoPhepDiTre13;
                                        iChoPhepDiTre13 = Convert.ToInt32(dtCaLamViecTuDongKhongQuaDem2.Rows[iCaLamViecTuDongKhongQuaDem2]["ChoPhepDiTre"].ToString());
                                        string sPhutTre15;
                                        sPhutTre15 = Convert.ToInt32((dGioVaoTuDong - dGioVaoKhaiBaoTuDongKhongQuaDemB2).TotalMinutes).ToString();
                                        if (sTruGioDiTre16 == "True")
                                        {
                                            if (Convert.ToInt32(sPhutTre15) < 0)
                                            {
                                                this.DGVTinhCong.Rows[addTuDong].Cells[9].Value = "0";
                                            }
                                            else
                                            {
                                                int iPhutTre13;
                                                iPhutTre13 = Convert.ToInt32(sPhutTre15) - iChoPhepDiTre13;
                                                if (sBatDauTinhDiTre16 == "True")
                                                {
                                                    if (iPhutTre13 < 1)
                                                    {
                                                        this.DGVTinhCong.Rows[addTuDong].Cells[9].Value = "0";
                                                    }
                                                    else
                                                    {
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[5].Style.BackColor = Color.Lime;
                                                        this.DGVTinhCong.Rows[addTuDong].Cells[9].Value = iPhutTre13.ToString();
                                                    }
                                                }
                                                else if (iPhutTre13 < 1)
                                                {
                                                    this.DGVTinhCong.Rows[addTuDong].Cells[9].Value = "0";
                                                }
                                                else
                                                {
                                                    this.DGVTinhCong.Rows[addTuDong].Cells[9].Value = sPhutTre15;
                                                }
                                            }
                                        }
                                        else
                                        {
                                            this.DGVTinhCong.Rows[addTuDong].Cells[9].Value = "0";
                                        }
                                        string sTruGioVeSom16;
                                        sTruGioVeSom16 = dtCaLamViecTuDongKhongQuaDem2.Rows[iCaLamViecTuDongKhongQuaDem2]["TruGioVeSom"].ToString();
                                        string sBatDauTinhVeSom16;
                                        sBatDauTinhVeSom16 = dtCaLamViecTuDongKhongQuaDem2.Rows[iCaLamViecTuDongKhongQuaDem2]["BatDauTinhVeSom"].ToString();
                                        int iChoPhepVeSom13;
                                        iChoPhepVeSom13 = Convert.ToInt32(dtCaLamViecTuDongKhongQuaDem2.Rows[iCaLamViecTuDongKhongQuaDem2]["ChoPhepVeSom"].ToString());
                                        string sPhutVeSom15;
                                        sPhutVeSom15 = Convert.ToInt32((dGioRaKhaiBaoTuDongKhongQuaDemB2 - dGioRaTuDong).TotalMinutes).ToString();
                                        if (sTruGioVeSom16 == "True")
                                        {
                                            if (Convert.ToInt32(sPhutVeSom15) < 0)
                                            {
                                                this.DGVTinhCong.Rows[addTuDong].Cells[10].Value = "0";
                                            }
                                            else
                                            {
                                                int iPhutVeSom13;
                                                iPhutVeSom13 = Convert.ToInt32(sPhutVeSom15) - iChoPhepVeSom13;
                                                if (iPhutVeSom13 < 1)
                                                {
                                                    this.DGVTinhCong.Rows[addTuDong].Cells[10].Value = "0";
                                                }
                                                else
                                                {
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[6].Style.BackColor = Color.Yellow;
                                                    if (sBatDauTinhVeSom16 == "True")
                                                    {
                                                        this.DGVTinhCong.Rows[addTuDong].Cells[10].Value = iPhutVeSom13.ToString();
                                                    }
                                                    else
                                                    {
                                                        this.DGVTinhCong.Rows[addTuDong].Cells[10].Value = sPhutVeSom15;
                                                    }
                                                }
                                            }
                                        }
                                        else
                                        {
                                            this.DGVTinhCong.Rows[addTuDong].Cells[10].Value = "0";
                                        }
                                        string sVeTre12;
                                        sVeTre12 = Convert.ToInt32((dGioRaTuDong - dGioRaKhaiBaoTuDongKhongQuaDemB2).TotalMinutes).ToString();
                                        if (Convert.ToInt32(sVeTre12) > 0)
                                        {
                                            this.DGVTinhCong.Rows[addTuDong].Cells[11].Value = sVeTre12;
                                        }
                                        else
                                        {
                                            this.DGVTinhCong.Rows[addTuDong].Cells[11].Value = "0";
                                        }
                                        double dGio12;
                                        dGio12 = Math.Round(Convert.ToDouble(Convert.ToSingle(dtCaLamViecTuDongKhongQuaDem2.Rows[iCaLamViecTuDongKhongQuaDem2]["TongGioTrongCaLamViec"]) * 60f - (float)(Convert.ToInt32(this.DGVTinhCong.Rows[addTuDong].Cells[9].Value.ToString()) + Convert.ToInt32(this.DGVTinhCong.Rows[addTuDong].Cells[10].Value))) / 60.0, this.iLamTronGio);
                                        double dTongGioTrongCa2;
                                        dTongGioTrongCa2 = Convert.ToDouble(dtCaLamViecTuDongKhongQuaDem2.Rows[iCaLamViecTuDongKhongQuaDem2]["TongGioTrongCaLamViec"].ToString());
                                        if (iTinhBuTru != 0 && Convert.ToInt32(this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value) > 0 && Convert.ToInt32(this.DGVTinhCong.Rows[_nhanVien].Cells[11].Value) > 0)
                                        {
                                            int iVeTre2;
                                            iVeTre2 = Convert.ToInt32(this.DGVTinhCong.Rows[addTuDong].Cells[11].Value);
                                            dGio12 = Math.Round(dGio12 + Convert.ToDouble(iVeTre2) / 60.0, 2);
                                            if (dGio12 > dTongGioTrongCa2)
                                            {
                                                iVeTre2 -= Convert.ToInt32(this.DGVTinhCong.Rows[addTuDong].Cells[9].Value);
                                                dGio12 = dTongGioTrongCa2;
                                                this.DGVTinhCong.Rows[addTuDong].Cells[11].Value = iVeTre2;
                                                this.DGVTinhCong.Rows[addTuDong].Cells[8].Value = dGio12.ToString();
                                            }
                                            else
                                            {
                                                this.DGVTinhCong.Rows[addTuDong].Cells[8].Value = dGio12.ToString();
                                                this.DGVTinhCong.Rows[addTuDong].Cells[9].Value = Convert.ToInt32(sPhutTre15) - iVeTre2;
                                                this.DGVTinhCong.Rows[addTuDong].Cells[11].Value = "0";
                                            }
                                        }
                                        else
                                        {
                                            this.DGVTinhCong.Rows[addTuDong].Cells[8].Value = dGio12.ToString();
                                        }
                                        double iGio12;
                                        iGio12 = Convert.ToDouble(dtCaLamViecTuDongKhongQuaDem2.Rows[iCaLamViecTuDongKhongQuaDem2]["TongGioTrongCaLamViec"].ToString());
                                        double dCongTinh11;
                                        dCongTinh11 = Convert.ToDouble(dtCaLamViecTuDongKhongQuaDem2.Rows[iCaLamViecTuDongKhongQuaDem2]["CongTinh"].ToString());
                                        double dCong12;
                                        dCong12 = Math.Round(dGio12 * dCongTinh11 / iGio12, this.iLamTronCong);
                                        this.DGVTinhCong.Rows[addTuDong].Cells[7].Value = dCong12.ToString();
                                        double dTongGioThucTeTuDongKhongQuaDem3;
                                        dTongGioThucTeTuDongKhongQuaDem3 = Math.Round(Convert.ToDouble(Convert.ToInt32((dGioRaTuDong - dGioVaoTuDong).TotalMinutes).ToString()) / 60.0, this.iLamTronGio);
                                        this.DGVTinhCong.Rows[addTuDong].Cells[16].Value = dTongGioThucTeTuDongKhongQuaDem3.ToString();
                                        this.DGVTinhCong.Rows[addTuDong].Cells[17].Value = dtCaLamViecTuDongKhongQuaDem2.Rows[iCaLamViecTuDongKhongQuaDem2]["CongTinh"].ToString();
                                        this.DGVTinhCong.Rows[addTuDong].Cells[18].Value = this.sKHDungGio;
                                        string sChoPhepTangCaTruocGioLamViecTuDongKhongQuaDem3;
                                        sChoPhepTangCaTruocGioLamViecTuDongKhongQuaDem3 = dtCaLamViecTuDongKhongQuaDem2.Rows[iCaLamViecTuDongKhongQuaDem2]["TangCaTruocGioLamViec"].ToString();
                                        int iPhutTangCaTruocGioLamViecTuDongKhongQuaDem3;
                                        iPhutTangCaTruocGioLamViecTuDongKhongQuaDem3 = Convert.ToInt32(dtCaLamViecTuDongKhongQuaDem2.Rows[iCaLamViecTuDongKhongQuaDem2]["SoPhutTangCaTruocGioLamViec"].ToString());
                                        int iPhutTangCaTruocGioLamViecDatDen15;
                                        iPhutTangCaTruocGioLamViecDatDen15 = Convert.ToInt32(dtCaLamViecTuDongKhongQuaDem2.Rows[iCaLamViecTuDongKhongQuaDem2]["TangCaTruocGioLamViecDatDen"].ToString());
                                        int iPhutTruTangCaTruoc15;
                                        iPhutTruTangCaTruoc15 = Convert.ToInt32(dtCaLamViecTuDongKhongQuaDem2.Rows[iCaLamViecTuDongKhongQuaDem2]["PhutTruTangCaTruoc"].ToString());
                                        string sChoPhepTangCaSauGioLamViecTuDongKhongQuaDem3;
                                        sChoPhepTangCaSauGioLamViecTuDongKhongQuaDem3 = dtCaLamViecTuDongKhongQuaDem2.Rows[iCaLamViecTuDongKhongQuaDem2]["TangCaSauGioLamViec"].ToString();
                                        int iPhutTangCaSauGioLamViecTuDongKhongQuaDem3;
                                        iPhutTangCaSauGioLamViecTuDongKhongQuaDem3 = Convert.ToInt32(dtCaLamViecTuDongKhongQuaDem2.Rows[iCaLamViecTuDongKhongQuaDem2]["SoPhutTangCaSauGioLamViec"].ToString());
                                        int iPhutTangCaSauGioLamViecDatDen15;
                                        iPhutTangCaSauGioLamViecDatDen15 = Convert.ToInt32(dtCaLamViecTuDongKhongQuaDem2.Rows[iCaLamViecTuDongKhongQuaDem2]["TangCaSauGioLamViecDatDen"].ToString());
                                        int iPhutTruTangCaSau15;
                                        iPhutTruTangCaSau15 = Convert.ToInt32(dtCaLamViecTuDongKhongQuaDem2.Rows[iCaLamViecTuDongKhongQuaDem2]["PhutTruTangCaSau"].ToString());
                                        int iGioiHanTC1TuDongKhongQuaDem3;
                                        iGioiHanTC1TuDongKhongQuaDem3 = Convert.ToInt32(dtCaLamViecTuDongKhongQuaDem2.Rows[iCaLamViecTuDongKhongQuaDem2]["GioiHanTangCa1"].ToString());
                                        int iGioiHanTC2TuDongKhongQuaDem3;
                                        iGioiHanTC2TuDongKhongQuaDem3 = Convert.ToInt32(dtCaLamViecTuDongKhongQuaDem2.Rows[iCaLamViecTuDongKhongQuaDem2]["GioiHanTangCa2"].ToString());
                                        int iGioiHanTC3TuDongKhongQuaDem3;
                                        iGioiHanTC3TuDongKhongQuaDem3 = Convert.ToInt32(dtCaLamViecTuDongKhongQuaDem2.Rows[iCaLamViecTuDongKhongQuaDem2]["GioiHanTangCa3"].ToString());
                                        int iGioiHanTC4TuDongKhongQuaDem3;
                                        iGioiHanTC4TuDongKhongQuaDem3 = Convert.ToInt32(dtCaLamViecTuDongKhongQuaDem2.Rows[iCaLamViecTuDongKhongQuaDem2]["GioiHanTangCa4"].ToString());
                                        int iTongGioTangCaSauTuDongKhongQuaDem3;
                                        iTongGioTangCaSauTuDongKhongQuaDem3 = 0;
                                        int iTongGioTangCaTruocTuDongKhongQuaDem3;
                                        iTongGioTangCaTruocTuDongKhongQuaDem3 = 0;
                                        if (sChoPhepTangCaTruocGioLamViecTuDongKhongQuaDem3 == "False" && sChoPhepTangCaSauGioLamViecTuDongKhongQuaDem3 == "False")
                                        {
                                            this.DGVTinhCong.Rows[addTuDong].Cells[12].Value = "0";
                                            this.DGVTinhCong.Rows[addTuDong].Cells[13].Value = "0";
                                            this.DGVTinhCong.Rows[addTuDong].Cells[14].Value = "0";
                                            this.DGVTinhCong.Rows[addTuDong].Cells[15].Value = "0";
                                        }
                                        else
                                        {
                                            if (sChoPhepTangCaTruocGioLamViecTuDongKhongQuaDem3 == "True")
                                            {
                                                int iThoiGianTruocGioLamTuDongKhongQuaDem3;
                                                iThoiGianTruocGioLamTuDongKhongQuaDem3 = Convert.ToInt32(Convert.ToInt32((dGioVaoKhaiBaoTuDongKhongQuaDemB2 - dGioVaoTuDong).TotalMinutes).ToString());
                                                if (iThoiGianTruocGioLamTuDongKhongQuaDem3 > 0 && iThoiGianTruocGioLamTuDongKhongQuaDem3 > iPhutTangCaTruocGioLamViecTuDongKhongQuaDem3 && iThoiGianTruocGioLamTuDongKhongQuaDem3 > iPhutTangCaTruocGioLamViecDatDen15)
                                                {
                                                    iTongGioTangCaTruocTuDongKhongQuaDem3 = iThoiGianTruocGioLamTuDongKhongQuaDem3 - iPhutTruTangCaTruoc15;
                                                }
                                            }
                                            if (sChoPhepTangCaSauGioLamViecTuDongKhongQuaDem3 == "True")
                                            {
                                                int iThoiGianSauGioLamViecTuDongKhongQuaDem3;
                                                iThoiGianSauGioLamViecTuDongKhongQuaDem3 = Convert.ToInt32(this.DGVTinhCong.Rows[addTuDong].Cells[11].Value);
                                                if (iThoiGianSauGioLamViecTuDongKhongQuaDem3 > 0 && iThoiGianSauGioLamViecTuDongKhongQuaDem3 > iPhutTangCaSauGioLamViecTuDongKhongQuaDem3)
                                                {
                                                    iTongGioTangCaSauTuDongKhongQuaDem3 = ((iThoiGianSauGioLamViecTuDongKhongQuaDem3 < iPhutTangCaSauGioLamViecDatDen15) ? iThoiGianSauGioLamViecTuDongKhongQuaDem3 : (iThoiGianSauGioLamViecTuDongKhongQuaDem3 - iPhutTruTangCaSau15));
                                                }
                                            }
                                        }
                                        double dTongThoiGianTangCaTuDongKhongQuaDem3;
                                        dTongThoiGianTangCaTuDongKhongQuaDem3 = Convert.ToDouble(iTongGioTangCaTruocTuDongKhongQuaDem3 + iTongGioTangCaSauTuDongKhongQuaDem3);
                                        if (dTongThoiGianTangCaTuDongKhongQuaDem3 > 0.0)
                                        {
                                            if (iGioiHanTC1TuDongKhongQuaDem3 == 0)
                                            {
                                                this.DGVTinhCong.Rows[addTuDong].Cells[12].Value = Math.Round(dTongThoiGianTangCaTuDongKhongQuaDem3 * this.dTangCa1HeSo / 60.0, this.iLamTronGio);
                                                this.DGVTinhCong.Rows[addTuDong].Cells[13].Value = "0";
                                                this.DGVTinhCong.Rows[addTuDong].Cells[14].Value = "0";
                                                this.DGVTinhCong.Rows[addTuDong].Cells[15].Value = "0";
                                            }
                                            if (iGioiHanTC1TuDongKhongQuaDem3 != 0 && iGioiHanTC2TuDongKhongQuaDem3 == 0)
                                            {
                                                if (dTongThoiGianTangCaTuDongKhongQuaDem3 < Convert.ToDouble(iGioiHanTC1TuDongKhongQuaDem3))
                                                {
                                                    this.DGVTinhCong.Rows[addTuDong].Cells[12].Value = Math.Round(dTongThoiGianTangCaTuDongKhongQuaDem3 * this.dTangCa1HeSo / 60.0, this.iLamTronGio);
                                                    this.DGVTinhCong.Rows[addTuDong].Cells[13].Value = "0";
                                                    this.DGVTinhCong.Rows[addTuDong].Cells[14].Value = "0";
                                                    this.DGVTinhCong.Rows[addTuDong].Cells[15].Value = "0";
                                                }
                                                else
                                                {
                                                    this.DGVTinhCong.Rows[addTuDong].Cells[12].Value = Math.Round(Convert.ToDouble(iGioiHanTC1TuDongKhongQuaDem3) / 60.0 * this.dTangCa1HeSo, this.iLamTronGio);
                                                    if (dTongThoiGianTangCaTuDongKhongQuaDem3 - Convert.ToDouble(iGioiHanTC1TuDongKhongQuaDem3) > 0.0)
                                                    {
                                                        this.DGVTinhCong.Rows[addTuDong].Cells[13].Value = Math.Round((dTongThoiGianTangCaTuDongKhongQuaDem3 - Convert.ToDouble(iGioiHanTC1TuDongKhongQuaDem3)) * this.dTangCa2HeSo / 60.0, this.iLamTronGio);
                                                    }
                                                    this.DGVTinhCong.Rows[addTuDong].Cells[14].Value = "0";
                                                    this.DGVTinhCong.Rows[addTuDong].Cells[15].Value = "0";
                                                }
                                            }
                                            if (iGioiHanTC1TuDongKhongQuaDem3 != 0 && iGioiHanTC2TuDongKhongQuaDem3 != 0 && iGioiHanTC3TuDongKhongQuaDem3 == 0)
                                            {
                                                if (dTongThoiGianTangCaTuDongKhongQuaDem3 < Convert.ToDouble(iGioiHanTC1TuDongKhongQuaDem3))
                                                {
                                                    this.DGVTinhCong.Rows[addTuDong].Cells[12].Value = Math.Round(dTongThoiGianTangCaTuDongKhongQuaDem3 * this.dTangCa1HeSo / 60.0, this.iLamTronGio);
                                                    this.DGVTinhCong.Rows[addTuDong].Cells[13].Value = "0";
                                                    this.DGVTinhCong.Rows[addTuDong].Cells[14].Value = "0";
                                                    this.DGVTinhCong.Rows[addTuDong].Cells[15].Value = "0";
                                                }
                                                else
                                                {
                                                    this.DGVTinhCong.Rows[addTuDong].Cells[12].Value = Math.Round(Convert.ToDouble(iGioiHanTC1TuDongKhongQuaDem3) * this.dTangCa1HeSo / 60.0, this.iLamTronGio);
                                                    if (dTongThoiGianTangCaTuDongKhongQuaDem3 - Convert.ToDouble(iGioiHanTC1TuDongKhongQuaDem3) < Convert.ToDouble(iGioiHanTC2TuDongKhongQuaDem3))
                                                    {
                                                        this.DGVTinhCong.Rows[addTuDong].Cells[13].Value = Math.Round((dTongThoiGianTangCaTuDongKhongQuaDem3 - Convert.ToDouble(iGioiHanTC1TuDongKhongQuaDem3)) * this.dTangCa2HeSo / 60.0, this.iLamTronGio);
                                                        this.DGVTinhCong.Rows[addTuDong].Cells[14].Value = "0";
                                                        this.DGVTinhCong.Rows[addTuDong].Cells[15].Value = "0";
                                                    }
                                                    else
                                                    {
                                                        this.DGVTinhCong.Rows[addTuDong].Cells[12].Value = Math.Round(Convert.ToDouble(iGioiHanTC1TuDongKhongQuaDem3) * this.dTangCa1HeSo / 60.0, this.iLamTronGio);
                                                        this.DGVTinhCong.Rows[addTuDong].Cells[13].Value = Math.Round(Convert.ToDouble(iGioiHanTC2TuDongKhongQuaDem3) * this.dTangCa2HeSo / 60.0, this.iLamTronGio);
                                                        this.DGVTinhCong.Rows[addTuDong].Cells[14].Value = Math.Round((dTongThoiGianTangCaTuDongKhongQuaDem3 - Convert.ToDouble(iGioiHanTC1TuDongKhongQuaDem3) - Convert.ToDouble(iGioiHanTC2TuDongKhongQuaDem3)) * this.dTangCa3HeSo / 60.0, this.iLamTronGio);
                                                        this.DGVTinhCong.Rows[addTuDong].Cells[15].Value = "0";
                                                    }
                                                }
                                            }
                                            if (iGioiHanTC1TuDongKhongQuaDem3 != 0 && iGioiHanTC2TuDongKhongQuaDem3 != 0 && iGioiHanTC3TuDongKhongQuaDem3 != 0 && iGioiHanTC4TuDongKhongQuaDem3 != 0)
                                            {
                                            }
                                        }
                                        else
                                        {
                                            this.DGVTinhCong.Rows[addTuDong].Cells[12].Value = "0";
                                            this.DGVTinhCong.Rows[addTuDong].Cells[13].Value = "0";
                                            this.DGVTinhCong.Rows[addTuDong].Cells[14].Value = "0";
                                            this.DGVTinhCong.Rows[addTuDong].Cells[15].Value = "0";
                                        }
                                    }
                                    if (DateTimeProgress.XuatIDThu((int)dt.AddDays(dem).DayOfWeek) == "0")
                                    {
                                        this.DGVTinhCong.Rows[addTuDong].Cells[19].Value = "CN";
                                    }
                                    else
                                    {
                                        this.DGVTinhCong.Rows[addTuDong].Cells[19].Value = "NT";
                                    }
                                    this.DGVTinhCong.Rows[addTuDong].Cells[20].Value = this.sMaChamCong;
                                    this.DGVTinhCong.Rows[addTuDong].Cells[21].Value = this.sPhongBanTinhCong;
                                    break;
                                }
                            }
                            if (iKiemTraDuLieuTuDong == 0)
                            {
                                this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = "0";
                                this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = "0";
                                this.DGVTinhCong.Rows[_nhanVien].Cells[16].Value = "0";
                                this.DGVTinhCong.Rows[_nhanVien].Cells[17].Value = "0";
                                this.DGVTinhCong.Rows[_nhanVien].Cells[18].Value = this.sKHVang;
                                if (DateTimeProgress.XuatIDThu((int)dt.AddDays(dem).DayOfWeek) == "0")
                                {
                                    this.DGVTinhCong.Rows[_nhanVien].Cells[19].Value = "CN";
                                }
                                else
                                {
                                    this.DGVTinhCong.Rows[_nhanVien].Cells[19].Value = "NT";
                                }
                                this.DGVTinhCong.Rows[_nhanVien].Cells[20].Value = this.sMaChamCong;
                                this.DGVTinhCong.Rows[_nhanVien].Cells[21].Value = this.sPhongBanTinhCong;
                            }
                        }
                        if (iChonLichTrinh == 3)
                        {
                            int iKiemTraLanChamTuDongKhongQuaDemLichTrinhVaoRa2;
                            iKiemTraLanChamTuDongKhongQuaDemLichTrinhVaoRa2 = 0;
                            int iKiemTraLanChamKhoangCachTuDongKhongQuaDemLichTrinhVaoRa2;
                            iKiemTraLanChamKhoangCachTuDongKhongQuaDemLichTrinhVaoRa2 = 0;
                            DateTime dGioVaoTuDongKhongQuaDemLichTrinhVaoRa2;
                            dGioVaoTuDongKhongQuaDemLichTrinhVaoRa2 = default(DateTime);
                            DateTime dGioRaTuDongKhongQuaDemLichTrinhVaoRa2;
                            dGioRaTuDongKhongQuaDemLichTrinhVaoRa2 = default(DateTime);
                            DateTime dGioVaoPhanTheoGio;
                            dGioVaoPhanTheoGio = default(DateTime);
                            int demPhanTheoGio;
                            demPhanTheoGio = 0;
                            int iKiemTraLanCham2;
                            iKiemTraLanCham2 = 0;
                            int addPhanTheoGio;
                            addPhanTheoGio = 0;
                            new DataTable();
                            DataTable dtPhanTheoGio;
                            dtPhanTheoGio = this._checkInOutBLL.getCheckInOutByMaChamCongAndNgayCham(Convert.ToInt32(this.sMaChamCong), Convert.ToDateTime(this.DGVTinhCong.Rows[_nhanVien].Cells[2].Value.ToString()));
                            for (int iPhanTheoGio = 0; iPhanTheoGio < dtPhanTheoGio.Rows.Count; iPhanTheoGio++)
                            {
                                string sPhanTheoGio;
                                sPhanTheoGio = this.DGVTinhCong.Rows[_nhanVien].Cells[2].Value.ToString();
                                DateTime dGioChamPhanTheoGio;
                                dGioChamPhanTheoGio = Convert.ToDateTime(dtPhanTheoGio.Rows[iPhanTheoGio]["GioCham"].ToString());
                                new DataTable();
                                this._phanTheoGioDTO.MaLichTrinhVaoRa = sLTVRNhanVien;
                                DataTable dtChiTietPhanTheoGio;
                                dtChiTietPhanTheoGio = this._phanTheoGioBLL.PhanTheoGioGetMaLichTrinhVaoRa(sLTVRNhanVien);
                                for (int iChiTietPhanTheoGio = 0; iChiTietPhanTheoGio < dtChiTietPhanTheoGio.Rows.Count; iChiTietPhanTheoGio++)
                                {
                                    DateTime dBatDauVao;
                                    dBatDauVao = Convert.ToDateTime(sPhanTheoGio + " " + string.Format("{0:T}", Convert.ToDateTime(dtChiTietPhanTheoGio.Rows[iChiTietPhanTheoGio]["BatDauVao"].ToString())));
                                    DateTime dKetThucVao;
                                    dKetThucVao = Convert.ToDateTime(sPhanTheoGio + " " + string.Format("{0:T}", Convert.ToDateTime(dtChiTietPhanTheoGio.Rows[iChiTietPhanTheoGio]["KetThucVao"].ToString())));
                                    DateTime dBatDauRa;
                                    dBatDauRa = Convert.ToDateTime(sPhanTheoGio + " " + string.Format("{0:T}", Convert.ToDateTime(dtChiTietPhanTheoGio.Rows[iChiTietPhanTheoGio]["BatDauRa"].ToString())));
                                    DateTime dKetThucRa;
                                    dKetThucRa = Convert.ToDateTime(sPhanTheoGio + " " + string.Format("{0:T}", Convert.ToDateTime(dtChiTietPhanTheoGio.Rows[iChiTietPhanTheoGio]["KetThucRa"].ToString())));
                                    if (dGioChamPhanTheoGio >= dBatDauVao && dGioChamPhanTheoGio <= dKetThucVao)
                                    {
                                        switch (iKiemTraLanCham2)
                                        {
                                            case 3:
                                                addPhanTheoGio = this.DGVTinhCong.Rows.Add();
                                                dGioVaoPhanTheoGio = dGioChamPhanTheoGio;
                                                this.DGVTinhCong.Rows[addPhanTheoGio].Cells[5].Value = string.Format(this.sDinhDangThoiGian, dGioVaoPhanTheoGio);
                                                this.DGVTinhCong.Rows[addPhanTheoGio].Cells[0].Value = this.sMaNhanVien;
                                                this.DGVTinhCong.Rows[addPhanTheoGio].Cells[1].Value = this.sTenNhanVien;
                                                this.DGVTinhCong.Rows[addPhanTheoGio].Cells[2].Value = this.DGVTinhCong.Rows[_nhanVien].Cells[2].Value.ToString();
                                                this.DGVTinhCong.Rows[addPhanTheoGio].Cells[4].Value = ca;
                                                this.DGVTinhCong.Rows[addPhanTheoGio].Cells[7].Value = "0";
                                                this.DGVTinhCong.Rows[addPhanTheoGio].Cells[8].Value = "0";
                                                this.DGVTinhCong.Rows[addPhanTheoGio].Cells[9].Value = "0";
                                                this.DGVTinhCong.Rows[addPhanTheoGio].Cells[10].Value = "0";
                                                this.DGVTinhCong.Rows[addPhanTheoGio].Cells[11].Value = "0";
                                                this.DGVTinhCong.Rows[addPhanTheoGio].Cells[12].Value = "0";
                                                this.DGVTinhCong.Rows[addPhanTheoGio].Cells[13].Value = "0";
                                                this.DGVTinhCong.Rows[addPhanTheoGio].Cells[14].Value = "0";
                                                this.DGVTinhCong.Rows[addPhanTheoGio].Cells[15].Value = "0";
                                                this.DGVTinhCong.Rows[addPhanTheoGio].Cells[16].Value = "0";
                                                this.DGVTinhCong.Rows[addPhanTheoGio].Cells[17].Value = "0";
                                                this.DGVTinhCong.Rows[addPhanTheoGio].Cells[18].Value = this.sKHVang;
                                                this.DGVTinhCong.Rows[addPhanTheoGio].Cells[3].Value = DateTimeProgress.XuatThuTinhCong((int)dt.AddDays(dem).DayOfWeek);
                                                if (DateTimeProgress.XuatIDThu((int)dt.AddDays(dem).DayOfWeek) == "0")
                                                {
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[19].Value = "CN";
                                                }
                                                else
                                                {
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[19].Value = "NT";
                                                }
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[20].Value = this.sMaChamCong;
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[21].Value = this.sPhongBanTinhCong;
                                                iKiemTraLanCham2 = 2;
                                                break;
                                            case 0:
                                                dGioVaoPhanTheoGio = dGioChamPhanTheoGio;
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[5].Value = string.Format(this.sDinhDangThoiGian, dGioVaoPhanTheoGio);
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[0].Value = this.sMaNhanVien;
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[1].Value = this.sTenNhanVien;
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[2].Value = this.DGVTinhCong.Rows[_nhanVien].Cells[2].Value.ToString();
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[4].Value = ca;
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[11].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[16].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[17].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[18].Value = this.sKHVang;
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[3].Value = DateTimeProgress.XuatThuTinhCong((int)dt.AddDays(dem).DayOfWeek);
                                                if (DateTimeProgress.XuatIDThu((int)dt.AddDays(dem).DayOfWeek) == "0")
                                                {
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[19].Value = "CN";
                                                }
                                                else
                                                {
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[19].Value = "NT";
                                                }
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[20].Value = this.sMaChamCong;
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[21].Value = this.sPhongBanTinhCong;
                                                iKiemTraLanCham2 = 1;
                                                break;
                                            case 1:
                                                addPhanTheoGio = this.DGVTinhCong.Rows.Add();
                                                dGioVaoPhanTheoGio = dGioChamPhanTheoGio;
                                                this.DGVTinhCong.Rows[addPhanTheoGio].Cells[5].Value = string.Format(this.sDinhDangThoiGian, dGioVaoPhanTheoGio);
                                                this.DGVTinhCong.Rows[addPhanTheoGio].Cells[0].Value = this.sMaNhanVien;
                                                this.DGVTinhCong.Rows[addPhanTheoGio].Cells[1].Value = this.sTenNhanVien;
                                                this.DGVTinhCong.Rows[addPhanTheoGio].Cells[2].Value = this.DGVTinhCong.Rows[_nhanVien].Cells[2].Value.ToString();
                                                this.DGVTinhCong.Rows[addPhanTheoGio].Cells[4].Value = ca;
                                                this.DGVTinhCong.Rows[addPhanTheoGio].Cells[7].Value = "0";
                                                this.DGVTinhCong.Rows[addPhanTheoGio].Cells[8].Value = "0";
                                                this.DGVTinhCong.Rows[addPhanTheoGio].Cells[9].Value = "0";
                                                this.DGVTinhCong.Rows[addPhanTheoGio].Cells[10].Value = "0";
                                                this.DGVTinhCong.Rows[addPhanTheoGio].Cells[11].Value = "0";
                                                this.DGVTinhCong.Rows[addPhanTheoGio].Cells[12].Value = "0";
                                                this.DGVTinhCong.Rows[addPhanTheoGio].Cells[13].Value = "0";
                                                this.DGVTinhCong.Rows[addPhanTheoGio].Cells[14].Value = "0";
                                                this.DGVTinhCong.Rows[addPhanTheoGio].Cells[15].Value = "0";
                                                this.DGVTinhCong.Rows[addPhanTheoGio].Cells[16].Value = "0";
                                                this.DGVTinhCong.Rows[addPhanTheoGio].Cells[17].Value = "0";
                                                this.DGVTinhCong.Rows[addPhanTheoGio].Cells[18].Value = this.sKHVang;
                                                this.DGVTinhCong.Rows[addPhanTheoGio].Cells[3].Value = DateTimeProgress.XuatThuTinhCong((int)dt.AddDays(dem).DayOfWeek);
                                                if (DateTimeProgress.XuatIDThu((int)dt.AddDays(dem).DayOfWeek) == "0")
                                                {
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[19].Value = "CN";
                                                }
                                                else
                                                {
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[19].Value = "NT";
                                                }
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[20].Value = this.sMaChamCong;
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[21].Value = this.sPhongBanTinhCong;
                                                iKiemTraLanCham2 = 2;
                                                break;
                                            case 2:
                                                addPhanTheoGio = this.DGVTinhCong.Rows.Add();
                                                dGioVaoPhanTheoGio = dGioChamPhanTheoGio;
                                                this.DGVTinhCong.Rows[addPhanTheoGio].Cells[5].Value = string.Format(this.sDinhDangThoiGian, dGioVaoPhanTheoGio);
                                                this.DGVTinhCong.Rows[addPhanTheoGio].Cells[0].Value = this.sMaNhanVien;
                                                this.DGVTinhCong.Rows[addPhanTheoGio].Cells[1].Value = this.sTenNhanVien;
                                                this.DGVTinhCong.Rows[addPhanTheoGio].Cells[2].Value = this.DGVTinhCong.Rows[_nhanVien].Cells[2].Value.ToString();
                                                this.DGVTinhCong.Rows[addPhanTheoGio].Cells[4].Value = ca;
                                                this.DGVTinhCong.Rows[addPhanTheoGio].Cells[7].Value = "0";
                                                this.DGVTinhCong.Rows[addPhanTheoGio].Cells[8].Value = "0";
                                                this.DGVTinhCong.Rows[addPhanTheoGio].Cells[9].Value = "0";
                                                this.DGVTinhCong.Rows[addPhanTheoGio].Cells[10].Value = "0";
                                                this.DGVTinhCong.Rows[addPhanTheoGio].Cells[11].Value = "0";
                                                this.DGVTinhCong.Rows[addPhanTheoGio].Cells[12].Value = "0";
                                                this.DGVTinhCong.Rows[addPhanTheoGio].Cells[13].Value = "0";
                                                this.DGVTinhCong.Rows[addPhanTheoGio].Cells[14].Value = "0";
                                                this.DGVTinhCong.Rows[addPhanTheoGio].Cells[15].Value = "0";
                                                this.DGVTinhCong.Rows[addPhanTheoGio].Cells[16].Value = "0";
                                                this.DGVTinhCong.Rows[addPhanTheoGio].Cells[17].Value = "0";
                                                this.DGVTinhCong.Rows[addPhanTheoGio].Cells[18].Value = this.sKHVang;
                                                this.DGVTinhCong.Rows[addPhanTheoGio].Cells[3].Value = DateTimeProgress.XuatThuTinhCong((int)dt.AddDays(dem).DayOfWeek);
                                                if (DateTimeProgress.XuatIDThu((int)dt.AddDays(dem).DayOfWeek) == "0")
                                                {
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[19].Value = "CN";
                                                }
                                                else
                                                {
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[19].Value = "NT";
                                                }
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[20].Value = this.sMaChamCong;
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[21].Value = this.sPhongBanTinhCong;
                                                iKiemTraLanCham2 = 2;
                                                break;
                                            default:
                                                continue;
                                        }
                                        break;
                                    }
                                    if (!(dGioChamPhanTheoGio >= dBatDauRa) || !(dGioChamPhanTheoGio <= dKetThucRa))
                                    {
                                        continue;
                                    }
                                    switch (iKiemTraLanCham2)
                                    {
                                        case 0:
                                            this.DGVTinhCong.Rows[_nhanVien].Cells[6].Value = string.Format(this.sDinhDangThoiGian, dGioChamPhanTheoGio);
                                            this.DGVTinhCong.Rows[_nhanVien].Cells[0].Value = this.sMaNhanVien;
                                            this.DGVTinhCong.Rows[_nhanVien].Cells[1].Value = this.sTenNhanVien;
                                            this.DGVTinhCong.Rows[_nhanVien].Cells[2].Value = this.DGVTinhCong.Rows[_nhanVien].Cells[2].Value.ToString();
                                            this.DGVTinhCong.Rows[_nhanVien].Cells[4].Value = ca;
                                            this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = "0";
                                            this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = "0";
                                            this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = "0";
                                            this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = "0";
                                            this.DGVTinhCong.Rows[_nhanVien].Cells[11].Value = "0";
                                            this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = "0";
                                            this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                            this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                            this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                            this.DGVTinhCong.Rows[_nhanVien].Cells[16].Value = "0";
                                            this.DGVTinhCong.Rows[_nhanVien].Cells[17].Value = "0";
                                            this.DGVTinhCong.Rows[_nhanVien].Cells[18].Value = this.sKHVang;
                                            this.DGVTinhCong.Rows[_nhanVien].Cells[3].Value = DateTimeProgress.XuatThuTinhCong((int)dt.AddDays(dem).DayOfWeek);
                                            this.DGVTinhCong.Rows[_nhanVien].Cells[20].Value = this.sMaChamCong;
                                            this.DGVTinhCong.Rows[_nhanVien].Cells[21].Value = this.sPhongBanTinhCong;
                                            iKiemTraLanCham2 = 3;
                                            break;
                                        case 1:
                                            {
                                                DateTime dGioRaPhanTheoGio;
                                                dGioRaPhanTheoGio = dGioChamPhanTheoGio;
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[6].Value = string.Format(this.sDinhDangThoiGian, dGioRaPhanTheoGio);
                                                int iCaTrongLIchtrinh3;
                                                iCaTrongLIchtrinh3 = 0;
                                                new DataTable();
                                                this._chiTietLichTrinhChoCalamViecDTO.MaLichTrinhCaLamViec = sLTCCLVNhanVien;
                                                this._chiTietLichTrinhChoCalamViecDTO.Thu = sThu;
                                                DataTable dtNhanCaPhanTheoGio;
                                                dtNhanCaPhanTheoGio = this._chiTietLichTrinhChoCaLamViecBLL.ChiTietLichTrinhChoCaLamViecNhanCa(this._chiTietLichTrinhChoCalamViecDTO);
                                                int iChiTietLichTrinhChoCaLamViecPhanTheoGio;
                                                iChiTietLichTrinhChoCaLamViecPhanTheoGio = 0;
                                                if (iChiTietLichTrinhChoCaLamViecPhanTheoGio < dtNhanCaPhanTheoGio.Rows.Count)
                                                {
                                                    iCaTrongLIchtrinh3 = 1;
                                                    int cellChiTietLichTrinhChoCaLamViecPhanTheoGio;
                                                    cellChiTietLichTrinhChoCaLamViecPhanTheoGio = 3;
                                                    while (true)
                                                    {
                                                        if (cellChiTietLichTrinhChoCaLamViecPhanTheoGio < 13)
                                                        {
                                                            kiemTraVao = 0;
                                                            kiemTraRa = 0;
                                                            this.sPhanTheoGioMaCaLamViec = dtNhanCaPhanTheoGio.Rows[iChiTietLichTrinhChoCaLamViecPhanTheoGio][cellChiTietLichTrinhChoCaLamViecPhanTheoGio].ToString();
                                                            new DataTable();
                                                            DataTable dtPhanTheoGioCa1;
                                                            dtPhanTheoGioCa1 = this._caLamViecBLL.CaLamViecGetByMaCaLamViec(sPhanTheoGioMaCaLamViec);
                                                            int iPhanTheoGioCa1;
                                                            iPhanTheoGioCa1 = 0;
                                                            while (iPhanTheoGioCa1 < dtPhanTheoGioCa1.Rows.Count)
                                                            {
                                                                string sGiayGioVao25;
                                                                sGiayGioVao25 = dGioVaoPhanTheoGio.Second.ToString();
                                                                string sGiayGioRa26;
                                                                sGiayGioRa26 = dGioRaPhanTheoGio.Second.ToString();
                                                                this.sPhanTheoGioTenCaLamViec = dtPhanTheoGioCa1.Rows[iPhanTheoGioCa1]["CaLamViec"].ToString();
                                                                DateTime dBatDauVaoPhanTheoGioB;
                                                                dBatDauVaoPhanTheoGioB = Convert.ToDateTime(sNgayCham + " " + string.Format("{0:T}", Convert.ToDateTime(dtPhanTheoGioCa1.Rows[iPhanTheoGioCa1]["BatDauVao"].ToString())).Replace("00 ", sGiayGioVao25 + " "));
                                                                DateTime dKetThucVaoPhanTheoGioB;
                                                                dKetThucVaoPhanTheoGioB = Convert.ToDateTime(sNgayCham + " " + string.Format("{0:T}", Convert.ToDateTime(dtPhanTheoGioCa1.Rows[iPhanTheoGioCa1]["KetThucVao"].ToString())).Replace("00 ", sGiayGioVao25 + " "));
                                                                DateTime dBatDauRaPhanTheoGioB;
                                                                dBatDauRaPhanTheoGioB = Convert.ToDateTime(sNgayCham + " " + string.Format("{0:T}", Convert.ToDateTime(dtPhanTheoGioCa1.Rows[iPhanTheoGioCa1]["BatDauRa"].ToString())).Replace("00 ", sGiayGioRa26 + " "));
                                                                DateTime dKetThucRaPhanTheoGioB;
                                                                dKetThucRaPhanTheoGioB = Convert.ToDateTime(sNgayCham + " " + string.Format("{0:T}", Convert.ToDateTime(dtPhanTheoGioCa1.Rows[iPhanTheoGioCa1]["KetThucRa"].ToString())).Replace("00 ", sGiayGioRa26 + " "));
                                                                if (dGioVaoPhanTheoGio >= dBatDauVaoPhanTheoGioB && dGioVaoPhanTheoGio <= dKetThucVaoPhanTheoGioB)
                                                                {
                                                                    kiemTraVao++;
                                                                }
                                                                if (dGioRaPhanTheoGio >= dBatDauRaPhanTheoGioB && dGioRaPhanTheoGio <= dKetThucRaPhanTheoGioB)
                                                                {
                                                                    kiemTraRa++;
                                                                }
                                                                if (kiemTraVao != 1 || kiemTraRa != 1)
                                                                {
                                                                    iPhanTheoGioCa1++;
                                                                    continue;
                                                                }
                                                                goto IL_1543b;
                                                            }
                                                            if (!(this.sPhanTheoGioMaCaLamViec == ""))
                                                            {
                                                                cellChiTietLichTrinhChoCaLamViecPhanTheoGio++;
                                                                continue;
                                                            }
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[4].Value = ca;
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[11].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[16].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[17].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[18].Value = this.sKHVang;
                                                            if (DateTimeProgress.XuatIDThu((int)dt.AddDays(dem).DayOfWeek) == "0")
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[19].Value = "CN";
                                                            }
                                                            else
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[19].Value = "NT";
                                                            }
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[20].Value = this.sMaChamCong;
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[21].Value = this.sPhongBanTinhCong;
                                                            break;
                                                        }
                                                        goto IL_1543b;
                                                    IL_1543b:
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[4].Value = this.sPhanTheoGioTenCaLamViec;
                                                        new DataTable();
                                                        DataTable dtCaLamViecPhanTheoGio;
                                                        dtCaLamViecPhanTheoGio = this._caLamViecBLL.CaLamViecGetByMaCaLamViec(sPhanTheoGioMaCaLamViec);
                                                        for (int iCaLamViecPhanTheoGio = 0; iCaLamViecPhanTheoGio < dtCaLamViecPhanTheoGio.Rows.Count; iCaLamViecPhanTheoGio++)
                                                        {
                                                            string sGiayGioVao27;
                                                            sGiayGioVao27 = dGioVaoPhanTheoGio.Second.ToString();
                                                            string sGiayGioRa27;
                                                            sGiayGioRa27 = dGioRaPhanTheoGio.Second.ToString();
                                                            DateTime dGioVaoKhaiBaoPhanTheoGioB;
                                                            dGioVaoKhaiBaoPhanTheoGioB = Convert.ToDateTime(sNgayCham + " " + string.Format("{0:T}", Convert.ToDateTime(dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["GioVaoLamViec"].ToString())).Replace("00 ", sGiayGioVao27 + " "));
                                                            DateTime dGioRaKhaiBaoPhanTheoGioB;
                                                            dGioRaKhaiBaoPhanTheoGioB = Convert.ToDateTime(sNgayCham + " " + string.Format("{0:T}", Convert.ToDateTime(dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["GioKetThucLamViec"].ToString())).Replace("00 ", sGiayGioRa27 + " "));
                                                            string sXemCaNayLaTangCa10;
                                                            sXemCaNayLaTangCa10 = dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["XemCaNayLaTangCa"].ToString();
                                                            int iTangCaMuc10;
                                                            iTangCaMuc10 = Convert.ToInt32(dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["TangCaMuc"].ToString());
                                                            string sXemChuNhatLaTangCa5;
                                                            sXemChuNhatLaTangCa5 = dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["XemCuoiTuanLaTangCa"].ToString();
                                                            int iTangCaChuNhatMuc5;
                                                            iTangCaChuNhatMuc5 = Convert.ToInt32(dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["TangCaCuoiTuanMuc"].ToString());
                                                            if (sXemCaNayLaTangCa10 == "True")
                                                            {
                                                                dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["TruGioDiTre"].ToString();
                                                                dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["BatDauTinhDiTre"].ToString();
                                                                Convert.ToInt32(dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["ChoPhepDiTre"].ToString());
                                                                string sPhutTre31;
                                                                sPhutTre31 = Convert.ToInt32((dGioVaoPhanTheoGio - dGioVaoKhaiBaoPhanTheoGioB).TotalMinutes).ToString();
                                                                if (Convert.ToInt32(sPhutTre31) < 0)
                                                                {
                                                                    sPhutTre31 = "0";
                                                                }
                                                                dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["TruGioVeSom"].ToString();
                                                                dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["BatDauTinhVeSom"].ToString();
                                                                Convert.ToInt32(dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["ChoPhepVeSom"].ToString());
                                                                string sPhutVeSom31;
                                                                sPhutVeSom31 = Convert.ToInt32((dGioRaKhaiBaoPhanTheoGioB - dGioRaPhanTheoGio).TotalMinutes).ToString();
                                                                if (Convert.ToInt32(sPhutVeSom31) < 0)
                                                                {
                                                                    sPhutVeSom31 = "0";
                                                                }
                                                                double dTongGioTangCaPhanTheoGio;
                                                                dTongGioTangCaPhanTheoGio = Math.Round((Convert.ToDouble(dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["TongGioTrongCaLamViec"]) * 60.0 - (Convert.ToDouble(sPhutTre31) + Convert.ToDouble(sPhutVeSom31))) / 60.0, this.iLamTronGio);
                                                                if (iTangCaMuc10 == 1)
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = dTongGioTangCaPhanTheoGio * this.dTangCa1HeSo;
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[18].Value = this.sKHDungGio;
                                                                }
                                                                if (iTangCaMuc10 == 2)
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = dTongGioTangCaPhanTheoGio * this.dTangCa2HeSo;
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[18].Value = this.sKHDungGio;
                                                                }
                                                                if (iTangCaMuc10 == 3)
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = dTongGioTangCaPhanTheoGio * this.dTangCa3HeSo;
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[18].Value = this.sKHDungGio;
                                                                }
                                                                if (iTangCaMuc10 == 4)
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = dTongGioTangCaPhanTheoGio * this.dTangCa4HeSo;
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[18].Value = this.sKHDungGio;
                                                                }
                                                            }
                                                            else if (DateTimeProgress.XuatIDThu((int)dt.AddDays(dem).DayOfWeek) == "0")
                                                            {
                                                                if (sXemChuNhatLaTangCa5 == "True")
                                                                {
                                                                    dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["TruGioDiTre"].ToString();
                                                                    dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["BatDauTinhDiTre"].ToString();
                                                                    Convert.ToInt32(dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["ChoPhepDiTre"].ToString());
                                                                    string sPhutTre30;
                                                                    sPhutTre30 = Convert.ToInt32((dGioVaoPhanTheoGio - dGioVaoKhaiBaoPhanTheoGioB).TotalMinutes).ToString();
                                                                    if (Convert.ToInt32(sPhutTre30) < 0)
                                                                    {
                                                                        sPhutTre30 = "0";
                                                                    }
                                                                    dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["TruGioVeSom"].ToString();
                                                                    dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["BatDauTinhVeSom"].ToString();
                                                                    Convert.ToInt32(dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["ChoPhepVeSom"].ToString());
                                                                    string sPhutVeSom30;
                                                                    sPhutVeSom30 = Convert.ToInt32((dGioRaKhaiBaoPhanTheoGioB - dGioRaPhanTheoGio).TotalMinutes).ToString();
                                                                    if (Convert.ToInt32(sPhutVeSom30) < 0)
                                                                    {
                                                                        sPhutVeSom30 = "0";
                                                                    }
                                                                    double dTongGioTangCaPhanTheoGioA;
                                                                    dTongGioTangCaPhanTheoGioA = Math.Round((Convert.ToDouble(dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["TongGioTrongCaLamViec"]) * 60.0 - (Convert.ToDouble(sPhutTre30) + Convert.ToDouble(sPhutVeSom30))) / 60.0, this.iLamTronGio);
                                                                    if (iTangCaChuNhatMuc5 == 1)
                                                                    {
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = dTongGioTangCaPhanTheoGioA * this.dTangCaChuNhatHeSo;
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[18].Value = this.sKHDungGio;
                                                                    }
                                                                    if (iTangCaChuNhatMuc5 == 2)
                                                                    {
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = dTongGioTangCaPhanTheoGioA * this.dTangCaChuNhatHeSo;
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[18].Value = this.sKHDungGio;
                                                                    }
                                                                    if (iTangCaChuNhatMuc5 == 3)
                                                                    {
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = dTongGioTangCaPhanTheoGioA * this.dTangCaChuNhatHeSo;
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[18].Value = this.sKHDungGio;
                                                                    }
                                                                    if (iTangCaChuNhatMuc5 == 4)
                                                                    {
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = dTongGioTangCaPhanTheoGioA * this.dTangCaChuNhatHeSo;
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[18].Value = this.sKHDungGio;
                                                                    }
                                                                }
                                                                else
                                                                {
                                                                    string sTruGioDiTre24;
                                                                    sTruGioDiTre24 = dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["TruGioDiTre"].ToString();
                                                                    string sBatDauTinhDiTre24;
                                                                    sBatDauTinhDiTre24 = dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["BatDauTinhDiTre"].ToString();
                                                                    int iChoPhepDiTre21;
                                                                    iChoPhepDiTre21 = Convert.ToInt32(dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["ChoPhepDiTre"].ToString());
                                                                    string sPhutTre29;
                                                                    sPhutTre29 = Convert.ToInt32((dGioVaoPhanTheoGio - dGioVaoKhaiBaoPhanTheoGioB).TotalMinutes).ToString();
                                                                    if (sTruGioDiTre24 == "True")
                                                                    {
                                                                        if (Convert.ToInt32(sPhutTre29) < 0)
                                                                        {
                                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = "0";
                                                                        }
                                                                        else
                                                                        {
                                                                            int iPhutTre21;
                                                                            iPhutTre21 = Convert.ToInt32(sPhutTre29) - iChoPhepDiTre21;
                                                                            if (sBatDauTinhDiTre24 == "True")
                                                                            {
                                                                                if (iPhutTre21 < 1)
                                                                                {
                                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = "0";
                                                                                }
                                                                                else
                                                                                {
                                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = iPhutTre21.ToString();
                                                                                }
                                                                            }
                                                                            else if (iPhutTre21 < 1)
                                                                            {
                                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = "0";
                                                                            }
                                                                            else
                                                                            {
                                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = sPhutTre29;
                                                                            }
                                                                        }
                                                                    }
                                                                    else
                                                                    {
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = "0";
                                                                    }
                                                                    string sTruGioVeSom24;
                                                                    sTruGioVeSom24 = dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["TruGioVeSom"].ToString();
                                                                    string sBatDauTinhVeSom24;
                                                                    sBatDauTinhVeSom24 = dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["BatDauTinhVeSom"].ToString();
                                                                    int iChoPhepVeSom21;
                                                                    iChoPhepVeSom21 = Convert.ToInt32(dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["ChoPhepVeSom"].ToString());
                                                                    string sPhutVeSom29;
                                                                    sPhutVeSom29 = Convert.ToInt32((dGioRaKhaiBaoPhanTheoGioB - dGioRaPhanTheoGio).TotalMinutes).ToString();
                                                                    if (sTruGioVeSom24 == "True")
                                                                    {
                                                                        if (Convert.ToInt32(sPhutVeSom29) < 0)
                                                                        {
                                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = "0";
                                                                        }
                                                                        else
                                                                        {
                                                                            int iPhutVeSom21;
                                                                            iPhutVeSom21 = Convert.ToInt32(sPhutVeSom29) - iChoPhepVeSom21;
                                                                            if (iPhutVeSom21 < 1)
                                                                            {
                                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = "0";
                                                                            }
                                                                            else if (sBatDauTinhVeSom24 == "True")
                                                                            {
                                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = iPhutVeSom21.ToString();
                                                                            }
                                                                            else
                                                                            {
                                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = sPhutVeSom29;
                                                                            }
                                                                        }
                                                                    }
                                                                    else
                                                                    {
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = "0";
                                                                    }
                                                                    string sVeTre19;
                                                                    sVeTre19 = Convert.ToInt32((dGioRaPhanTheoGio - dGioRaKhaiBaoPhanTheoGioB).TotalMinutes).ToString();
                                                                    if (Convert.ToInt32(sVeTre19) > 0)
                                                                    {
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[11].Value = sVeTre19;
                                                                    }
                                                                    else
                                                                    {
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[11].Value = "0";
                                                                    }
                                                                    double dGio19;
                                                                    dGio19 = Math.Round(Convert.ToDouble(Convert.ToSingle(dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["TongGioTrongCaLamViec"]) * 60f - (float)(Convert.ToInt32(this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value.ToString()) + Convert.ToInt32(this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value))) / 60.0, this.iLamTronGio);
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = dGio19 * this.dTangCaChuNhatHeSo;
                                                                    double iGio19;
                                                                    iGio19 = Convert.ToDouble(dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["TongGioTrongCaLamViec"].ToString());
                                                                    double dCongTinh17;
                                                                    dCongTinh17 = Convert.ToDouble(dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["CongTinh"].ToString());
                                                                    double dCong19;
                                                                    dCong19 = Math.Round(dGio19 * dCongTinh17 / iGio19, this.iLamTronCong);
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = dCong19 * this.dTangCaChuNhatHeSo;
                                                                    string sTangCaTruocGioLamViec11;
                                                                    sTangCaTruocGioLamViec11 = dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["TangCaTruocGioLamViec"].ToString();
                                                                    string sTangCaSauGioLamViec11;
                                                                    sTangCaSauGioLamViec11 = dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["TangCaSauGioLamViec"].ToString();
                                                                    if (sTangCaTruocGioLamViec11 == "False" && sTangCaSauGioLamViec11 == "False")
                                                                    {
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = "0";
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                                    }
                                                                    if (sXemCaNayLaTangCa10 == "True")
                                                                    {
                                                                        if (iTangCaMuc10 == 1)
                                                                        {
                                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = "0";
                                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = "0";
                                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = dGio19.ToString();
                                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                                        }
                                                                        if (iTangCaMuc10 == 2)
                                                                        {
                                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = "0";
                                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = "0";
                                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = "0";
                                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = dGio19.ToString();
                                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                                        }
                                                                        if (iTangCaMuc10 == 3)
                                                                        {
                                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = "0";
                                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = "0";
                                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = "0";
                                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = dGio19.ToString();
                                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                                        }
                                                                        if (iTangCaMuc10 == 4)
                                                                        {
                                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = "0";
                                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = "0";
                                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = "0";
                                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = dGio19.ToString();
                                                                        }
                                                                    }
                                                                    string sChoPhepTangCaTruocGioLamViecPhanTheoGio2;
                                                                    sChoPhepTangCaTruocGioLamViecPhanTheoGio2 = dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["TangCaTruocGioLamViec"].ToString();
                                                                    int iPhutTangCaTruocGioLamViecPhanTheoGio2;
                                                                    iPhutTangCaTruocGioLamViecPhanTheoGio2 = Convert.ToInt32(dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["SoPhutTangCaTruocGioLamViec"].ToString());
                                                                    int iPhutTangCaTruocGioLamViecDatDen23;
                                                                    iPhutTangCaTruocGioLamViecDatDen23 = Convert.ToInt32(dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["TangCaTruocGioLamViecDatDen"].ToString());
                                                                    int iPhutTruTangCaTruoc23;
                                                                    iPhutTruTangCaTruoc23 = Convert.ToInt32(dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["PhutTruTangCaTruoc"].ToString());
                                                                    string sChoPhepTangCaSauGioLamViecPhanTheoGio2;
                                                                    sChoPhepTangCaSauGioLamViecPhanTheoGio2 = dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["TangCaSauGioLamViec"].ToString();
                                                                    int iPhutTangCaSauGioLamViecPhanTheoGio2;
                                                                    iPhutTangCaSauGioLamViecPhanTheoGio2 = Convert.ToInt32(dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["SoPhutTangCaSauGioLamViec"].ToString());
                                                                    int iPhutTangCaSauGioLamViecDatDen23;
                                                                    iPhutTangCaSauGioLamViecDatDen23 = Convert.ToInt32(dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["TangCaSauGioLamViecDatDen"].ToString());
                                                                    int iPhutTruTangCaSau23;
                                                                    iPhutTruTangCaSau23 = Convert.ToInt32(dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["PhutTruTangCaSau"].ToString());
                                                                    int iGioiHanTC1PhanTheoGio2;
                                                                    iGioiHanTC1PhanTheoGio2 = Convert.ToInt32(dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["GioiHanTangCa1"].ToString());
                                                                    int iGioiHanTC2PhanTheoGio2;
                                                                    iGioiHanTC2PhanTheoGio2 = Convert.ToInt32(dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["GioiHanTangCa2"].ToString());
                                                                    int iGioiHanTC3PhanTheoGio2;
                                                                    iGioiHanTC3PhanTheoGio2 = Convert.ToInt32(dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["GioiHanTangCa3"].ToString());
                                                                    int iGioiHanTC4PhanTheoGio2;
                                                                    iGioiHanTC4PhanTheoGio2 = Convert.ToInt32(dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["GioiHanTangCa4"].ToString());
                                                                    int iTongGioTangCaSauPhanTheoGio2;
                                                                    iTongGioTangCaSauPhanTheoGio2 = 0;
                                                                    int iTongGioTangCaTruocPhanTheoGio2;
                                                                    iTongGioTangCaTruocPhanTheoGio2 = 0;
                                                                    if (sChoPhepTangCaTruocGioLamViecPhanTheoGio2 == "False" && sChoPhepTangCaSauGioLamViecPhanTheoGio2 == "False")
                                                                    {
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = "0";
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                                    }
                                                                    else
                                                                    {
                                                                        if (sChoPhepTangCaTruocGioLamViecPhanTheoGio2 == "True")
                                                                        {
                                                                            int iThoiGianTruocGioLamPhanTheoGio2;
                                                                            iThoiGianTruocGioLamPhanTheoGio2 = Convert.ToInt32(Convert.ToInt32((dGioVaoKhaiBaoPhanTheoGioB - dGioVaoPhanTheoGio).TotalMinutes).ToString());
                                                                            if (iThoiGianTruocGioLamPhanTheoGio2 > 0 && iThoiGianTruocGioLamPhanTheoGio2 > iPhutTangCaTruocGioLamViecPhanTheoGio2 && iThoiGianTruocGioLamPhanTheoGio2 > iPhutTangCaTruocGioLamViecDatDen23)
                                                                            {
                                                                                iTongGioTangCaTruocPhanTheoGio2 = iThoiGianTruocGioLamPhanTheoGio2 - iPhutTruTangCaTruoc23;
                                                                            }
                                                                        }
                                                                        if (sChoPhepTangCaSauGioLamViecPhanTheoGio2 == "True")
                                                                        {
                                                                            int iThoiGianSauGioLamViecPhanTheoGio2;
                                                                            iThoiGianSauGioLamViecPhanTheoGio2 = Convert.ToInt32(Convert.ToInt32((dGioRaPhanTheoGio - dGioRaKhaiBaoPhanTheoGioB).TotalMinutes).ToString());
                                                                            if (iThoiGianSauGioLamViecPhanTheoGio2 > 0 && iThoiGianSauGioLamViecPhanTheoGio2 > iPhutTangCaSauGioLamViecPhanTheoGio2 && iThoiGianSauGioLamViecPhanTheoGio2 > iPhutTangCaSauGioLamViecDatDen23)
                                                                            {
                                                                                iTongGioTangCaSauPhanTheoGio2 = iThoiGianSauGioLamViecPhanTheoGio2 - iPhutTruTangCaSau23;
                                                                            }
                                                                        }
                                                                    }
                                                                    double dTongThoiGianTangCaPhanTheoGio2;
                                                                    dTongThoiGianTangCaPhanTheoGio2 = Convert.ToDouble(iTongGioTangCaTruocPhanTheoGio2 + iTongGioTangCaSauPhanTheoGio2);
                                                                    if (dTongThoiGianTangCaPhanTheoGio2 > 0.0)
                                                                    {
                                                                        string sLayGio2;
                                                                        sLayGio2 = Math.Round(dTongThoiGianTangCaPhanTheoGio2 / 60.0, 2).ToString().Substring(0, 1);
                                                                        int iPhutConLai2;
                                                                        iPhutConLai2 = Convert.ToInt32(dTongThoiGianTangCaPhanTheoGio2) - Convert.ToInt32(sLayGio2) * 60;
                                                                        double dLamTronGioTangCa2;
                                                                        dLamTronGioTangCa2 = 0.0;
                                                                        if (iPhutConLai2 > this.iLamTronTuA && iPhutConLai2 <= this.iLamTronDenA)
                                                                        {
                                                                            dLamTronGioTangCa2 = Convert.ToDouble(this.sLamTronA);
                                                                        }
                                                                        else if (iPhutConLai2 > this.iLamTronTuB && iPhutConLai2 <= this.iLamTronDenB)
                                                                        {
                                                                            dLamTronGioTangCa2 = Convert.ToDouble(this.sLamTronB);
                                                                        }
                                                                        else if (iPhutConLai2 > this.iLamTronTuC && iPhutConLai2 <= this.iLamTronDenC)
                                                                        {
                                                                            dLamTronGioTangCa2 = Convert.ToDouble(this.sLamTronC);
                                                                        }
                                                                        else if (iPhutConLai2 > this.iLamTronTuD && iPhutConLai2 <= this.iLamTronDenD)
                                                                        {
                                                                            dLamTronGioTangCa2 = Convert.ToDouble(this.sLamTronD);
                                                                        }
                                                                        if (iGioiHanTC1PhanTheoGio2 == 0)
                                                                        {
                                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = (Convert.ToDouble(sLayGio2) + dLamTronGioTangCa2) * this.dTangCa1HeSo;
                                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                                        }
                                                                        if (iGioiHanTC1PhanTheoGio2 != 0 && iGioiHanTC2PhanTheoGio2 == 0)
                                                                        {
                                                                            if (dTongThoiGianTangCaPhanTheoGio2 < Convert.ToDouble(iGioiHanTC1PhanTheoGio2))
                                                                            {
                                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = Math.Round(dTongThoiGianTangCaPhanTheoGio2 * this.dTangCa1HeSo / 60.0, this.iLamTronGio);
                                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                                            }
                                                                            else
                                                                            {
                                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = Math.Round(Convert.ToDouble(iGioiHanTC1PhanTheoGio2) / 60.0 * this.dTangCa1HeSo, this.iLamTronGio);
                                                                                if (dTongThoiGianTangCaPhanTheoGio2 - Convert.ToDouble(iGioiHanTC1PhanTheoGio2) > 0.0)
                                                                                {
                                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = Math.Round((dTongThoiGianTangCaPhanTheoGio2 - Convert.ToDouble(iGioiHanTC1PhanTheoGio2)) * this.dTangCa2HeSo / 60.0, this.iLamTronGio);
                                                                                }
                                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                                            }
                                                                        }
                                                                        if (iGioiHanTC1PhanTheoGio2 != 0 && iGioiHanTC2PhanTheoGio2 != 0 && iGioiHanTC3PhanTheoGio2 == 0)
                                                                        {
                                                                            if (dTongThoiGianTangCaPhanTheoGio2 < Convert.ToDouble(iGioiHanTC1PhanTheoGio2))
                                                                            {
                                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = Math.Round(dTongThoiGianTangCaPhanTheoGio2 * this.dTangCa1HeSo / 60.0, this.iLamTronGio);
                                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                                            }
                                                                            else
                                                                            {
                                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = Math.Round(Convert.ToDouble(iGioiHanTC1PhanTheoGio2) * this.dTangCa1HeSo / 60.0, this.iLamTronGio);
                                                                                if (dTongThoiGianTangCaPhanTheoGio2 - Convert.ToDouble(iGioiHanTC1PhanTheoGio2) < Convert.ToDouble(iGioiHanTC2PhanTheoGio2))
                                                                                {
                                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = Math.Round((dTongThoiGianTangCaPhanTheoGio2 - Convert.ToDouble(iGioiHanTC1PhanTheoGio2)) * this.dTangCa2HeSo / 60.0, this.iLamTronGio);
                                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                                                }
                                                                                else
                                                                                {
                                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = Math.Round(Convert.ToDouble(iGioiHanTC1PhanTheoGio2) * this.dTangCa1HeSo / 60.0, this.iLamTronGio);
                                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = Math.Round(Convert.ToDouble(iGioiHanTC2PhanTheoGio2) * this.dTangCa2HeSo / 60.0, this.iLamTronGio);
                                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = Math.Round((dTongThoiGianTangCaPhanTheoGio2 - Convert.ToDouble(iGioiHanTC1PhanTheoGio2) - Convert.ToDouble(iGioiHanTC2PhanTheoGio2)) * this.dTangCa3HeSo / 60.0, this.iLamTronGio);
                                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                                                }
                                                                            }
                                                                        }
                                                                        if (iGioiHanTC1PhanTheoGio2 != 0 && iGioiHanTC2PhanTheoGio2 != 0 && iGioiHanTC3PhanTheoGio2 != 0 && iGioiHanTC4PhanTheoGio2 != 0)
                                                                        {
                                                                        }
                                                                    }
                                                                    else
                                                                    {
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = "0";
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                                    }
                                                                    string sTongGio11;
                                                                    sTongGio11 = Math.Round(Convert.ToDouble(Convert.ToInt32((dGioRaPhanTheoGio - dGioVaoPhanTheoGio).TotalMinutes).ToString()) / 60.0, this.iLamTronGio).ToString();
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[16].Value = Convert.ToDouble(sTongGio11) * this.dTangCaChuNhatHeSo;
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[17].Value = Convert.ToDouble(dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["CongTinh"].ToString()) * this.dTangCaChuNhatHeSo;
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[18].Value = this.sKHDungGio;
                                                                }
                                                            }
                                                            else
                                                            {
                                                                string sTruGioDiTre22;
                                                                sTruGioDiTre22 = dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["TruGioDiTre"].ToString();
                                                                string sBatDauTinhDiTre22;
                                                                sBatDauTinhDiTre22 = dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["BatDauTinhDiTre"].ToString();
                                                                int iChoPhepDiTre19;
                                                                iChoPhepDiTre19 = Convert.ToInt32(dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["ChoPhepDiTre"].ToString());
                                                                string sPhutTre27;
                                                                sPhutTre27 = Convert.ToInt32((dGioVaoPhanTheoGio - dGioVaoKhaiBaoPhanTheoGioB).TotalMinutes).ToString();
                                                                if (sTruGioDiTre22 == "True")
                                                                {
                                                                    if (Convert.ToInt32(sPhutTre27) < 0)
                                                                    {
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = "0";
                                                                    }
                                                                    else
                                                                    {
                                                                        int iPhutTre19;
                                                                        iPhutTre19 = Convert.ToInt32(sPhutTre27) - iChoPhepDiTre19;
                                                                        if (sBatDauTinhDiTre22 == "True")
                                                                        {
                                                                            if (iPhutTre19 < 1)
                                                                            {
                                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = "0";
                                                                            }
                                                                            else
                                                                            {
                                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = iPhutTre19.ToString();
                                                                            }
                                                                        }
                                                                        else if (iPhutTre19 < 1)
                                                                        {
                                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = "0";
                                                                        }
                                                                        else
                                                                        {
                                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = sPhutTre27;
                                                                        }
                                                                    }
                                                                }
                                                                else
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = "0";
                                                                }
                                                                string sTruGioVeSom22;
                                                                sTruGioVeSom22 = dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["TruGioVeSom"].ToString();
                                                                string sBatDauTinhVeSom22;
                                                                sBatDauTinhVeSom22 = dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["BatDauTinhVeSom"].ToString();
                                                                int iChoPhepVeSom19;
                                                                iChoPhepVeSom19 = Convert.ToInt32(dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["ChoPhepVeSom"].ToString());
                                                                string sPhutVeSom28;
                                                                sPhutVeSom28 = Convert.ToInt32((dGioRaKhaiBaoPhanTheoGioB - dGioRaPhanTheoGio).TotalMinutes).ToString();
                                                                if (sTruGioVeSom22 == "True")
                                                                {
                                                                    if (Convert.ToInt32(sPhutVeSom28) < 0)
                                                                    {
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = "0";
                                                                    }
                                                                    else
                                                                    {
                                                                        int iPhutVeSom20;
                                                                        iPhutVeSom20 = Convert.ToInt32(sPhutVeSom28) - iChoPhepVeSom19;
                                                                        if (iPhutVeSom20 < 1)
                                                                        {
                                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = "0";
                                                                        }
                                                                        else if (sBatDauTinhVeSom22 == "True")
                                                                        {
                                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = iPhutVeSom20.ToString();
                                                                        }
                                                                        else
                                                                        {
                                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = sPhutVeSom28;
                                                                        }
                                                                    }
                                                                }
                                                                else
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = "0";
                                                                }
                                                                string sVeTre18;
                                                                sVeTre18 = Convert.ToInt32((dGioRaPhanTheoGio - dGioRaKhaiBaoPhanTheoGioB).TotalMinutes).ToString();
                                                                if (Convert.ToInt32(sVeTre18) > 0)
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[11].Value = sVeTre18;
                                                                }
                                                                else
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[11].Value = "0";
                                                                }
                                                                double dGio18;
                                                                dGio18 = Math.Round(Convert.ToDouble(Convert.ToSingle(dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["TongGioTrongCaLamViec"]) * 60f - (float)(Convert.ToInt32(this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value.ToString()) + Convert.ToInt32(this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value))) / 60.0, this.iLamTronGio);
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = dGio18.ToString();
                                                                double iGio18;
                                                                iGio18 = Convert.ToDouble(dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["TongGioTrongCaLamViec"].ToString());
                                                                double dCongTinh16;
                                                                dCongTinh16 = Convert.ToDouble(dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["CongTinh"].ToString());
                                                                double dCong18;
                                                                dCong18 = Math.Round(dGio18 * dCongTinh16 / iGio18, this.iLamTronCong);
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = dCong18.ToString();
                                                                string sTangCaTruocGioLamViec10;
                                                                sTangCaTruocGioLamViec10 = dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["TangCaTruocGioLamViec"].ToString();
                                                                string sTangCaSauGioLamViec10;
                                                                sTangCaSauGioLamViec10 = dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["TangCaSauGioLamViec"].ToString();
                                                                if (sTangCaTruocGioLamViec10 == "False" && sTangCaSauGioLamViec10 == "False")
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = "0";
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                                }
                                                                if (sXemCaNayLaTangCa10 == "True")
                                                                {
                                                                    if (iTangCaMuc10 == 1)
                                                                    {
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = "0";
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = "0";
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = dGio18.ToString();
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                                    }
                                                                    if (iTangCaMuc10 == 2)
                                                                    {
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = "0";
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = "0";
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = "0";
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = dGio18.ToString();
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                                    }
                                                                    if (iTangCaMuc10 == 3)
                                                                    {
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = "0";
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = "0";
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = "0";
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = dGio18.ToString();
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                                    }
                                                                    if (iTangCaMuc10 == 4)
                                                                    {
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = "0";
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = "0";
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = "0";
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = dGio18.ToString();
                                                                    }
                                                                }
                                                                string sChoPhepTangCaTruocGioLamViecPhanTheoGio;
                                                                sChoPhepTangCaTruocGioLamViecPhanTheoGio = dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["TangCaTruocGioLamViec"].ToString();
                                                                int iPhutTangCaTruocGioLamViecPhanTheoGio;
                                                                iPhutTangCaTruocGioLamViecPhanTheoGio = Convert.ToInt32(dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["SoPhutTangCaTruocGioLamViec"].ToString());
                                                                int iPhutTangCaTruocGioLamViecDatDen21;
                                                                iPhutTangCaTruocGioLamViecDatDen21 = Convert.ToInt32(dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["TangCaTruocGioLamViecDatDen"].ToString());
                                                                int iPhutTruTangCaTruoc21;
                                                                iPhutTruTangCaTruoc21 = Convert.ToInt32(dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["PhutTruTangCaTruoc"].ToString());
                                                                string sChoPhepTangCaSauGioLamViecPhanTheoGio;
                                                                sChoPhepTangCaSauGioLamViecPhanTheoGio = dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["TangCaSauGioLamViec"].ToString();
                                                                int iPhutTangCaSauGioLamViecPhanTheoGio;
                                                                iPhutTangCaSauGioLamViecPhanTheoGio = Convert.ToInt32(dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["SoPhutTangCaSauGioLamViec"].ToString());
                                                                int iPhutTangCaSauGioLamViecDatDen21;
                                                                iPhutTangCaSauGioLamViecDatDen21 = Convert.ToInt32(dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["TangCaSauGioLamViecDatDen"].ToString());
                                                                int iPhutTruTangCaSau21;
                                                                iPhutTruTangCaSau21 = Convert.ToInt32(dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["PhutTruTangCaSau"].ToString());
                                                                int iGioiHanTC1PhanTheoGio;
                                                                iGioiHanTC1PhanTheoGio = Convert.ToInt32(dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["GioiHanTangCa1"].ToString());
                                                                int iGioiHanTC2PhanTheoGio;
                                                                iGioiHanTC2PhanTheoGio = Convert.ToInt32(dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["GioiHanTangCa2"].ToString());
                                                                int iGioiHanTC3PhanTheoGio;
                                                                iGioiHanTC3PhanTheoGio = Convert.ToInt32(dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["GioiHanTangCa3"].ToString());
                                                                int iGioiHanTC4PhanTheoGio;
                                                                iGioiHanTC4PhanTheoGio = Convert.ToInt32(dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["GioiHanTangCa4"].ToString());
                                                                int iTongGioTangCaSauPhanTheoGio;
                                                                iTongGioTangCaSauPhanTheoGio = 0;
                                                                int iTongGioTangCaTruocPhanTheoGio;
                                                                iTongGioTangCaTruocPhanTheoGio = 0;
                                                                if (sChoPhepTangCaTruocGioLamViecPhanTheoGio == "False" && sChoPhepTangCaSauGioLamViecPhanTheoGio == "False")
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = "0";
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                                }
                                                                else
                                                                {
                                                                    if (sChoPhepTangCaTruocGioLamViecPhanTheoGio == "True")
                                                                    {
                                                                        int iThoiGianTruocGioLamPhanTheoGio;
                                                                        iThoiGianTruocGioLamPhanTheoGio = Convert.ToInt32(Convert.ToInt32((dGioVaoKhaiBaoPhanTheoGioB - dGioVaoPhanTheoGio).TotalMinutes).ToString());
                                                                        if (iThoiGianTruocGioLamPhanTheoGio > 0 && iThoiGianTruocGioLamPhanTheoGio > iPhutTangCaTruocGioLamViecPhanTheoGio && iThoiGianTruocGioLamPhanTheoGio > iPhutTangCaTruocGioLamViecDatDen21)
                                                                        {
                                                                            iTongGioTangCaTruocPhanTheoGio = iThoiGianTruocGioLamPhanTheoGio - iPhutTruTangCaTruoc21;
                                                                        }
                                                                    }
                                                                    if (sChoPhepTangCaSauGioLamViecPhanTheoGio == "True")
                                                                    {
                                                                        int iThoiGianSauGioLamViecPhanTheoGio;
                                                                        iThoiGianSauGioLamViecPhanTheoGio = Convert.ToInt32(Convert.ToInt32((dGioRaPhanTheoGio - dGioRaKhaiBaoPhanTheoGioB).TotalMinutes).ToString());
                                                                        if (iThoiGianSauGioLamViecPhanTheoGio > 0 && iThoiGianSauGioLamViecPhanTheoGio > iPhutTangCaSauGioLamViecPhanTheoGio && iThoiGianSauGioLamViecPhanTheoGio > iPhutTangCaSauGioLamViecDatDen21)
                                                                        {
                                                                            iTongGioTangCaSauPhanTheoGio = iThoiGianSauGioLamViecPhanTheoGio - iPhutTruTangCaSau21;
                                                                        }
                                                                    }
                                                                }
                                                                double dTongThoiGianTangCaPhanTheoGio;
                                                                dTongThoiGianTangCaPhanTheoGio = Convert.ToDouble(iTongGioTangCaTruocPhanTheoGio + iTongGioTangCaSauPhanTheoGio);
                                                                if (dTongThoiGianTangCaPhanTheoGio > 0.0)
                                                                {
                                                                    string sLayGio;
                                                                    sLayGio = Math.Round(dTongThoiGianTangCaPhanTheoGio / 60.0, 2).ToString().Substring(0, 1);
                                                                    int iPhutConLai;
                                                                    iPhutConLai = Convert.ToInt32(dTongThoiGianTangCaPhanTheoGio) - Convert.ToInt32(sLayGio) * 60;
                                                                    double dLamTronGioTangCa;
                                                                    dLamTronGioTangCa = 0.0;
                                                                    if (iPhutConLai > this.iLamTronTuA && iPhutConLai <= this.iLamTronDenA)
                                                                    {
                                                                        dLamTronGioTangCa = Convert.ToDouble(this.sLamTronA);
                                                                    }
                                                                    else if (iPhutConLai > this.iLamTronTuB && iPhutConLai <= this.iLamTronDenB)
                                                                    {
                                                                        dLamTronGioTangCa = Convert.ToDouble(this.sLamTronB);
                                                                    }
                                                                    else if (iPhutConLai > this.iLamTronTuC && iPhutConLai <= this.iLamTronDenC)
                                                                    {
                                                                        dLamTronGioTangCa = Convert.ToDouble(this.sLamTronC);
                                                                    }
                                                                    else if (iPhutConLai > this.iLamTronTuD && iPhutConLai <= this.iLamTronDenD)
                                                                    {
                                                                        dLamTronGioTangCa = Convert.ToDouble(this.sLamTronD);
                                                                    }
                                                                    if (iGioiHanTC1PhanTheoGio == 0)
                                                                    {
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = (Convert.ToDouble(sLayGio) + dLamTronGioTangCa) * this.dTangCa1HeSo;
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                                    }
                                                                    if (iGioiHanTC1PhanTheoGio != 0 && iGioiHanTC2PhanTheoGio == 0)
                                                                    {
                                                                        if (dTongThoiGianTangCaPhanTheoGio < Convert.ToDouble(iGioiHanTC1PhanTheoGio))
                                                                        {
                                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = Math.Round(dTongThoiGianTangCaPhanTheoGio * this.dTangCa1HeSo / 60.0, this.iLamTronGio);
                                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                                        }
                                                                        else
                                                                        {
                                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = Math.Round(Convert.ToDouble(iGioiHanTC1PhanTheoGio) / 60.0 * this.dTangCa1HeSo, this.iLamTronGio);
                                                                            if (dTongThoiGianTangCaPhanTheoGio - Convert.ToDouble(iGioiHanTC1PhanTheoGio) > 0.0)
                                                                            {
                                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = Math.Round((dTongThoiGianTangCaPhanTheoGio - Convert.ToDouble(iGioiHanTC1PhanTheoGio)) * this.dTangCa2HeSo / 60.0, this.iLamTronGio);
                                                                            }
                                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                                        }
                                                                    }
                                                                    if (iGioiHanTC1PhanTheoGio != 0 && iGioiHanTC2PhanTheoGio != 0 && iGioiHanTC3PhanTheoGio == 0)
                                                                    {
                                                                        if (dTongThoiGianTangCaPhanTheoGio < Convert.ToDouble(iGioiHanTC1PhanTheoGio))
                                                                        {
                                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = Math.Round(dTongThoiGianTangCaPhanTheoGio * this.dTangCa1HeSo / 60.0, this.iLamTronGio);
                                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                                        }
                                                                        else
                                                                        {
                                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = Math.Round(Convert.ToDouble(iGioiHanTC1PhanTheoGio) * this.dTangCa1HeSo / 60.0, this.iLamTronGio);
                                                                            if (dTongThoiGianTangCaPhanTheoGio - Convert.ToDouble(iGioiHanTC1PhanTheoGio) < Convert.ToDouble(iGioiHanTC2PhanTheoGio))
                                                                            {
                                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = Math.Round((dTongThoiGianTangCaPhanTheoGio - Convert.ToDouble(iGioiHanTC1PhanTheoGio)) * this.dTangCa2HeSo / 60.0, this.iLamTronGio);
                                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                                            }
                                                                            else
                                                                            {
                                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = Math.Round(Convert.ToDouble(iGioiHanTC1PhanTheoGio) * this.dTangCa1HeSo / 60.0, this.iLamTronGio);
                                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = Math.Round(Convert.ToDouble(iGioiHanTC2PhanTheoGio) * this.dTangCa2HeSo / 60.0, this.iLamTronGio);
                                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = Math.Round((dTongThoiGianTangCaPhanTheoGio - Convert.ToDouble(iGioiHanTC1PhanTheoGio) - Convert.ToDouble(iGioiHanTC2PhanTheoGio)) * this.dTangCa3HeSo / 60.0, this.iLamTronGio);
                                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                                            }
                                                                        }
                                                                    }
                                                                    if (iGioiHanTC1PhanTheoGio != 0 && iGioiHanTC2PhanTheoGio != 0 && iGioiHanTC3PhanTheoGio != 0 && iGioiHanTC4PhanTheoGio != 0)
                                                                    {
                                                                    }
                                                                }
                                                                else
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = "0";
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                                }
                                                                string sTongGio10;
                                                                sTongGio10 = Math.Round(Convert.ToDouble(Convert.ToInt32((dGioRaPhanTheoGio - dGioVaoPhanTheoGio).TotalMinutes).ToString()) / 60.0, this.iLamTronGio).ToString();
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[16].Value = sTongGio10;
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[17].Value = dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["CongTinh"].ToString();
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[18].Value = this.sKHDungGio;
                                                            }
                                                            if (DateTimeProgress.XuatIDThu((int)dt.AddDays(dem).DayOfWeek) == "0")
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[19].Value = "CN";
                                                            }
                                                            else
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[19].Value = "NT";
                                                            }
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[20].Value = this.sMaChamCong;
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[21].Value = this.sPhongBanTinhCong;
                                                        }
                                                        break;
                                                    }
                                                }
                                                if (iCaTrongLIchtrinh3 == 0)
                                                {
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[4].Value = ca;
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[11].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[16].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[17].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[18].Value = this.sKHVang;
                                                    if (DateTimeProgress.XuatIDThu((int)dt.AddDays(dem).DayOfWeek) == "0")
                                                    {
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[19].Value = "CN";
                                                    }
                                                    else
                                                    {
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[19].Value = "NT";
                                                    }
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[20].Value = this.sMaChamCong;
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[21].Value = this.sPhongBanTinhCong;
                                                }
                                                break;
                                            }
                                        case 2:
                                            {
                                                DateTime dGioRaPhanTheoGio;
                                                dGioRaPhanTheoGio = dGioChamPhanTheoGio;
                                                this.DGVTinhCong.Rows[addPhanTheoGio].Cells[6].Value = string.Format(this.sDinhDangThoiGian, dGioRaPhanTheoGio);
                                                int iCaTrongLIchtrinh5;
                                                iCaTrongLIchtrinh5 = 0;
                                                new DataTable();
                                                this._chiTietLichTrinhChoCalamViecDTO.MaLichTrinhCaLamViec = sLTCCLVNhanVien;
                                                this._chiTietLichTrinhChoCalamViecDTO.Thu = sThu;
                                                DataTable dtNhanCaPhanTheoGio2;
                                                dtNhanCaPhanTheoGio2 = this._chiTietLichTrinhChoCaLamViecBLL.ChiTietLichTrinhChoCaLamViecNhanCa(this._chiTietLichTrinhChoCalamViecDTO);
                                                int iChiTietLichTrinhChoCaLamViecPhanTheoGio2;
                                                iChiTietLichTrinhChoCaLamViecPhanTheoGio2 = 0;
                                                if (iChiTietLichTrinhChoCaLamViecPhanTheoGio2 < dtNhanCaPhanTheoGio2.Rows.Count)
                                                {
                                                    iCaTrongLIchtrinh5 = 1;
                                                    int cellChiTietLichTrinhChoCaLamViecPhanTheoGio2;
                                                    cellChiTietLichTrinhChoCaLamViecPhanTheoGio2 = 3;
                                                    while (true)
                                                    {
                                                        if (cellChiTietLichTrinhChoCaLamViecPhanTheoGio2 < 13)
                                                        {
                                                            kiemTraVao = 0;
                                                            kiemTraRa = 0;
                                                            this.sPhanTheoGioMaCaLamViec = dtNhanCaPhanTheoGio2.Rows[iChiTietLichTrinhChoCaLamViecPhanTheoGio2][cellChiTietLichTrinhChoCaLamViecPhanTheoGio2].ToString();
                                                            new DataTable();
                                                            DataTable dtPhanTheoGioCa2;
                                                            dtPhanTheoGioCa2 = this._caLamViecBLL.CaLamViecGetByMaCaLamViec(sPhanTheoGioMaCaLamViec);
                                                            int iPhanTheoGioCa2;
                                                            iPhanTheoGioCa2 = 0;
                                                            while (iPhanTheoGioCa2 < dtPhanTheoGioCa2.Rows.Count)
                                                            {
                                                                string sGiayGioVao32;
                                                                sGiayGioVao32 = dGioVaoPhanTheoGio.Second.ToString();
                                                                string sGiayGioRa32;
                                                                sGiayGioRa32 = dGioRaPhanTheoGio.Second.ToString();
                                                                this.sPhanTheoGioTenCaLamViec = dtPhanTheoGioCa2.Rows[iPhanTheoGioCa2]["CaLamViec"].ToString();
                                                                DateTime dBatDauVaoPhanTheoGioB2;
                                                                dBatDauVaoPhanTheoGioB2 = Convert.ToDateTime(sNgayCham + " " + string.Format("{0:T}", Convert.ToDateTime(dtPhanTheoGioCa2.Rows[iPhanTheoGioCa2]["BatDauVao"].ToString())).Replace("00 ", sGiayGioVao32 + " "));
                                                                DateTime dKetThucVaoPhanTheoGioB2;
                                                                dKetThucVaoPhanTheoGioB2 = Convert.ToDateTime(sNgayCham + " " + string.Format("{0:T}", Convert.ToDateTime(dtPhanTheoGioCa2.Rows[iPhanTheoGioCa2]["KetThucVao"].ToString())).Replace("00 ", sGiayGioVao32 + " "));
                                                                DateTime dBatDauRaPhanTheoGioB2;
                                                                dBatDauRaPhanTheoGioB2 = Convert.ToDateTime(sNgayCham + " " + string.Format("{0:T}", Convert.ToDateTime(dtPhanTheoGioCa2.Rows[iPhanTheoGioCa2]["BatDauRa"].ToString())).Replace("00 ", sGiayGioRa32 + " "));
                                                                DateTime dKetThucRaPhanTheoGioB2;
                                                                dKetThucRaPhanTheoGioB2 = Convert.ToDateTime(sNgayCham + " " + string.Format("{0:T}", Convert.ToDateTime(dtPhanTheoGioCa2.Rows[iPhanTheoGioCa2]["KetThucRa"].ToString())).Replace("00 ", sGiayGioRa32 + " "));
                                                                if (dGioVaoPhanTheoGio >= dBatDauVaoPhanTheoGioB2 && dGioVaoPhanTheoGio <= dKetThucVaoPhanTheoGioB2)
                                                                {
                                                                    kiemTraVao++;
                                                                }
                                                                if (dGioRaPhanTheoGio >= dBatDauRaPhanTheoGioB2 && dGioRaPhanTheoGio <= dKetThucRaPhanTheoGioB2)
                                                                {
                                                                    kiemTraRa++;
                                                                }
                                                                if (kiemTraVao != 1 || kiemTraRa != 1)
                                                                {
                                                                    iPhanTheoGioCa2++;
                                                                    continue;
                                                                }
                                                                goto IL_19658;
                                                            }
                                                            if (!(this.sPhanTheoGioMaCaLamViec == ""))
                                                            {
                                                                cellChiTietLichTrinhChoCaLamViecPhanTheoGio2++;
                                                                continue;
                                                            }
                                                            this.DGVTinhCong.Rows[addPhanTheoGio].Cells[4].Value = ca;
                                                            this.DGVTinhCong.Rows[addPhanTheoGio].Cells[7].Value = "0";
                                                            this.DGVTinhCong.Rows[addPhanTheoGio].Cells[8].Value = "0";
                                                            this.DGVTinhCong.Rows[addPhanTheoGio].Cells[9].Value = "0";
                                                            this.DGVTinhCong.Rows[addPhanTheoGio].Cells[10].Value = "0";
                                                            this.DGVTinhCong.Rows[addPhanTheoGio].Cells[11].Value = "0";
                                                            this.DGVTinhCong.Rows[addPhanTheoGio].Cells[12].Value = "0";
                                                            this.DGVTinhCong.Rows[addPhanTheoGio].Cells[13].Value = "0";
                                                            this.DGVTinhCong.Rows[addPhanTheoGio].Cells[14].Value = "0";
                                                            this.DGVTinhCong.Rows[addPhanTheoGio].Cells[15].Value = "0";
                                                            this.DGVTinhCong.Rows[addPhanTheoGio].Cells[16].Value = "0";
                                                            this.DGVTinhCong.Rows[addPhanTheoGio].Cells[17].Value = "0";
                                                            this.DGVTinhCong.Rows[addPhanTheoGio].Cells[18].Value = this.sKHVang;
                                                            if (DateTimeProgress.XuatIDThu((int)dt.AddDays(dem).DayOfWeek) == "0")
                                                            {
                                                                this.DGVTinhCong.Rows[addPhanTheoGio].Cells[19].Value = "CN";
                                                            }
                                                            else
                                                            {
                                                                this.DGVTinhCong.Rows[addPhanTheoGio].Cells[19].Value = "NT";
                                                            }
                                                            this.DGVTinhCong.Rows[addPhanTheoGio].Cells[20].Value = this.sMaChamCong;
                                                            this.DGVTinhCong.Rows[addPhanTheoGio].Cells[21].Value = this.sPhongBanTinhCong;
                                                            break;
                                                        }
                                                        goto IL_19658;
                                                    IL_19658:
                                                        this.DGVTinhCong.Rows[addPhanTheoGio].Cells[4].Value = this.sPhanTheoGioTenCaLamViec;
                                                        new DataTable();
                                                        DataTable dtCaLamViecPhanTheoGio2;
                                                        dtCaLamViecPhanTheoGio2 = this._caLamViecBLL.CaLamViecGetByMaCaLamViec(sPhanTheoGioMaCaLamViec);
                                                        for (int iCaLamViecPhanTheoGio2 = 0; iCaLamViecPhanTheoGio2 < dtCaLamViecPhanTheoGio2.Rows.Count; iCaLamViecPhanTheoGio2++)
                                                        {
                                                            string sGiayGioVao33;
                                                            sGiayGioVao33 = dGioVaoPhanTheoGio.Second.ToString();
                                                            string sGiayGioRa33;
                                                            sGiayGioRa33 = dGioRaPhanTheoGio.Second.ToString();
                                                            DateTime dGioVaoKhaiBaoPhanTheoGioB2;
                                                            dGioVaoKhaiBaoPhanTheoGioB2 = Convert.ToDateTime(sNgayCham + " " + string.Format("{0:T}", Convert.ToDateTime(dtCaLamViecPhanTheoGio2.Rows[iCaLamViecPhanTheoGio2]["GioVaoLamViec"].ToString())).Replace("00 ", sGiayGioVao33 + " "));
                                                            DateTime dGioRaKhaiBaoPhanTheoGioB2;
                                                            dGioRaKhaiBaoPhanTheoGioB2 = Convert.ToDateTime(sNgayCham + " " + string.Format("{0:T}", Convert.ToDateTime(dtCaLamViecPhanTheoGio2.Rows[iCaLamViecPhanTheoGio2]["GioKetThucLamViec"].ToString())).Replace("00 ", sGiayGioRa33 + " "));
                                                            string sXemCaNayLaTangCa11;
                                                            sXemCaNayLaTangCa11 = dtCaLamViecPhanTheoGio2.Rows[iCaLamViecPhanTheoGio2]["XemCaNayLaTangCa"].ToString();
                                                            int iTangCaMuc11;
                                                            iTangCaMuc11 = Convert.ToInt32(dtCaLamViecPhanTheoGio2.Rows[iCaLamViecPhanTheoGio2]["TangCaMuc"].ToString());
                                                            string sXemChuNhatLaTangCa6;
                                                            sXemChuNhatLaTangCa6 = dtCaLamViecPhanTheoGio2.Rows[iCaLamViecPhanTheoGio2]["XemCuoiTuanLaTangCa"].ToString();
                                                            int iTangCaChuNhatMuc6;
                                                            iTangCaChuNhatMuc6 = Convert.ToInt32(dtCaLamViecPhanTheoGio2.Rows[iCaLamViecPhanTheoGio2]["TangCaCuoiTuanMuc"].ToString());
                                                            if (sXemCaNayLaTangCa11 == "True")
                                                            {
                                                                dtCaLamViecPhanTheoGio2.Rows[iCaLamViecPhanTheoGio2]["TruGioDiTre"].ToString();
                                                                dtCaLamViecPhanTheoGio2.Rows[iCaLamViecPhanTheoGio2]["BatDauTinhDiTre"].ToString();
                                                                Convert.ToInt32(dtCaLamViecPhanTheoGio2.Rows[iCaLamViecPhanTheoGio2]["ChoPhepDiTre"].ToString());
                                                                string sPhutTre37;
                                                                sPhutTre37 = Convert.ToInt32((dGioVaoPhanTheoGio - dGioVaoKhaiBaoPhanTheoGioB2).TotalMinutes).ToString();
                                                                if (Convert.ToInt32(sPhutTre37) < 0)
                                                                {
                                                                    sPhutTre37 = "0";
                                                                }
                                                                dtCaLamViecPhanTheoGio2.Rows[iCaLamViecPhanTheoGio2]["TruGioVeSom"].ToString();
                                                                dtCaLamViecPhanTheoGio2.Rows[iCaLamViecPhanTheoGio2]["BatDauTinhVeSom"].ToString();
                                                                Convert.ToInt32(dtCaLamViecPhanTheoGio2.Rows[iCaLamViecPhanTheoGio2]["ChoPhepVeSom"].ToString());
                                                                string sPhutVeSom37;
                                                                sPhutVeSom37 = Convert.ToInt32((dGioRaKhaiBaoPhanTheoGioB2 - dGioRaPhanTheoGio).TotalMinutes).ToString();
                                                                if (Convert.ToInt32(sPhutVeSom37) < 0)
                                                                {
                                                                    sPhutVeSom37 = "0";
                                                                }
                                                                double dTongGioTangCaPhanTheoGio2;
                                                                dTongGioTangCaPhanTheoGio2 = Math.Round((Convert.ToDouble(dtCaLamViecPhanTheoGio2.Rows[iCaLamViecPhanTheoGio2]["TongGioTrongCaLamViec"]) * 60.0 - (Convert.ToDouble(sPhutTre37) + Convert.ToDouble(sPhutVeSom37))) / 60.0, this.iLamTronGio);
                                                                if (iTangCaMuc11 == 1)
                                                                {
                                                                    this.DGVTinhCong.Rows[addPhanTheoGio].Cells[12].Value = dTongGioTangCaPhanTheoGio2 * this.dTangCa1HeSo;
                                                                    this.DGVTinhCong.Rows[addPhanTheoGio].Cells[18].Value = this.sKHDungGio;
                                                                }
                                                                if (iTangCaMuc11 == 2)
                                                                {
                                                                    this.DGVTinhCong.Rows[addPhanTheoGio].Cells[13].Value = dTongGioTangCaPhanTheoGio2 * this.dTangCa2HeSo;
                                                                    this.DGVTinhCong.Rows[addPhanTheoGio].Cells[18].Value = this.sKHDungGio;
                                                                }
                                                                if (iTangCaMuc11 == 3)
                                                                {
                                                                    this.DGVTinhCong.Rows[addPhanTheoGio].Cells[14].Value = dTongGioTangCaPhanTheoGio2 * this.dTangCa3HeSo;
                                                                    this.DGVTinhCong.Rows[addPhanTheoGio].Cells[18].Value = this.sKHDungGio;
                                                                }
                                                                if (iTangCaMuc11 == 4)
                                                                {
                                                                    this.DGVTinhCong.Rows[addPhanTheoGio].Cells[15].Value = dTongGioTangCaPhanTheoGio2 * this.dTangCa4HeSo;
                                                                    this.DGVTinhCong.Rows[addPhanTheoGio].Cells[18].Value = this.sKHDungGio;
                                                                }
                                                            }
                                                            else if (DateTimeProgress.XuatIDThu((int)dt.AddDays(dem).DayOfWeek) == "0")
                                                            {
                                                                if (sXemChuNhatLaTangCa6 == "True")
                                                                {
                                                                    dtCaLamViecPhanTheoGio2.Rows[iCaLamViecPhanTheoGio2]["TruGioDiTre"].ToString();
                                                                    dtCaLamViecPhanTheoGio2.Rows[iCaLamViecPhanTheoGio2]["BatDauTinhDiTre"].ToString();
                                                                    Convert.ToInt32(dtCaLamViecPhanTheoGio2.Rows[iCaLamViecPhanTheoGio2]["ChoPhepDiTre"].ToString());
                                                                    string sPhutTre36;
                                                                    sPhutTre36 = Convert.ToInt32((dGioVaoPhanTheoGio - dGioVaoKhaiBaoPhanTheoGioB2).TotalMinutes).ToString();
                                                                    if (Convert.ToInt32(sPhutTre36) < 0)
                                                                    {
                                                                        sPhutTre36 = "0";
                                                                    }
                                                                    dtCaLamViecPhanTheoGio2.Rows[iCaLamViecPhanTheoGio2]["TruGioVeSom"].ToString();
                                                                    dtCaLamViecPhanTheoGio2.Rows[iCaLamViecPhanTheoGio2]["BatDauTinhVeSom"].ToString();
                                                                    Convert.ToInt32(dtCaLamViecPhanTheoGio2.Rows[iCaLamViecPhanTheoGio2]["ChoPhepVeSom"].ToString());
                                                                    string sPhutVeSom36;
                                                                    sPhutVeSom36 = Convert.ToInt32((dGioRaKhaiBaoPhanTheoGioB2 - dGioRaPhanTheoGio).TotalMinutes).ToString();
                                                                    if (Convert.ToInt32(sPhutVeSom36) < 0)
                                                                    {
                                                                        sPhutVeSom36 = "0";
                                                                    }
                                                                    double dTongGioTangCaPhanTheoGioA2;
                                                                    dTongGioTangCaPhanTheoGioA2 = Math.Round((Convert.ToDouble(dtCaLamViecPhanTheoGio2.Rows[iCaLamViecPhanTheoGio2]["TongGioTrongCaLamViec"]) * 60.0 - (Convert.ToDouble(sPhutTre36) + Convert.ToDouble(sPhutVeSom36))) / 60.0, this.iLamTronGio);
                                                                    if (iTangCaChuNhatMuc6 == 1)
                                                                    {
                                                                        this.DGVTinhCong.Rows[addPhanTheoGio].Cells[12].Value = dTongGioTangCaPhanTheoGioA2 * this.dTangCaChuNhatHeSo;
                                                                        this.DGVTinhCong.Rows[addPhanTheoGio].Cells[18].Value = this.sKHDungGio;
                                                                    }
                                                                    if (iTangCaChuNhatMuc6 == 2)
                                                                    {
                                                                        this.DGVTinhCong.Rows[addPhanTheoGio].Cells[13].Value = dTongGioTangCaPhanTheoGioA2 * this.dTangCaChuNhatHeSo;
                                                                        this.DGVTinhCong.Rows[addPhanTheoGio].Cells[18].Value = this.sKHDungGio;
                                                                    }
                                                                    if (iTangCaChuNhatMuc6 == 3)
                                                                    {
                                                                        this.DGVTinhCong.Rows[addPhanTheoGio].Cells[14].Value = dTongGioTangCaPhanTheoGioA2 * this.dTangCaChuNhatHeSo;
                                                                        this.DGVTinhCong.Rows[addPhanTheoGio].Cells[18].Value = this.sKHDungGio;
                                                                    }
                                                                    if (iTangCaChuNhatMuc6 == 4)
                                                                    {
                                                                        this.DGVTinhCong.Rows[addPhanTheoGio].Cells[15].Value = dTongGioTangCaPhanTheoGioA2 * this.dTangCaChuNhatHeSo;
                                                                        this.DGVTinhCong.Rows[addPhanTheoGio].Cells[18].Value = this.sKHDungGio;
                                                                    }
                                                                }
                                                                else
                                                                {
                                                                    string sTruGioDiTre28;
                                                                    sTruGioDiTre28 = dtCaLamViecPhanTheoGio2.Rows[iCaLamViecPhanTheoGio2]["TruGioDiTre"].ToString();
                                                                    string sBatDauTinhDiTre28;
                                                                    sBatDauTinhDiTre28 = dtCaLamViecPhanTheoGio2.Rows[iCaLamViecPhanTheoGio2]["BatDauTinhDiTre"].ToString();
                                                                    int iChoPhepDiTre24;
                                                                    iChoPhepDiTre24 = Convert.ToInt32(dtCaLamViecPhanTheoGio2.Rows[iCaLamViecPhanTheoGio2]["ChoPhepDiTre"].ToString());
                                                                    string sPhutTre34;
                                                                    sPhutTre34 = Convert.ToInt32((dGioVaoPhanTheoGio - dGioVaoKhaiBaoPhanTheoGioB2).TotalMinutes).ToString();
                                                                    if (sTruGioDiTre28 == "True")
                                                                    {
                                                                        if (Convert.ToInt32(sPhutTre34) < 0)
                                                                        {
                                                                            this.DGVTinhCong.Rows[addPhanTheoGio].Cells[9].Value = "0";
                                                                        }
                                                                        else
                                                                        {
                                                                            int iPhutTre24;
                                                                            iPhutTre24 = Convert.ToInt32(sPhutTre34) - iChoPhepDiTre24;
                                                                            if (sBatDauTinhDiTre28 == "True")
                                                                            {
                                                                                if (iPhutTre24 < 1)
                                                                                {
                                                                                    this.DGVTinhCong.Rows[addPhanTheoGio].Cells[9].Value = "0";
                                                                                }
                                                                                else
                                                                                {
                                                                                    this.DGVTinhCong.Rows[addPhanTheoGio].Cells[9].Value = iPhutTre24.ToString();
                                                                                }
                                                                            }
                                                                            else if (iPhutTre24 < 1)
                                                                            {
                                                                                this.DGVTinhCong.Rows[addPhanTheoGio].Cells[9].Value = "0";
                                                                            }
                                                                            else
                                                                            {
                                                                                this.DGVTinhCong.Rows[addPhanTheoGio].Cells[9].Value = sPhutTre34;
                                                                            }
                                                                        }
                                                                    }
                                                                    else
                                                                    {
                                                                        this.DGVTinhCong.Rows[addPhanTheoGio].Cells[9].Value = "0";
                                                                    }
                                                                    string sTruGioVeSom28;
                                                                    sTruGioVeSom28 = dtCaLamViecPhanTheoGio2.Rows[iCaLamViecPhanTheoGio2]["TruGioVeSom"].ToString();
                                                                    string sBatDauTinhVeSom29;
                                                                    sBatDauTinhVeSom29 = dtCaLamViecPhanTheoGio2.Rows[iCaLamViecPhanTheoGio2]["BatDauTinhVeSom"].ToString();
                                                                    int iChoPhepVeSom25;
                                                                    iChoPhepVeSom25 = Convert.ToInt32(dtCaLamViecPhanTheoGio2.Rows[iCaLamViecPhanTheoGio2]["ChoPhepVeSom"].ToString());
                                                                    string sPhutVeSom35;
                                                                    sPhutVeSom35 = Convert.ToInt32((dGioRaKhaiBaoPhanTheoGioB2 - dGioRaPhanTheoGio).TotalMinutes).ToString();
                                                                    if (sTruGioVeSom28 == "True")
                                                                    {
                                                                        if (Convert.ToInt32(sPhutVeSom35) < 0)
                                                                        {
                                                                            this.DGVTinhCong.Rows[addPhanTheoGio].Cells[10].Value = "0";
                                                                        }
                                                                        else
                                                                        {
                                                                            int iPhutVeSom25;
                                                                            iPhutVeSom25 = Convert.ToInt32(sPhutVeSom35) - iChoPhepVeSom25;
                                                                            if (iPhutVeSom25 < 1)
                                                                            {
                                                                                this.DGVTinhCong.Rows[addPhanTheoGio].Cells[10].Value = "0";
                                                                            }
                                                                            else if (sBatDauTinhVeSom29 == "True")
                                                                            {
                                                                                this.DGVTinhCong.Rows[addPhanTheoGio].Cells[10].Value = iPhutVeSom25.ToString();
                                                                            }
                                                                            else
                                                                            {
                                                                                this.DGVTinhCong.Rows[addPhanTheoGio].Cells[10].Value = sPhutVeSom35;
                                                                            }
                                                                        }
                                                                    }
                                                                    else
                                                                    {
                                                                        this.DGVTinhCong.Rows[addPhanTheoGio].Cells[10].Value = "0";
                                                                    }
                                                                    string sVeTre23;
                                                                    sVeTre23 = Convert.ToInt32((dGioRaPhanTheoGio - dGioRaKhaiBaoPhanTheoGioB2).TotalMinutes).ToString();
                                                                    if (Convert.ToInt32(sVeTre23) > 0)
                                                                    {
                                                                        this.DGVTinhCong.Rows[addPhanTheoGio].Cells[11].Value = sVeTre23;
                                                                    }
                                                                    else
                                                                    {
                                                                        this.DGVTinhCong.Rows[addPhanTheoGio].Cells[11].Value = "0";
                                                                    }
                                                                    double dGio23;
                                                                    dGio23 = Math.Round(Convert.ToDouble(Convert.ToSingle(dtCaLamViecPhanTheoGio2.Rows[iCaLamViecPhanTheoGio2]["TongGioTrongCaLamViec"]) * 60f - (float)(Convert.ToInt32(this.DGVTinhCong.Rows[addPhanTheoGio].Cells[9].Value.ToString()) + Convert.ToInt32(this.DGVTinhCong.Rows[addPhanTheoGio].Cells[10].Value))) / 60.0, this.iLamTronGio);
                                                                    this.DGVTinhCong.Rows[addPhanTheoGio].Cells[8].Value = dGio23 * this.dTangCaChuNhatHeSo;
                                                                    double iGio23;
                                                                    iGio23 = Convert.ToDouble(dtCaLamViecPhanTheoGio2.Rows[iCaLamViecPhanTheoGio2]["TongGioTrongCaLamViec"].ToString());
                                                                    double dCongTinh21;
                                                                    dCongTinh21 = Convert.ToDouble(dtCaLamViecPhanTheoGio2.Rows[iCaLamViecPhanTheoGio2]["CongTinh"].ToString());
                                                                    double dCong23;
                                                                    dCong23 = Math.Round(dGio23 * dCongTinh21 / iGio23, this.iLamTronCong);
                                                                    this.DGVTinhCong.Rows[addPhanTheoGio].Cells[7].Value = dCong23 * this.dTangCaChuNhatHeSo;
                                                                    string sTangCaTruocGioLamViec15;
                                                                    sTangCaTruocGioLamViec15 = dtCaLamViecPhanTheoGio2.Rows[iCaLamViecPhanTheoGio2]["TangCaTruocGioLamViec"].ToString();
                                                                    string sTangCaSauGioLamViec15;
                                                                    sTangCaSauGioLamViec15 = dtCaLamViecPhanTheoGio2.Rows[iCaLamViecPhanTheoGio2]["TangCaSauGioLamViec"].ToString();
                                                                    if (sTangCaTruocGioLamViec15 == "False" && sTangCaSauGioLamViec15 == "False")
                                                                    {
                                                                        this.DGVTinhCong.Rows[addPhanTheoGio].Cells[12].Value = "0";
                                                                        this.DGVTinhCong.Rows[addPhanTheoGio].Cells[13].Value = "0";
                                                                        this.DGVTinhCong.Rows[addPhanTheoGio].Cells[14].Value = "0";
                                                                        this.DGVTinhCong.Rows[addPhanTheoGio].Cells[15].Value = "0";
                                                                    }
                                                                    if (sXemCaNayLaTangCa11 == "True")
                                                                    {
                                                                        if (iTangCaMuc11 == 1)
                                                                        {
                                                                            this.DGVTinhCong.Rows[addPhanTheoGio].Cells[7].Value = "0";
                                                                            this.DGVTinhCong.Rows[addPhanTheoGio].Cells[8].Value = "0";
                                                                            this.DGVTinhCong.Rows[addPhanTheoGio].Cells[12].Value = dGio23.ToString();
                                                                            this.DGVTinhCong.Rows[addPhanTheoGio].Cells[13].Value = "0";
                                                                            this.DGVTinhCong.Rows[addPhanTheoGio].Cells[14].Value = "0";
                                                                            this.DGVTinhCong.Rows[addPhanTheoGio].Cells[15].Value = "0";
                                                                        }
                                                                        if (iTangCaMuc11 == 2)
                                                                        {
                                                                            this.DGVTinhCong.Rows[addPhanTheoGio].Cells[7].Value = "0";
                                                                            this.DGVTinhCong.Rows[addPhanTheoGio].Cells[8].Value = "0";
                                                                            this.DGVTinhCong.Rows[addPhanTheoGio].Cells[12].Value = "0";
                                                                            this.DGVTinhCong.Rows[addPhanTheoGio].Cells[13].Value = dGio23.ToString();
                                                                            this.DGVTinhCong.Rows[addPhanTheoGio].Cells[14].Value = "0";
                                                                            this.DGVTinhCong.Rows[addPhanTheoGio].Cells[15].Value = "0";
                                                                        }
                                                                        if (iTangCaMuc11 == 3)
                                                                        {
                                                                            this.DGVTinhCong.Rows[addPhanTheoGio].Cells[7].Value = "0";
                                                                            this.DGVTinhCong.Rows[addPhanTheoGio].Cells[8].Value = "0";
                                                                            this.DGVTinhCong.Rows[addPhanTheoGio].Cells[12].Value = "0";
                                                                            this.DGVTinhCong.Rows[addPhanTheoGio].Cells[13].Value = "0";
                                                                            this.DGVTinhCong.Rows[addPhanTheoGio].Cells[14].Value = dGio23.ToString();
                                                                            this.DGVTinhCong.Rows[addPhanTheoGio].Cells[15].Value = "0";
                                                                        }
                                                                        if (iTangCaMuc11 == 4)
                                                                        {
                                                                            this.DGVTinhCong.Rows[addPhanTheoGio].Cells[7].Value = "0";
                                                                            this.DGVTinhCong.Rows[addPhanTheoGio].Cells[8].Value = "0";
                                                                            this.DGVTinhCong.Rows[addPhanTheoGio].Cells[12].Value = "0";
                                                                            this.DGVTinhCong.Rows[addPhanTheoGio].Cells[13].Value = "0";
                                                                            this.DGVTinhCong.Rows[addPhanTheoGio].Cells[14].Value = "0";
                                                                            this.DGVTinhCong.Rows[addPhanTheoGio].Cells[15].Value = dGio23.ToString();
                                                                        }
                                                                    }
                                                                    string sChoPhepTangCaTruocGioLamViecPhanTheoGio4;
                                                                    sChoPhepTangCaTruocGioLamViecPhanTheoGio4 = dtCaLamViecPhanTheoGio2.Rows[iCaLamViecPhanTheoGio2]["TangCaTruocGioLamViec"].ToString();
                                                                    int iPhutTangCaTruocGioLamViecPhanTheoGio4;
                                                                    iPhutTangCaTruocGioLamViecPhanTheoGio4 = Convert.ToInt32(dtCaLamViecPhanTheoGio2.Rows[iCaLamViecPhanTheoGio2]["SoPhutTangCaTruocGioLamViec"].ToString());
                                                                    int iPhutTangCaTruocGioLamViecDatDen27;
                                                                    iPhutTangCaTruocGioLamViecDatDen27 = Convert.ToInt32(dtCaLamViecPhanTheoGio2.Rows[iCaLamViecPhanTheoGio2]["TangCaTruocGioLamViecDatDen"].ToString());
                                                                    int iPhutTruTangCaTruoc27;
                                                                    iPhutTruTangCaTruoc27 = Convert.ToInt32(dtCaLamViecPhanTheoGio2.Rows[iCaLamViecPhanTheoGio2]["PhutTruTangCaTruoc"].ToString());
                                                                    string sChoPhepTangCaSauGioLamViecPhanTheoGio4;
                                                                    sChoPhepTangCaSauGioLamViecPhanTheoGio4 = dtCaLamViecPhanTheoGio2.Rows[iCaLamViecPhanTheoGio2]["TangCaSauGioLamViec"].ToString();
                                                                    int iPhutTangCaSauGioLamViecPhanTheoGio4;
                                                                    iPhutTangCaSauGioLamViecPhanTheoGio4 = Convert.ToInt32(dtCaLamViecPhanTheoGio2.Rows[iCaLamViecPhanTheoGio2]["SoPhutTangCaSauGioLamViec"].ToString());
                                                                    int iPhutTangCaSauGioLamViecDatDen27;
                                                                    iPhutTangCaSauGioLamViecDatDen27 = Convert.ToInt32(dtCaLamViecPhanTheoGio2.Rows[iCaLamViecPhanTheoGio2]["TangCaSauGioLamViecDatDen"].ToString());
                                                                    int iPhutTruTangCaSau27;
                                                                    iPhutTruTangCaSau27 = Convert.ToInt32(dtCaLamViecPhanTheoGio2.Rows[iCaLamViecPhanTheoGio2]["PhutTruTangCaSau"].ToString());
                                                                    int iGioiHanTC1PhanTheoGio4;
                                                                    iGioiHanTC1PhanTheoGio4 = Convert.ToInt32(dtCaLamViecPhanTheoGio2.Rows[iCaLamViecPhanTheoGio2]["GioiHanTangCa1"].ToString());
                                                                    int iGioiHanTC2PhanTheoGio4;
                                                                    iGioiHanTC2PhanTheoGio4 = Convert.ToInt32(dtCaLamViecPhanTheoGio2.Rows[iCaLamViecPhanTheoGio2]["GioiHanTangCa2"].ToString());
                                                                    int iGioiHanTC3PhanTheoGio4;
                                                                    iGioiHanTC3PhanTheoGio4 = Convert.ToInt32(dtCaLamViecPhanTheoGio2.Rows[iCaLamViecPhanTheoGio2]["GioiHanTangCa3"].ToString());
                                                                    int iGioiHanTC4PhanTheoGio4;
                                                                    iGioiHanTC4PhanTheoGio4 = Convert.ToInt32(dtCaLamViecPhanTheoGio2.Rows[iCaLamViecPhanTheoGio2]["GioiHanTangCa4"].ToString());
                                                                    int iTongGioTangCaSauPhanTheoGio4;
                                                                    iTongGioTangCaSauPhanTheoGio4 = 0;
                                                                    int iTongGioTangCaTruocPhanTheoGio4;
                                                                    iTongGioTangCaTruocPhanTheoGio4 = 0;
                                                                    if (sChoPhepTangCaTruocGioLamViecPhanTheoGio4 == "False" && sChoPhepTangCaSauGioLamViecPhanTheoGio4 == "False")
                                                                    {
                                                                        this.DGVTinhCong.Rows[addPhanTheoGio].Cells[12].Value = "0";
                                                                        this.DGVTinhCong.Rows[addPhanTheoGio].Cells[13].Value = "0";
                                                                        this.DGVTinhCong.Rows[addPhanTheoGio].Cells[14].Value = "0";
                                                                        this.DGVTinhCong.Rows[addPhanTheoGio].Cells[15].Value = "0";
                                                                    }
                                                                    else
                                                                    {
                                                                        if (sChoPhepTangCaTruocGioLamViecPhanTheoGio4 == "True")
                                                                        {
                                                                            int iThoiGianTruocGioLamPhanTheoGio4;
                                                                            iThoiGianTruocGioLamPhanTheoGio4 = Convert.ToInt32(Convert.ToInt32((dGioVaoKhaiBaoPhanTheoGioB2 - dGioVaoPhanTheoGio).TotalMinutes).ToString());
                                                                            if (iThoiGianTruocGioLamPhanTheoGio4 > 0 && iThoiGianTruocGioLamPhanTheoGio4 > iPhutTangCaTruocGioLamViecPhanTheoGio4 && iThoiGianTruocGioLamPhanTheoGio4 > iPhutTangCaTruocGioLamViecDatDen27)
                                                                            {
                                                                                iTongGioTangCaTruocPhanTheoGio4 = iThoiGianTruocGioLamPhanTheoGio4 - iPhutTruTangCaTruoc27;
                                                                            }
                                                                        }
                                                                        if (sChoPhepTangCaSauGioLamViecPhanTheoGio4 == "True")
                                                                        {
                                                                            int iThoiGianSauGioLamViecPhanTheoGio4;
                                                                            iThoiGianSauGioLamViecPhanTheoGio4 = Convert.ToInt32(Convert.ToInt32((dGioRaPhanTheoGio - dGioRaKhaiBaoPhanTheoGioB2).TotalMinutes).ToString());
                                                                            if (iThoiGianSauGioLamViecPhanTheoGio4 > 0 && iThoiGianSauGioLamViecPhanTheoGio4 > iPhutTangCaSauGioLamViecPhanTheoGio4 && iThoiGianSauGioLamViecPhanTheoGio4 > iPhutTangCaSauGioLamViecDatDen27)
                                                                            {
                                                                                iTongGioTangCaSauPhanTheoGio4 = iThoiGianSauGioLamViecPhanTheoGio4 - iPhutTruTangCaSau27;
                                                                            }
                                                                        }
                                                                    }
                                                                    double dTongThoiGianTangCaPhanTheoGio4;
                                                                    dTongThoiGianTangCaPhanTheoGio4 = Convert.ToDouble(iTongGioTangCaTruocPhanTheoGio4 + iTongGioTangCaSauPhanTheoGio4);
                                                                    if (dTongThoiGianTangCaPhanTheoGio4 > 0.0)
                                                                    {
                                                                        string sLayGio4;
                                                                        sLayGio4 = Math.Round(dTongThoiGianTangCaPhanTheoGio4 / 60.0, 2).ToString().Substring(0, 1);
                                                                        int iPhutConLai4;
                                                                        iPhutConLai4 = Convert.ToInt32(dTongThoiGianTangCaPhanTheoGio4) - Convert.ToInt32(sLayGio4) * 60;
                                                                        double dLamTronGioTangCa4;
                                                                        dLamTronGioTangCa4 = 0.0;
                                                                        if (iPhutConLai4 > this.iLamTronTuA && iPhutConLai4 <= this.iLamTronDenA)
                                                                        {
                                                                            dLamTronGioTangCa4 = Convert.ToDouble(this.sLamTronA);
                                                                        }
                                                                        else if (iPhutConLai4 > this.iLamTronTuB && iPhutConLai4 <= this.iLamTronDenB)
                                                                        {
                                                                            dLamTronGioTangCa4 = Convert.ToDouble(this.sLamTronB);
                                                                        }
                                                                        else if (iPhutConLai4 > this.iLamTronTuC && iPhutConLai4 <= this.iLamTronDenC)
                                                                        {
                                                                            dLamTronGioTangCa4 = Convert.ToDouble(this.sLamTronC);
                                                                        }
                                                                        else if (iPhutConLai4 > this.iLamTronTuD && iPhutConLai4 <= this.iLamTronDenD)
                                                                        {
                                                                            dLamTronGioTangCa4 = Convert.ToDouble(this.sLamTronD);
                                                                        }
                                                                        if (iGioiHanTC1PhanTheoGio4 == 0)
                                                                        {
                                                                            this.DGVTinhCong.Rows[addPhanTheoGio].Cells[12].Value = (Convert.ToDouble(sLayGio4) + dLamTronGioTangCa4) * this.dTangCa1HeSo;
                                                                            this.DGVTinhCong.Rows[addPhanTheoGio].Cells[13].Value = "0";
                                                                            this.DGVTinhCong.Rows[addPhanTheoGio].Cells[14].Value = "0";
                                                                            this.DGVTinhCong.Rows[addPhanTheoGio].Cells[15].Value = "0";
                                                                        }
                                                                        if (iGioiHanTC1PhanTheoGio4 != 0 && iGioiHanTC2PhanTheoGio4 == 0)
                                                                        {
                                                                            if (dTongThoiGianTangCaPhanTheoGio4 < Convert.ToDouble(iGioiHanTC1PhanTheoGio4))
                                                                            {
                                                                                this.DGVTinhCong.Rows[addPhanTheoGio].Cells[12].Value = Math.Round(dTongThoiGianTangCaPhanTheoGio4 * this.dTangCa1HeSo / 60.0, this.iLamTronGio);
                                                                                this.DGVTinhCong.Rows[addPhanTheoGio].Cells[13].Value = "0";
                                                                                this.DGVTinhCong.Rows[addPhanTheoGio].Cells[14].Value = "0";
                                                                                this.DGVTinhCong.Rows[addPhanTheoGio].Cells[15].Value = "0";
                                                                            }
                                                                            else
                                                                            {
                                                                                this.DGVTinhCong.Rows[addPhanTheoGio].Cells[12].Value = Math.Round(Convert.ToDouble(iGioiHanTC1PhanTheoGio4) / 60.0 * this.dTangCa1HeSo, this.iLamTronGio);
                                                                                if (dTongThoiGianTangCaPhanTheoGio4 - Convert.ToDouble(iGioiHanTC1PhanTheoGio4) > 0.0)
                                                                                {
                                                                                    this.DGVTinhCong.Rows[addPhanTheoGio].Cells[13].Value = Math.Round((dTongThoiGianTangCaPhanTheoGio4 - Convert.ToDouble(iGioiHanTC1PhanTheoGio4)) * this.dTangCa2HeSo / 60.0, this.iLamTronGio);
                                                                                }
                                                                                this.DGVTinhCong.Rows[addPhanTheoGio].Cells[14].Value = "0";
                                                                                this.DGVTinhCong.Rows[addPhanTheoGio].Cells[15].Value = "0";
                                                                            }
                                                                        }
                                                                        if (iGioiHanTC1PhanTheoGio4 != 0 && iGioiHanTC2PhanTheoGio4 != 0 && iGioiHanTC3PhanTheoGio4 == 0)
                                                                        {
                                                                            if (dTongThoiGianTangCaPhanTheoGio4 < Convert.ToDouble(iGioiHanTC1PhanTheoGio4))
                                                                            {
                                                                                this.DGVTinhCong.Rows[addPhanTheoGio].Cells[12].Value = Math.Round(dTongThoiGianTangCaPhanTheoGio4 * this.dTangCa1HeSo / 60.0, this.iLamTronGio);
                                                                                this.DGVTinhCong.Rows[addPhanTheoGio].Cells[13].Value = "0";
                                                                                this.DGVTinhCong.Rows[addPhanTheoGio].Cells[14].Value = "0";
                                                                                this.DGVTinhCong.Rows[addPhanTheoGio].Cells[15].Value = "0";
                                                                            }
                                                                            else
                                                                            {
                                                                                this.DGVTinhCong.Rows[addPhanTheoGio].Cells[12].Value = Math.Round(Convert.ToDouble(iGioiHanTC1PhanTheoGio4) * this.dTangCa1HeSo / 60.0, this.iLamTronGio);
                                                                                if (dTongThoiGianTangCaPhanTheoGio4 - Convert.ToDouble(iGioiHanTC1PhanTheoGio4) < Convert.ToDouble(iGioiHanTC2PhanTheoGio4))
                                                                                {
                                                                                    this.DGVTinhCong.Rows[addPhanTheoGio].Cells[13].Value = Math.Round((dTongThoiGianTangCaPhanTheoGio4 - Convert.ToDouble(iGioiHanTC1PhanTheoGio4)) * this.dTangCa2HeSo / 60.0, this.iLamTronGio);
                                                                                    this.DGVTinhCong.Rows[addPhanTheoGio].Cells[14].Value = "0";
                                                                                    this.DGVTinhCong.Rows[addPhanTheoGio].Cells[15].Value = "0";
                                                                                }
                                                                                else
                                                                                {
                                                                                    this.DGVTinhCong.Rows[addPhanTheoGio].Cells[12].Value = Math.Round(Convert.ToDouble(iGioiHanTC1PhanTheoGio4) * this.dTangCa1HeSo / 60.0, this.iLamTronGio);
                                                                                    this.DGVTinhCong.Rows[addPhanTheoGio].Cells[13].Value = Math.Round(Convert.ToDouble(iGioiHanTC2PhanTheoGio4) * this.dTangCa2HeSo / 60.0, this.iLamTronGio);
                                                                                    this.DGVTinhCong.Rows[addPhanTheoGio].Cells[14].Value = Math.Round((dTongThoiGianTangCaPhanTheoGio4 - Convert.ToDouble(iGioiHanTC1PhanTheoGio4) - Convert.ToDouble(iGioiHanTC2PhanTheoGio4)) * this.dTangCa3HeSo / 60.0, this.iLamTronGio);
                                                                                    this.DGVTinhCong.Rows[addPhanTheoGio].Cells[15].Value = "0";
                                                                                }
                                                                            }
                                                                        }
                                                                        if (iGioiHanTC1PhanTheoGio4 != 0 && iGioiHanTC2PhanTheoGio4 != 0 && iGioiHanTC3PhanTheoGio4 != 0 && iGioiHanTC4PhanTheoGio4 != 0)
                                                                        {
                                                                        }
                                                                    }
                                                                    else
                                                                    {
                                                                        this.DGVTinhCong.Rows[addPhanTheoGio].Cells[12].Value = "0";
                                                                        this.DGVTinhCong.Rows[addPhanTheoGio].Cells[13].Value = "0";
                                                                        this.DGVTinhCong.Rows[addPhanTheoGio].Cells[14].Value = "0";
                                                                        this.DGVTinhCong.Rows[addPhanTheoGio].Cells[15].Value = "0";
                                                                    }
                                                                    string sTongGio16;
                                                                    sTongGio16 = Math.Round(Convert.ToDouble(Convert.ToInt32((dGioRaPhanTheoGio - dGioVaoPhanTheoGio).TotalMinutes).ToString()) / 60.0, this.iLamTronGio).ToString();
                                                                    this.DGVTinhCong.Rows[addPhanTheoGio].Cells[16].Value = Convert.ToDouble(sTongGio16) * this.dTangCaChuNhatHeSo;
                                                                    this.DGVTinhCong.Rows[addPhanTheoGio].Cells[17].Value = Convert.ToDouble(dtCaLamViecPhanTheoGio2.Rows[iCaLamViecPhanTheoGio2]["CongTinh"].ToString()) * this.dTangCaChuNhatHeSo;
                                                                    this.DGVTinhCong.Rows[addPhanTheoGio].Cells[18].Value = this.sKHDungGio;
                                                                }
                                                            }
                                                            else
                                                            {
                                                                string sTruGioDiTre26;
                                                                sTruGioDiTre26 = dtCaLamViecPhanTheoGio2.Rows[iCaLamViecPhanTheoGio2]["TruGioDiTre"].ToString();
                                                                string sBatDauTinhDiTre26;
                                                                sBatDauTinhDiTre26 = dtCaLamViecPhanTheoGio2.Rows[iCaLamViecPhanTheoGio2]["BatDauTinhDiTre"].ToString();
                                                                int iChoPhepDiTre22;
                                                                iChoPhepDiTre22 = Convert.ToInt32(dtCaLamViecPhanTheoGio2.Rows[iCaLamViecPhanTheoGio2]["ChoPhepDiTre"].ToString());
                                                                string sPhutTre32;
                                                                sPhutTre32 = Convert.ToInt32((dGioVaoPhanTheoGio - dGioVaoKhaiBaoPhanTheoGioB2).TotalMinutes).ToString();
                                                                if (sTruGioDiTre26 == "True")
                                                                {
                                                                    if (Convert.ToInt32(sPhutTre32) < 0)
                                                                    {
                                                                        this.DGVTinhCong.Rows[addPhanTheoGio].Cells[9].Value = "0";
                                                                    }
                                                                    else
                                                                    {
                                                                        int iPhutTre22;
                                                                        iPhutTre22 = Convert.ToInt32(sPhutTre32) - iChoPhepDiTre22;
                                                                        if (sBatDauTinhDiTre26 == "True")
                                                                        {
                                                                            if (iPhutTre22 < 1)
                                                                            {
                                                                                this.DGVTinhCong.Rows[addPhanTheoGio].Cells[9].Value = "0";
                                                                            }
                                                                            else
                                                                            {
                                                                                this.DGVTinhCong.Rows[addPhanTheoGio].Cells[9].Value = iPhutTre22.ToString();
                                                                            }
                                                                        }
                                                                        else if (iPhutTre22 < 1)
                                                                        {
                                                                            this.DGVTinhCong.Rows[addPhanTheoGio].Cells[9].Value = "0";
                                                                        }
                                                                        else
                                                                        {
                                                                            this.DGVTinhCong.Rows[addPhanTheoGio].Cells[9].Value = sPhutTre32;
                                                                        }
                                                                    }
                                                                }
                                                                else
                                                                {
                                                                    this.DGVTinhCong.Rows[addPhanTheoGio].Cells[9].Value = "0";
                                                                }
                                                                string sTruGioVeSom26;
                                                                sTruGioVeSom26 = dtCaLamViecPhanTheoGio2.Rows[iCaLamViecPhanTheoGio2]["TruGioVeSom"].ToString();
                                                                string sBatDauTinhVeSom26;
                                                                sBatDauTinhVeSom26 = dtCaLamViecPhanTheoGio2.Rows[iCaLamViecPhanTheoGio2]["BatDauTinhVeSom"].ToString();
                                                                int iChoPhepVeSom23;
                                                                iChoPhepVeSom23 = Convert.ToInt32(dtCaLamViecPhanTheoGio2.Rows[iCaLamViecPhanTheoGio2]["ChoPhepVeSom"].ToString());
                                                                string sPhutVeSom33;
                                                                sPhutVeSom33 = Convert.ToInt32((dGioRaKhaiBaoPhanTheoGioB2 - dGioRaPhanTheoGio).TotalMinutes).ToString();
                                                                if (sTruGioVeSom26 == "True")
                                                                {
                                                                    if (Convert.ToInt32(sPhutVeSom33) < 0)
                                                                    {
                                                                        this.DGVTinhCong.Rows[addPhanTheoGio].Cells[10].Value = "0";
                                                                    }
                                                                    else
                                                                    {
                                                                        int iPhutVeSom23;
                                                                        iPhutVeSom23 = Convert.ToInt32(sPhutVeSom33) - iChoPhepVeSom23;
                                                                        if (iPhutVeSom23 < 1)
                                                                        {
                                                                            this.DGVTinhCong.Rows[addPhanTheoGio].Cells[10].Value = "0";
                                                                        }
                                                                        else if (sBatDauTinhVeSom26 == "True")
                                                                        {
                                                                            this.DGVTinhCong.Rows[addPhanTheoGio].Cells[10].Value = iPhutVeSom23.ToString();
                                                                        }
                                                                        else
                                                                        {
                                                                            this.DGVTinhCong.Rows[addPhanTheoGio].Cells[10].Value = sPhutVeSom33;
                                                                        }
                                                                    }
                                                                }
                                                                else
                                                                {
                                                                    this.DGVTinhCong.Rows[addPhanTheoGio].Cells[10].Value = "0";
                                                                }
                                                                string sVeTre21;
                                                                sVeTre21 = Convert.ToInt32((dGioRaPhanTheoGio - dGioRaKhaiBaoPhanTheoGioB2).TotalMinutes).ToString();
                                                                if (Convert.ToInt32(sVeTre21) > 0)
                                                                {
                                                                    this.DGVTinhCong.Rows[addPhanTheoGio].Cells[11].Value = sVeTre21;
                                                                }
                                                                else
                                                                {
                                                                    this.DGVTinhCong.Rows[addPhanTheoGio].Cells[11].Value = "0";
                                                                }
                                                                double dGio21;
                                                                dGio21 = Math.Round(Convert.ToDouble(Convert.ToSingle(dtCaLamViecPhanTheoGio2.Rows[iCaLamViecPhanTheoGio2]["TongGioTrongCaLamViec"]) * 60f - (float)(Convert.ToInt32(this.DGVTinhCong.Rows[addPhanTheoGio].Cells[9].Value.ToString()) + Convert.ToInt32(this.DGVTinhCong.Rows[addPhanTheoGio].Cells[10].Value))) / 60.0, this.iLamTronGio);
                                                                this.DGVTinhCong.Rows[addPhanTheoGio].Cells[8].Value = dGio21.ToString();
                                                                double iGio21;
                                                                iGio21 = Convert.ToDouble(dtCaLamViecPhanTheoGio2.Rows[iCaLamViecPhanTheoGio2]["TongGioTrongCaLamViec"].ToString());
                                                                double dCongTinh19;
                                                                dCongTinh19 = Convert.ToDouble(dtCaLamViecPhanTheoGio2.Rows[iCaLamViecPhanTheoGio2]["CongTinh"].ToString());
                                                                double dCong21;
                                                                dCong21 = Math.Round(dGio21 * dCongTinh19 / iGio21, this.iLamTronCong);
                                                                this.DGVTinhCong.Rows[addPhanTheoGio].Cells[7].Value = dCong21.ToString();
                                                                string sTangCaTruocGioLamViec13;
                                                                sTangCaTruocGioLamViec13 = dtCaLamViecPhanTheoGio2.Rows[iCaLamViecPhanTheoGio2]["TangCaTruocGioLamViec"].ToString();
                                                                string sTangCaSauGioLamViec13;
                                                                sTangCaSauGioLamViec13 = dtCaLamViecPhanTheoGio2.Rows[iCaLamViecPhanTheoGio2]["TangCaSauGioLamViec"].ToString();
                                                                if (sTangCaTruocGioLamViec13 == "False" && sTangCaSauGioLamViec13 == "False")
                                                                {
                                                                    this.DGVTinhCong.Rows[addPhanTheoGio].Cells[12].Value = "0";
                                                                    this.DGVTinhCong.Rows[addPhanTheoGio].Cells[13].Value = "0";
                                                                    this.DGVTinhCong.Rows[addPhanTheoGio].Cells[14].Value = "0";
                                                                    this.DGVTinhCong.Rows[addPhanTheoGio].Cells[15].Value = "0";
                                                                }
                                                                if (sXemCaNayLaTangCa11 == "True")
                                                                {
                                                                    if (iTangCaMuc11 == 1)
                                                                    {
                                                                        this.DGVTinhCong.Rows[addPhanTheoGio].Cells[7].Value = "0";
                                                                        this.DGVTinhCong.Rows[addPhanTheoGio].Cells[8].Value = "0";
                                                                        this.DGVTinhCong.Rows[addPhanTheoGio].Cells[12].Value = dGio21.ToString();
                                                                        this.DGVTinhCong.Rows[addPhanTheoGio].Cells[13].Value = "0";
                                                                        this.DGVTinhCong.Rows[addPhanTheoGio].Cells[14].Value = "0";
                                                                        this.DGVTinhCong.Rows[addPhanTheoGio].Cells[15].Value = "0";
                                                                    }
                                                                    if (iTangCaMuc11 == 2)
                                                                    {
                                                                        this.DGVTinhCong.Rows[addPhanTheoGio].Cells[7].Value = "0";
                                                                        this.DGVTinhCong.Rows[addPhanTheoGio].Cells[8].Value = "0";
                                                                        this.DGVTinhCong.Rows[addPhanTheoGio].Cells[12].Value = "0";
                                                                        this.DGVTinhCong.Rows[addPhanTheoGio].Cells[13].Value = dGio21.ToString();
                                                                        this.DGVTinhCong.Rows[addPhanTheoGio].Cells[14].Value = "0";
                                                                        this.DGVTinhCong.Rows[addPhanTheoGio].Cells[15].Value = "0";
                                                                    }
                                                                    if (iTangCaMuc11 == 3)
                                                                    {
                                                                        this.DGVTinhCong.Rows[addPhanTheoGio].Cells[7].Value = "0";
                                                                        this.DGVTinhCong.Rows[addPhanTheoGio].Cells[8].Value = "0";
                                                                        this.DGVTinhCong.Rows[addPhanTheoGio].Cells[12].Value = "0";
                                                                        this.DGVTinhCong.Rows[addPhanTheoGio].Cells[13].Value = "0";
                                                                        this.DGVTinhCong.Rows[addPhanTheoGio].Cells[14].Value = dGio21.ToString();
                                                                        this.DGVTinhCong.Rows[addPhanTheoGio].Cells[15].Value = "0";
                                                                    }
                                                                    if (iTangCaMuc11 == 4)
                                                                    {
                                                                        this.DGVTinhCong.Rows[addPhanTheoGio].Cells[7].Value = "0";
                                                                        this.DGVTinhCong.Rows[addPhanTheoGio].Cells[8].Value = "0";
                                                                        this.DGVTinhCong.Rows[addPhanTheoGio].Cells[12].Value = "0";
                                                                        this.DGVTinhCong.Rows[addPhanTheoGio].Cells[13].Value = "0";
                                                                        this.DGVTinhCong.Rows[addPhanTheoGio].Cells[14].Value = "0";
                                                                        this.DGVTinhCong.Rows[addPhanTheoGio].Cells[15].Value = dGio21.ToString();
                                                                    }
                                                                }
                                                                string sChoPhepTangCaTruocGioLamViecPhanTheoGio3;
                                                                sChoPhepTangCaTruocGioLamViecPhanTheoGio3 = dtCaLamViecPhanTheoGio2.Rows[iCaLamViecPhanTheoGio2]["TangCaTruocGioLamViec"].ToString();
                                                                int iPhutTangCaTruocGioLamViecPhanTheoGio3;
                                                                iPhutTangCaTruocGioLamViecPhanTheoGio3 = Convert.ToInt32(dtCaLamViecPhanTheoGio2.Rows[iCaLamViecPhanTheoGio2]["SoPhutTangCaTruocGioLamViec"].ToString());
                                                                int iPhutTangCaTruocGioLamViecDatDen25;
                                                                iPhutTangCaTruocGioLamViecDatDen25 = Convert.ToInt32(dtCaLamViecPhanTheoGio2.Rows[iCaLamViecPhanTheoGio2]["TangCaTruocGioLamViecDatDen"].ToString());
                                                                int iPhutTruTangCaTruoc25;
                                                                iPhutTruTangCaTruoc25 = Convert.ToInt32(dtCaLamViecPhanTheoGio2.Rows[iCaLamViecPhanTheoGio2]["PhutTruTangCaTruoc"].ToString());
                                                                string sChoPhepTangCaSauGioLamViecPhanTheoGio3;
                                                                sChoPhepTangCaSauGioLamViecPhanTheoGio3 = dtCaLamViecPhanTheoGio2.Rows[iCaLamViecPhanTheoGio2]["TangCaSauGioLamViec"].ToString();
                                                                int iPhutTangCaSauGioLamViecPhanTheoGio3;
                                                                iPhutTangCaSauGioLamViecPhanTheoGio3 = Convert.ToInt32(dtCaLamViecPhanTheoGio2.Rows[iCaLamViecPhanTheoGio2]["SoPhutTangCaSauGioLamViec"].ToString());
                                                                int iPhutTangCaSauGioLamViecDatDen25;
                                                                iPhutTangCaSauGioLamViecDatDen25 = Convert.ToInt32(dtCaLamViecPhanTheoGio2.Rows[iCaLamViecPhanTheoGio2]["TangCaSauGioLamViecDatDen"].ToString());
                                                                int iPhutTruTangCaSau25;
                                                                iPhutTruTangCaSau25 = Convert.ToInt32(dtCaLamViecPhanTheoGio2.Rows[iCaLamViecPhanTheoGio2]["PhutTruTangCaSau"].ToString());
                                                                int iGioiHanTC1PhanTheoGio3;
                                                                iGioiHanTC1PhanTheoGio3 = Convert.ToInt32(dtCaLamViecPhanTheoGio2.Rows[iCaLamViecPhanTheoGio2]["GioiHanTangCa1"].ToString());
                                                                int iGioiHanTC2PhanTheoGio3;
                                                                iGioiHanTC2PhanTheoGio3 = Convert.ToInt32(dtCaLamViecPhanTheoGio2.Rows[iCaLamViecPhanTheoGio2]["GioiHanTangCa2"].ToString());
                                                                int iGioiHanTC3PhanTheoGio3;
                                                                iGioiHanTC3PhanTheoGio3 = Convert.ToInt32(dtCaLamViecPhanTheoGio2.Rows[iCaLamViecPhanTheoGio2]["GioiHanTangCa3"].ToString());
                                                                int iGioiHanTC4PhanTheoGio3;
                                                                iGioiHanTC4PhanTheoGio3 = Convert.ToInt32(dtCaLamViecPhanTheoGio2.Rows[iCaLamViecPhanTheoGio2]["GioiHanTangCa4"].ToString());
                                                                int iTongGioTangCaSauPhanTheoGio3;
                                                                iTongGioTangCaSauPhanTheoGio3 = 0;
                                                                int iTongGioTangCaTruocPhanTheoGio3;
                                                                iTongGioTangCaTruocPhanTheoGio3 = 0;
                                                                if (sChoPhepTangCaTruocGioLamViecPhanTheoGio3 == "False" && sChoPhepTangCaSauGioLamViecPhanTheoGio3 == "False")
                                                                {
                                                                    this.DGVTinhCong.Rows[addPhanTheoGio].Cells[12].Value = "0";
                                                                    this.DGVTinhCong.Rows[addPhanTheoGio].Cells[13].Value = "0";
                                                                    this.DGVTinhCong.Rows[addPhanTheoGio].Cells[14].Value = "0";
                                                                    this.DGVTinhCong.Rows[addPhanTheoGio].Cells[15].Value = "0";
                                                                }
                                                                else
                                                                {
                                                                    if (sChoPhepTangCaTruocGioLamViecPhanTheoGio3 == "True")
                                                                    {
                                                                        int iThoiGianTruocGioLamPhanTheoGio3;
                                                                        iThoiGianTruocGioLamPhanTheoGio3 = Convert.ToInt32(Convert.ToInt32((dGioVaoKhaiBaoPhanTheoGioB2 - dGioVaoPhanTheoGio).TotalMinutes).ToString());
                                                                        if (iThoiGianTruocGioLamPhanTheoGio3 > 0 && iThoiGianTruocGioLamPhanTheoGio3 > iPhutTangCaTruocGioLamViecPhanTheoGio3 && iThoiGianTruocGioLamPhanTheoGio3 > iPhutTangCaTruocGioLamViecDatDen25)
                                                                        {
                                                                            iTongGioTangCaTruocPhanTheoGio3 = iThoiGianTruocGioLamPhanTheoGio3 - iPhutTruTangCaTruoc25;
                                                                        }
                                                                    }
                                                                    if (sChoPhepTangCaSauGioLamViecPhanTheoGio3 == "True")
                                                                    {
                                                                        int iThoiGianSauGioLamViecPhanTheoGio3;
                                                                        iThoiGianSauGioLamViecPhanTheoGio3 = Convert.ToInt32(Convert.ToInt32((dGioRaPhanTheoGio - dGioRaKhaiBaoPhanTheoGioB2).TotalMinutes).ToString());
                                                                        if (iThoiGianSauGioLamViecPhanTheoGio3 > 0 && iThoiGianSauGioLamViecPhanTheoGio3 > iPhutTangCaSauGioLamViecPhanTheoGio3 && iThoiGianSauGioLamViecPhanTheoGio3 > iPhutTangCaSauGioLamViecDatDen25)
                                                                        {
                                                                            iTongGioTangCaSauPhanTheoGio3 = iThoiGianSauGioLamViecPhanTheoGio3 - iPhutTruTangCaSau25;
                                                                        }
                                                                    }
                                                                }
                                                                double dTongThoiGianTangCaPhanTheoGio3;
                                                                dTongThoiGianTangCaPhanTheoGio3 = Convert.ToDouble(iTongGioTangCaTruocPhanTheoGio3 + iTongGioTangCaSauPhanTheoGio3);
                                                                if (dTongThoiGianTangCaPhanTheoGio3 > 0.0)
                                                                {
                                                                    string sLayGio3;
                                                                    sLayGio3 = Math.Round(dTongThoiGianTangCaPhanTheoGio3 / 60.0, 2).ToString().Substring(0, 1);
                                                                    int iPhutConLai3;
                                                                    iPhutConLai3 = Convert.ToInt32(dTongThoiGianTangCaPhanTheoGio3) - Convert.ToInt32(sLayGio3) * 60;
                                                                    double dLamTronGioTangCa3;
                                                                    dLamTronGioTangCa3 = 0.0;
                                                                    if (iPhutConLai3 > this.iLamTronTuA && iPhutConLai3 <= this.iLamTronDenA)
                                                                    {
                                                                        dLamTronGioTangCa3 = Convert.ToDouble(this.sLamTronA);
                                                                    }
                                                                    else if (iPhutConLai3 > this.iLamTronTuB && iPhutConLai3 <= this.iLamTronDenB)
                                                                    {
                                                                        dLamTronGioTangCa3 = Convert.ToDouble(this.sLamTronB);
                                                                    }
                                                                    else if (iPhutConLai3 > this.iLamTronTuC && iPhutConLai3 <= this.iLamTronDenC)
                                                                    {
                                                                        dLamTronGioTangCa3 = Convert.ToDouble(this.sLamTronC);
                                                                    }
                                                                    else if (iPhutConLai3 > this.iLamTronTuD && iPhutConLai3 <= this.iLamTronDenD)
                                                                    {
                                                                        dLamTronGioTangCa3 = Convert.ToDouble(this.sLamTronD);
                                                                    }
                                                                    if (iGioiHanTC1PhanTheoGio3 == 0)
                                                                    {
                                                                        this.DGVTinhCong.Rows[addPhanTheoGio].Cells[12].Value = (Convert.ToDouble(sLayGio3) + dLamTronGioTangCa3) * this.dTangCa1HeSo;
                                                                        this.DGVTinhCong.Rows[addPhanTheoGio].Cells[13].Value = "0";
                                                                        this.DGVTinhCong.Rows[addPhanTheoGio].Cells[14].Value = "0";
                                                                        this.DGVTinhCong.Rows[addPhanTheoGio].Cells[15].Value = "0";
                                                                    }
                                                                    if (iGioiHanTC1PhanTheoGio3 != 0 && iGioiHanTC2PhanTheoGio3 == 0)
                                                                    {
                                                                        if (dTongThoiGianTangCaPhanTheoGio3 < Convert.ToDouble(iGioiHanTC1PhanTheoGio3))
                                                                        {
                                                                            this.DGVTinhCong.Rows[addPhanTheoGio].Cells[12].Value = Math.Round(dTongThoiGianTangCaPhanTheoGio3 * this.dTangCa1HeSo / 60.0, this.iLamTronGio);
                                                                            this.DGVTinhCong.Rows[addPhanTheoGio].Cells[13].Value = "0";
                                                                            this.DGVTinhCong.Rows[addPhanTheoGio].Cells[14].Value = "0";
                                                                            this.DGVTinhCong.Rows[addPhanTheoGio].Cells[15].Value = "0";
                                                                        }
                                                                        else
                                                                        {
                                                                            this.DGVTinhCong.Rows[addPhanTheoGio].Cells[12].Value = Math.Round(Convert.ToDouble(iGioiHanTC1PhanTheoGio3) / 60.0 * this.dTangCa1HeSo, this.iLamTronGio);
                                                                            if (dTongThoiGianTangCaPhanTheoGio3 - Convert.ToDouble(iGioiHanTC1PhanTheoGio3) > 0.0)
                                                                            {
                                                                                this.DGVTinhCong.Rows[addPhanTheoGio].Cells[13].Value = Math.Round((dTongThoiGianTangCaPhanTheoGio3 - Convert.ToDouble(iGioiHanTC1PhanTheoGio3)) * this.dTangCa2HeSo / 60.0, this.iLamTronGio);
                                                                            }
                                                                            this.DGVTinhCong.Rows[addPhanTheoGio].Cells[14].Value = "0";
                                                                            this.DGVTinhCong.Rows[addPhanTheoGio].Cells[15].Value = "0";
                                                                        }
                                                                    }
                                                                    if (iGioiHanTC1PhanTheoGio3 != 0 && iGioiHanTC2PhanTheoGio3 != 0 && iGioiHanTC3PhanTheoGio3 == 0)
                                                                    {
                                                                        if (dTongThoiGianTangCaPhanTheoGio3 < Convert.ToDouble(iGioiHanTC1PhanTheoGio3))
                                                                        {
                                                                            this.DGVTinhCong.Rows[addPhanTheoGio].Cells[12].Value = Math.Round(dTongThoiGianTangCaPhanTheoGio3 * this.dTangCa1HeSo / 60.0, this.iLamTronGio);
                                                                            this.DGVTinhCong.Rows[addPhanTheoGio].Cells[13].Value = "0";
                                                                            this.DGVTinhCong.Rows[addPhanTheoGio].Cells[14].Value = "0";
                                                                            this.DGVTinhCong.Rows[addPhanTheoGio].Cells[15].Value = "0";
                                                                        }
                                                                        else
                                                                        {
                                                                            this.DGVTinhCong.Rows[addPhanTheoGio].Cells[12].Value = Math.Round(Convert.ToDouble(iGioiHanTC1PhanTheoGio3) * this.dTangCa1HeSo / 60.0, this.iLamTronGio);
                                                                            if (dTongThoiGianTangCaPhanTheoGio3 - Convert.ToDouble(iGioiHanTC1PhanTheoGio3) < Convert.ToDouble(iGioiHanTC2PhanTheoGio3))
                                                                            {
                                                                                this.DGVTinhCong.Rows[addPhanTheoGio].Cells[13].Value = Math.Round((dTongThoiGianTangCaPhanTheoGio3 - Convert.ToDouble(iGioiHanTC1PhanTheoGio3)) * this.dTangCa2HeSo / 60.0, this.iLamTronGio);
                                                                                this.DGVTinhCong.Rows[addPhanTheoGio].Cells[14].Value = "0";
                                                                                this.DGVTinhCong.Rows[addPhanTheoGio].Cells[15].Value = "0";
                                                                            }
                                                                            else
                                                                            {
                                                                                this.DGVTinhCong.Rows[addPhanTheoGio].Cells[12].Value = Math.Round(Convert.ToDouble(iGioiHanTC1PhanTheoGio3) * this.dTangCa1HeSo / 60.0, this.iLamTronGio);
                                                                                this.DGVTinhCong.Rows[addPhanTheoGio].Cells[13].Value = Math.Round(Convert.ToDouble(iGioiHanTC2PhanTheoGio3) * this.dTangCa2HeSo / 60.0, this.iLamTronGio);
                                                                                this.DGVTinhCong.Rows[addPhanTheoGio].Cells[14].Value = Math.Round((dTongThoiGianTangCaPhanTheoGio3 - Convert.ToDouble(iGioiHanTC1PhanTheoGio3) - Convert.ToDouble(iGioiHanTC2PhanTheoGio3)) * this.dTangCa3HeSo / 60.0, this.iLamTronGio);
                                                                                this.DGVTinhCong.Rows[addPhanTheoGio].Cells[15].Value = "0";
                                                                            }
                                                                        }
                                                                    }
                                                                    if (iGioiHanTC1PhanTheoGio3 != 0 && iGioiHanTC2PhanTheoGio3 != 0 && iGioiHanTC3PhanTheoGio3 != 0 && iGioiHanTC4PhanTheoGio3 != 0)
                                                                    {
                                                                    }
                                                                }
                                                                else
                                                                {
                                                                    this.DGVTinhCong.Rows[addPhanTheoGio].Cells[12].Value = "0";
                                                                    this.DGVTinhCong.Rows[addPhanTheoGio].Cells[13].Value = "0";
                                                                    this.DGVTinhCong.Rows[addPhanTheoGio].Cells[14].Value = "0";
                                                                    this.DGVTinhCong.Rows[addPhanTheoGio].Cells[15].Value = "0";
                                                                }
                                                                string sTongGio14;
                                                                sTongGio14 = Math.Round(Convert.ToDouble(Convert.ToInt32((dGioRaPhanTheoGio - dGioVaoPhanTheoGio).TotalMinutes).ToString()) / 60.0, this.iLamTronGio).ToString();
                                                                this.DGVTinhCong.Rows[addPhanTheoGio].Cells[16].Value = sTongGio14;
                                                                this.DGVTinhCong.Rows[addPhanTheoGio].Cells[17].Value = dtCaLamViecPhanTheoGio2.Rows[iCaLamViecPhanTheoGio2]["CongTinh"].ToString();
                                                                this.DGVTinhCong.Rows[addPhanTheoGio].Cells[18].Value = this.sKHDungGio;
                                                            }
                                                            if (DateTimeProgress.XuatIDThu((int)dt.AddDays(dem).DayOfWeek) == "0")
                                                            {
                                                                this.DGVTinhCong.Rows[addPhanTheoGio].Cells[19].Value = "CN";
                                                            }
                                                            else
                                                            {
                                                                this.DGVTinhCong.Rows[addPhanTheoGio].Cells[19].Value = "NT";
                                                            }
                                                            this.DGVTinhCong.Rows[addPhanTheoGio].Cells[20].Value = this.sMaChamCong;
                                                            this.DGVTinhCong.Rows[addPhanTheoGio].Cells[21].Value = this.sPhongBanTinhCong;
                                                        }
                                                        break;
                                                    }
                                                }
                                                if (iCaTrongLIchtrinh5 == 0)
                                                {
                                                    this.DGVTinhCong.Rows[addPhanTheoGio].Cells[4].Value = ca;
                                                    this.DGVTinhCong.Rows[addPhanTheoGio].Cells[7].Value = "0";
                                                    this.DGVTinhCong.Rows[addPhanTheoGio].Cells[8].Value = "0";
                                                    this.DGVTinhCong.Rows[addPhanTheoGio].Cells[9].Value = "0";
                                                    this.DGVTinhCong.Rows[addPhanTheoGio].Cells[10].Value = "0";
                                                    this.DGVTinhCong.Rows[addPhanTheoGio].Cells[11].Value = "0";
                                                    this.DGVTinhCong.Rows[addPhanTheoGio].Cells[12].Value = "0";
                                                    this.DGVTinhCong.Rows[addPhanTheoGio].Cells[13].Value = "0";
                                                    this.DGVTinhCong.Rows[addPhanTheoGio].Cells[14].Value = "0";
                                                    this.DGVTinhCong.Rows[addPhanTheoGio].Cells[15].Value = "0";
                                                    this.DGVTinhCong.Rows[addPhanTheoGio].Cells[16].Value = "0";
                                                    this.DGVTinhCong.Rows[addPhanTheoGio].Cells[17].Value = "0";
                                                    this.DGVTinhCong.Rows[addPhanTheoGio].Cells[18].Value = this.sKHVang;
                                                    if (DateTimeProgress.XuatIDThu((int)dt.AddDays(dem).DayOfWeek) == "0")
                                                    {
                                                        this.DGVTinhCong.Rows[addPhanTheoGio].Cells[19].Value = "CN";
                                                    }
                                                    else
                                                    {
                                                        this.DGVTinhCong.Rows[addPhanTheoGio].Cells[19].Value = "NT";
                                                    }
                                                    this.DGVTinhCong.Rows[addPhanTheoGio].Cells[20].Value = this.sMaChamCong;
                                                    this.DGVTinhCong.Rows[addPhanTheoGio].Cells[21].Value = this.sPhongBanTinhCong;
                                                }
                                                break;
                                            }
                                        case 3:
                                            {
                                                int addPhanTheoGioB;
                                                addPhanTheoGioB = this.DGVTinhCong.Rows.Add();
                                                this.DGVTinhCong.Rows[addPhanTheoGioB].Cells[6].Value = string.Format(this.sDinhDangThoiGian, dGioChamPhanTheoGio);
                                                this.DGVTinhCong.Rows[addPhanTheoGioB].Cells[0].Value = this.sMaNhanVien;
                                                this.DGVTinhCong.Rows[addPhanTheoGioB].Cells[1].Value = this.sTenNhanVien;
                                                this.DGVTinhCong.Rows[addPhanTheoGioB].Cells[2].Value = this.DGVTinhCong.Rows[_nhanVien].Cells[2].Value.ToString();
                                                this.DGVTinhCong.Rows[addPhanTheoGioB].Cells[4].Value = ca;
                                                this.DGVTinhCong.Rows[addPhanTheoGioB].Cells[7].Value = "0";
                                                this.DGVTinhCong.Rows[addPhanTheoGioB].Cells[8].Value = "0";
                                                this.DGVTinhCong.Rows[addPhanTheoGioB].Cells[9].Value = "0";
                                                this.DGVTinhCong.Rows[addPhanTheoGioB].Cells[10].Value = "0";
                                                this.DGVTinhCong.Rows[addPhanTheoGioB].Cells[11].Value = "0";
                                                this.DGVTinhCong.Rows[addPhanTheoGioB].Cells[12].Value = "0";
                                                this.DGVTinhCong.Rows[addPhanTheoGioB].Cells[13].Value = "0";
                                                this.DGVTinhCong.Rows[addPhanTheoGioB].Cells[14].Value = "0";
                                                this.DGVTinhCong.Rows[addPhanTheoGioB].Cells[15].Value = "0";
                                                this.DGVTinhCong.Rows[addPhanTheoGioB].Cells[16].Value = "0";
                                                this.DGVTinhCong.Rows[addPhanTheoGioB].Cells[17].Value = "0";
                                                this.DGVTinhCong.Rows[addPhanTheoGioB].Cells[18].Value = this.sKHVang;
                                                this.DGVTinhCong.Rows[addPhanTheoGioB].Cells[3].Value = DateTimeProgress.XuatThuTinhCong((int)dt.AddDays(dem).DayOfWeek);
                                                this.DGVTinhCong.Rows[addPhanTheoGioB].Cells[20].Value = this.sMaChamCong;
                                                this.DGVTinhCong.Rows[addPhanTheoGioB].Cells[21].Value = this.sPhongBanTinhCong;
                                                break;
                                            }
                                        default:
                                            continue;
                                    }
                                    break;
                                }
                                demPhanTheoGio++;
                            }
                            if (demPhanTheoGio == 0)
                            {
                                this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = "0";
                                this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = "0";
                                this.DGVTinhCong.Rows[_nhanVien].Cells[17].Value = "0";
                                this.DGVTinhCong.Rows[_nhanVien].Cells[18].Value = this.sKHVang;
                                if (DateTimeProgress.XuatIDThu((int)dt.AddDays(dem).DayOfWeek) == "0")
                                {
                                    this.DGVTinhCong.Rows[_nhanVien].Cells[19].Value = "CN";
                                }
                                else
                                {
                                    this.DGVTinhCong.Rows[_nhanVien].Cells[19].Value = "NT";
                                }
                                this.DGVTinhCong.Rows[_nhanVien].Cells[20].Value = this.sMaChamCong;
                                this.DGVTinhCong.Rows[_nhanVien].Cells[21].Value = this.sPhongBanTinhCong;
                            }
                        }
                        if (iChonLichTrinh == 4)
                        {
                            int iKiemTraLanChamLichTrinhVaoRa3;
                            iKiemTraLanChamLichTrinhVaoRa3 = 0;
                            int iKiemTraLanChamKhoangCachTuDongQuaDemLichTrinhVaoRa3;
                            iKiemTraLanChamKhoangCachTuDongQuaDemLichTrinhVaoRa3 = 0;
                            DateTime dGioVaoTuDongQuaDemKiemTraLichTrinhVaoRa3;
                            dGioVaoTuDongQuaDemKiemTraLichTrinhVaoRa3 = default(DateTime);
                            DateTime dGioRaTuDongQuaDemKiemTraLichTrinhVaoRa3;
                            dGioRaTuDongQuaDemKiemTraLichTrinhVaoRa3 = default(DateTime);
                            int iLanCham2;
                            iLanCham2 = 1;
                            int addTheoIDMay;
                            addTheoIDMay = 0;
                            int iKiemTra2;
                            iKiemTra2 = 0;
                            int iKiemTraB2;
                            iKiemTraB2 = 0;
                            DateTime dGioVaoTheoIDMay;
                            dGioVaoTheoIDMay = default(DateTime);
                            new DataTable();
                            DataTable dtTheoIDMay;
                            dtTheoIDMay = this._checkInOutBLL.getCheckInOutByMaChamCongAndNgayCham(Convert.ToInt32(this.sMaChamCong), Convert.ToDateTime(this.DGVTinhCong.Rows[_nhanVien].Cells[2].Value.ToString()));
                            for (int iTheoIDMay = 0; iTheoIDMay < dtTheoIDMay.Rows.Count; iTheoIDMay++)
                            {
                                iKiemTraLanChamLichTrinhVaoRa3++;
                                if (iKiemTraLanChamLichTrinhVaoRa3 == 1)
                                {
                                    dGioVaoTuDongQuaDemKiemTraLichTrinhVaoRa3 = Convert.ToDateTime(dtTheoIDMay.Rows[iTheoIDMay]["GioCham"].ToString());
                                    if (dtTheoIDMay.Rows.Count > 2 && iKiemTraLanChamKhoangCachTuDongQuaDemLichTrinhVaoRa3 == 3)
                                    {
                                        if (Convert.ToInt32(Convert.ToInt32((dGioVaoTuDongQuaDemKiemTraLichTrinhVaoRa3 - dGioRaTuDongQuaDemKiemTraLichTrinhVaoRa3).TotalMinutes).ToString()) < iKhoangCachGiuaHaiCapVaoRa)
                                        {
                                            iKiemTraLanChamLichTrinhVaoRa3 = 0;
                                            continue;
                                        }
                                        iKiemTraLanChamLichTrinhVaoRa3 = 1;
                                    }
                                }
                                if (iKiemTraLanChamLichTrinhVaoRa3 == 2)
                                {
                                    dGioRaTuDongQuaDemKiemTraLichTrinhVaoRa3 = Convert.ToDateTime(dtTheoIDMay.Rows[iTheoIDMay]["GioCham"].ToString());
                                    if (Convert.ToInt32(Convert.ToInt32((dGioRaTuDongQuaDemKiemTraLichTrinhVaoRa3 - dGioVaoTuDongQuaDemKiemTraLichTrinhVaoRa3).TotalMinutes).ToString()) < iThoiGianNhoNhat)
                                    {
                                        iKiemTraLanChamLichTrinhVaoRa3 = 1;
                                        continue;
                                    }
                                    iKiemTraLanChamLichTrinhVaoRa3 = 0;
                                    iKiemTraLanChamKhoangCachTuDongQuaDemLichTrinhVaoRa3 = 3;
                                }
                                DateTime dateGioChamTheoIDMay;
                                dateGioChamTheoIDMay = Convert.ToDateTime(dtTheoIDMay.Rows[iTheoIDMay]["GioCham"].ToString());
                                int iMaSoMay;
                                iMaSoMay = Convert.ToInt32(dtTheoIDMay.Rows[iTheoIDMay]["MaSoMay"].ToString());
                                if (iMaSoMay == 1 || iMaSoMay == 3 || iMaSoMay == 5 || iMaSoMay == 7 || iMaSoMay == 9)
                                {
                                    if (iLanCham2 == 1)
                                    {
                                        dGioVaoTheoIDMay = Convert.ToDateTime(dateGioChamTheoIDMay.ToString());
                                        this.DGVTinhCong.Rows[_nhanVien].Cells[4].Value = ca;
                                        this.DGVTinhCong.Rows[_nhanVien].Cells[5].Value = string.Format(this.sDinhDangThoiGian, dGioVaoTheoIDMay);
                                        this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = "0";
                                        this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = "0";
                                        this.DGVTinhCong.Rows[_nhanVien].Cells[17].Value = "0";
                                        this.DGVTinhCong.Rows[_nhanVien].Cells[18].Value = this.sKHVang;
                                        if (DateTimeProgress.XuatIDThu((int)dt.AddDays(dem).DayOfWeek) == "0")
                                        {
                                            this.DGVTinhCong.Rows[_nhanVien].Cells[19].Value = "CN";
                                        }
                                        else
                                        {
                                            this.DGVTinhCong.Rows[_nhanVien].Cells[19].Value = "NT";
                                        }
                                        this.DGVTinhCong.Rows[_nhanVien].Cells[20].Value = this.sMaChamCong;
                                        this.DGVTinhCong.Rows[_nhanVien].Cells[21].Value = this.sPhongBanTinhCong;
                                        iKiemTra2 = 1;
                                    }
                                    else
                                    {
                                        addTheoIDMay = this.DGVTinhCong.Rows.Add();
                                        dGioVaoTheoIDMay = Convert.ToDateTime(dateGioChamTheoIDMay.ToString());
                                        this.DGVTinhCong.Rows[addTheoIDMay].Cells[5].Value = string.Format(this.sDinhDangThoiGian, dGioVaoTheoIDMay);
                                        iKiemTraB2 = 1;
                                        this.DGVTinhCong.Rows[addTheoIDMay].Cells[0].Value = this.sMaNhanVien;
                                        this.DGVTinhCong.Rows[addTheoIDMay].Cells[1].Value = this.sTenNhanVien;
                                        this.DGVTinhCong.Rows[addTheoIDMay].Cells[2].Value = this.DGVTinhCong.Rows[_nhanVien].Cells[2].Value.ToString();
                                        this.DGVTinhCong.Rows[addTheoIDMay].Cells[4].Value = ca;
                                        this.DGVTinhCong.Rows[addTheoIDMay].Cells[7].Value = "0";
                                        this.DGVTinhCong.Rows[addTheoIDMay].Cells[8].Value = "0";
                                        this.DGVTinhCong.Rows[addTheoIDMay].Cells[3].Value = DateTimeProgress.XuatThuTinhCong((int)dt.AddDays(dem).DayOfWeek);
                                        this.DGVTinhCong.Rows[addTheoIDMay].Cells[17].Value = "0";
                                        this.DGVTinhCong.Rows[addTheoIDMay].Cells[18].Value = this.sKHVang;
                                        if (DateTimeProgress.XuatIDThu((int)dt.AddDays(dem).DayOfWeek) == "0")
                                        {
                                            this.DGVTinhCong.Rows[addTheoIDMay].Cells[19].Value = "CN";
                                        }
                                        else
                                        {
                                            this.DGVTinhCong.Rows[addTheoIDMay].Cells[19].Value = "NT";
                                        }
                                        this.DGVTinhCong.Rows[addTheoIDMay].Cells[20].Value = this.sMaChamCong;
                                        this.DGVTinhCong.Rows[addTheoIDMay].Cells[21].Value = this.sPhongBanTinhCong;
                                    }
                                }
                                else
                                {
                                    if ((iKiemTra2 == 1 && iLanCham2 == 2) || iLanCham2 == 1)
                                    {
                                        DateTime dGioRaTheoIDMay;
                                        if (iKiemTra2 == 0 && iLanCham2 == 1)
                                        {
                                            if (_nhanVien == 0 && iKiemTraNhanVien == 1)
                                            {
                                                dGioRaTheoIDMay = Convert.ToDateTime(dateGioChamTheoIDMay.ToString());
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[6].Value = string.Format(this.sDinhDangThoiGian, dGioRaTheoIDMay);
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[20].Value = this.sMaChamCong;
                                                iLanCham2++;
                                                continue;
                                            }
                                            if (_nhanVien != 0 && this.sMaChamCong != this.DGVTinhCong.Rows[_nhanVien - 1].Cells[20].Value.ToString())
                                            {
                                                dGioRaTheoIDMay = Convert.ToDateTime(dateGioChamTheoIDMay.ToString());
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[6].Value = string.Format(this.sDinhDangThoiGian, dGioRaTheoIDMay);
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[20].Value = this.sMaChamCong;
                                                iLanCham2++;
                                                continue;
                                            }
                                            if (_nhanVien == 0)
                                            {
                                                dGioRaTheoIDMay = Convert.ToDateTime(dateGioChamTheoIDMay.ToString());
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[6].Value = string.Format(this.sDinhDangThoiGian, dGioRaTheoIDMay);
                                                iLanCham2++;
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[4].Value = ca;
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[11].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[16].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[17].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[18].Value = this.sKHVang;
                                                if (DateTimeProgress.XuatIDThu((int)dt.AddDays(dem).DayOfWeek) == "0")
                                                {
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[19].Value = "CN";
                                                }
                                                else
                                                {
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[19].Value = "NT";
                                                }
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[20].Value = this.sMaChamCong;
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[21].Value = this.sPhongBanTinhCong;
                                                continue;
                                            }
                                            if (this.DGVTinhCong.Rows[_nhanVien - 1].Cells[5].Value != null && this.DGVTinhCong.Rows[_nhanVien - 1].Cells[6].Value == null)
                                            {
                                                DateTime dGioNgayHomTruoc3;
                                                dGioNgayHomTruoc3 = default(DateTime);
                                                DateTime dNgayTruocTheoIDMay;
                                                dNgayTruocTheoIDMay = Convert.ToDateTime(dt.AddDays(dem - 1).ToString());
                                                new DataTable();
                                                DataTable dtNgayTruocTheoIDMay;
                                                dtNgayTruocTheoIDMay = this._checkInOutBLL.getCheckInOutByMaChamCongAndNgayCham(Convert.ToInt32(this.sMaChamCong), dNgayTruocTheoIDMay);
                                                for (int iNgayTruocTheoIDMay = 0; iNgayTruocTheoIDMay < dtNgayTruocTheoIDMay.Rows.Count; iNgayTruocTheoIDMay++)
                                                {
                                                    dGioNgayHomTruoc3 = Convert.ToDateTime(dtNgayTruocTheoIDMay.Rows[iNgayTruocTheoIDMay]["GioCham"].ToString());
                                                }
                                                dGioRaTheoIDMay = Convert.ToDateTime(dateGioChamTheoIDMay.ToString());
                                                this.DGVTinhCong.Rows[_nhanVien - 1].Cells[6].Value = string.Format(this.sDinhDangThoiGian, dGioRaTheoIDMay);
                                                new DataTable();
                                                this._chiTietLichTrinhChoCalamViecDTO.MaLichTrinhCaLamViec = sLTCCLVNhanVien;
                                                this._chiTietLichTrinhChoCalamViecDTO.Thu = sThu;
                                                DataTable dtNhanCaQuaDemTheoIDMay;
                                                dtNhanCaQuaDemTheoIDMay = this._chiTietLichTrinhChoCaLamViecBLL.ChiTietLichTrinhChoCaLamViecNhanCa(this._chiTietLichTrinhChoCalamViecDTO);
                                                int iChiTietLichTrinhChoCaLamViecQuaDemTheoIDMay;
                                                iChiTietLichTrinhChoCaLamViecQuaDemTheoIDMay = 0;
                                                if (iChiTietLichTrinhChoCaLamViecQuaDemTheoIDMay >= dtNhanCaQuaDemTheoIDMay.Rows.Count)
                                                {
                                                    continue;
                                                }
                                                int cellChiTietLichTrinhChoCaLamViecQuaDemTheoIDMay;
                                                cellChiTietLichTrinhChoCaLamViecQuaDemTheoIDMay = 3;
                                                while (true)
                                                {
                                                    if (cellChiTietLichTrinhChoCaLamViecQuaDemTheoIDMay < 13)
                                                    {
                                                        kiemTraVao = 0;
                                                        kiemTraRa = 0;
                                                        this.sTheoIDMayMaCaLamViec = dtNhanCaQuaDemTheoIDMay.Rows[iChiTietLichTrinhChoCaLamViecQuaDemTheoIDMay][cellChiTietLichTrinhChoCaLamViecQuaDemTheoIDMay].ToString();
                                                        new DataTable();
                                                        DataTable dtTheoIDMayCa1;
                                                        dtTheoIDMayCa1 = this._caLamViecBLL.CaLamViecGetByMaCaLamViec(sTheoIDMayMaCaLamViec);
                                                        int iTheoIDMayCa1;
                                                        iTheoIDMayCa1 = 0;
                                                        while (iTheoIDMayCa1 < dtTheoIDMayCa1.Rows.Count)
                                                        {
                                                            this.sTheoIDMayTenCaLamViec = dtTheoIDMayCa1.Rows[iTheoIDMayCa1]["CaLamViec"].ToString();
                                                            DateTime dBatDauVaoTheoIDMayB;
                                                            dBatDauVaoTheoIDMayB = Convert.ToDateTime(sNgayCham + " " + string.Format("{0:T}", Convert.ToDateTime(dtTheoIDMayCa1.Rows[iTheoIDMayCa1]["BatDauVao"].ToString()))).AddDays(-1.0);
                                                            DateTime dKetThucVaoTheoIDMayB;
                                                            dKetThucVaoTheoIDMayB = Convert.ToDateTime(sNgayCham + " " + string.Format("{0:T}", Convert.ToDateTime(dtTheoIDMayCa1.Rows[iTheoIDMayCa1]["KetThucVao"].ToString()))).AddDays(-1.0);
                                                            string sBatDauRaTheoIDMayA;
                                                            sBatDauRaTheoIDMayA = string.Format("{0:T}", Convert.ToDateTime(dtTheoIDMayCa1.Rows[iTheoIDMayCa1]["BatDauRa"].ToString()));
                                                            string sBatDauRaTheoIDMayB;
                                                            sBatDauRaTheoIDMayB = sNgayCham + " " + sBatDauRaTheoIDMayA;
                                                            DateTime dBatDauRaTheoIDMayB;
                                                            dBatDauRaTheoIDMayB = Convert.ToDateTime(sBatDauRaTheoIDMayB).AddDays(-1.0);
                                                            dBatDauRaTheoIDMayB = ((!(sBatDauRaTheoIDMayA == "12:01:00 AM")) ? Convert.ToDateTime(sBatDauRaTheoIDMayB) : Convert.ToDateTime(dBatDauRaTheoIDMayB.AddDays(1.0).ToString()));
                                                            string sKetThucRaTheoIDMayB;
                                                            sKetThucRaTheoIDMayB = sNgayCham + " " + string.Format("{0:T}", Convert.ToDateTime(dtTheoIDMayCa1.Rows[iTheoIDMayCa1]["KetThucRa"].ToString()));
                                                            DateTime dKetThucRaTheoIDMayB;
                                                            dKetThucRaTheoIDMayB = Convert.ToDateTime(sKetThucRaTheoIDMayB).AddDays(-1.0);
                                                            dKetThucRaTheoIDMayB = ((!(sBatDauRaTheoIDMayA == "12:01:00 AM")) ? Convert.ToDateTime(sKetThucRaTheoIDMayB) : Convert.ToDateTime(dKetThucRaTheoIDMayB.AddDays(1.0).ToString()));
                                                            if (dGioNgayHomTruoc3 >= dBatDauVaoTheoIDMayB && dGioNgayHomTruoc3 <= dKetThucVaoTheoIDMayB)
                                                            {
                                                                kiemTraVao++;
                                                            }
                                                            if (dGioRaTheoIDMay >= dBatDauRaTheoIDMayB && dGioRaTheoIDMay <= dKetThucRaTheoIDMayB)
                                                            {
                                                                kiemTraRa++;
                                                            }
                                                            if (kiemTraVao != 1 || kiemTraRa != 1)
                                                            {
                                                                iTheoIDMayCa1++;
                                                                continue;
                                                            }
                                                            goto IL_1ee6a;
                                                        }
                                                        if (!(this.sTheoIDMayMaCaLamViec == ""))
                                                        {
                                                            cellChiTietLichTrinhChoCaLamViecQuaDemTheoIDMay++;
                                                            continue;
                                                        }
                                                        this.DGVTinhCong.Rows[_nhanVien - 1].Cells[4].Value = ca;
                                                        this.DGVTinhCong.Rows[_nhanVien - 1].Cells[7].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien - 1].Cells[8].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien - 1].Cells[9].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien - 1].Cells[10].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien - 1].Cells[11].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien - 1].Cells[12].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien - 1].Cells[13].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien - 1].Cells[14].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien - 1].Cells[15].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien - 1].Cells[16].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien - 1].Cells[17].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien - 1].Cells[18].Value = this.sKHVang;
                                                        if (DateTimeProgress.XuatThuQuaDem((int)dt.AddDays(dem).DayOfWeek) == "1")
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien - 1].Cells[19].Value = "CN";
                                                        }
                                                        else
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien - 1].Cells[19].Value = "NT";
                                                        }
                                                        this.DGVTinhCong.Rows[_nhanVien - 1].Cells[20].Value = this.sMaChamCong;
                                                        this.DGVTinhCong.Rows[_nhanVien - 1].Cells[21].Value = this.sPhongBanTinhCong;
                                                        break;
                                                    }
                                                    goto IL_1ee6a;
                                                IL_1ee6a:
                                                    this.DGVTinhCong.Rows[_nhanVien - 1].Cells[4].Value = this.sTheoIDMayTenCaLamViec;
                                                    new DataTable();
                                                    DataTable dtThongSoCaLamViecTheoIDMay;
                                                    dtThongSoCaLamViecTheoIDMay = this._caLamViecBLL.CaLamViecGetByMaCaLamViec(sTheoIDMayMaCaLamViec);
                                                    for (int iThongSoCaLamViecTheoIDMay = 0; iThongSoCaLamViecTheoIDMay < dtThongSoCaLamViecTheoIDMay.Rows.Count; iThongSoCaLamViecTheoIDMay++)
                                                    {
                                                        double dTongGioTheoIDMay;
                                                        dTongGioTheoIDMay = Math.Round(Convert.ToDouble(Convert.ToInt32((dGioRaTheoIDMay - dGioNgayHomTruoc3).TotalMinutes)) / 60.0, this.iLamTronGio);
                                                        this.DGVTinhCong.Rows[_nhanVien - 1].Cells[16].Value = dTongGioTheoIDMay.ToString();
                                                        this.DGVTinhCong.Rows[_nhanVien - 1].Cells[17].Value = dtThongSoCaLamViecTheoIDMay.Rows[iThongSoCaLamViecTheoIDMay]["CongTinh"].ToString();
                                                        string sGiayGioVao31;
                                                        sGiayGioVao31 = dGioNgayHomTruoc3.Second.ToString();
                                                        string sGiayGioRa31;
                                                        sGiayGioRa31 = dGioRaTheoIDMay.Second.ToString();
                                                        string sGioVaoKhaiBaoTheoIDMayB;
                                                        sGioVaoKhaiBaoTheoIDMayB = sNgayCham + " " + string.Format("{0:T}", Convert.ToDateTime(dtThongSoCaLamViecTheoIDMay.Rows[iThongSoCaLamViecTheoIDMay]["GioVaoLamViec"].ToString())).Replace("00 ", sGiayGioVao31 + " ");
                                                        string sGioRaKhaiBaoTheoIDMayB;
                                                        sGioRaKhaiBaoTheoIDMayB = sNgayCham + " " + string.Format("{0:T}", Convert.ToDateTime(dtThongSoCaLamViecTheoIDMay.Rows[iThongSoCaLamViecTheoIDMay]["GioKetThucLamViec"].ToString())).Replace("00 ", sGiayGioRa31 + " ");
                                                        string sCatChuoi4;
                                                        sCatChuoi4 = sGioRaKhaiBaoTheoIDMayB.Substring(sGioRaKhaiBaoTheoIDMayB.Length - 2);
                                                        string sTruGioDiTre25;
                                                        sTruGioDiTre25 = dtThongSoCaLamViecTheoIDMay.Rows[iThongSoCaLamViecTheoIDMay]["TruGioDiTre"].ToString();
                                                        string sBatDauTinhDiTre25;
                                                        sBatDauTinhDiTre25 = dtThongSoCaLamViecTheoIDMay.Rows[iThongSoCaLamViecTheoIDMay]["BatDauTinhDiTre"].ToString();
                                                        if (sTruGioDiTre25 == "True")
                                                        {
                                                            int iChoPhepTreTheoIDMay;
                                                            iChoPhepTreTheoIDMay = Convert.ToInt32(dtThongSoCaLamViecTheoIDMay.Rows[iThongSoCaLamViecTheoIDMay]["ChoPhepDiTre"].ToString());
                                                            if (sBatDauTinhDiTre25 == "True")
                                                            {
                                                                int iPhutTreTheoIDMay;
                                                                iPhutTreTheoIDMay = Convert.ToInt32((dGioNgayHomTruoc3 - Convert.ToDateTime(sGioVaoKhaiBaoTheoIDMayB).AddDays(-1.0)).TotalMinutes) - iChoPhepTreTheoIDMay;
                                                                if (iPhutTreTheoIDMay > 0)
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien - 1].Cells[5].Style.BackColor = Color.Lime;
                                                                    this.DGVTinhCong.Rows[_nhanVien - 1].Cells[9].Value = iPhutTreTheoIDMay.ToString();
                                                                }
                                                                else
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien - 1].Cells[9].Value = "0";
                                                                }
                                                            }
                                                            else if (Convert.ToInt32((dGioNgayHomTruoc3 - Convert.ToDateTime(sGioVaoKhaiBaoTheoIDMayB).AddDays(-1.0)).TotalMinutes) - iChoPhepTreTheoIDMay > 0)
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien - 1].Cells[9].Value = Convert.ToInt32((dGioNgayHomTruoc3 - Convert.ToDateTime(sGioVaoKhaiBaoTheoIDMayB).AddDays(-1.0)).TotalMinutes).ToString();
                                                            }
                                                            else
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien - 1].Cells[9].Value = "0";
                                                            }
                                                        }
                                                        else
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien - 1].Cells[9].Value = "0";
                                                        }
                                                        string sTruGioVeSom25;
                                                        sTruGioVeSom25 = dtThongSoCaLamViecTheoIDMay.Rows[iThongSoCaLamViecTheoIDMay]["TruGioVeSom"].ToString();
                                                        string sBatDauTinhVeSom25;
                                                        sBatDauTinhVeSom25 = dtThongSoCaLamViecTheoIDMay.Rows[iThongSoCaLamViecTheoIDMay]["BatDauTinhVeSom"].ToString();
                                                        if (sTruGioVeSom25 == "True")
                                                        {
                                                            int iChoPhepVeSomTheoIDMay;
                                                            iChoPhepVeSomTheoIDMay = Convert.ToInt32(dtThongSoCaLamViecTheoIDMay.Rows[iThongSoCaLamViecTheoIDMay]["ChoPhepVeSom"].ToString());
                                                            if (sBatDauTinhVeSom25 == "True")
                                                            {
                                                                if (sCatChuoi4 == "PM")
                                                                {
                                                                    int iPhutVeSomTheoIDMay;
                                                                    iPhutVeSomTheoIDMay = Convert.ToInt32((Convert.ToDateTime(sGioRaKhaiBaoTheoIDMayB).AddDays(-1.0) - dGioRaTheoIDMay).TotalMinutes) - iChoPhepVeSomTheoIDMay;
                                                                    if (iPhutVeSomTheoIDMay > 0)
                                                                    {
                                                                        this.DGVTinhCong.Rows[_nhanVien - 1].Cells[6].Style.BackColor = Color.Yellow;
                                                                        this.DGVTinhCong.Rows[_nhanVien - 1].Cells[10].Value = iPhutVeSomTheoIDMay.ToString();
                                                                    }
                                                                    else
                                                                    {
                                                                        this.DGVTinhCong.Rows[_nhanVien - 1].Cells[10].Value = "0";
                                                                    }
                                                                }
                                                                else
                                                                {
                                                                    int iPhutVeSomTheoIDMay2;
                                                                    iPhutVeSomTheoIDMay2 = Convert.ToInt32((Convert.ToDateTime(sGioRaKhaiBaoTheoIDMayB) - dGioRaTheoIDMay).TotalMinutes) - iChoPhepVeSomTheoIDMay;
                                                                    if (iPhutVeSomTheoIDMay2 > 0)
                                                                    {
                                                                        this.DGVTinhCong.Rows[_nhanVien - 1].Cells[6].Style.BackColor = Color.Yellow;
                                                                        this.DGVTinhCong.Rows[_nhanVien - 1].Cells[10].Value = iPhutVeSomTheoIDMay2.ToString();
                                                                    }
                                                                    else
                                                                    {
                                                                        this.DGVTinhCong.Rows[_nhanVien - 1].Cells[10].Value = "0";
                                                                    }
                                                                }
                                                            }
                                                            else if (Convert.ToInt32((Convert.ToDateTime(sGioRaKhaiBaoTheoIDMayB) - dGioRaTheoIDMay).TotalMinutes) - iChoPhepVeSomTheoIDMay > 0)
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien - 1].Cells[10].Value = Convert.ToInt32((Convert.ToDateTime(sGioRaKhaiBaoTheoIDMayB) - dGioRaTheoIDMay).TotalMinutes).ToString();
                                                            }
                                                            else
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien - 1].Cells[10].Value = "0";
                                                            }
                                                        }
                                                        else
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien - 1].Cells[10].Value = "0";
                                                        }
                                                        if (sCatChuoi4 == "PM")
                                                        {
                                                            int iPhutVeTre7;
                                                            iPhutVeTre7 = Convert.ToInt32((dGioRaTheoIDMay - Convert.ToDateTime(sGioRaKhaiBaoTheoIDMayB).AddDays(-1.0)).TotalMinutes);
                                                            if (iPhutVeTre7 > 0)
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien - 1].Cells[11].Value = iPhutVeTre7;
                                                            }
                                                            else
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien - 1].Cells[11].Value = "0";
                                                            }
                                                        }
                                                        else
                                                        {
                                                            int iPhutVeTre8;
                                                            iPhutVeTre8 = Convert.ToInt32((dGioRaTheoIDMay - Convert.ToDateTime(sGioRaKhaiBaoTheoIDMayB)).TotalMinutes);
                                                            if (iPhutVeTre8 > 0)
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien - 1].Cells[11].Value = iPhutVeTre8;
                                                            }
                                                            else
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien - 1].Cells[11].Value = "0";
                                                            }
                                                        }
                                                        double dTongGioTrongCaTheoIDMay;
                                                        dTongGioTrongCaTheoIDMay = Convert.ToDouble(dtThongSoCaLamViecTheoIDMay.Rows[iThongSoCaLamViecTheoIDMay]["TongGioTrongCaLamViec"].ToString());
                                                        double dTongCongTrongCaTheoIDMay;
                                                        dTongCongTrongCaTheoIDMay = Convert.ToDouble(dtThongSoCaLamViecTheoIDMay.Rows[iThongSoCaLamViecTheoIDMay]["CongTinh"].ToString());
                                                        double dTongPhutTreSomTheoIDMay;
                                                        dTongPhutTreSomTheoIDMay = Convert.ToDouble(this.DGVTinhCong.Rows[_nhanVien - 1].Cells[9].Value.ToString()) + Convert.ToDouble(this.DGVTinhCong.Rows[_nhanVien - 1].Cells[10].Value.ToString());
                                                        this.DGVTinhCong.Rows[_nhanVien - 1].Cells[8].Value = Math.Round((dTongGioTrongCaTheoIDMay * 60.0 - dTongPhutTreSomTheoIDMay) / 60.0, this.iLamTronGio);
                                                        this.DGVTinhCong.Rows[_nhanVien - 1].Cells[7].Value = Math.Round(Convert.ToDouble(this.DGVTinhCong.Rows[_nhanVien - 1].Cells[8].Value.ToString()) * dTongCongTrongCaTheoIDMay / dTongGioTrongCaTheoIDMay, this.iLamTronCong);
                                                        string sChoPhepTangCaTruocGioLamViecTheoIDMay;
                                                        sChoPhepTangCaTruocGioLamViecTheoIDMay = dtThongSoCaLamViecTheoIDMay.Rows[iThongSoCaLamViecTheoIDMay]["TangCaTruocGioLamViec"].ToString();
                                                        int iPhutTangCaTruocGioLamViecTheoIDMay;
                                                        iPhutTangCaTruocGioLamViecTheoIDMay = Convert.ToInt32(dtThongSoCaLamViecTheoIDMay.Rows[iThongSoCaLamViecTheoIDMay]["SoPhutTangCaTruocGioLamViec"].ToString());
                                                        int iPhutTangCaTruocGioLamViecDatDen22;
                                                        iPhutTangCaTruocGioLamViecDatDen22 = Convert.ToInt32(dtThongSoCaLamViecTheoIDMay.Rows[iThongSoCaLamViecTheoIDMay]["TangCaTruocGioLamViecDatDen"].ToString());
                                                        int iPhutTruTangCaTruoc22;
                                                        iPhutTruTangCaTruoc22 = Convert.ToInt32(dtThongSoCaLamViecTheoIDMay.Rows[iThongSoCaLamViecTheoIDMay]["PhutTruTangCaTruoc"].ToString());
                                                        string sChoPhepTangCaSauGioLamViecTheoIDMay;
                                                        sChoPhepTangCaSauGioLamViecTheoIDMay = dtThongSoCaLamViecTheoIDMay.Rows[iThongSoCaLamViecTheoIDMay]["TangCaSauGioLamViec"].ToString();
                                                        int iPhutTangCaSauGioLamViecTheoIDMay;
                                                        iPhutTangCaSauGioLamViecTheoIDMay = Convert.ToInt32(dtThongSoCaLamViecTheoIDMay.Rows[iThongSoCaLamViecTheoIDMay]["SoPhutTangCaSauGioLamViec"].ToString());
                                                        int iPhutTangCaSauGioLamViecDatDen22;
                                                        iPhutTangCaSauGioLamViecDatDen22 = Convert.ToInt32(dtThongSoCaLamViecTheoIDMay.Rows[iThongSoCaLamViecTheoIDMay]["TangCaSauGioLamViecDatDen"].ToString());
                                                        int iPhutTruTangCaSau22;
                                                        iPhutTruTangCaSau22 = Convert.ToInt32(dtThongSoCaLamViecTheoIDMay.Rows[iThongSoCaLamViecTheoIDMay]["PhutTruTangCaSau"].ToString());
                                                        int iGioiHanTC1TheoIDMay;
                                                        iGioiHanTC1TheoIDMay = Convert.ToInt32(dtThongSoCaLamViecTheoIDMay.Rows[iThongSoCaLamViecTheoIDMay]["GioiHanTangCa1"].ToString());
                                                        int iGioiHanTC2TheoIDMay;
                                                        iGioiHanTC2TheoIDMay = Convert.ToInt32(dtThongSoCaLamViecTheoIDMay.Rows[iThongSoCaLamViecTheoIDMay]["GioiHanTangCa2"].ToString());
                                                        int iGioiHanTC3TheoIDMay;
                                                        iGioiHanTC3TheoIDMay = Convert.ToInt32(dtThongSoCaLamViecTheoIDMay.Rows[iThongSoCaLamViecTheoIDMay]["GioiHanTangCa3"].ToString());
                                                        int iGioiHanTC4TheoIDMay;
                                                        iGioiHanTC4TheoIDMay = Convert.ToInt32(dtThongSoCaLamViecTheoIDMay.Rows[iThongSoCaLamViecTheoIDMay]["GioiHanTangCa4"].ToString());
                                                        int iTongGioTangCaSauTheoIDMay;
                                                        iTongGioTangCaSauTheoIDMay = 0;
                                                        int iTongGioTangCaTruocTheoIDMay;
                                                        iTongGioTangCaTruocTheoIDMay = 0;
                                                        if (sChoPhepTangCaTruocGioLamViecTheoIDMay == "False" && sChoPhepTangCaSauGioLamViecTheoIDMay == "False")
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien - 1].Cells[12].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien - 1].Cells[13].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien - 1].Cells[14].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien - 1].Cells[15].Value = "0";
                                                        }
                                                        else
                                                        {
                                                            if (sChoPhepTangCaTruocGioLamViecTheoIDMay == "True")
                                                            {
                                                                int iThoiGianTruocGioLamTheoIDMay;
                                                                iThoiGianTruocGioLamTheoIDMay = Convert.ToInt32(Convert.ToInt32((Convert.ToDateTime(sGioVaoKhaiBaoTheoIDMayB).AddDays(-1.0) - dGioNgayHomTruoc3).TotalMinutes).ToString());
                                                                if (iThoiGianTruocGioLamTheoIDMay > 0 && iThoiGianTruocGioLamTheoIDMay > iPhutTangCaTruocGioLamViecTheoIDMay && iThoiGianTruocGioLamTheoIDMay > iPhutTangCaTruocGioLamViecDatDen22)
                                                                {
                                                                    iTongGioTangCaTruocTheoIDMay = iThoiGianTruocGioLamTheoIDMay - iPhutTruTangCaTruoc22;
                                                                }
                                                            }
                                                            if (sChoPhepTangCaSauGioLamViecTheoIDMay == "True")
                                                            {
                                                                if (sCatChuoi4 == "PM")
                                                                {
                                                                    int iThoiGianSauGioLamViecTheoIDMay;
                                                                    iThoiGianSauGioLamViecTheoIDMay = Convert.ToInt32(Convert.ToInt32((dGioRaTheoIDMay - Convert.ToDateTime(sGioRaKhaiBaoTheoIDMayB).AddDays(-1.0)).TotalMinutes).ToString());
                                                                    if (iThoiGianSauGioLamViecTheoIDMay > 0 && iThoiGianSauGioLamViecTheoIDMay > iPhutTangCaSauGioLamViecTheoIDMay && iThoiGianSauGioLamViecTheoIDMay > iPhutTangCaSauGioLamViecDatDen22)
                                                                    {
                                                                        iTongGioTangCaSauTheoIDMay = iThoiGianSauGioLamViecTheoIDMay - iPhutTruTangCaSau22;
                                                                    }
                                                                }
                                                                else
                                                                {
                                                                    int iThoiGianSauGioLamViecTheoIDMay2;
                                                                    iThoiGianSauGioLamViecTheoIDMay2 = Convert.ToInt32(Convert.ToInt32((dGioRaTheoIDMay - Convert.ToDateTime(sGioRaKhaiBaoTheoIDMayB)).TotalMinutes).ToString());
                                                                    if (iThoiGianSauGioLamViecTheoIDMay2 > 0 && iThoiGianSauGioLamViecTheoIDMay2 > iPhutTangCaSauGioLamViecTheoIDMay && iThoiGianSauGioLamViecTheoIDMay2 > iPhutTangCaSauGioLamViecDatDen22)
                                                                    {
                                                                        iTongGioTangCaSauTheoIDMay = iThoiGianSauGioLamViecTheoIDMay2 - iPhutTruTangCaSau22;
                                                                    }
                                                                }
                                                            }
                                                        }
                                                        double dTongThoiGianTangCaTheoIDMay;
                                                        dTongThoiGianTangCaTheoIDMay = Convert.ToDouble(iTongGioTangCaTruocTheoIDMay + iTongGioTangCaSauTheoIDMay);
                                                        if (dTongThoiGianTangCaTheoIDMay > 0.0)
                                                        {
                                                            if (iGioiHanTC1TheoIDMay == 0)
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien - 1].Cells[12].Value = Math.Round(dTongThoiGianTangCaTheoIDMay * this.dTangCa1HeSo / 60.0, this.iLamTronGio);
                                                                this.DGVTinhCong.Rows[_nhanVien - 1].Cells[13].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien - 1].Cells[14].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien - 1].Cells[15].Value = "0";
                                                            }
                                                            if (iGioiHanTC1TheoIDMay != 0 && iGioiHanTC2TheoIDMay == 0)
                                                            {
                                                                if (dTongThoiGianTangCaTheoIDMay < Convert.ToDouble(iGioiHanTC1TheoIDMay))
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien - 1].Cells[12].Value = Math.Round(dTongThoiGianTangCaTheoIDMay * this.dTangCa1HeSo / 60.0, this.iLamTronGio);
                                                                    this.DGVTinhCong.Rows[_nhanVien - 1].Cells[13].Value = "0";
                                                                    this.DGVTinhCong.Rows[_nhanVien - 1].Cells[14].Value = "0";
                                                                    this.DGVTinhCong.Rows[_nhanVien - 1].Cells[15].Value = "0";
                                                                }
                                                                else
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien - 1].Cells[12].Value = Math.Round(Convert.ToDouble(iGioiHanTC1TheoIDMay) / 60.0 * this.dTangCa1HeSo, this.iLamTronGio);
                                                                    if (dTongThoiGianTangCaTheoIDMay - Convert.ToDouble(iGioiHanTC1TheoIDMay) > 0.0)
                                                                    {
                                                                        this.DGVTinhCong.Rows[_nhanVien - 1].Cells[13].Value = Math.Round((dTongThoiGianTangCaTheoIDMay - Convert.ToDouble(iGioiHanTC1TheoIDMay)) * this.dTangCa2HeSo / 60.0, this.iLamTronGio);
                                                                    }
                                                                    this.DGVTinhCong.Rows[_nhanVien - 1].Cells[14].Value = "0";
                                                                    this.DGVTinhCong.Rows[_nhanVien - 1].Cells[15].Value = "0";
                                                                }
                                                            }
                                                            if (iGioiHanTC1TheoIDMay != 0 && iGioiHanTC2TheoIDMay != 0 && iGioiHanTC3TheoIDMay == 0)
                                                            {
                                                                if (dTongThoiGianTangCaTheoIDMay < Convert.ToDouble(iGioiHanTC1TheoIDMay))
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien - 1].Cells[12].Value = Math.Round(dTongThoiGianTangCaTheoIDMay * this.dTangCa1HeSo / 60.0, this.iLamTronGio);
                                                                    this.DGVTinhCong.Rows[_nhanVien - 1].Cells[13].Value = "0";
                                                                    this.DGVTinhCong.Rows[_nhanVien - 1].Cells[14].Value = "0";
                                                                    this.DGVTinhCong.Rows[_nhanVien - 1].Cells[15].Value = "0";
                                                                }
                                                                else
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien - 1].Cells[12].Value = Math.Round(Convert.ToDouble(iGioiHanTC1TheoIDMay) * this.dTangCa1HeSo / 60.0, this.iLamTronGio);
                                                                    if (dTongThoiGianTangCaTheoIDMay - Convert.ToDouble(iGioiHanTC1TheoIDMay) < Convert.ToDouble(iGioiHanTC2TheoIDMay))
                                                                    {
                                                                        this.DGVTinhCong.Rows[_nhanVien - 1].Cells[13].Value = Math.Round((dTongThoiGianTangCaTheoIDMay - Convert.ToDouble(iGioiHanTC1TheoIDMay)) * this.dTangCa2HeSo / 60.0, this.iLamTronGio);
                                                                        this.DGVTinhCong.Rows[_nhanVien - 1].Cells[14].Value = "0";
                                                                        this.DGVTinhCong.Rows[_nhanVien - 1].Cells[15].Value = "0";
                                                                    }
                                                                    else
                                                                    {
                                                                        this.DGVTinhCong.Rows[_nhanVien - 1].Cells[12].Value = Math.Round(Convert.ToDouble(iGioiHanTC1TheoIDMay) * this.dTangCa1HeSo / 60.0, this.iLamTronGio);
                                                                        this.DGVTinhCong.Rows[_nhanVien - 1].Cells[13].Value = Math.Round(Convert.ToDouble(iGioiHanTC2TheoIDMay) * this.dTangCa2HeSo / 60.0, this.iLamTronGio);
                                                                        this.DGVTinhCong.Rows[_nhanVien - 1].Cells[14].Value = Math.Round((dTongThoiGianTangCaTheoIDMay - Convert.ToDouble(iGioiHanTC1TheoIDMay) - Convert.ToDouble(iGioiHanTC2TheoIDMay)) * this.dTangCa3HeSo / 60.0, this.iLamTronGio);
                                                                        this.DGVTinhCong.Rows[_nhanVien - 1].Cells[15].Value = "0";
                                                                    }
                                                                }
                                                            }
                                                            if (iGioiHanTC1TheoIDMay != 0 && iGioiHanTC2TheoIDMay != 0 && iGioiHanTC3TheoIDMay != 0 && iGioiHanTC4TheoIDMay != 0)
                                                            {
                                                            }
                                                        }
                                                        else
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien - 1].Cells[12].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien - 1].Cells[13].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien - 1].Cells[14].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien - 1].Cells[15].Value = "0";
                                                        }
                                                        this.DGVTinhCong.Rows[_nhanVien - 1].Cells[18].Value = this.sKHDungGio;
                                                        if (DateTimeProgress.XuatThuQuaDem((int)dt.AddDays(dem).DayOfWeek) == "1")
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien - 1].Cells[19].Value = "CN";
                                                        }
                                                        else
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien - 1].Cells[19].Value = "NT";
                                                        }
                                                        this.DGVTinhCong.Rows[_nhanVien - 1].Cells[20].Value = this.sMaChamCong;
                                                        this.DGVTinhCong.Rows[_nhanVien - 1].Cells[21].Value = this.sPhongBanTinhCong;
                                                    }
                                                    break;
                                                }
                                                continue;
                                            }
                                            dGioRaTheoIDMay = Convert.ToDateTime(dateGioChamTheoIDMay.ToString());
                                            this.DGVTinhCong.Rows[_nhanVien].Cells[6].Value = string.Format(this.sDinhDangThoiGian, dGioRaTheoIDMay);
                                            iLanCham2++;
                                            new DataTable();
                                            this._chiTietLichTrinhChoCalamViecDTO.MaLichTrinhCaLamViec = sLTCCLVNhanVien;
                                            this._chiTietLichTrinhChoCalamViecDTO.Thu = sThu;
                                            DataTable dtNhanCaTheoIDMay;
                                            dtNhanCaTheoIDMay = this._chiTietLichTrinhChoCaLamViecBLL.ChiTietLichTrinhChoCaLamViecNhanCa(this._chiTietLichTrinhChoCalamViecDTO);
                                            int iChiTietLichTrinhChoCaLamViecTheoIDMay;
                                            iChiTietLichTrinhChoCaLamViecTheoIDMay = 0;
                                            if (iChiTietLichTrinhChoCaLamViecTheoIDMay >= dtNhanCaTheoIDMay.Rows.Count)
                                            {
                                                continue;
                                            }
                                            int cellChiTietLichTrinhChoCaLamViecTheoIDMay;
                                            cellChiTietLichTrinhChoCaLamViecTheoIDMay = 3;
                                            while (true)
                                            {
                                                if (cellChiTietLichTrinhChoCaLamViecTheoIDMay < 13)
                                                {
                                                    kiemTraVao = 0;
                                                    kiemTraRa = 0;
                                                    this.sTheoIDMayMaCaLamViec = dtNhanCaTheoIDMay.Rows[iChiTietLichTrinhChoCaLamViecTheoIDMay][cellChiTietLichTrinhChoCaLamViecTheoIDMay].ToString();
                                                    new DataTable();
                                                    DataTable dtTheoIDMayCa2;
                                                    dtTheoIDMayCa2 = this._caLamViecBLL.CaLamViecGetByMaCaLamViec(sTheoIDMayMaCaLamViec);
                                                    int iTheoIDMayCa2;
                                                    iTheoIDMayCa2 = 0;
                                                    while (iTheoIDMayCa2 < dtTheoIDMayCa2.Rows.Count)
                                                    {
                                                        this.sTheoIDMayTenCaLamViec = dtTheoIDMayCa2.Rows[iTheoIDMayCa2]["CaLamViec"].ToString();
                                                        DateTime dBatDauVaoTheoIDMayB2;
                                                        dBatDauVaoTheoIDMayB2 = Convert.ToDateTime(sNgayCham + " " + string.Format("{0:T}", Convert.ToDateTime(dtTheoIDMayCa2.Rows[iTheoIDMayCa2]["BatDauVao"].ToString())));
                                                        DateTime dKetThucVaoTheoIDMayB2;
                                                        dKetThucVaoTheoIDMayB2 = Convert.ToDateTime(sNgayCham + " " + string.Format("{0:T}", Convert.ToDateTime(dtTheoIDMayCa2.Rows[iTheoIDMayCa2]["KetThucVao"].ToString())));
                                                        string sBatDauRaTheoIDMayB2;
                                                        sBatDauRaTheoIDMayB2 = sNgayCham + " " + string.Format("{0:T}", Convert.ToDateTime(dtTheoIDMayCa2.Rows[iTheoIDMayCa2]["BatDauRa"].ToString()));
                                                        DateTime dBatDauRaTheoIDMayB2;
                                                        dBatDauRaTheoIDMayB2 = Convert.ToDateTime(sBatDauRaTheoIDMayB2);
                                                        dBatDauRaTheoIDMayB2 = ((!(sBatDauRaTheoIDMayB2 == "12:01:00 AM")) ? Convert.ToDateTime(dBatDauRaTheoIDMayB2) : Convert.ToDateTime(dBatDauRaTheoIDMayB2.AddDays(1.0).ToString()));
                                                        string sKetThucRaTheoIDMayA;
                                                        sKetThucRaTheoIDMayA = string.Format("{0:T}", Convert.ToDateTime(dtTheoIDMayCa2.Rows[iTheoIDMayCa2]["KetThucRa"].ToString()));
                                                        DateTime dKetThucRaTheoIDMayB2;
                                                        dKetThucRaTheoIDMayB2 = Convert.ToDateTime(sNgayCham + " " + sKetThucRaTheoIDMayA);
                                                        dKetThucRaTheoIDMayB2 = ((!(sKetThucRaTheoIDMayA == "12:01:00 AM")) ? Convert.ToDateTime(dKetThucRaTheoIDMayB2) : Convert.ToDateTime(dKetThucRaTheoIDMayB2.AddDays(1.0).ToString()));
                                                        if (dGioVaoTheoIDMay >= dBatDauVaoTheoIDMayB2 && dGioVaoTheoIDMay <= dKetThucVaoTheoIDMayB2)
                                                        {
                                                            kiemTraVao++;
                                                        }
                                                        if (dGioRaTheoIDMay >= dBatDauRaTheoIDMayB2 && dGioRaTheoIDMay <= dKetThucRaTheoIDMayB2)
                                                        {
                                                            kiemTraRa++;
                                                        }
                                                        if (kiemTraVao != 1 || kiemTraRa != 1)
                                                        {
                                                            iTheoIDMayCa2++;
                                                            continue;
                                                        }
                                                        goto IL_20cc0;
                                                    }
                                                    if (!(this.sTheoIDMayMaCaLamViec == ""))
                                                    {
                                                        cellChiTietLichTrinhChoCaLamViecTheoIDMay++;
                                                        continue;
                                                    }
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[4].Value = ca;
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[11].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[16].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[17].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[18].Value = this.sKHVang;
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[20].Value = this.sMaChamCong;
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[21].Value = this.sPhongBanTinhCong;
                                                    break;
                                                }
                                                goto IL_20cc0;
                                            IL_20cc0:
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[4].Value = this.sTheoIDMayTenCaLamViec;
                                                new DataTable();
                                                DataTable dtCaLamViecTheoIDMay;
                                                dtCaLamViecTheoIDMay = this._caLamViecBLL.CaLamViecGetByMaCaLamViec(sTheoIDMayMaCaLamViec);
                                                for (int iCaLamViecTheoIDMay = 0; iCaLamViecTheoIDMay < dtCaLamViecTheoIDMay.Rows.Count; iCaLamViecTheoIDMay++)
                                                {
                                                    string sGiayGioVao34;
                                                    sGiayGioVao34 = dGioVaoTheoIDMay.Second.ToString();
                                                    string sGiayGioRa34;
                                                    sGiayGioRa34 = dGioRaTheoIDMay.Second.ToString();
                                                    DateTime dGioVaoKhaiBaoTheoIDMayB;
                                                    dGioVaoKhaiBaoTheoIDMayB = Convert.ToDateTime(sNgayCham + " " + string.Format("{0:T}", Convert.ToDateTime(dtCaLamViecTheoIDMay.Rows[iCaLamViecTheoIDMay]["GioVaoLamViec"].ToString())).Replace("00 ", sGiayGioVao34 + " "));
                                                    DateTime dGioRaKhaiBaoTheoIDMayB;
                                                    dGioRaKhaiBaoTheoIDMayB = Convert.ToDateTime(sNgayCham + " " + string.Format("{0:T}", Convert.ToDateTime(dtCaLamViecTheoIDMay.Rows[iCaLamViecTheoIDMay]["GioKetThucLamViec"].ToString())).Replace("00 ", sGiayGioRa34 + " "));
                                                    dtCaLamViecTheoIDMay.Rows[iCaLamViecTheoIDMay]["XemCaDem"].ToString();
                                                    string sTruGioDiTre27;
                                                    sTruGioDiTre27 = dtCaLamViecTheoIDMay.Rows[iCaLamViecTheoIDMay]["TruGioDiTre"].ToString();
                                                    string sBatDauTinhDiTre27;
                                                    sBatDauTinhDiTre27 = dtCaLamViecTheoIDMay.Rows[iCaLamViecTheoIDMay]["BatDauTinhDiTre"].ToString();
                                                    int iChoPhepDiTre23;
                                                    iChoPhepDiTre23 = Convert.ToInt32(dtCaLamViecTheoIDMay.Rows[iCaLamViecTheoIDMay]["ChoPhepDiTre"].ToString());
                                                    string sPhutTre33;
                                                    sPhutTre33 = Convert.ToInt32((dGioVaoTheoIDMay - dGioVaoKhaiBaoTheoIDMayB).TotalMinutes).ToString();
                                                    if (sTruGioDiTre27 == "True")
                                                    {
                                                        if (Convert.ToInt32(sPhutTre33) < 0)
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = "0";
                                                        }
                                                        else
                                                        {
                                                            int iPhutTre23;
                                                            iPhutTre23 = Convert.ToInt32(sPhutTre33) - iChoPhepDiTre23;
                                                            if (sBatDauTinhDiTre27 == "True")
                                                            {
                                                                if (iPhutTre23 < 1)
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = "0";
                                                                }
                                                                else
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[5].Style.BackColor = Color.Lime;
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = iPhutTre23.ToString();
                                                                }
                                                            }
                                                            else if (iPhutTre23 < 1)
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = "0";
                                                            }
                                                            else
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = sPhutTre33;
                                                            }
                                                        }
                                                    }
                                                    else
                                                    {
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = "0";
                                                    }
                                                    string sTruGioVeSom27;
                                                    sTruGioVeSom27 = dtCaLamViecTheoIDMay.Rows[iCaLamViecTheoIDMay]["TruGioVeSom"].ToString();
                                                    string sBatDauTinhVeSom27;
                                                    sBatDauTinhVeSom27 = dtCaLamViecTheoIDMay.Rows[iCaLamViecTheoIDMay]["BatDauTinhVeSom"].ToString();
                                                    int iChoPhepVeSom22;
                                                    iChoPhepVeSom22 = Convert.ToInt32(dtCaLamViecTheoIDMay.Rows[iCaLamViecTheoIDMay]["ChoPhepVeSom"].ToString());
                                                    string sPhutVeSom32;
                                                    sPhutVeSom32 = Convert.ToInt32((dGioRaKhaiBaoTheoIDMayB - dGioRaTheoIDMay).TotalMinutes).ToString();
                                                    if (sTruGioVeSom27 == "True")
                                                    {
                                                        if (Convert.ToInt32(sPhutVeSom32) < 0)
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = "0";
                                                        }
                                                        else
                                                        {
                                                            int iPhutVeSom22;
                                                            iPhutVeSom22 = Convert.ToInt32(sPhutVeSom32) - iChoPhepVeSom22;
                                                            if (iPhutVeSom22 < 1)
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = "0";
                                                            }
                                                            else if (sBatDauTinhVeSom27 == "True")
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[6].Style.BackColor = Color.Yellow;
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = iPhutVeSom22.ToString();
                                                            }
                                                            else
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = sPhutVeSom32;
                                                            }
                                                        }
                                                    }
                                                    else
                                                    {
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = "0";
                                                    }
                                                    string sVeTre20;
                                                    sVeTre20 = Convert.ToInt32((dGioRaTheoIDMay - dGioRaKhaiBaoTheoIDMayB).TotalMinutes).ToString();
                                                    if (Convert.ToInt32(sVeTre20) > 0)
                                                    {
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[11].Value = sVeTre20;
                                                    }
                                                    else
                                                    {
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[11].Value = "0";
                                                    }
                                                    double dGio20;
                                                    dGio20 = Math.Round(Convert.ToDouble(Convert.ToSingle(dtCaLamViecTheoIDMay.Rows[iCaLamViecTheoIDMay]["TongGioTrongCaLamViec"]) * 60f - (float)(Convert.ToInt32(this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value.ToString()) + Convert.ToInt32(this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value))) / 60.0, this.iLamTronGio);
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = dGio20.ToString();
                                                    double iGio20;
                                                    iGio20 = Convert.ToDouble(dtCaLamViecTheoIDMay.Rows[iCaLamViecTheoIDMay]["TongGioTrongCaLamViec"].ToString());
                                                    double dCongTinh18;
                                                    dCongTinh18 = Convert.ToDouble(dtCaLamViecTheoIDMay.Rows[iCaLamViecTheoIDMay]["CongTinh"].ToString());
                                                    double dCong20;
                                                    dCong20 = Math.Round(dGio20 * dCongTinh18 / iGio20, this.iLamTronCong);
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = dCong20.ToString();
                                                    string sTangCaTruocGioLamViec12;
                                                    sTangCaTruocGioLamViec12 = dtCaLamViecTheoIDMay.Rows[iCaLamViecTheoIDMay]["TangCaTruocGioLamViec"].ToString();
                                                    string sTangCaSauGioLamViec12;
                                                    sTangCaSauGioLamViec12 = dtCaLamViecTheoIDMay.Rows[iCaLamViecTheoIDMay]["TangCaSauGioLamViec"].ToString();
                                                    if (sTangCaTruocGioLamViec12 == "False" && sTangCaSauGioLamViec12 == "False")
                                                    {
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                    }
                                                    string sXemCaNayLaTangCa12;
                                                    sXemCaNayLaTangCa12 = dtCaLamViecTheoIDMay.Rows[iCaLamViecTheoIDMay]["XemCaNayLaTangCa"].ToString();
                                                    int iTangCaMuc12;
                                                    iTangCaMuc12 = Convert.ToInt32(dtCaLamViecTheoIDMay.Rows[iCaLamViecTheoIDMay]["TangCaMuc"].ToString());
                                                    if (sXemCaNayLaTangCa12 == "True")
                                                    {
                                                        if (iTangCaMuc12 == 1)
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = dGio20.ToString();
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                        }
                                                        if (iTangCaMuc12 == 2)
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = dGio20.ToString();
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                        }
                                                        if (iTangCaMuc12 == 3)
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = dGio20.ToString();
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                        }
                                                        if (iTangCaMuc12 == 4)
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = dGio20.ToString();
                                                        }
                                                    }
                                                    string sChoPhepTangCaTruocGioLamViecTheoIDMay2;
                                                    sChoPhepTangCaTruocGioLamViecTheoIDMay2 = dtCaLamViecTheoIDMay.Rows[iCaLamViecTheoIDMay]["TangCaTruocGioLamViec"].ToString();
                                                    int iPhutTangCaTruocGioLamViecTheoIDMay2;
                                                    iPhutTangCaTruocGioLamViecTheoIDMay2 = Convert.ToInt32(dtCaLamViecTheoIDMay.Rows[iCaLamViecTheoIDMay]["SoPhutTangCaTruocGioLamViec"].ToString());
                                                    int iPhutTangCaTruocGioLamViecDatDen24;
                                                    iPhutTangCaTruocGioLamViecDatDen24 = Convert.ToInt32(dtCaLamViecTheoIDMay.Rows[iCaLamViecTheoIDMay]["TangCaTruocGioLamViecDatDen"].ToString());
                                                    int iPhutTruTangCaTruoc24;
                                                    iPhutTruTangCaTruoc24 = Convert.ToInt32(dtCaLamViecTheoIDMay.Rows[iCaLamViecTheoIDMay]["PhutTruTangCaTruoc"].ToString());
                                                    string sChoPhepTangCaSauGioLamViecTheoIDMay2;
                                                    sChoPhepTangCaSauGioLamViecTheoIDMay2 = dtCaLamViecTheoIDMay.Rows[iCaLamViecTheoIDMay]["TangCaSauGioLamViec"].ToString();
                                                    int iPhutTangCaSauGioLamViecTheoIDMay2;
                                                    iPhutTangCaSauGioLamViecTheoIDMay2 = Convert.ToInt32(dtCaLamViecTheoIDMay.Rows[iCaLamViecTheoIDMay]["SoPhutTangCaSauGioLamViec"].ToString());
                                                    int iPhutTangCaSauGioLamViecDatDen24;
                                                    iPhutTangCaSauGioLamViecDatDen24 = Convert.ToInt32(dtCaLamViecTheoIDMay.Rows[iCaLamViecTheoIDMay]["TangCaSauGioLamViecDatDen"].ToString());
                                                    int iPhutTruTangCaSau24;
                                                    iPhutTruTangCaSau24 = Convert.ToInt32(dtCaLamViecTheoIDMay.Rows[iCaLamViecTheoIDMay]["PhutTruTangCaSau"].ToString());
                                                    int iGioiHanTC1TheoIDMay2;
                                                    iGioiHanTC1TheoIDMay2 = Convert.ToInt32(dtCaLamViecTheoIDMay.Rows[iCaLamViecTheoIDMay]["GioiHanTangCa1"].ToString());
                                                    int iGioiHanTC2TheoIDMay2;
                                                    iGioiHanTC2TheoIDMay2 = Convert.ToInt32(dtCaLamViecTheoIDMay.Rows[iCaLamViecTheoIDMay]["GioiHanTangCa2"].ToString());
                                                    int iGioiHanTC3TheoIDMay2;
                                                    iGioiHanTC3TheoIDMay2 = Convert.ToInt32(dtCaLamViecTheoIDMay.Rows[iCaLamViecTheoIDMay]["GioiHanTangCa3"].ToString());
                                                    int iGioiHanTC4TheoIDMay2;
                                                    iGioiHanTC4TheoIDMay2 = Convert.ToInt32(dtCaLamViecTheoIDMay.Rows[iCaLamViecTheoIDMay]["GioiHanTangCa4"].ToString());
                                                    int iTongGioTangCaSauTheoIDMay2;
                                                    iTongGioTangCaSauTheoIDMay2 = 0;
                                                    int iTongGioTangCaTruocTheoIDMay2;
                                                    iTongGioTangCaTruocTheoIDMay2 = 0;
                                                    if (sChoPhepTangCaTruocGioLamViecTheoIDMay2 == "False" && sChoPhepTangCaSauGioLamViecTheoIDMay2 == "False")
                                                    {
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                    }
                                                    else
                                                    {
                                                        if (sChoPhepTangCaTruocGioLamViecTheoIDMay2 == "True")
                                                        {
                                                            int iThoiGianTruocGioLamTheoIDMay2;
                                                            iThoiGianTruocGioLamTheoIDMay2 = Convert.ToInt32(Convert.ToInt32((dGioVaoKhaiBaoTheoIDMayB - dGioVaoTheoIDMay).TotalMinutes).ToString());
                                                            if (iThoiGianTruocGioLamTheoIDMay2 > 0 && iThoiGianTruocGioLamTheoIDMay2 > iPhutTangCaTruocGioLamViecTheoIDMay2 && iThoiGianTruocGioLamTheoIDMay2 > iPhutTangCaTruocGioLamViecDatDen24)
                                                            {
                                                                iTongGioTangCaTruocTheoIDMay2 = iThoiGianTruocGioLamTheoIDMay2 - iPhutTruTangCaTruoc24;
                                                            }
                                                        }
                                                        if (sChoPhepTangCaSauGioLamViecTheoIDMay2 == "True")
                                                        {
                                                            int iThoiGianSauGioLamViecTheoIDMay3;
                                                            iThoiGianSauGioLamViecTheoIDMay3 = Convert.ToInt32(Convert.ToInt32((dGioRaTheoIDMay - dGioRaKhaiBaoTheoIDMayB).TotalMinutes).ToString());
                                                            if (iThoiGianSauGioLamViecTheoIDMay3 > 0 && iThoiGianSauGioLamViecTheoIDMay3 > iPhutTangCaSauGioLamViecTheoIDMay2 && iThoiGianSauGioLamViecTheoIDMay3 > iPhutTangCaSauGioLamViecDatDen24)
                                                            {
                                                                iTongGioTangCaSauTheoIDMay2 = iThoiGianSauGioLamViecTheoIDMay3 - iPhutTruTangCaSau24;
                                                            }
                                                        }
                                                    }
                                                    double dTongThoiGianTangCaTheoIDMay2;
                                                    dTongThoiGianTangCaTheoIDMay2 = Convert.ToDouble(iTongGioTangCaTruocTheoIDMay2 + iTongGioTangCaSauTheoIDMay2);
                                                    if (dTongThoiGianTangCaTheoIDMay2 > 0.0)
                                                    {
                                                        if (iGioiHanTC1TheoIDMay2 == 0)
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = Math.Round(dTongThoiGianTangCaTheoIDMay2 * this.dTangCa1HeSo / 60.0, this.iLamTronGio);
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                        }
                                                        if (iGioiHanTC1TheoIDMay2 != 0 && iGioiHanTC2TheoIDMay2 == 0)
                                                        {
                                                            if (dTongThoiGianTangCaTheoIDMay2 < Convert.ToDouble(iGioiHanTC1TheoIDMay2))
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = Math.Round(dTongThoiGianTangCaTheoIDMay2 * this.dTangCa1HeSo / 60.0, this.iLamTronGio);
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                            }
                                                            else
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = Math.Round(Convert.ToDouble(iGioiHanTC1TheoIDMay2) / 60.0 * this.dTangCa1HeSo, this.iLamTronGio);
                                                                if (dTongThoiGianTangCaTheoIDMay2 - Convert.ToDouble(iGioiHanTC1TheoIDMay2) > 0.0)
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = Math.Round((dTongThoiGianTangCaTheoIDMay2 - Convert.ToDouble(iGioiHanTC1TheoIDMay2)) * this.dTangCa2HeSo / 60.0, this.iLamTronGio);
                                                                }
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                            }
                                                        }
                                                        if (iGioiHanTC1TheoIDMay2 != 0 && iGioiHanTC2TheoIDMay2 != 0 && iGioiHanTC3TheoIDMay2 == 0)
                                                        {
                                                            if (dTongThoiGianTangCaTheoIDMay2 < Convert.ToDouble(iGioiHanTC1TheoIDMay2))
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = Math.Round(dTongThoiGianTangCaTheoIDMay2 * this.dTangCa1HeSo / 60.0, this.iLamTronGio);
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                            }
                                                            else
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = Math.Round(Convert.ToDouble(iGioiHanTC1TheoIDMay2) * this.dTangCa1HeSo / 60.0, this.iLamTronGio);
                                                                if (dTongThoiGianTangCaTheoIDMay2 - Convert.ToDouble(iGioiHanTC1TheoIDMay2) < Convert.ToDouble(iGioiHanTC2TheoIDMay2))
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = Math.Round((dTongThoiGianTangCaTheoIDMay2 - Convert.ToDouble(iGioiHanTC1TheoIDMay2)) * this.dTangCa2HeSo / 60.0, this.iLamTronGio);
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                                }
                                                                else
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = Math.Round(Convert.ToDouble(iGioiHanTC1TheoIDMay2) * this.dTangCa1HeSo / 60.0, this.iLamTronGio);
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = Math.Round(Convert.ToDouble(iGioiHanTC2TheoIDMay2) * this.dTangCa2HeSo / 60.0, this.iLamTronGio);
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = Math.Round((dTongThoiGianTangCaTheoIDMay2 - Convert.ToDouble(iGioiHanTC1TheoIDMay2) - Convert.ToDouble(iGioiHanTC2TheoIDMay2)) * this.dTangCa3HeSo / 60.0, this.iLamTronGio);
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                                }
                                                            }
                                                        }
                                                        if (iGioiHanTC1TheoIDMay2 != 0 && iGioiHanTC2TheoIDMay2 != 0 && iGioiHanTC3TheoIDMay2 != 0 && iGioiHanTC4TheoIDMay2 != 0)
                                                        {
                                                        }
                                                    }
                                                    else
                                                    {
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                    }
                                                    string sTongGio12;
                                                    sTongGio12 = Math.Round(Convert.ToDouble(Convert.ToInt32((dGioRaTheoIDMay - dGioVaoTheoIDMay).TotalMinutes).ToString()) / 60.0, this.iLamTronGio).ToString();
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[16].Value = sTongGio12;
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[17].Value = dtCaLamViecTheoIDMay.Rows[iCaLamViecTheoIDMay]["CongTinh"].ToString();
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[18].Value = this.sKHDungGio;
                                                    if (DateTimeProgress.XuatIDThu((int)dt.AddDays(dem).DayOfWeek) == "0")
                                                    {
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[19].Value = "CN";
                                                    }
                                                    else
                                                    {
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[19].Value = "NT";
                                                    }
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[20].Value = this.sMaChamCong;
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[21].Value = this.sPhongBanTinhCong;
                                                }
                                                break;
                                            }
                                            continue;
                                        }
                                        dGioRaTheoIDMay = Convert.ToDateTime(dateGioChamTheoIDMay.ToString());
                                        this.DGVTinhCong.Rows[_nhanVien].Cells[6].Value = string.Format(this.sDinhDangThoiGian, dGioRaTheoIDMay);
                                        iLanCham2++;
                                        new DataTable();
                                        this._chiTietLichTrinhChoCalamViecDTO.MaLichTrinhCaLamViec = sLTCCLVNhanVien;
                                        this._chiTietLichTrinhChoCalamViecDTO.Thu = sThu;
                                        DataTable dtNhanCaTheoIDMay2;
                                        dtNhanCaTheoIDMay2 = this._chiTietLichTrinhChoCaLamViecBLL.ChiTietLichTrinhChoCaLamViecNhanCa(this._chiTietLichTrinhChoCalamViecDTO);
                                        int iChiTietLichTrinhChoCaLamViecTheoIDMay2;
                                        iChiTietLichTrinhChoCaLamViecTheoIDMay2 = 0;
                                        if (iChiTietLichTrinhChoCaLamViecTheoIDMay2 >= dtNhanCaTheoIDMay2.Rows.Count)
                                        {
                                            continue;
                                        }
                                        int cellChiTietLichTrinhChoCaLamViecTheoIDMay2;
                                        cellChiTietLichTrinhChoCaLamViecTheoIDMay2 = 3;
                                        while (true)
                                        {
                                            if (cellChiTietLichTrinhChoCaLamViecTheoIDMay2 < 13)
                                            {
                                                kiemTraVao = 0;
                                                kiemTraRa = 0;
                                                this.sTheoIDMayMaCaLamViec = dtNhanCaTheoIDMay2.Rows[iChiTietLichTrinhChoCaLamViecTheoIDMay2][cellChiTietLichTrinhChoCaLamViecTheoIDMay2].ToString();
                                                new DataTable();
                                                DataTable dtTheoIDMayCa3;
                                                dtTheoIDMayCa3 = this._caLamViecBLL.CaLamViecGetByMaCaLamViec(sTheoIDMayMaCaLamViec);
                                                int iTheoIDMayCa3;
                                                iTheoIDMayCa3 = 0;
                                                while (iTheoIDMayCa3 < dtTheoIDMayCa3.Rows.Count)
                                                {
                                                    this.sTheoIDMayTenCaLamViec = dtTheoIDMayCa3.Rows[iTheoIDMayCa3]["CaLamViec"].ToString();
                                                    DateTime dBatDauVaoTheoIDMayB3;
                                                    dBatDauVaoTheoIDMayB3 = Convert.ToDateTime(sNgayCham + " " + string.Format("{0:T}", Convert.ToDateTime(dtTheoIDMayCa3.Rows[iTheoIDMayCa3]["BatDauVao"].ToString())));
                                                    DateTime dKetThucVaoTheoIDMayB3;
                                                    dKetThucVaoTheoIDMayB3 = Convert.ToDateTime(sNgayCham + " " + string.Format("{0:T}", Convert.ToDateTime(dtTheoIDMayCa3.Rows[iTheoIDMayCa3]["KetThucVao"].ToString())));
                                                    string sBatDauRaTheoIDMayB3;
                                                    sBatDauRaTheoIDMayB3 = sNgayCham + " " + string.Format("{0:T}", Convert.ToDateTime(dtTheoIDMayCa3.Rows[iTheoIDMayCa3]["BatDauRa"].ToString()));
                                                    DateTime dBatDauRaTheoIDMayB3;
                                                    dBatDauRaTheoIDMayB3 = Convert.ToDateTime(sBatDauRaTheoIDMayB3);
                                                    dBatDauRaTheoIDMayB3 = ((!(sBatDauRaTheoIDMayB3 == "12:01:00 AM")) ? Convert.ToDateTime(dBatDauRaTheoIDMayB3) : Convert.ToDateTime(dBatDauRaTheoIDMayB3.AddDays(1.0).ToString()));
                                                    string sKetThucRaTheoIDMayA2;
                                                    sKetThucRaTheoIDMayA2 = string.Format("{0:T}", Convert.ToDateTime(dtTheoIDMayCa3.Rows[iTheoIDMayCa3]["KetThucRa"].ToString()));
                                                    DateTime dKetThucRaTheoIDMayB3;
                                                    dKetThucRaTheoIDMayB3 = Convert.ToDateTime(sNgayCham + " " + sKetThucRaTheoIDMayA2);
                                                    dKetThucRaTheoIDMayB3 = ((!(sKetThucRaTheoIDMayA2 == "12:01:00 AM")) ? Convert.ToDateTime(dKetThucRaTheoIDMayB3) : Convert.ToDateTime(dKetThucRaTheoIDMayB3.AddDays(1.0).ToString()));
                                                    if (dGioVaoTheoIDMay >= dBatDauVaoTheoIDMayB3 && dGioVaoTheoIDMay <= dKetThucVaoTheoIDMayB3)
                                                    {
                                                        kiemTraVao++;
                                                    }
                                                    if (dGioRaTheoIDMay >= dBatDauRaTheoIDMayB3 && dGioRaTheoIDMay <= dKetThucRaTheoIDMayB3)
                                                    {
                                                        kiemTraRa++;
                                                    }
                                                    if (kiemTraVao != 1 || kiemTraRa != 1)
                                                    {
                                                        iTheoIDMayCa3++;
                                                        continue;
                                                    }
                                                    goto IL_22c98;
                                                }
                                                if (!(this.sTheoIDMayMaCaLamViec == ""))
                                                {
                                                    cellChiTietLichTrinhChoCaLamViecTheoIDMay2++;
                                                    continue;
                                                }
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[4].Value = ca;
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[11].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[16].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[17].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[18].Value = this.sKHVang;
                                                break;
                                            }
                                            goto IL_22c98;
                                        IL_22c98:
                                            this.DGVTinhCong.Rows[_nhanVien].Cells[4].Value = this.sTheoIDMayTenCaLamViec;
                                            new DataTable();
                                            DataTable dtCaLamViecTheoIDMay2;
                                            dtCaLamViecTheoIDMay2 = this._caLamViecBLL.CaLamViecGetByMaCaLamViec(sTheoIDMayMaCaLamViec);
                                            for (int iCaLamViecTheoIDMay2 = 0; iCaLamViecTheoIDMay2 < dtCaLamViecTheoIDMay2.Rows.Count; iCaLamViecTheoIDMay2++)
                                            {
                                                string sGiayGioVao35;
                                                sGiayGioVao35 = dGioVaoTheoIDMay.Second.ToString();
                                                string sGiayGioRa35;
                                                sGiayGioRa35 = dGioRaTheoIDMay.Second.ToString();
                                                DateTime dGioVaoKhaiBaoTheoIDMayB2;
                                                dGioVaoKhaiBaoTheoIDMayB2 = Convert.ToDateTime(sNgayCham + " " + string.Format("{0:T}", Convert.ToDateTime(dtCaLamViecTheoIDMay2.Rows[iCaLamViecTheoIDMay2]["GioVaoLamViec"].ToString())).Replace("00 ", sGiayGioVao35 + " "));
                                                DateTime dGioRaKhaiBaoTheoIDMayB2;
                                                dGioRaKhaiBaoTheoIDMayB2 = Convert.ToDateTime(sNgayCham + " " + string.Format("{0:T}", Convert.ToDateTime(dtCaLamViecTheoIDMay2.Rows[iCaLamViecTheoIDMay2]["GioKetThucLamViec"].ToString())).Replace("00 ", sGiayGioRa35 + " "));
                                                dtCaLamViecTheoIDMay2.Rows[iCaLamViecTheoIDMay2]["XemCaDem"].ToString();
                                                string sTruGioDiTre29;
                                                sTruGioDiTre29 = dtCaLamViecTheoIDMay2.Rows[iCaLamViecTheoIDMay2]["TruGioDiTre"].ToString();
                                                string sBatDauTinhDiTre29;
                                                sBatDauTinhDiTre29 = dtCaLamViecTheoIDMay2.Rows[iCaLamViecTheoIDMay2]["BatDauTinhDiTre"].ToString();
                                                int iChoPhepDiTre25;
                                                iChoPhepDiTre25 = Convert.ToInt32(dtCaLamViecTheoIDMay2.Rows[iCaLamViecTheoIDMay2]["ChoPhepDiTre"].ToString());
                                                string sPhutTre35;
                                                sPhutTre35 = Convert.ToInt32((dGioVaoTheoIDMay - dGioVaoKhaiBaoTheoIDMayB2).TotalMinutes).ToString();
                                                if (sTruGioDiTre29 == "True")
                                                {
                                                    if (Convert.ToInt32(sPhutTre35) < 0)
                                                    {
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = "0";
                                                    }
                                                    else
                                                    {
                                                        int iPhutTre25;
                                                        iPhutTre25 = Convert.ToInt32(sPhutTre35) - iChoPhepDiTre25;
                                                        if (sBatDauTinhDiTre29 == "True")
                                                        {
                                                            if (iPhutTre25 < 1)
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = "0";
                                                            }
                                                            else
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[5].Style.BackColor = Color.Lime;
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = iPhutTre25.ToString();
                                                            }
                                                        }
                                                        else if (iPhutTre25 < 1)
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = "0";
                                                        }
                                                        else
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = sPhutTre35;
                                                        }
                                                    }
                                                }
                                                else
                                                {
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = "0";
                                                }
                                                string sTruGioVeSom29;
                                                sTruGioVeSom29 = dtCaLamViecTheoIDMay2.Rows[iCaLamViecTheoIDMay2]["TruGioVeSom"].ToString();
                                                string sBatDauTinhVeSom28;
                                                sBatDauTinhVeSom28 = dtCaLamViecTheoIDMay2.Rows[iCaLamViecTheoIDMay2]["BatDauTinhVeSom"].ToString();
                                                int iChoPhepVeSom24;
                                                iChoPhepVeSom24 = Convert.ToInt32(dtCaLamViecTheoIDMay2.Rows[iCaLamViecTheoIDMay2]["ChoPhepVeSom"].ToString());
                                                string sPhutVeSom34;
                                                sPhutVeSom34 = Convert.ToInt32((dGioRaKhaiBaoTheoIDMayB2 - dGioRaTheoIDMay).TotalMinutes).ToString();
                                                if (sTruGioVeSom29 == "True")
                                                {
                                                    if (Convert.ToInt32(sPhutVeSom34) < 0)
                                                    {
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = "0";
                                                    }
                                                    else
                                                    {
                                                        int iPhutVeSom24;
                                                        iPhutVeSom24 = Convert.ToInt32(sPhutVeSom34) - iChoPhepVeSom24;
                                                        if (iPhutVeSom24 < 1)
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = "0";
                                                        }
                                                        else if (sBatDauTinhVeSom28 == "True")
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[6].Style.BackColor = Color.Yellow;
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = iPhutVeSom24.ToString();
                                                        }
                                                        else
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = sPhutVeSom34;
                                                        }
                                                    }
                                                }
                                                else
                                                {
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = "0";
                                                }
                                                string sVeTre22;
                                                sVeTre22 = Convert.ToInt32((dGioRaTheoIDMay - dGioRaKhaiBaoTheoIDMayB2).TotalMinutes).ToString();
                                                if (Convert.ToInt32(sVeTre22) > 0)
                                                {
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[11].Value = sVeTre22;
                                                }
                                                else
                                                {
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[11].Value = "0";
                                                }
                                                double dGio22;
                                                dGio22 = Math.Round(Convert.ToDouble(Convert.ToSingle(dtCaLamViecTheoIDMay2.Rows[iCaLamViecTheoIDMay2]["TongGioTrongCaLamViec"]) * 60f - (float)(Convert.ToInt32(this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value.ToString()) + Convert.ToInt32(this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value))) / 60.0, this.iLamTronGio);
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = dGio22.ToString();
                                                double iGio22;
                                                iGio22 = Convert.ToDouble(dtCaLamViecTheoIDMay2.Rows[iCaLamViecTheoIDMay2]["TongGioTrongCaLamViec"].ToString());
                                                double dCongTinh20;
                                                dCongTinh20 = Convert.ToDouble(dtCaLamViecTheoIDMay2.Rows[iCaLamViecTheoIDMay2]["CongTinh"].ToString());
                                                double dCong22;
                                                dCong22 = Math.Round(dGio22 * dCongTinh20 / iGio22, this.iLamTronCong);
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = dCong22.ToString();
                                                string sTangCaTruocGioLamViec14;
                                                sTangCaTruocGioLamViec14 = dtCaLamViecTheoIDMay2.Rows[iCaLamViecTheoIDMay2]["TangCaTruocGioLamViec"].ToString();
                                                string sTangCaSauGioLamViec14;
                                                sTangCaSauGioLamViec14 = dtCaLamViecTheoIDMay2.Rows[iCaLamViecTheoIDMay2]["TangCaSauGioLamViec"].ToString();
                                                if (sTangCaTruocGioLamViec14 == "False" && sTangCaSauGioLamViec14 == "False")
                                                {
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                }
                                                string sXemCaNayLaTangCa13;
                                                sXemCaNayLaTangCa13 = dtCaLamViecTheoIDMay2.Rows[iCaLamViecTheoIDMay2]["XemCaNayLaTangCa"].ToString();
                                                int iTangCaMuc13;
                                                iTangCaMuc13 = Convert.ToInt32(dtCaLamViecTheoIDMay2.Rows[iCaLamViecTheoIDMay2]["TangCaMuc"].ToString());
                                                if (sXemCaNayLaTangCa13 == "True")
                                                {
                                                    if (iTangCaMuc13 == 1)
                                                    {
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = dGio22.ToString();
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                    }
                                                    if (iTangCaMuc13 == 2)
                                                    {
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = dGio22.ToString();
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                    }
                                                    if (iTangCaMuc13 == 3)
                                                    {
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = dGio22.ToString();
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                    }
                                                    if (iTangCaMuc13 == 4)
                                                    {
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = dGio22.ToString();
                                                    }
                                                }
                                                string sChoPhepTangCaTruocGioLamViecTheoIDMay3;
                                                sChoPhepTangCaTruocGioLamViecTheoIDMay3 = dtCaLamViecTheoIDMay2.Rows[iCaLamViecTheoIDMay2]["TangCaTruocGioLamViec"].ToString();
                                                int iPhutTangCaTruocGioLamViecTheoIDMay3;
                                                iPhutTangCaTruocGioLamViecTheoIDMay3 = Convert.ToInt32(dtCaLamViecTheoIDMay2.Rows[iCaLamViecTheoIDMay2]["SoPhutTangCaTruocGioLamViec"].ToString());
                                                int iPhutTangCaTruocGioLamViecDatDen26;
                                                iPhutTangCaTruocGioLamViecDatDen26 = Convert.ToInt32(dtCaLamViecTheoIDMay2.Rows[iCaLamViecTheoIDMay2]["TangCaTruocGioLamViecDatDen"].ToString());
                                                int iPhutTruTangCaTruoc26;
                                                iPhutTruTangCaTruoc26 = Convert.ToInt32(dtCaLamViecTheoIDMay2.Rows[iCaLamViecTheoIDMay2]["PhutTruTangCaTruoc"].ToString());
                                                string sChoPhepTangCaSauGioLamViecTheoIDMay3;
                                                sChoPhepTangCaSauGioLamViecTheoIDMay3 = dtCaLamViecTheoIDMay2.Rows[iCaLamViecTheoIDMay2]["TangCaSauGioLamViec"].ToString();
                                                int iPhutTangCaSauGioLamViecTheoIDMay3;
                                                iPhutTangCaSauGioLamViecTheoIDMay3 = Convert.ToInt32(dtCaLamViecTheoIDMay2.Rows[iCaLamViecTheoIDMay2]["SoPhutTangCaSauGioLamViec"].ToString());
                                                int iPhutTangCaSauGioLamViecDatDen26;
                                                iPhutTangCaSauGioLamViecDatDen26 = Convert.ToInt32(dtCaLamViecTheoIDMay2.Rows[iCaLamViecTheoIDMay2]["TangCaSauGioLamViecDatDen"].ToString());
                                                int iPhutTruTangCaSau26;
                                                iPhutTruTangCaSau26 = Convert.ToInt32(dtCaLamViecTheoIDMay2.Rows[iCaLamViecTheoIDMay2]["PhutTruTangCaSau"].ToString());
                                                int iGioiHanTC1TheoIDMay3;
                                                iGioiHanTC1TheoIDMay3 = Convert.ToInt32(dtCaLamViecTheoIDMay2.Rows[iCaLamViecTheoIDMay2]["GioiHanTangCa1"].ToString());
                                                int iGioiHanTC2TheoIDMay3;
                                                iGioiHanTC2TheoIDMay3 = Convert.ToInt32(dtCaLamViecTheoIDMay2.Rows[iCaLamViecTheoIDMay2]["GioiHanTangCa2"].ToString());
                                                int iGioiHanTC3TheoIDMay3;
                                                iGioiHanTC3TheoIDMay3 = Convert.ToInt32(dtCaLamViecTheoIDMay2.Rows[iCaLamViecTheoIDMay2]["GioiHanTangCa3"].ToString());
                                                int iGioiHanTC4TheoIDMay3;
                                                iGioiHanTC4TheoIDMay3 = Convert.ToInt32(dtCaLamViecTheoIDMay2.Rows[iCaLamViecTheoIDMay2]["GioiHanTangCa4"].ToString());
                                                int iTongGioTangCaSauTheoIDMay3;
                                                iTongGioTangCaSauTheoIDMay3 = 0;
                                                int iTongGioTangCaTruocTheoIDMay3;
                                                iTongGioTangCaTruocTheoIDMay3 = 0;
                                                if (sChoPhepTangCaTruocGioLamViecTheoIDMay3 == "False" && sChoPhepTangCaSauGioLamViecTheoIDMay3 == "False")
                                                {
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                }
                                                else
                                                {
                                                    if (sChoPhepTangCaTruocGioLamViecTheoIDMay3 == "True")
                                                    {
                                                        int iThoiGianTruocGioLamTheoIDMay3;
                                                        iThoiGianTruocGioLamTheoIDMay3 = Convert.ToInt32(Convert.ToInt32((dGioVaoKhaiBaoTheoIDMayB2 - dGioVaoTheoIDMay).TotalMinutes).ToString());
                                                        if (iThoiGianTruocGioLamTheoIDMay3 > 0 && iThoiGianTruocGioLamTheoIDMay3 > iPhutTangCaTruocGioLamViecTheoIDMay3 && iThoiGianTruocGioLamTheoIDMay3 > iPhutTangCaTruocGioLamViecDatDen26)
                                                        {
                                                            iTongGioTangCaTruocTheoIDMay3 = iThoiGianTruocGioLamTheoIDMay3 - iPhutTruTangCaTruoc26;
                                                        }
                                                    }
                                                    if (sChoPhepTangCaSauGioLamViecTheoIDMay3 == "True")
                                                    {
                                                        int iThoiGianSauGioLamViecTheoIDMay4;
                                                        iThoiGianSauGioLamViecTheoIDMay4 = Convert.ToInt32(Convert.ToInt32((dGioRaTheoIDMay - dGioRaKhaiBaoTheoIDMayB2).TotalMinutes).ToString());
                                                        if (iThoiGianSauGioLamViecTheoIDMay4 > 0 && iThoiGianSauGioLamViecTheoIDMay4 > iPhutTangCaSauGioLamViecTheoIDMay3 && iThoiGianSauGioLamViecTheoIDMay4 > iPhutTangCaSauGioLamViecDatDen26)
                                                        {
                                                            iTongGioTangCaSauTheoIDMay3 = iThoiGianSauGioLamViecTheoIDMay4 - iPhutTruTangCaSau26;
                                                        }
                                                    }
                                                }
                                                double dTongThoiGianTangCaTheoIDMay3;
                                                dTongThoiGianTangCaTheoIDMay3 = Convert.ToDouble(iTongGioTangCaTruocTheoIDMay3 + iTongGioTangCaSauTheoIDMay3);
                                                if (dTongThoiGianTangCaTheoIDMay3 > 0.0)
                                                {
                                                    if (iGioiHanTC1TheoIDMay3 == 0)
                                                    {
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = Math.Round(dTongThoiGianTangCaTheoIDMay3 * this.dTangCa1HeSo / 60.0, this.iLamTronGio);
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                    }
                                                    if (iGioiHanTC1TheoIDMay3 != 0 && iGioiHanTC2TheoIDMay3 == 0)
                                                    {
                                                        if (dTongThoiGianTangCaTheoIDMay3 < Convert.ToDouble(iGioiHanTC1TheoIDMay3))
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = Math.Round(dTongThoiGianTangCaTheoIDMay3 * this.dTangCa1HeSo / 60.0, this.iLamTronGio);
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                        }
                                                        else
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = Math.Round(Convert.ToDouble(iGioiHanTC1TheoIDMay3) / 60.0 * this.dTangCa1HeSo, this.iLamTronGio);
                                                            if (dTongThoiGianTangCaTheoIDMay3 - Convert.ToDouble(iGioiHanTC1TheoIDMay3) > 0.0)
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = Math.Round((dTongThoiGianTangCaTheoIDMay3 - Convert.ToDouble(iGioiHanTC1TheoIDMay3)) * this.dTangCa2HeSo / 60.0, this.iLamTronGio);
                                                            }
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                        }
                                                    }
                                                    if (iGioiHanTC1TheoIDMay3 != 0 && iGioiHanTC2TheoIDMay3 != 0 && iGioiHanTC3TheoIDMay3 == 0)
                                                    {
                                                        if (dTongThoiGianTangCaTheoIDMay3 < Convert.ToDouble(iGioiHanTC1TheoIDMay3))
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = Math.Round(dTongThoiGianTangCaTheoIDMay3 * this.dTangCa1HeSo / 60.0, this.iLamTronGio);
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                        }
                                                        else
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = Math.Round(Convert.ToDouble(iGioiHanTC1TheoIDMay3) * this.dTangCa1HeSo / 60.0, this.iLamTronGio);
                                                            if (dTongThoiGianTangCaTheoIDMay3 - Convert.ToDouble(iGioiHanTC1TheoIDMay3) < Convert.ToDouble(iGioiHanTC2TheoIDMay3))
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = Math.Round((dTongThoiGianTangCaTheoIDMay3 - Convert.ToDouble(iGioiHanTC1TheoIDMay3)) * this.dTangCa2HeSo / 60.0, this.iLamTronGio);
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                            }
                                                            else
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = Math.Round(Convert.ToDouble(iGioiHanTC1TheoIDMay3) * this.dTangCa1HeSo / 60.0, this.iLamTronGio);
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = Math.Round(Convert.ToDouble(iGioiHanTC2TheoIDMay3) * this.dTangCa2HeSo / 60.0, this.iLamTronGio);
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = Math.Round((dTongThoiGianTangCaTheoIDMay3 - Convert.ToDouble(iGioiHanTC1TheoIDMay3) - Convert.ToDouble(iGioiHanTC2TheoIDMay3)) * this.dTangCa3HeSo / 60.0, this.iLamTronGio);
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                            }
                                                        }
                                                    }
                                                    if (iGioiHanTC1TheoIDMay3 != 0 && iGioiHanTC2TheoIDMay3 != 0 && iGioiHanTC3TheoIDMay3 != 0 && iGioiHanTC4TheoIDMay3 != 0)
                                                    {
                                                    }
                                                }
                                                else
                                                {
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                }
                                                string sTongGio13;
                                                sTongGio13 = Math.Round(Convert.ToDouble(Convert.ToInt32((dGioRaTheoIDMay - dGioVaoTheoIDMay).TotalMinutes).ToString()) / 60.0, this.iLamTronGio).ToString();
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[16].Value = sTongGio13;
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[17].Value = dtCaLamViecTheoIDMay2.Rows[iCaLamViecTheoIDMay2]["CongTinh"].ToString();
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[18].Value = this.sKHDungGio;
                                                if (DateTimeProgress.XuatIDThu((int)dt.AddDays(dem).DayOfWeek) == "0")
                                                {
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[19].Value = "CN";
                                                }
                                                else
                                                {
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[19].Value = "NT";
                                                }
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[20].Value = this.sMaChamCong;
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[21].Value = this.sPhongBanTinhCong;
                                            }
                                            break;
                                        }
                                        continue;
                                    }
                                    switch (iKiemTraB2)
                                    {
                                        case 1:
                                            {
                                                DateTime dGioRaTheoIDMay;
                                                dGioRaTheoIDMay = Convert.ToDateTime(dateGioChamTheoIDMay.ToString());
                                                this.DGVTinhCong.Rows[addTheoIDMay].Cells[6].Value = string.Format(this.sDinhDangThoiGian, dGioRaTheoIDMay);
                                                iKiemTraB2 = 0;
                                                new DataTable();
                                                this._chiTietLichTrinhChoCalamViecDTO.MaLichTrinhCaLamViec = sLTCCLVNhanVien;
                                                this._chiTietLichTrinhChoCalamViecDTO.Thu = sThu;
                                                DataTable dtNhanCaTheoIDMay3;
                                                dtNhanCaTheoIDMay3 = this._chiTietLichTrinhChoCaLamViecBLL.ChiTietLichTrinhChoCaLamViecNhanCa(this._chiTietLichTrinhChoCalamViecDTO);
                                                int iChiTietLichTrinhChoCaLamViecTheoIDMay3;
                                                iChiTietLichTrinhChoCaLamViecTheoIDMay3 = 0;
                                                if (iChiTietLichTrinhChoCaLamViecTheoIDMay3 >= dtNhanCaTheoIDMay3.Rows.Count)
                                                {
                                                    continue;
                                                }
                                                int cellChiTietLichTrinhChoCaLamViecTheoIDMay3;
                                                cellChiTietLichTrinhChoCaLamViecTheoIDMay3 = 3;
                                                while (true)
                                                {
                                                    if (cellChiTietLichTrinhChoCaLamViecTheoIDMay3 < 13)
                                                    {
                                                        kiemTraVao = 0;
                                                        kiemTraRa = 0;
                                                        this.sTheoIDMayMaCaLamViec = dtNhanCaTheoIDMay3.Rows[iChiTietLichTrinhChoCaLamViecTheoIDMay3][cellChiTietLichTrinhChoCaLamViecTheoIDMay3].ToString();
                                                        new DataTable();
                                                        DataTable dtTheoIDMayCa4;
                                                        dtTheoIDMayCa4 = this._caLamViecBLL.CaLamViecGetByMaCaLamViec(sTheoIDMayMaCaLamViec);
                                                        int iTheoIDMayCa4;
                                                        iTheoIDMayCa4 = 0;
                                                        while (iTheoIDMayCa4 < dtTheoIDMayCa4.Rows.Count)
                                                        {
                                                            this.sTheoIDMayTenCaLamViec = dtTheoIDMayCa4.Rows[iTheoIDMayCa4]["CaLamViec"].ToString();
                                                            DateTime dBatDauVaoTheoIDMayB4;
                                                            dBatDauVaoTheoIDMayB4 = Convert.ToDateTime(sNgayCham + " " + string.Format("{0:T}", Convert.ToDateTime(dtTheoIDMayCa4.Rows[iTheoIDMayCa4]["BatDauVao"].ToString())));
                                                            DateTime dKetThucVaoTheoIDMayB4;
                                                            dKetThucVaoTheoIDMayB4 = Convert.ToDateTime(sNgayCham + " " + string.Format("{0:T}", Convert.ToDateTime(dtTheoIDMayCa4.Rows[iTheoIDMayCa4]["KetThucVao"].ToString())));
                                                            string sBatDauRaTheoIDMayB4;
                                                            sBatDauRaTheoIDMayB4 = sNgayCham + " " + string.Format("{0:T}", Convert.ToDateTime(dtTheoIDMayCa4.Rows[iTheoIDMayCa4]["BatDauRa"].ToString()));
                                                            DateTime dBatDauRaTheoIDMayB4;
                                                            dBatDauRaTheoIDMayB4 = Convert.ToDateTime(sBatDauRaTheoIDMayB4);
                                                            dBatDauRaTheoIDMayB4 = ((!(sBatDauRaTheoIDMayB4 == "12:01:00 AM")) ? Convert.ToDateTime(dBatDauRaTheoIDMayB4) : Convert.ToDateTime(dBatDauRaTheoIDMayB4.AddDays(1.0).ToString()));
                                                            string sKetThucRaTheoIDMayA3;
                                                            sKetThucRaTheoIDMayA3 = string.Format("{0:T}", Convert.ToDateTime(dtTheoIDMayCa4.Rows[iTheoIDMayCa4]["KetThucRa"].ToString()));
                                                            DateTime dKetThucRaTheoIDMayB4;
                                                            dKetThucRaTheoIDMayB4 = Convert.ToDateTime(sNgayCham + " " + sKetThucRaTheoIDMayA3);
                                                            dKetThucRaTheoIDMayB4 = ((!(sKetThucRaTheoIDMayA3 == "12:01:00 AM")) ? Convert.ToDateTime(dKetThucRaTheoIDMayB4) : Convert.ToDateTime(dKetThucRaTheoIDMayB4.AddDays(1.0).ToString()));
                                                            if (dGioVaoTheoIDMay >= dBatDauVaoTheoIDMayB4 && dGioVaoTheoIDMay <= dKetThucVaoTheoIDMayB4)
                                                            {
                                                                kiemTraVao++;
                                                            }
                                                            if (dGioRaTheoIDMay >= dBatDauRaTheoIDMayB4 && dGioRaTheoIDMay <= dKetThucRaTheoIDMayB4)
                                                            {
                                                                kiemTraRa++;
                                                            }
                                                            if (kiemTraVao != 1 || kiemTraRa != 1)
                                                            {
                                                                iTheoIDMayCa4++;
                                                                continue;
                                                            }
                                                            goto IL_24c25;
                                                        }
                                                        if (!(this.sTheoIDMayMaCaLamViec == ""))
                                                        {
                                                            cellChiTietLichTrinhChoCaLamViecTheoIDMay3++;
                                                            continue;
                                                        }
                                                        this.DGVTinhCong.Rows[addTheoIDMay].Cells[4].Value = ca;
                                                        this.DGVTinhCong.Rows[addTheoIDMay].Cells[7].Value = "0";
                                                        this.DGVTinhCong.Rows[addTheoIDMay].Cells[8].Value = "0";
                                                        this.DGVTinhCong.Rows[addTheoIDMay].Cells[9].Value = "0";
                                                        this.DGVTinhCong.Rows[addTheoIDMay].Cells[10].Value = "0";
                                                        this.DGVTinhCong.Rows[addTheoIDMay].Cells[11].Value = "0";
                                                        this.DGVTinhCong.Rows[addTheoIDMay].Cells[12].Value = "0";
                                                        this.DGVTinhCong.Rows[addTheoIDMay].Cells[13].Value = "0";
                                                        this.DGVTinhCong.Rows[addTheoIDMay].Cells[14].Value = "0";
                                                        this.DGVTinhCong.Rows[addTheoIDMay].Cells[15].Value = "0";
                                                        this.DGVTinhCong.Rows[addTheoIDMay].Cells[16].Value = "0";
                                                        this.DGVTinhCong.Rows[addTheoIDMay].Cells[17].Value = "0";
                                                        this.DGVTinhCong.Rows[addTheoIDMay].Cells[18].Value = this.sKHVang;
                                                        break;
                                                    }
                                                    goto IL_24c25;
                                                IL_24c25:
                                                    this.DGVTinhCong.Rows[addTheoIDMay].Cells[4].Value = this.sTheoIDMayTenCaLamViec;
                                                    new DataTable();
                                                    DataTable dtCaLamViecTheoIDMay3;
                                                    dtCaLamViecTheoIDMay3 = this._caLamViecBLL.CaLamViecGetByMaCaLamViec(sTheoIDMayMaCaLamViec);
                                                    for (int iCaLamViecTheoIDMay3 = 0; iCaLamViecTheoIDMay3 < dtCaLamViecTheoIDMay3.Rows.Count; iCaLamViecTheoIDMay3++)
                                                    {
                                                        string sGiayGioVao36;
                                                        sGiayGioVao36 = dGioVaoTheoIDMay.Second.ToString();
                                                        string sGiayGioRa36;
                                                        sGiayGioRa36 = dGioRaTheoIDMay.Second.ToString();
                                                        DateTime dGioVaoKhaiBaoTheoIDMayB3;
                                                        dGioVaoKhaiBaoTheoIDMayB3 = Convert.ToDateTime(sNgayCham + " " + string.Format("{0:T}", Convert.ToDateTime(dtCaLamViecTheoIDMay3.Rows[iCaLamViecTheoIDMay3]["GioVaoLamViec"].ToString())).Replace("00 ", sGiayGioVao36 + " "));
                                                        DateTime dGioRaKhaiBaoTheoIDMayB3;
                                                        dGioRaKhaiBaoTheoIDMayB3 = Convert.ToDateTime(sNgayCham + " " + string.Format("{0:T}", Convert.ToDateTime(dtCaLamViecTheoIDMay3.Rows[iCaLamViecTheoIDMay3]["GioKetThucLamViec"].ToString())).Replace("00 ", sGiayGioRa36 + " "));
                                                        dtCaLamViecTheoIDMay3.Rows[iCaLamViecTheoIDMay3]["XemCaDem"].ToString();
                                                        string sTruGioDiTre30;
                                                        sTruGioDiTre30 = dtCaLamViecTheoIDMay3.Rows[iCaLamViecTheoIDMay3]["TruGioDiTre"].ToString();
                                                        string sBatDauTinhDiTre30;
                                                        sBatDauTinhDiTre30 = dtCaLamViecTheoIDMay3.Rows[iCaLamViecTheoIDMay3]["BatDauTinhDiTre"].ToString();
                                                        int iChoPhepDiTre26;
                                                        iChoPhepDiTre26 = Convert.ToInt32(dtCaLamViecTheoIDMay3.Rows[iCaLamViecTheoIDMay3]["ChoPhepDiTre"].ToString());
                                                        string sPhutTre38;
                                                        sPhutTre38 = Convert.ToInt32((dGioVaoTheoIDMay - dGioVaoKhaiBaoTheoIDMayB3).TotalMinutes).ToString();
                                                        if (sTruGioDiTre30 == "True")
                                                        {
                                                            if (Convert.ToInt32(sPhutTre38) < 0)
                                                            {
                                                                this.DGVTinhCong.Rows[addTheoIDMay].Cells[9].Value = "0";
                                                            }
                                                            else
                                                            {
                                                                int iPhutTre26;
                                                                iPhutTre26 = Convert.ToInt32(sPhutTre38) - iChoPhepDiTre26;
                                                                if (sBatDauTinhDiTre30 == "True")
                                                                {
                                                                    if (iPhutTre26 < 1)
                                                                    {
                                                                        this.DGVTinhCong.Rows[addTheoIDMay].Cells[9].Value = "0";
                                                                    }
                                                                    else
                                                                    {
                                                                        this.DGVTinhCong.Rows[addTheoIDMay].Cells[5].Style.BackColor = Color.Lime;
                                                                        this.DGVTinhCong.Rows[addTheoIDMay].Cells[9].Value = iPhutTre26.ToString();
                                                                    }
                                                                }
                                                                else if (iPhutTre26 < 1)
                                                                {
                                                                    this.DGVTinhCong.Rows[addTheoIDMay].Cells[9].Value = "0";
                                                                }
                                                                else
                                                                {
                                                                    this.DGVTinhCong.Rows[addTheoIDMay].Cells[9].Value = sPhutTre38;
                                                                }
                                                            }
                                                        }
                                                        else
                                                        {
                                                            this.DGVTinhCong.Rows[addTheoIDMay].Cells[9].Value = "0";
                                                        }
                                                        string sTruGioVeSom30;
                                                        sTruGioVeSom30 = dtCaLamViecTheoIDMay3.Rows[iCaLamViecTheoIDMay3]["TruGioVeSom"].ToString();
                                                        string sBatDauTinhVeSom30;
                                                        sBatDauTinhVeSom30 = dtCaLamViecTheoIDMay3.Rows[iCaLamViecTheoIDMay3]["BatDauTinhVeSom"].ToString();
                                                        int iChoPhepVeSom26;
                                                        iChoPhepVeSom26 = Convert.ToInt32(dtCaLamViecTheoIDMay3.Rows[iCaLamViecTheoIDMay3]["ChoPhepVeSom"].ToString());
                                                        string sPhutVeSom38;
                                                        sPhutVeSom38 = Convert.ToInt32((dGioRaKhaiBaoTheoIDMayB3 - dGioRaTheoIDMay).TotalMinutes).ToString();
                                                        if (sTruGioVeSom30 == "True")
                                                        {
                                                            if (Convert.ToInt32(sPhutVeSom38) < 0)
                                                            {
                                                                this.DGVTinhCong.Rows[addTheoIDMay].Cells[10].Value = "0";
                                                            }
                                                            else
                                                            {
                                                                int iPhutVeSom26;
                                                                iPhutVeSom26 = Convert.ToInt32(sPhutVeSom38) - iChoPhepVeSom26;
                                                                if (iPhutVeSom26 < 1)
                                                                {
                                                                    this.DGVTinhCong.Rows[addTheoIDMay].Cells[10].Value = "0";
                                                                }
                                                                else if (sBatDauTinhVeSom30 == "True")
                                                                {
                                                                    this.DGVTinhCong.Rows[addTheoIDMay].Cells[6].Style.BackColor = Color.Yellow;
                                                                    this.DGVTinhCong.Rows[addTheoIDMay].Cells[10].Value = iPhutVeSom26.ToString();
                                                                }
                                                                else
                                                                {
                                                                    this.DGVTinhCong.Rows[addTheoIDMay].Cells[10].Value = sPhutVeSom38;
                                                                }
                                                            }
                                                        }
                                                        else
                                                        {
                                                            this.DGVTinhCong.Rows[addTheoIDMay].Cells[10].Value = "0";
                                                        }
                                                        string sVeTre24;
                                                        sVeTre24 = Convert.ToInt32((dGioRaTheoIDMay - dGioRaKhaiBaoTheoIDMayB3).TotalMinutes).ToString();
                                                        if (Convert.ToInt32(sVeTre24) > 0)
                                                        {
                                                            this.DGVTinhCong.Rows[addTheoIDMay].Cells[11].Value = sVeTre24;
                                                        }
                                                        else
                                                        {
                                                            this.DGVTinhCong.Rows[addTheoIDMay].Cells[11].Value = "0";
                                                        }
                                                        double dGio24;
                                                        dGio24 = Math.Round(Convert.ToDouble(Convert.ToSingle(dtCaLamViecTheoIDMay3.Rows[iCaLamViecTheoIDMay3]["TongGioTrongCaLamViec"]) * 60f - (float)(Convert.ToInt32(this.DGVTinhCong.Rows[addTheoIDMay].Cells[9].Value.ToString()) + Convert.ToInt32(this.DGVTinhCong.Rows[addTheoIDMay].Cells[10].Value))) / 60.0, this.iLamTronGio);
                                                        this.DGVTinhCong.Rows[addTheoIDMay].Cells[8].Value = dGio24.ToString();
                                                        double iGio24;
                                                        iGio24 = Convert.ToDouble(dtCaLamViecTheoIDMay3.Rows[iCaLamViecTheoIDMay3]["TongGioTrongCaLamViec"].ToString());
                                                        double dCongTinh22;
                                                        dCongTinh22 = Convert.ToDouble(dtCaLamViecTheoIDMay3.Rows[iCaLamViecTheoIDMay3]["CongTinh"].ToString());
                                                        double dCong24;
                                                        dCong24 = Math.Round(dGio24 * dCongTinh22 / iGio24, this.iLamTronCong);
                                                        this.DGVTinhCong.Rows[addTheoIDMay].Cells[7].Value = dCong24.ToString();
                                                        string sTangCaTruocGioLamViec16;
                                                        sTangCaTruocGioLamViec16 = dtCaLamViecTheoIDMay3.Rows[iCaLamViecTheoIDMay3]["TangCaTruocGioLamViec"].ToString();
                                                        string sTangCaSauGioLamViec16;
                                                        sTangCaSauGioLamViec16 = dtCaLamViecTheoIDMay3.Rows[iCaLamViecTheoIDMay3]["TangCaSauGioLamViec"].ToString();
                                                        if (sTangCaTruocGioLamViec16 == "False" && sTangCaSauGioLamViec16 == "False")
                                                        {
                                                            this.DGVTinhCong.Rows[addTheoIDMay].Cells[12].Value = "0";
                                                            this.DGVTinhCong.Rows[addTheoIDMay].Cells[13].Value = "0";
                                                            this.DGVTinhCong.Rows[addTheoIDMay].Cells[14].Value = "0";
                                                            this.DGVTinhCong.Rows[addTheoIDMay].Cells[15].Value = "0";
                                                        }
                                                        string sXemCaNayLaTangCa14;
                                                        sXemCaNayLaTangCa14 = dtCaLamViecTheoIDMay3.Rows[iCaLamViecTheoIDMay3]["XemCaNayLaTangCa"].ToString();
                                                        int iTangCaMuc14;
                                                        iTangCaMuc14 = Convert.ToInt32(dtCaLamViecTheoIDMay3.Rows[iCaLamViecTheoIDMay3]["TangCaMuc"].ToString());
                                                        if (sXemCaNayLaTangCa14 == "True")
                                                        {
                                                            if (iTangCaMuc14 == 1)
                                                            {
                                                                this.DGVTinhCong.Rows[addTheoIDMay].Cells[7].Value = "0";
                                                                this.DGVTinhCong.Rows[addTheoIDMay].Cells[8].Value = "0";
                                                                this.DGVTinhCong.Rows[addTheoIDMay].Cells[12].Value = dGio24.ToString();
                                                                this.DGVTinhCong.Rows[addTheoIDMay].Cells[13].Value = "0";
                                                                this.DGVTinhCong.Rows[addTheoIDMay].Cells[14].Value = "0";
                                                                this.DGVTinhCong.Rows[addTheoIDMay].Cells[15].Value = "0";
                                                            }
                                                            if (iTangCaMuc14 == 2)
                                                            {
                                                                this.DGVTinhCong.Rows[addTheoIDMay].Cells[7].Value = "0";
                                                                this.DGVTinhCong.Rows[addTheoIDMay].Cells[8].Value = "0";
                                                                this.DGVTinhCong.Rows[addTheoIDMay].Cells[12].Value = "0";
                                                                this.DGVTinhCong.Rows[addTheoIDMay].Cells[13].Value = dGio24.ToString();
                                                                this.DGVTinhCong.Rows[addTheoIDMay].Cells[14].Value = "0";
                                                                this.DGVTinhCong.Rows[addTheoIDMay].Cells[15].Value = "0";
                                                            }
                                                            if (iTangCaMuc14 == 3)
                                                            {
                                                                this.DGVTinhCong.Rows[addTheoIDMay].Cells[7].Value = "0";
                                                                this.DGVTinhCong.Rows[addTheoIDMay].Cells[8].Value = "0";
                                                                this.DGVTinhCong.Rows[addTheoIDMay].Cells[12].Value = "0";
                                                                this.DGVTinhCong.Rows[addTheoIDMay].Cells[13].Value = "0";
                                                                this.DGVTinhCong.Rows[addTheoIDMay].Cells[14].Value = dGio24.ToString();
                                                                this.DGVTinhCong.Rows[addTheoIDMay].Cells[15].Value = "0";
                                                            }
                                                            if (iTangCaMuc14 == 4)
                                                            {
                                                                this.DGVTinhCong.Rows[addTheoIDMay].Cells[7].Value = "0";
                                                                this.DGVTinhCong.Rows[addTheoIDMay].Cells[8].Value = "0";
                                                                this.DGVTinhCong.Rows[addTheoIDMay].Cells[12].Value = "0";
                                                                this.DGVTinhCong.Rows[addTheoIDMay].Cells[13].Value = "0";
                                                                this.DGVTinhCong.Rows[addTheoIDMay].Cells[14].Value = "0";
                                                                this.DGVTinhCong.Rows[addTheoIDMay].Cells[15].Value = dGio24.ToString();
                                                            }
                                                        }
                                                        string sChoPhepTangCaTruocGioLamViecTheoIDMay4;
                                                        sChoPhepTangCaTruocGioLamViecTheoIDMay4 = dtCaLamViecTheoIDMay3.Rows[iCaLamViecTheoIDMay3]["TangCaTruocGioLamViec"].ToString();
                                                        int iPhutTangCaTruocGioLamViecTheoIDMay4;
                                                        iPhutTangCaTruocGioLamViecTheoIDMay4 = Convert.ToInt32(dtCaLamViecTheoIDMay3.Rows[iCaLamViecTheoIDMay3]["SoPhutTangCaTruocGioLamViec"].ToString());
                                                        int iPhutTangCaTruocGioLamViecDatDen28;
                                                        iPhutTangCaTruocGioLamViecDatDen28 = Convert.ToInt32(dtCaLamViecTheoIDMay3.Rows[iCaLamViecTheoIDMay3]["TangCaTruocGioLamViecDatDen"].ToString());
                                                        int iPhutTruTangCaTruoc28;
                                                        iPhutTruTangCaTruoc28 = Convert.ToInt32(dtCaLamViecTheoIDMay3.Rows[iCaLamViecTheoIDMay3]["PhutTruTangCaTruoc"].ToString());
                                                        string sChoPhepTangCaSauGioLamViecTheoIDMay4;
                                                        sChoPhepTangCaSauGioLamViecTheoIDMay4 = dtCaLamViecTheoIDMay3.Rows[iCaLamViecTheoIDMay3]["TangCaSauGioLamViec"].ToString();
                                                        int iPhutTangCaSauGioLamViecTheoIDMay4;
                                                        iPhutTangCaSauGioLamViecTheoIDMay4 = Convert.ToInt32(dtCaLamViecTheoIDMay3.Rows[iCaLamViecTheoIDMay3]["SoPhutTangCaSauGioLamViec"].ToString());
                                                        int iPhutTangCaSauGioLamViecDatDen28;
                                                        iPhutTangCaSauGioLamViecDatDen28 = Convert.ToInt32(dtCaLamViecTheoIDMay3.Rows[iCaLamViecTheoIDMay3]["TangCaSauGioLamViecDatDen"].ToString());
                                                        int iPhutTruTangCaSau28;
                                                        iPhutTruTangCaSau28 = Convert.ToInt32(dtCaLamViecTheoIDMay3.Rows[iCaLamViecTheoIDMay3]["PhutTruTangCaSau"].ToString());
                                                        int iGioiHanTC1TheoIDMay4;
                                                        iGioiHanTC1TheoIDMay4 = Convert.ToInt32(dtCaLamViecTheoIDMay3.Rows[iCaLamViecTheoIDMay3]["GioiHanTangCa1"].ToString());
                                                        int iGioiHanTC2TheoIDMay4;
                                                        iGioiHanTC2TheoIDMay4 = Convert.ToInt32(dtCaLamViecTheoIDMay3.Rows[iCaLamViecTheoIDMay3]["GioiHanTangCa2"].ToString());
                                                        int iGioiHanTC3TheoIDMay4;
                                                        iGioiHanTC3TheoIDMay4 = Convert.ToInt32(dtCaLamViecTheoIDMay3.Rows[iCaLamViecTheoIDMay3]["GioiHanTangCa3"].ToString());
                                                        int iGioiHanTC4TheoIDMay4;
                                                        iGioiHanTC4TheoIDMay4 = Convert.ToInt32(dtCaLamViecTheoIDMay3.Rows[iCaLamViecTheoIDMay3]["GioiHanTangCa4"].ToString());
                                                        int iTongGioTangCaSauTheoIDMay4;
                                                        iTongGioTangCaSauTheoIDMay4 = 0;
                                                        int iTongGioTangCaTruocTheoIDMay4;
                                                        iTongGioTangCaTruocTheoIDMay4 = 0;
                                                        if (sChoPhepTangCaTruocGioLamViecTheoIDMay4 == "False" && sChoPhepTangCaSauGioLamViecTheoIDMay4 == "False")
                                                        {
                                                            this.DGVTinhCong.Rows[addTheoIDMay].Cells[12].Value = "0";
                                                            this.DGVTinhCong.Rows[addTheoIDMay].Cells[13].Value = "0";
                                                            this.DGVTinhCong.Rows[addTheoIDMay].Cells[14].Value = "0";
                                                            this.DGVTinhCong.Rows[addTheoIDMay].Cells[15].Value = "0";
                                                        }
                                                        else
                                                        {
                                                            if (sChoPhepTangCaTruocGioLamViecTheoIDMay4 == "True")
                                                            {
                                                                int iThoiGianTruocGioLamTheoIDMay4;
                                                                iThoiGianTruocGioLamTheoIDMay4 = Convert.ToInt32(Convert.ToInt32((dGioVaoKhaiBaoTheoIDMayB3 - dGioVaoTheoIDMay).TotalMinutes).ToString());
                                                                if (iThoiGianTruocGioLamTheoIDMay4 > 0 && iThoiGianTruocGioLamTheoIDMay4 > iPhutTangCaTruocGioLamViecTheoIDMay4 && iThoiGianTruocGioLamTheoIDMay4 > iPhutTangCaTruocGioLamViecDatDen28)
                                                                {
                                                                    iTongGioTangCaTruocTheoIDMay4 = iThoiGianTruocGioLamTheoIDMay4 - iPhutTruTangCaTruoc28;
                                                                }
                                                            }
                                                            if (sChoPhepTangCaSauGioLamViecTheoIDMay4 == "True")
                                                            {
                                                                int iThoiGianSauGioLamViecTheoIDMay5;
                                                                iThoiGianSauGioLamViecTheoIDMay5 = Convert.ToInt32(Convert.ToInt32((dGioRaTheoIDMay - dGioRaKhaiBaoTheoIDMayB3).TotalMinutes).ToString());
                                                                if (iThoiGianSauGioLamViecTheoIDMay5 > 0 && iThoiGianSauGioLamViecTheoIDMay5 > iPhutTangCaSauGioLamViecTheoIDMay4 && iThoiGianSauGioLamViecTheoIDMay5 > iPhutTangCaSauGioLamViecDatDen28)
                                                                {
                                                                    iTongGioTangCaSauTheoIDMay4 = iThoiGianSauGioLamViecTheoIDMay5 - iPhutTruTangCaSau28;
                                                                }
                                                            }
                                                        }
                                                        double dTongThoiGianTangCaTheoIDMay4;
                                                        dTongThoiGianTangCaTheoIDMay4 = Convert.ToDouble(iTongGioTangCaTruocTheoIDMay4 + iTongGioTangCaSauTheoIDMay4);
                                                        if (dTongThoiGianTangCaTheoIDMay4 > 0.0)
                                                        {
                                                            if (iGioiHanTC1TheoIDMay4 == 0)
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = Math.Round(dTongThoiGianTangCaTheoIDMay4 * this.dTangCa1HeSo / 60.0, this.iLamTronGio);
                                                                this.DGVTinhCong.Rows[addTheoIDMay].Cells[13].Value = "0";
                                                                this.DGVTinhCong.Rows[addTheoIDMay].Cells[14].Value = "0";
                                                                this.DGVTinhCong.Rows[addTheoIDMay].Cells[15].Value = "0";
                                                            }
                                                            if (iGioiHanTC1TheoIDMay4 != 0 && iGioiHanTC2TheoIDMay4 == 0)
                                                            {
                                                                if (dTongThoiGianTangCaTheoIDMay4 < Convert.ToDouble(iGioiHanTC1TheoIDMay4))
                                                                {
                                                                    this.DGVTinhCong.Rows[addTheoIDMay].Cells[12].Value = Math.Round(dTongThoiGianTangCaTheoIDMay4 * this.dTangCa1HeSo / 60.0, this.iLamTronGio);
                                                                    this.DGVTinhCong.Rows[addTheoIDMay].Cells[13].Value = "0";
                                                                    this.DGVTinhCong.Rows[addTheoIDMay].Cells[14].Value = "0";
                                                                    this.DGVTinhCong.Rows[addTheoIDMay].Cells[15].Value = "0";
                                                                }
                                                                else
                                                                {
                                                                    this.DGVTinhCong.Rows[addTheoIDMay].Cells[12].Value = Math.Round(Convert.ToDouble(iGioiHanTC1TheoIDMay4) / 60.0 * this.dTangCa1HeSo, this.iLamTronGio);
                                                                    if (dTongThoiGianTangCaTheoIDMay4 - Convert.ToDouble(iGioiHanTC1TheoIDMay4) > 0.0)
                                                                    {
                                                                        this.DGVTinhCong.Rows[addTheoIDMay].Cells[13].Value = Math.Round((dTongThoiGianTangCaTheoIDMay4 - Convert.ToDouble(iGioiHanTC1TheoIDMay4)) * this.dTangCa2HeSo / 60.0, this.iLamTronGio);
                                                                    }
                                                                    this.DGVTinhCong.Rows[addTheoIDMay].Cells[14].Value = "0";
                                                                    this.DGVTinhCong.Rows[addTheoIDMay].Cells[15].Value = "0";
                                                                }
                                                            }
                                                            if (iGioiHanTC1TheoIDMay4 != 0 && iGioiHanTC2TheoIDMay4 != 0 && iGioiHanTC3TheoIDMay4 == 0)
                                                            {
                                                                if (dTongThoiGianTangCaTheoIDMay4 < Convert.ToDouble(iGioiHanTC1TheoIDMay4))
                                                                {
                                                                    this.DGVTinhCong.Rows[addTheoIDMay].Cells[12].Value = Math.Round(dTongThoiGianTangCaTheoIDMay4 * this.dTangCa1HeSo / 60.0, this.iLamTronGio);
                                                                    this.DGVTinhCong.Rows[addTheoIDMay].Cells[13].Value = "0";
                                                                    this.DGVTinhCong.Rows[addTheoIDMay].Cells[14].Value = "0";
                                                                    this.DGVTinhCong.Rows[addTheoIDMay].Cells[15].Value = "0";
                                                                }
                                                                else
                                                                {
                                                                    this.DGVTinhCong.Rows[addTheoIDMay].Cells[12].Value = Math.Round(Convert.ToDouble(iGioiHanTC1TheoIDMay4) * this.dTangCa1HeSo / 60.0, this.iLamTronGio);
                                                                    if (dTongThoiGianTangCaTheoIDMay4 - Convert.ToDouble(iGioiHanTC1TheoIDMay4) < Convert.ToDouble(iGioiHanTC2TheoIDMay4))
                                                                    {
                                                                        this.DGVTinhCong.Rows[addTheoIDMay].Cells[13].Value = Math.Round((dTongThoiGianTangCaTheoIDMay4 - Convert.ToDouble(iGioiHanTC1TheoIDMay4)) * this.dTangCa2HeSo / 60.0, this.iLamTronGio);
                                                                        this.DGVTinhCong.Rows[addTheoIDMay].Cells[14].Value = "0";
                                                                        this.DGVTinhCong.Rows[addTheoIDMay].Cells[15].Value = "0";
                                                                    }
                                                                    else
                                                                    {
                                                                        this.DGVTinhCong.Rows[addTheoIDMay].Cells[12].Value = Math.Round(Convert.ToDouble(iGioiHanTC1TheoIDMay4) * this.dTangCa1HeSo / 60.0, this.iLamTronGio);
                                                                        this.DGVTinhCong.Rows[addTheoIDMay].Cells[13].Value = Math.Round(Convert.ToDouble(iGioiHanTC2TheoIDMay4) * this.dTangCa2HeSo / 60.0, this.iLamTronGio);
                                                                        this.DGVTinhCong.Rows[addTheoIDMay].Cells[14].Value = Math.Round((dTongThoiGianTangCaTheoIDMay4 - Convert.ToDouble(iGioiHanTC1TheoIDMay4) - Convert.ToDouble(iGioiHanTC2TheoIDMay4)) * this.dTangCa3HeSo / 60.0, this.iLamTronGio);
                                                                        this.DGVTinhCong.Rows[addTheoIDMay].Cells[15].Value = "0";
                                                                    }
                                                                }
                                                            }
                                                            if (iGioiHanTC1TheoIDMay4 != 0 && iGioiHanTC2TheoIDMay4 != 0 && iGioiHanTC3TheoIDMay4 != 0 && iGioiHanTC4TheoIDMay4 != 0)
                                                            {
                                                            }
                                                        }
                                                        else
                                                        {
                                                            this.DGVTinhCong.Rows[addTheoIDMay].Cells[12].Value = "0";
                                                            this.DGVTinhCong.Rows[addTheoIDMay].Cells[13].Value = "0";
                                                            this.DGVTinhCong.Rows[addTheoIDMay].Cells[14].Value = "0";
                                                            this.DGVTinhCong.Rows[addTheoIDMay].Cells[15].Value = "0";
                                                        }
                                                        string sTongGio15;
                                                        sTongGio15 = Math.Round(Convert.ToDouble(Convert.ToInt32((dGioRaTheoIDMay - dGioVaoTheoIDMay).TotalMinutes).ToString()) / 60.0, this.iLamTronGio).ToString();
                                                        this.DGVTinhCong.Rows[addTheoIDMay].Cells[16].Value = sTongGio15;
                                                        this.DGVTinhCong.Rows[addTheoIDMay].Cells[17].Value = dtCaLamViecTheoIDMay3.Rows[iCaLamViecTheoIDMay3]["CongTinh"].ToString();
                                                        this.DGVTinhCong.Rows[addTheoIDMay].Cells[18].Value = this.sKHDungGio;
                                                        if (DateTimeProgress.XuatIDThu((int)dt.AddDays(dem).DayOfWeek) == "0")
                                                        {
                                                            this.DGVTinhCong.Rows[addTheoIDMay].Cells[19].Value = "CN";
                                                        }
                                                        else
                                                        {
                                                            this.DGVTinhCong.Rows[addTheoIDMay].Cells[19].Value = "NT";
                                                        }
                                                        this.DGVTinhCong.Rows[addTheoIDMay].Cells[20].Value = this.sMaChamCong;
                                                        this.DGVTinhCong.Rows[addTheoIDMay].Cells[21].Value = this.sPhongBanTinhCong;
                                                    }
                                                    break;
                                                }
                                                continue;
                                            }
                                        case 0:
                                            {
                                                int addTheoIDMayB;
                                                addTheoIDMayB = this.DGVTinhCong.Rows.Add();
                                                DateTime dGioRaTheoIDMay;
                                                dGioRaTheoIDMay = Convert.ToDateTime(dateGioChamTheoIDMay.ToString());
                                                this.DGVTinhCong.Rows[addTheoIDMayB].Cells[6].Value = string.Format(this.sDinhDangThoiGian, dGioRaTheoIDMay);
                                                this.DGVTinhCong.Rows[addTheoIDMayB].Cells[0].Value = this.sMaNhanVien;
                                                this.DGVTinhCong.Rows[addTheoIDMayB].Cells[1].Value = this.sTenNhanVien;
                                                this.DGVTinhCong.Rows[addTheoIDMayB].Cells[2].Value = this.DGVTinhCong.Rows[_nhanVien].Cells[2].Value.ToString();
                                                this.DGVTinhCong.Rows[addTheoIDMayB].Cells[4].Value = ca;
                                                this.DGVTinhCong.Rows[addTheoIDMayB].Cells[7].Value = "0";
                                                this.DGVTinhCong.Rows[addTheoIDMayB].Cells[8].Value = "0";
                                                this.DGVTinhCong.Rows[addTheoIDMayB].Cells[3].Value = DateTimeProgress.XuatThuTinhCong((int)dt.AddDays(dem).DayOfWeek);
                                                this.DGVTinhCong.Rows[addTheoIDMayB].Cells[17].Value = "0";
                                                this.DGVTinhCong.Rows[addTheoIDMayB].Cells[18].Value = this.sKHVang;
                                                if (DateTimeProgress.XuatIDThu((int)dt.AddDays(dem).DayOfWeek) == "0")
                                                {
                                                    this.DGVTinhCong.Rows[addTheoIDMayB].Cells[19].Value = "CN";
                                                }
                                                else
                                                {
                                                    this.DGVTinhCong.Rows[addTheoIDMayB].Cells[19].Value = "NT";
                                                }
                                                this.DGVTinhCong.Rows[addTheoIDMayB].Cells[20].Value = this.sMaChamCong;
                                                this.DGVTinhCong.Rows[addTheoIDMayB].Cells[21].Value = this.sPhongBanTinhCong;
                                                break;
                                            }
                                    }
                                }
                                iLanCham2++;
                            }
                            _ = dtTheoIDMay.Rows.Count;
                            if (iLanCham2 == 1)
                            {
                                this.DGVTinhCong.Rows[_nhanVien].Cells[0].Value = this.sMaNhanVien;
                                this.DGVTinhCong.Rows[_nhanVien].Cells[1].Value = this.sTenNhanVien;
                                this.DGVTinhCong.Rows[_nhanVien].Cells[2].Value = this.DGVTinhCong.Rows[_nhanVien].Cells[2].Value.ToString();
                                this.DGVTinhCong.Rows[_nhanVien].Cells[3].Value = DateTimeProgress.XuatThuTinhCong((int)dt.AddDays(dem).DayOfWeek);
                                this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = "0";
                                this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = "0";
                                this.DGVTinhCong.Rows[_nhanVien].Cells[17].Value = "0";
                                this.DGVTinhCong.Rows[_nhanVien].Cells[18].Value = this.sKHVang;
                                if (DateTimeProgress.XuatIDThu((int)dt.AddDays(dem).DayOfWeek) == "0")
                                {
                                    this.DGVTinhCong.Rows[_nhanVien].Cells[19].Value = "CN";
                                }
                                else
                                {
                                    this.DGVTinhCong.Rows[_nhanVien].Cells[19].Value = "NT";
                                }
                                this.DGVTinhCong.Rows[_nhanVien].Cells[20].Value = this.sMaChamCong;
                                this.DGVTinhCong.Rows[_nhanVien].Cells[21].Value = this.sPhongBanTinhCong;
                            }
                        }
                        if (iChonLichTrinh == 5)
                        {
                            DateTime dGioVaoFilo;
                            dGioVaoFilo = default(DateTime);
                            DateTime dGioRaFilo;
                            dGioRaFilo = default(DateTime);
                            int iLanChamFilo;
                            iLanChamFilo = 0;
                            new DataTable();
                            DataTable dtGioChamFilo;
                            dtGioChamFilo = this._checkInOutBLL.getCheckInOutByMaChamCongAndNgayCham(Convert.ToInt32(this.sMaChamCong), Convert.ToDateTime(this.DGVTinhCong.Rows[_nhanVien].Cells[2].Value.ToString()));
                            for (int iGioChamFilo = 0; iGioChamFilo < dtGioChamFilo.Rows.Count; iGioChamFilo++)
                            {
                                iLanChamFilo++;
                                if (iLanChamFilo == 1 && dtGioChamFilo.Rows.Count == 1)
                                {
                                    dGioVaoFilo = Convert.ToDateTime(dtGioChamFilo.Rows[iGioChamFilo]["GioCham"].ToString());
                                    this.DGVTinhCong.Rows[_nhanVien].Cells[5].Value = string.Format(this.sDinhDangThoiGian, dGioVaoFilo);
                                    new DataTable();
                                    this._chiTietLichTrinhChoCalamViecDTO.MaLichTrinhCaLamViec = sLTCCLVNhanVien;
                                    this._chiTietLichTrinhChoCalamViecDTO.Thu = sThu;
                                    DataTable dtNhanCaFilo2;
                                    dtNhanCaFilo2 = this._chiTietLichTrinhChoCaLamViecBLL.ChiTietLichTrinhChoCaLamViecNhanCa(this._chiTietLichTrinhChoCalamViecDTO);
                                    int iChiTietLichTrinhChoCaLamViecFilo2;
                                    iChiTietLichTrinhChoCaLamViecFilo2 = 0;
                                    if (iChiTietLichTrinhChoCaLamViecFilo2 < dtNhanCaFilo2.Rows.Count)
                                    {
                                        int cellChiTietLichTrinhChoCaLamViecFilo2;
                                        cellChiTietLichTrinhChoCaLamViecFilo2 = 3;
                                        while (true)
                                        {
                                            if (cellChiTietLichTrinhChoCaLamViecFilo2 < 13)
                                            {
                                                kiemTraVao = 0;
                                                kiemTraRa = 0;
                                                this.sFiloMaCaLamViec = dtNhanCaFilo2.Rows[iChiTietLichTrinhChoCaLamViecFilo2][cellChiTietLichTrinhChoCaLamViecFilo2].ToString();
                                                new DataTable();
                                                DataTable dtFiloCa2;
                                                dtFiloCa2 = this._caLamViecBLL.CaLamViecGetByMaCaLamViec(sFiloMaCaLamViec);
                                                int iFiloCa2;
                                                iFiloCa2 = 0;
                                                while (iFiloCa2 < dtFiloCa2.Rows.Count)
                                                {
                                                    string sGiayGioVao30;
                                                    sGiayGioVao30 = dGioVaoFilo.Second.ToString();
                                                    string sGiayGioRa30;
                                                    sGiayGioRa30 = dGioRaFilo.Second.ToString();
                                                    this.sFiloTenCaLamViec = dtFiloCa2.Rows[iFiloCa2]["CaLamViec"].ToString();
                                                    DateTime dBatDauVaoFiloB2;
                                                    dBatDauVaoFiloB2 = Convert.ToDateTime(sNgayCham + " " + string.Format("{0:T}", Convert.ToDateTime(dtFiloCa2.Rows[iFiloCa2]["BatDauVao"].ToString())).Replace("00 ", sGiayGioVao30 + " "));
                                                    DateTime dKetThucVaoFiloB2;
                                                    dKetThucVaoFiloB2 = Convert.ToDateTime(sNgayCham + " " + string.Format("{0:T}", Convert.ToDateTime(dtFiloCa2.Rows[iFiloCa2]["KetThucVao"].ToString())).Replace("00 ", sGiayGioVao30 + " "));
                                                    DateTime dBatDauRaFiloB2;
                                                    dBatDauRaFiloB2 = Convert.ToDateTime(sNgayCham + " " + string.Format("{0:T}", Convert.ToDateTime(dtFiloCa2.Rows[iFiloCa2]["BatDauRa"].ToString())).Replace("00 ", sGiayGioRa30 + " "));
                                                    DateTime dKetThucRaFiloB2;
                                                    dKetThucRaFiloB2 = Convert.ToDateTime(sNgayCham + " " + string.Format("{0:T}", Convert.ToDateTime(dtFiloCa2.Rows[iFiloCa2]["KetThucRa"].ToString())).Replace("00 ", sGiayGioRa30 + " "));
                                                    if (dGioVaoFilo >= dBatDauVaoFiloB2 && dGioVaoFilo <= dKetThucVaoFiloB2)
                                                    {
                                                        kiemTraVao++;
                                                    }
                                                    if (dGioVaoFilo >= dBatDauRaFiloB2 && dGioVaoFilo <= dKetThucRaFiloB2)
                                                    {
                                                        kiemTraRa++;
                                                    }
                                                    if ((kiemTraVao != 1 || kiemTraRa != 0) && (kiemTraVao != 0 || kiemTraRa != 1))
                                                    {
                                                        iFiloCa2++;
                                                        continue;
                                                    }
                                                    goto IL_2734f;
                                                }
                                                if (!(this.sFiloMaCaLamViec == ""))
                                                {
                                                    cellChiTietLichTrinhChoCaLamViecFilo2++;
                                                    continue;
                                                }
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[4].Value = ca;
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[11].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[16].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[17].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[18].Value = this.sKHThieuGioRa;
                                                if (DateTimeProgress.XuatIDThu((int)dt.AddDays(dem).DayOfWeek) == "0")
                                                {
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[19].Value = "CN";
                                                }
                                                else
                                                {
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[19].Value = "NT";
                                                }
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[20].Value = this.sMaChamCong;
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[21].Value = this.sPhongBanTinhCong;
                                                break;
                                            }
                                            goto IL_2734f;
                                        IL_2734f:
                                            this.DGVTinhCong.Rows[_nhanVien].Cells[4].Value = this.sFiloTenCaLamViec;
                                            new DataTable();
                                            DataTable dtCaLamViecFiloChamMotLan2;
                                            dtCaLamViecFiloChamMotLan2 = this._caLamViecBLL.CaLamViecGetByMaCaLamViec(sFiloMaCaLamViec);
                                            for (int iCaLamViecFiLoChamMotLan2 = 0; iCaLamViecFiLoChamMotLan2 < dtCaLamViecFiloChamMotLan2.Rows.Count; iCaLamViecFiLoChamMotLan2++)
                                            {
                                                string sGiayGioVao29;
                                                sGiayGioVao29 = dGioVaoFilo.Second.ToString();
                                                DateTime dGioVaoKhaiBaoFiloB4;
                                                dGioVaoKhaiBaoFiloB4 = Convert.ToDateTime(sNgayCham + " " + string.Format("{0:T}", Convert.ToDateTime(dtCaLamViecFiloChamMotLan2.Rows[iCaLamViecFiLoChamMotLan2]["GioVaoLamViec"].ToString())).Replace("00 ", sGiayGioVao29 + " "));
                                                if (Convert.ToInt32(dtCaLamViecFiloChamMotLan2.Rows[iCaLamViecFiLoChamMotLan2]["KhongCoGioRa"].ToString()) == 0)
                                                {
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[16].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[17].Value = "0";
                                                }
                                                else if (kiemTraVao != 0)
                                                {
                                                    string sTruGioDiTre23;
                                                    sTruGioDiTre23 = dtCaLamViecFiloChamMotLan2.Rows[iCaLamViecFiLoChamMotLan2]["TruGioDiTre"].ToString();
                                                    string sBatDauTinhDiTre23;
                                                    sBatDauTinhDiTre23 = dtCaLamViecFiloChamMotLan2.Rows[iCaLamViecFiLoChamMotLan2]["BatDauTinhDiTre"].ToString();
                                                    int iChoPhepDiTre20;
                                                    iChoPhepDiTre20 = Convert.ToInt32(dtCaLamViecFiloChamMotLan2.Rows[iCaLamViecFiLoChamMotLan2]["ChoPhepDiTre"].ToString());
                                                    string sPhutTre28;
                                                    sPhutTre28 = Convert.ToInt32((dGioVaoFilo - dGioVaoKhaiBaoFiloB4).TotalMinutes).ToString();
                                                    if (sTruGioDiTre23 == "True")
                                                    {
                                                        if (Convert.ToInt32(sPhutTre28) < 0)
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = "0";
                                                        }
                                                        else
                                                        {
                                                            int iPhutTre20;
                                                            iPhutTre20 = Convert.ToInt32(sPhutTre28) - iChoPhepDiTre20;
                                                            if (sBatDauTinhDiTre23 == "True")
                                                            {
                                                                if (iPhutTre20 < 1)
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = "0";
                                                                }
                                                                else
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = iPhutTre20.ToString();
                                                                }
                                                            }
                                                            else if (iPhutTre20 < 1)
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = "0";
                                                            }
                                                            else
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = sPhutTre28;
                                                            }
                                                        }
                                                    }
                                                    else
                                                    {
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = "0";
                                                    }
                                                    double dGioChamMotLan4;
                                                    dGioChamMotLan4 = Math.Round((Convert.ToDouble(dtCaLamViecFiloChamMotLan2.Rows[iCaLamViecFiLoChamMotLan2]["KhongCoGioRa"].ToString()) - Convert.ToDouble(this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value.ToString())) / 60.0, this.iLamTronGio);
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = dGioChamMotLan4.ToString();
                                                    Math.Round(Convert.ToDouble(dtCaLamViecFiloChamMotLan2.Rows[iCaLamViecFiLoChamMotLan2]["KhongCoGioRa"].ToString()) / 60.0, 2);
                                                    double dCongChamMotLan4;
                                                    dCongChamMotLan4 = Math.Round(dGioChamMotLan4 * Convert.ToDouble(dtCaLamViecFiloChamMotLan2.Rows[iCaLamViecFiLoChamMotLan2]["CongTinh"].ToString()) / Convert.ToDouble(dtCaLamViecFiloChamMotLan2.Rows[iCaLamViecFiLoChamMotLan2]["TongGioTrongCaLamViec"].ToString()), this.iLamTronCong);
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = dCongChamMotLan4.ToString();
                                                }
                                                if (Convert.ToInt32(dtCaLamViecFiloChamMotLan2.Rows[iCaLamViecFiLoChamMotLan2]["KhongCoGioVao"].ToString()) == 0)
                                                {
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[16].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[17].Value = "0";
                                                }
                                                else if (kiemTraRa != 0)
                                                {
                                                    string sTruGioVeSom23;
                                                    sTruGioVeSom23 = dtCaLamViecFiloChamMotLan2.Rows[iCaLamViecFiLoChamMotLan2]["TruGioVeSom"].ToString();
                                                    string sBatDauTinhVeSom23;
                                                    sBatDauTinhVeSom23 = dtCaLamViecFiloChamMotLan2.Rows[iCaLamViecFiLoChamMotLan2]["BatDauTinhVeSom"].ToString();
                                                    int iChoPhepVeSom20;
                                                    iChoPhepVeSom20 = Convert.ToInt32(dtCaLamViecFiloChamMotLan2.Rows[iCaLamViecFiLoChamMotLan2]["ChoPhepVeSom"].ToString());
                                                    string sGiayGioRa29;
                                                    sGiayGioRa29 = dGioVaoFilo.Second.ToString();
                                                    string sPhutVeSom27;
                                                    sPhutVeSom27 = Convert.ToInt32((Convert.ToDateTime(sNgayCham + " " + string.Format("{0:T}", Convert.ToDateTime(dtCaLamViecFiloChamMotLan2.Rows[iCaLamViecFiLoChamMotLan2]["GioKetThucLamViec"].ToString())).Replace("00 ", sGiayGioRa29 + " ")) - dGioVaoFilo).TotalMinutes).ToString();
                                                    if (sTruGioVeSom23 == "True")
                                                    {
                                                        if (Convert.ToInt32(sPhutVeSom27) < 0)
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = "0";
                                                        }
                                                        else
                                                        {
                                                            int iPhutVeSom19;
                                                            iPhutVeSom19 = Convert.ToInt32(sPhutVeSom27) - iChoPhepVeSom20;
                                                            if (iPhutVeSom19 < 1)
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = "0";
                                                            }
                                                            else if (sBatDauTinhVeSom23 == "True")
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = iPhutVeSom19.ToString();
                                                            }
                                                            else
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = sPhutVeSom27;
                                                            }
                                                        }
                                                    }
                                                    else
                                                    {
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = "0";
                                                    }
                                                    double dGioChamMotLan3;
                                                    dGioChamMotLan3 = Math.Round((Convert.ToDouble(dtCaLamViecFiloChamMotLan2.Rows[iCaLamViecFiLoChamMotLan2]["KhongCoGioVao"].ToString()) - Convert.ToDouble(this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value.ToString())) / 60.0, this.iLamTronGio);
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = dGioChamMotLan3.ToString();
                                                    Math.Round(Convert.ToDouble(dtCaLamViecFiloChamMotLan2.Rows[iCaLamViecFiLoChamMotLan2]["KhongCoGioRa"].ToString()) / 60.0, 2);
                                                    double dCongChamMotLan3;
                                                    dCongChamMotLan3 = Math.Round(dGioChamMotLan3 * Convert.ToDouble(dtCaLamViecFiloChamMotLan2.Rows[iCaLamViecFiLoChamMotLan2]["CongTinh"].ToString()) / Convert.ToDouble(dtCaLamViecFiloChamMotLan2.Rows[iCaLamViecFiLoChamMotLan2]["TongGioTrongCaLamViec"].ToString()), this.iLamTronCong);
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = dCongChamMotLan3.ToString();
                                                }
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[11].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[16].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[17].Value = dtCaLamViecFiloChamMotLan2.Rows[iCaLamViecFiLoChamMotLan2]["CongTinh"].ToString();
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[18].Value = this.sKHThieuGioRa;
                                                if (DateTimeProgress.XuatIDThu((int)dt.AddDays(dem).DayOfWeek) == "0")
                                                {
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[19].Value = "CN";
                                                }
                                                else
                                                {
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[19].Value = "NT";
                                                }
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[20].Value = this.sMaChamCong;
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[21].Value = this.sPhongBanTinhCong;
                                            }
                                            break;
                                        }
                                    }
                                }
                                if (iLanChamFilo == 1 && dtGioChamFilo.Rows.Count > 1)
                                {
                                    dGioVaoFilo = Convert.ToDateTime(dtGioChamFilo.Rows[iGioChamFilo]["GioCham"].ToString());
                                    this.DGVTinhCong.Rows[_nhanVien].Cells[5].Value = string.Format(this.sDinhDangThoiGian, dGioVaoFilo);
                                }
                                if (iLanChamFilo != dtGioChamFilo.Rows.Count || dtGioChamFilo.Rows.Count <= 1)
                                {
                                    continue;
                                }
                                dGioRaFilo = Convert.ToDateTime(dtGioChamFilo.Rows[iGioChamFilo]["GioCham"].ToString());
                                this.DGVTinhCong.Rows[_nhanVien].Cells[6].Value = string.Format(this.sDinhDangThoiGian, dGioRaFilo);
                                int iCaTrongLIchtrinh4;
                                iCaTrongLIchtrinh4 = 0;
                                if (iLichTrinhThang != 0)
                                {
                                    this.DGVTinhCong.Rows[_nhanVien].Cells[4].Value = sNhanCaLamViecTheoThang;
                                    new DataTable();
                                    DataTable dtCaLamViecFilo;
                                    dtCaLamViecFilo = this._caLamViecBLL.getMaByTenCaLamViec(sNhanCaLamViecTheoThang);
                                    for (int iCaLamViecFilo = 0; iCaLamViecFilo < dtCaLamViecFilo.Rows.Count; iCaLamViecFilo++)
                                    {
                                        string sGiayGioVao24;
                                        sGiayGioVao24 = dGioVaoFilo.Second.ToString();
                                        string sGiayGioRa24;
                                        sGiayGioRa24 = dGioRaFilo.Second.ToString();
                                        DateTime dGioVaoKhaiBaoFiloB2;
                                        dGioVaoKhaiBaoFiloB2 = Convert.ToDateTime(sNgayCham + " " + string.Format("{0:T}", Convert.ToDateTime(dtCaLamViecFilo.Rows[iCaLamViecFilo]["GioVaoLamViec"].ToString())).Replace("00 ", sGiayGioVao24 + " "));
                                        DateTime dGioRaKhaiBaoFiLoB;
                                        dGioRaKhaiBaoFiLoB = Convert.ToDateTime(sNgayCham + " " + string.Format("{0:T}", Convert.ToDateTime(dtCaLamViecFilo.Rows[iCaLamViecFilo]["GioKetThucLamViec"].ToString())).Replace("00 ", sGiayGioRa24 + " "));
                                        string sXemCaNayLaTangCa8;
                                        sXemCaNayLaTangCa8 = dtCaLamViecFilo.Rows[iCaLamViecFilo]["XemCaNayLaTangCa"].ToString();
                                        int iTangCaMuc8;
                                        iTangCaMuc8 = Convert.ToInt32(dtCaLamViecFilo.Rows[iCaLamViecFilo]["TangCaMuc"].ToString());
                                        string sXemChuNhatLaTangCa3;
                                        sXemChuNhatLaTangCa3 = dtCaLamViecFilo.Rows[iCaLamViecFilo]["XemCuoiTuanLaTangCa"].ToString();
                                        int iTangCaChuNhatMuc3;
                                        iTangCaChuNhatMuc3 = Convert.ToInt32(dtCaLamViecFilo.Rows[iCaLamViecFilo]["TangCaCuoiTuanMuc"].ToString());
                                        if (sXemCaNayLaTangCa8 == "True")
                                        {
                                            dtCaLamViecFilo.Rows[iCaLamViecFilo]["TruGioDiTre"].ToString();
                                            dtCaLamViecFilo.Rows[iCaLamViecFilo]["BatDauTinhDiTre"].ToString();
                                            Convert.ToInt32(dtCaLamViecFilo.Rows[iCaLamViecFilo]["ChoPhepDiTre"].ToString());
                                            string sPhutTre16;
                                            sPhutTre16 = Convert.ToInt32((dGioVaoFilo - dGioVaoKhaiBaoFiloB2).TotalMinutes).ToString();
                                            if (Convert.ToInt32(sPhutTre16) < 0)
                                            {
                                                sPhutTre16 = "0";
                                            }
                                            dtCaLamViecFilo.Rows[iCaLamViecFilo]["TruGioVeSom"].ToString();
                                            dtCaLamViecFilo.Rows[iCaLamViecFilo]["BatDauTinhVeSom"].ToString();
                                            Convert.ToInt32(dtCaLamViecFilo.Rows[iCaLamViecFilo]["ChoPhepVeSom"].ToString());
                                            string sPhutVeSom16;
                                            sPhutVeSom16 = Convert.ToInt32((dGioRaKhaiBaoFiLoB - dGioRaFilo).TotalMinutes).ToString();
                                            if (Convert.ToInt32(sPhutVeSom16) < 0)
                                            {
                                                sPhutVeSom16 = "0";
                                            }
                                            double dTongGioTangCaFilo;
                                            dTongGioTangCaFilo = Math.Round((Convert.ToDouble(dtCaLamViecFilo.Rows[iCaLamViecFilo]["TongGioTrongCaLamViec"]) * 60.0 - (Convert.ToDouble(sPhutTre16) + Convert.ToDouble(sPhutVeSom16))) / 60.0, this.iLamTronGio);
                                            if (iTangCaMuc8 == 1)
                                            {
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = dTongGioTangCaFilo * this.dTangCa1HeSo;
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[18].Value = this.sKHDungGio;
                                            }
                                            if (iTangCaMuc8 == 2)
                                            {
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = dTongGioTangCaFilo * this.dTangCa2HeSo;
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[18].Value = this.sKHDungGio;
                                            }
                                            if (iTangCaMuc8 == 3)
                                            {
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = dTongGioTangCaFilo * this.dTangCa3HeSo;
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[18].Value = this.sKHDungGio;
                                            }
                                            if (iTangCaMuc8 == 4)
                                            {
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = dTongGioTangCaFilo * this.dTangCa4HeSo;
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[18].Value = this.sKHDungGio;
                                            }
                                        }
                                        else if (DateTimeProgress.XuatIDThu((int)dt.AddDays(dem).DayOfWeek) == "0")
                                        {
                                            if (sXemChuNhatLaTangCa3 == "True")
                                            {
                                                dtCaLamViecFilo.Rows[iCaLamViecFilo]["TruGioDiTre"].ToString();
                                                dtCaLamViecFilo.Rows[iCaLamViecFilo]["BatDauTinhDiTre"].ToString();
                                                Convert.ToInt32(dtCaLamViecFilo.Rows[iCaLamViecFilo]["ChoPhepDiTre"].ToString());
                                                string sPhutTre17;
                                                sPhutTre17 = Convert.ToInt32((dGioVaoFilo - dGioVaoKhaiBaoFiloB2).TotalMinutes).ToString();
                                                if (Convert.ToInt32(sPhutTre17) < 0)
                                                {
                                                    sPhutTre17 = "0";
                                                }
                                                dtCaLamViecFilo.Rows[iCaLamViecFilo]["TruGioVeSom"].ToString();
                                                dtCaLamViecFilo.Rows[iCaLamViecFilo]["BatDauTinhVeSom"].ToString();
                                                Convert.ToInt32(dtCaLamViecFilo.Rows[iCaLamViecFilo]["ChoPhepVeSom"].ToString());
                                                string sPhutVeSom17;
                                                sPhutVeSom17 = Convert.ToInt32((dGioRaKhaiBaoFiLoB - dGioRaFilo).TotalMinutes).ToString();
                                                if (Convert.ToInt32(sPhutVeSom17) < 0)
                                                {
                                                    sPhutVeSom17 = "0";
                                                }
                                                double dTongGioTangCaFiloA;
                                                dTongGioTangCaFiloA = Math.Round((Convert.ToDouble(dtCaLamViecFilo.Rows[iCaLamViecFilo]["TongGioTrongCaLamViec"]) * 60.0 - (Convert.ToDouble(sPhutTre17) + Convert.ToDouble(sPhutVeSom17))) / 60.0, this.iLamTronGio);
                                                if (iTangCaChuNhatMuc3 == 1)
                                                {
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = dTongGioTangCaFiloA * this.dTangCaChuNhatHeSo;
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[18].Value = this.sKHDungGio;
                                                }
                                                if (iTangCaChuNhatMuc3 == 2)
                                                {
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = dTongGioTangCaFiloA * this.dTangCaChuNhatHeSo;
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[18].Value = this.sKHDungGio;
                                                }
                                                if (iTangCaChuNhatMuc3 == 3)
                                                {
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = dTongGioTangCaFiloA * this.dTangCaChuNhatHeSo;
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[18].Value = this.sKHDungGio;
                                                }
                                                if (iTangCaChuNhatMuc3 == 4)
                                                {
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = dTongGioTangCaFiloA * this.dTangCaChuNhatHeSo;
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[18].Value = this.sKHDungGio;
                                                }
                                            }
                                            else
                                            {
                                                string sTruGioDiTre18;
                                                sTruGioDiTre18 = dtCaLamViecFilo.Rows[iCaLamViecFilo]["TruGioDiTre"].ToString();
                                                string sBatDauTinhDiTre18;
                                                sBatDauTinhDiTre18 = dtCaLamViecFilo.Rows[iCaLamViecFilo]["BatDauTinhDiTre"].ToString();
                                                int iChoPhepDiTre15;
                                                iChoPhepDiTre15 = Convert.ToInt32(dtCaLamViecFilo.Rows[iCaLamViecFilo]["ChoPhepDiTre"].ToString());
                                                string sPhutTre18;
                                                sPhutTre18 = Convert.ToInt32((dGioVaoFilo - dGioVaoKhaiBaoFiloB2).TotalMinutes).ToString();
                                                if (sTruGioDiTre18 == "True")
                                                {
                                                    if (Convert.ToInt32(sPhutTre18) < 0)
                                                    {
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = "0";
                                                    }
                                                    else
                                                    {
                                                        int iPhutTre14;
                                                        iPhutTre14 = Convert.ToInt32(sPhutTre18) - iChoPhepDiTre15;
                                                        if (sBatDauTinhDiTre18 == "True")
                                                        {
                                                            if (iPhutTre14 < 1)
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = "0";
                                                            }
                                                            else
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = iPhutTre14.ToString();
                                                            }
                                                        }
                                                        else if (iPhutTre14 < 1)
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = "0";
                                                        }
                                                        else
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = sPhutTre18;
                                                        }
                                                    }
                                                }
                                                else
                                                {
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = "0";
                                                }
                                                string sTruGioVeSom17;
                                                sTruGioVeSom17 = dtCaLamViecFilo.Rows[iCaLamViecFilo]["TruGioVeSom"].ToString();
                                                string sBatDauTinhVeSom17;
                                                sBatDauTinhVeSom17 = dtCaLamViecFilo.Rows[iCaLamViecFilo]["BatDauTinhVeSom"].ToString();
                                                int iChoPhepVeSom14;
                                                iChoPhepVeSom14 = Convert.ToInt32(dtCaLamViecFilo.Rows[iCaLamViecFilo]["ChoPhepVeSom"].ToString());
                                                string sPhutVeSom18;
                                                sPhutVeSom18 = Convert.ToInt32((dGioRaKhaiBaoFiLoB - dGioRaFilo).TotalMinutes).ToString();
                                                if (sTruGioVeSom17 == "True")
                                                {
                                                    if (Convert.ToInt32(sPhutVeSom18) < 0)
                                                    {
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = "0";
                                                    }
                                                    else
                                                    {
                                                        int iPhutVeSom14;
                                                        iPhutVeSom14 = Convert.ToInt32(sPhutVeSom18) - iChoPhepVeSom14;
                                                        if (iPhutVeSom14 < 1)
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = "0";
                                                        }
                                                        else if (sBatDauTinhVeSom17 == "True")
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = iPhutVeSom14.ToString();
                                                        }
                                                        else
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = sPhutVeSom18;
                                                        }
                                                    }
                                                }
                                                else
                                                {
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = "0";
                                                }
                                                string sVeTre13;
                                                sVeTre13 = Convert.ToInt32((dGioRaFilo - dGioRaKhaiBaoFiLoB).TotalMinutes).ToString();
                                                if (Convert.ToInt32(sVeTre13) > 0)
                                                {
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[11].Value = sVeTre13;
                                                }
                                                else
                                                {
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[11].Value = "0";
                                                }
                                                double dGio13;
                                                dGio13 = Math.Round(Convert.ToDouble(Convert.ToSingle(dtCaLamViecFilo.Rows[iCaLamViecFilo]["TongGioTrongCaLamViec"]) * 60f - (float)(Convert.ToInt32(this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value.ToString()) + Convert.ToInt32(this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value))) / 60.0, this.iLamTronGio);
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = dGio13 * this.dTangCaChuNhatHeSo;
                                                double iGio13;
                                                iGio13 = Convert.ToDouble(dtCaLamViecFilo.Rows[iCaLamViecFilo]["TongGioTrongCaLamViec"].ToString());
                                                double dCongTinh12;
                                                dCongTinh12 = Convert.ToDouble(dtCaLamViecFilo.Rows[iCaLamViecFilo]["CongTinh"].ToString());
                                                double dCong13;
                                                dCong13 = Math.Round(dGio13 * dCongTinh12 / iGio13, this.iLamTronCong);
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = dCong13 * this.dTangCaChuNhatHeSo;
                                                string sTangCaTruocGioLamViec6;
                                                sTangCaTruocGioLamViec6 = dtCaLamViecFilo.Rows[iCaLamViecFilo]["TangCaTruocGioLamViec"].ToString();
                                                string sTangCaSauGioLamViec6;
                                                sTangCaSauGioLamViec6 = dtCaLamViecFilo.Rows[iCaLamViecFilo]["TangCaSauGioLamViec"].ToString();
                                                if (sTangCaTruocGioLamViec6 == "False" && sTangCaSauGioLamViec6 == "False")
                                                {
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                }
                                                if (sXemCaNayLaTangCa8 == "True")
                                                {
                                                    if (iTangCaMuc8 == 1)
                                                    {
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = dGio13.ToString();
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                    }
                                                    if (iTangCaMuc8 == 2)
                                                    {
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = dGio13.ToString();
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                    }
                                                    if (iTangCaMuc8 == 3)
                                                    {
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = dGio13.ToString();
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                    }
                                                    if (iTangCaMuc8 == 4)
                                                    {
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = dGio13.ToString();
                                                    }
                                                }
                                                string sChoPhepTangCaTruocGioLamViecFiLo;
                                                sChoPhepTangCaTruocGioLamViecFiLo = dtCaLamViecFilo.Rows[iCaLamViecFilo]["TangCaTruocGioLamViec"].ToString();
                                                int iPhutTangCaTruocGioLamViecFiLo;
                                                iPhutTangCaTruocGioLamViecFiLo = Convert.ToInt32(dtCaLamViecFilo.Rows[iCaLamViecFilo]["SoPhutTangCaTruocGioLamViec"].ToString());
                                                int iPhutTangCaTruocGioLamViecDatDen16;
                                                iPhutTangCaTruocGioLamViecDatDen16 = Convert.ToInt32(dtCaLamViecFilo.Rows[iCaLamViecFilo]["TangCaTruocGioLamViecDatDen"].ToString());
                                                int iPhutTruTangCaTruoc16;
                                                iPhutTruTangCaTruoc16 = Convert.ToInt32(dtCaLamViecFilo.Rows[iCaLamViecFilo]["PhutTruTangCaTruoc"].ToString());
                                                string sChoPhepTangCaSauGioLamViecFiLo;
                                                sChoPhepTangCaSauGioLamViecFiLo = dtCaLamViecFilo.Rows[iCaLamViecFilo]["TangCaSauGioLamViec"].ToString();
                                                int iPhutTangCaSauGioLamViecFiLo;
                                                iPhutTangCaSauGioLamViecFiLo = Convert.ToInt32(dtCaLamViecFilo.Rows[iCaLamViecFilo]["SoPhutTangCaSauGioLamViec"].ToString());
                                                int iPhutTangCaSauGioLamViecDatDen16;
                                                iPhutTangCaSauGioLamViecDatDen16 = Convert.ToInt32(dtCaLamViecFilo.Rows[iCaLamViecFilo]["TangCaSauGioLamViecDatDen"].ToString());
                                                int iPhutTruTangCaSau16;
                                                iPhutTruTangCaSau16 = Convert.ToInt32(dtCaLamViecFilo.Rows[iCaLamViecFilo]["PhutTruTangCaSau"].ToString());
                                                int iGioiHanTC1FiLo;
                                                iGioiHanTC1FiLo = Convert.ToInt32(dtCaLamViecFilo.Rows[iCaLamViecFilo]["GioiHanTangCa1"].ToString());
                                                int iGioiHanTC2FiLo;
                                                iGioiHanTC2FiLo = Convert.ToInt32(dtCaLamViecFilo.Rows[iCaLamViecFilo]["GioiHanTangCa2"].ToString());
                                                int iGioiHanTC3FiLo;
                                                iGioiHanTC3FiLo = Convert.ToInt32(dtCaLamViecFilo.Rows[iCaLamViecFilo]["GioiHanTangCa3"].ToString());
                                                int iGioiHanTC4FiLo;
                                                iGioiHanTC4FiLo = Convert.ToInt32(dtCaLamViecFilo.Rows[iCaLamViecFilo]["GioiHanTangCa4"].ToString());
                                                int iTongGioTangCaSauFiLo;
                                                iTongGioTangCaSauFiLo = 0;
                                                int iTongGioTangCaTruocFiLo;
                                                iTongGioTangCaTruocFiLo = 0;
                                                if (sChoPhepTangCaTruocGioLamViecFiLo == "False" && sChoPhepTangCaSauGioLamViecFiLo == "False")
                                                {
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                }
                                                else
                                                {
                                                    if (sChoPhepTangCaTruocGioLamViecFiLo == "True")
                                                    {
                                                        int iThoiGianTruocGioLamFiLo;
                                                        iThoiGianTruocGioLamFiLo = Convert.ToInt32(Convert.ToInt32((dGioVaoKhaiBaoFiloB2 - dGioVaoFilo).TotalMinutes).ToString());
                                                        if (iThoiGianTruocGioLamFiLo > 0 && iThoiGianTruocGioLamFiLo > iPhutTangCaTruocGioLamViecFiLo && iThoiGianTruocGioLamFiLo > iPhutTangCaTruocGioLamViecDatDen16)
                                                        {
                                                            iTongGioTangCaTruocFiLo = iThoiGianTruocGioLamFiLo - iPhutTruTangCaTruoc16;
                                                        }
                                                    }
                                                    if (sChoPhepTangCaSauGioLamViecFiLo == "True")
                                                    {
                                                        int iThoiGianSauGioLamViecFiLo;
                                                        iThoiGianSauGioLamViecFiLo = Convert.ToInt32(Convert.ToInt32((dGioRaFilo - dGioRaKhaiBaoFiLoB).TotalMinutes).ToString());
                                                        if (iThoiGianSauGioLamViecFiLo > 0 && iThoiGianSauGioLamViecFiLo > iPhutTangCaSauGioLamViecFiLo && iThoiGianSauGioLamViecFiLo > iPhutTangCaSauGioLamViecDatDen16)
                                                        {
                                                            iTongGioTangCaSauFiLo = iThoiGianSauGioLamViecFiLo - iPhutTruTangCaSau16;
                                                        }
                                                    }
                                                }
                                                double dTongThoiGianTangCaFiLo;
                                                dTongThoiGianTangCaFiLo = Convert.ToDouble(iTongGioTangCaTruocFiLo + iTongGioTangCaSauFiLo);
                                                if (dTongThoiGianTangCaFiLo > 0.0)
                                                {
                                                    if (iGioiHanTC1FiLo == 0)
                                                    {
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = Math.Round(dTongThoiGianTangCaFiLo * this.dTangCa1HeSo / 60.0, this.iLamTronGio);
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                    }
                                                    if (iGioiHanTC1FiLo != 0 && iGioiHanTC2FiLo == 0)
                                                    {
                                                        if (dTongThoiGianTangCaFiLo < Convert.ToDouble(iGioiHanTC1FiLo))
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = Math.Round(dTongThoiGianTangCaFiLo * this.dTangCa1HeSo / 60.0, this.iLamTronGio);
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                        }
                                                        else
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = Math.Round(Convert.ToDouble(iGioiHanTC1FiLo) / 60.0 * this.dTangCa1HeSo, this.iLamTronGio);
                                                            if (dTongThoiGianTangCaFiLo - Convert.ToDouble(iGioiHanTC1FiLo) > 0.0)
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = Math.Round((dTongThoiGianTangCaFiLo - Convert.ToDouble(iGioiHanTC1FiLo)) * this.dTangCa2HeSo / 60.0, this.iLamTronGio);
                                                            }
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                        }
                                                    }
                                                    if (iGioiHanTC1FiLo != 0 && iGioiHanTC2FiLo != 0 && iGioiHanTC3FiLo == 0)
                                                    {
                                                        if (dTongThoiGianTangCaFiLo < Convert.ToDouble(iGioiHanTC1FiLo))
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = Math.Round(dTongThoiGianTangCaFiLo * this.dTangCa1HeSo / 60.0, this.iLamTronGio);
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                        }
                                                        else
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = Math.Round(Convert.ToDouble(iGioiHanTC1FiLo) * this.dTangCa1HeSo / 60.0, this.iLamTronGio);
                                                            if (dTongThoiGianTangCaFiLo - Convert.ToDouble(iGioiHanTC1FiLo) < Convert.ToDouble(iGioiHanTC2FiLo))
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = Math.Round((dTongThoiGianTangCaFiLo - Convert.ToDouble(iGioiHanTC1FiLo)) * this.dTangCa2HeSo / 60.0, this.iLamTronGio);
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                            }
                                                            else
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = Math.Round(Convert.ToDouble(iGioiHanTC1FiLo) * this.dTangCa1HeSo / 60.0, this.iLamTronGio);
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = Math.Round(Convert.ToDouble(iGioiHanTC2FiLo) * this.dTangCa2HeSo / 60.0, this.iLamTronGio);
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = Math.Round((dTongThoiGianTangCaFiLo - Convert.ToDouble(iGioiHanTC1FiLo) - Convert.ToDouble(iGioiHanTC2FiLo)) * this.dTangCa3HeSo / 60.0, this.iLamTronGio);
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                            }
                                                        }
                                                    }
                                                    if (iGioiHanTC1FiLo != 0 && iGioiHanTC2FiLo != 0 && iGioiHanTC3FiLo != 0 && iGioiHanTC4FiLo != 0)
                                                    {
                                                    }
                                                }
                                                else
                                                {
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                }
                                                string sTongGio6;
                                                sTongGio6 = Math.Round(Convert.ToDouble(Convert.ToInt32((dGioRaFilo - dGioVaoFilo).TotalMinutes).ToString()) / 60.0, this.iLamTronGio).ToString();
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[16].Value = Convert.ToDouble(sTongGio6) * this.dTangCaChuNhatHeSo;
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[17].Value = Convert.ToDouble(dtCaLamViecFilo.Rows[iCaLamViecFilo]["CongTinh"].ToString()) * this.dTangCaChuNhatHeSo;
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[18].Value = this.sKHDungGio;
                                            }
                                        }
                                        else
                                        {
                                            string sTruGioDiTre19;
                                            sTruGioDiTre19 = dtCaLamViecFilo.Rows[iCaLamViecFilo]["TruGioDiTre"].ToString();
                                            string sBatDauTinhDiTre19;
                                            sBatDauTinhDiTre19 = dtCaLamViecFilo.Rows[iCaLamViecFilo]["BatDauTinhDiTre"].ToString();
                                            int iChoPhepDiTre16;
                                            iChoPhepDiTre16 = Convert.ToInt32(dtCaLamViecFilo.Rows[iCaLamViecFilo]["ChoPhepDiTre"].ToString());
                                            string sPhutTre20;
                                            sPhutTre20 = Convert.ToInt32((dGioVaoFilo - dGioVaoKhaiBaoFiloB2).TotalMinutes).ToString();
                                            if (sTruGioDiTre19 == "True")
                                            {
                                                if (Convert.ToInt32(sPhutTre20) < 0)
                                                {
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = "0";
                                                }
                                                else
                                                {
                                                    int iPhutTre16;
                                                    iPhutTre16 = Convert.ToInt32(sPhutTre20) - iChoPhepDiTre16;
                                                    if (sBatDauTinhDiTre19 == "True")
                                                    {
                                                        if (iPhutTre16 < 1)
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = "0";
                                                        }
                                                        else
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[5].Style.BackColor = Color.Lime;
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = iPhutTre16.ToString();
                                                        }
                                                    }
                                                    else if (iPhutTre16 < 1)
                                                    {
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = "0";
                                                    }
                                                    else
                                                    {
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = sPhutTre20;
                                                    }
                                                }
                                            }
                                            else
                                            {
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = "0";
                                            }
                                            string sTruGioVeSom19;
                                            sTruGioVeSom19 = dtCaLamViecFilo.Rows[iCaLamViecFilo]["TruGioVeSom"].ToString();
                                            string sBatDauTinhVeSom19;
                                            sBatDauTinhVeSom19 = dtCaLamViecFilo.Rows[iCaLamViecFilo]["BatDauTinhVeSom"].ToString();
                                            int iChoPhepVeSom16;
                                            iChoPhepVeSom16 = Convert.ToInt32(dtCaLamViecFilo.Rows[iCaLamViecFilo]["ChoPhepVeSom"].ToString());
                                            string sPhutVeSom20;
                                            sPhutVeSom20 = Convert.ToInt32((dGioRaKhaiBaoFiLoB - dGioRaFilo).TotalMinutes).ToString();
                                            if (sTruGioVeSom19 == "True")
                                            {
                                                if (Convert.ToInt32(sPhutVeSom20) < 0)
                                                {
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = "0";
                                                }
                                                else
                                                {
                                                    int iPhutVeSom16;
                                                    iPhutVeSom16 = Convert.ToInt32(sPhutVeSom20) - iChoPhepVeSom16;
                                                    if (iPhutVeSom16 < 1)
                                                    {
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = "0";
                                                    }
                                                    else
                                                    {
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[6].Style.BackColor = Color.Yellow;
                                                        if (sBatDauTinhVeSom19 == "True")
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = iPhutVeSom16.ToString();
                                                        }
                                                        else
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = sPhutVeSom20;
                                                        }
                                                    }
                                                }
                                            }
                                            else
                                            {
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = "0";
                                            }
                                            string sVeTre15;
                                            sVeTre15 = Convert.ToInt32((dGioRaFilo - dGioRaKhaiBaoFiLoB).TotalMinutes).ToString();
                                            if (Convert.ToInt32(sVeTre15) > 0)
                                            {
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[11].Value = sVeTre15;
                                            }
                                            else
                                            {
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[11].Value = "0";
                                            }
                                            double dGio14;
                                            dGio14 = Math.Round(Convert.ToDouble(Convert.ToSingle(dtCaLamViecFilo.Rows[iCaLamViecFilo]["TongGioTrongCaLamViec"]) * 60f - (float)(Convert.ToInt32(this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value.ToString()) + Convert.ToInt32(this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value))) / 60.0, this.iLamTronGio);
                                            double dTongGioTrongCa3;
                                            dTongGioTrongCa3 = Convert.ToDouble(dtCaLamViecFilo.Rows[iCaLamViecFilo]["TongGioTrongCaLamViec"].ToString());
                                            if (iTinhBuTru != 0 && Convert.ToInt32(this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value) > 0 && Convert.ToInt32(this.DGVTinhCong.Rows[_nhanVien].Cells[11].Value) > 0)
                                            {
                                                int iVeTre3;
                                                iVeTre3 = Convert.ToInt32(this.DGVTinhCong.Rows[_nhanVien].Cells[11].Value);
                                                dGio14 = Math.Round(dGio14 + Convert.ToDouble(iVeTre3) / 60.0, 2);
                                                if (dGio14 > dTongGioTrongCa3)
                                                {
                                                    iVeTre3 -= Convert.ToInt32(this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value);
                                                    dGio14 = dTongGioTrongCa3;
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[11].Value = iVeTre3;
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = dGio14.ToString();
                                                }
                                                else
                                                {
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = dGio14.ToString();
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = Convert.ToInt32(sPhutTre20) - iVeTre3;
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[11].Value = "0";
                                                }
                                            }
                                            else
                                            {
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = dGio14.ToString();
                                            }
                                            double iGio14;
                                            iGio14 = Convert.ToDouble(dtCaLamViecFilo.Rows[iCaLamViecFilo]["TongGioTrongCaLamViec"].ToString());
                                            double dCongTinh13;
                                            dCongTinh13 = Convert.ToDouble(dtCaLamViecFilo.Rows[iCaLamViecFilo]["CongTinh"].ToString());
                                            double dCong14;
                                            dCong14 = Math.Round(dGio14 * dCongTinh13 / iGio14, this.iLamTronCong);
                                            this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = dCong14.ToString();
                                            string sTangCaTruocGioLamViec7;
                                            sTangCaTruocGioLamViec7 = dtCaLamViecFilo.Rows[iCaLamViecFilo]["TangCaTruocGioLamViec"].ToString();
                                            string sTangCaSauGioLamViec7;
                                            sTangCaSauGioLamViec7 = dtCaLamViecFilo.Rows[iCaLamViecFilo]["TangCaSauGioLamViec"].ToString();
                                            if (sTangCaTruocGioLamViec7 == "False" && sTangCaSauGioLamViec7 == "False")
                                            {
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                            }
                                            if (sXemCaNayLaTangCa8 == "True")
                                            {
                                                if (iTangCaMuc8 == 1)
                                                {
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = dGio14.ToString();
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                }
                                                if (iTangCaMuc8 == 2)
                                                {
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = dGio14.ToString();
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                }
                                                if (iTangCaMuc8 == 3)
                                                {
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = dGio14.ToString();
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                }
                                                if (iTangCaMuc8 == 4)
                                                {
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = dGio14.ToString();
                                                }
                                            }
                                            string sChoPhepTangCaTruocGioLamViecFiLo2;
                                            sChoPhepTangCaTruocGioLamViecFiLo2 = dtCaLamViecFilo.Rows[iCaLamViecFilo]["TangCaTruocGioLamViec"].ToString();
                                            int iPhutTangCaTruocGioLamViecFiLo2;
                                            iPhutTangCaTruocGioLamViecFiLo2 = Convert.ToInt32(dtCaLamViecFilo.Rows[iCaLamViecFilo]["SoPhutTangCaTruocGioLamViec"].ToString());
                                            int iPhutTangCaTruocGioLamViecDatDen17;
                                            iPhutTangCaTruocGioLamViecDatDen17 = Convert.ToInt32(dtCaLamViecFilo.Rows[iCaLamViecFilo]["TangCaTruocGioLamViecDatDen"].ToString());
                                            int iPhutTruTangCaTruoc17;
                                            iPhutTruTangCaTruoc17 = Convert.ToInt32(dtCaLamViecFilo.Rows[iCaLamViecFilo]["PhutTruTangCaTruoc"].ToString());
                                            string sChoPhepTangCaSauGioLamViecFiLo2;
                                            sChoPhepTangCaSauGioLamViecFiLo2 = dtCaLamViecFilo.Rows[iCaLamViecFilo]["TangCaSauGioLamViec"].ToString();
                                            int iPhutTangCaSauGioLamViecFiLo2;
                                            iPhutTangCaSauGioLamViecFiLo2 = Convert.ToInt32(dtCaLamViecFilo.Rows[iCaLamViecFilo]["SoPhutTangCaSauGioLamViec"].ToString());
                                            int iPhutTangCaSauGioLamViecDatDen17;
                                            iPhutTangCaSauGioLamViecDatDen17 = Convert.ToInt32(dtCaLamViecFilo.Rows[iCaLamViecFilo]["TangCaSauGioLamViecDatDen"].ToString());
                                            int iPhutTruTangCaSau17;
                                            iPhutTruTangCaSau17 = Convert.ToInt32(dtCaLamViecFilo.Rows[iCaLamViecFilo]["PhutTruTangCaSau"].ToString());
                                            int iGioiHanTC1FiLo2;
                                            iGioiHanTC1FiLo2 = Convert.ToInt32(dtCaLamViecFilo.Rows[iCaLamViecFilo]["GioiHanTangCa1"].ToString());
                                            int iGioiHanTC2FiLo2;
                                            iGioiHanTC2FiLo2 = Convert.ToInt32(dtCaLamViecFilo.Rows[iCaLamViecFilo]["GioiHanTangCa2"].ToString());
                                            int iGioiHanTC3FiLo2;
                                            iGioiHanTC3FiLo2 = Convert.ToInt32(dtCaLamViecFilo.Rows[iCaLamViecFilo]["GioiHanTangCa3"].ToString());
                                            int iGioiHanTC4FiLo2;
                                            iGioiHanTC4FiLo2 = Convert.ToInt32(dtCaLamViecFilo.Rows[iCaLamViecFilo]["GioiHanTangCa4"].ToString());
                                            int iTongGioTangCaSauFiLo2;
                                            iTongGioTangCaSauFiLo2 = 0;
                                            int iTongGioTangCaTruocFiLo2;
                                            iTongGioTangCaTruocFiLo2 = 0;
                                            if (sChoPhepTangCaTruocGioLamViecFiLo2 == "False" && sChoPhepTangCaSauGioLamViecFiLo2 == "False")
                                            {
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                            }
                                            else
                                            {
                                                if (sChoPhepTangCaTruocGioLamViecFiLo2 == "True")
                                                {
                                                    int iThoiGianTruocGioLamFiLo2;
                                                    iThoiGianTruocGioLamFiLo2 = Convert.ToInt32(Convert.ToInt32((dGioVaoKhaiBaoFiloB2 - dGioVaoFilo).TotalMinutes).ToString());
                                                    if (iThoiGianTruocGioLamFiLo2 > 0 && iThoiGianTruocGioLamFiLo2 > iPhutTangCaTruocGioLamViecFiLo2 && iThoiGianTruocGioLamFiLo2 > iPhutTangCaTruocGioLamViecDatDen17)
                                                    {
                                                        iTongGioTangCaTruocFiLo2 = iThoiGianTruocGioLamFiLo2 - iPhutTruTangCaTruoc17;
                                                    }
                                                }
                                                if (sChoPhepTangCaSauGioLamViecFiLo2 == "True")
                                                {
                                                    int iThoiGianSauGioLamViecFiLo2;
                                                    iThoiGianSauGioLamViecFiLo2 = Convert.ToInt32(this.DGVTinhCong.Rows[_nhanVien].Cells[11].Value);
                                                    if (iThoiGianSauGioLamViecFiLo2 > 0 && iThoiGianSauGioLamViecFiLo2 > iPhutTangCaSauGioLamViecFiLo2)
                                                    {
                                                        iTongGioTangCaSauFiLo2 = ((iThoiGianSauGioLamViecFiLo2 < iPhutTangCaSauGioLamViecDatDen17) ? iThoiGianSauGioLamViecFiLo2 : (iThoiGianSauGioLamViecFiLo2 - iPhutTruTangCaSau17));
                                                    }
                                                }
                                            }
                                            double dTongThoiGianTangCaFiLo2;
                                            dTongThoiGianTangCaFiLo2 = Convert.ToDouble(iTongGioTangCaTruocFiLo2 + iTongGioTangCaSauFiLo2);
                                            if (dTongThoiGianTangCaFiLo2 > 0.0)
                                            {
                                                if (iGioiHanTC1FiLo2 == 0)
                                                {
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = Math.Round(dTongThoiGianTangCaFiLo2 * this.dTangCa1HeSo / 60.0, this.iLamTronGio);
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                }
                                                if (iGioiHanTC1FiLo2 != 0 && iGioiHanTC2FiLo2 == 0)
                                                {
                                                    if (dTongThoiGianTangCaFiLo2 < Convert.ToDouble(iGioiHanTC1FiLo2))
                                                    {
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = Math.Round(dTongThoiGianTangCaFiLo2 * this.dTangCa1HeSo / 60.0, this.iLamTronGio);
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                    }
                                                    else
                                                    {
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = Math.Round(Convert.ToDouble(iGioiHanTC1FiLo2) / 60.0 * this.dTangCa1HeSo, this.iLamTronGio);
                                                        if (dTongThoiGianTangCaFiLo2 - Convert.ToDouble(iGioiHanTC1FiLo2) > 0.0)
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = Math.Round((dTongThoiGianTangCaFiLo2 - Convert.ToDouble(iGioiHanTC1FiLo2)) * this.dTangCa2HeSo / 60.0, this.iLamTronGio);
                                                        }
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                    }
                                                }
                                                if (iGioiHanTC1FiLo2 != 0 && iGioiHanTC2FiLo2 != 0 && iGioiHanTC3FiLo2 == 0)
                                                {
                                                    if (dTongThoiGianTangCaFiLo2 < Convert.ToDouble(iGioiHanTC1FiLo2))
                                                    {
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = Math.Round(dTongThoiGianTangCaFiLo2 * this.dTangCa1HeSo / 60.0, this.iLamTronGio);
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                    }
                                                    else
                                                    {
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = Math.Round(Convert.ToDouble(iGioiHanTC1FiLo2) * this.dTangCa1HeSo / 60.0, this.iLamTronGio);
                                                        if (dTongThoiGianTangCaFiLo2 - Convert.ToDouble(iGioiHanTC1FiLo2) < Convert.ToDouble(iGioiHanTC2FiLo2))
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = Math.Round((dTongThoiGianTangCaFiLo2 - Convert.ToDouble(iGioiHanTC1FiLo2)) * this.dTangCa2HeSo / 60.0, this.iLamTronGio);
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                        }
                                                        else
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = Math.Round(Convert.ToDouble(iGioiHanTC1FiLo2) * this.dTangCa1HeSo / 60.0, this.iLamTronGio);
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = Math.Round(Convert.ToDouble(iGioiHanTC2FiLo2) * this.dTangCa2HeSo / 60.0, this.iLamTronGio);
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = Math.Round((dTongThoiGianTangCaFiLo2 - Convert.ToDouble(iGioiHanTC1FiLo2) - Convert.ToDouble(iGioiHanTC2FiLo2)) * this.dTangCa3HeSo / 60.0, this.iLamTronGio);
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                        }
                                                    }
                                                }
                                                if (iGioiHanTC1FiLo2 != 0 && iGioiHanTC2FiLo2 != 0 && iGioiHanTC3FiLo2 != 0 && iGioiHanTC4FiLo2 != 0)
                                                {
                                                }
                                            }
                                            else
                                            {
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                            }
                                            string sTongGio7;
                                            sTongGio7 = Math.Round(Convert.ToDouble(Convert.ToInt32((dGioRaFilo - dGioVaoFilo).TotalMinutes).ToString()) / 60.0, this.iLamTronGio).ToString();
                                            this.DGVTinhCong.Rows[_nhanVien].Cells[16].Value = sTongGio7;
                                            this.DGVTinhCong.Rows[_nhanVien].Cells[17].Value = dtCaLamViecFilo.Rows[iCaLamViecFilo]["CongTinh"].ToString();
                                            this.DGVTinhCong.Rows[_nhanVien].Cells[18].Value = this.sKHDungGio;
                                        }
                                        if (DateTimeProgress.XuatIDThu((int)dt.AddDays(dem).DayOfWeek) == "0")
                                        {
                                            this.DGVTinhCong.Rows[_nhanVien].Cells[19].Value = "CN";
                                        }
                                        else
                                        {
                                            this.DGVTinhCong.Rows[_nhanVien].Cells[19].Value = "NT";
                                        }
                                        this.DGVTinhCong.Rows[_nhanVien].Cells[20].Value = this.sMaChamCong;
                                        this.DGVTinhCong.Rows[_nhanVien].Cells[21].Value = this.sPhongBanTinhCong;
                                    }
                                    break;
                                }
                                sThu = DateTimeProgress.Test((int)dt.AddDays(dem).DayOfWeek);
                                new DataTable();
                                this._chiTietLichTrinhChoCalamViecDTO.MaLichTrinhCaLamViec = sLTCCLVNhanVien;
                                this._chiTietLichTrinhChoCalamViecDTO.Thu = sThu;
                                DataTable dtNhanCaFilo;
                                dtNhanCaFilo = this._chiTietLichTrinhChoCaLamViecBLL.ChiTietLichTrinhChoCaLamViecNhanCa(this._chiTietLichTrinhChoCalamViecDTO);
                                int iChiTietLichTrinhChoCaLamViecFilo;
                                iChiTietLichTrinhChoCaLamViecFilo = 0;
                                if (iChiTietLichTrinhChoCaLamViecFilo < dtNhanCaFilo.Rows.Count)
                                {
                                    iCaTrongLIchtrinh4 = 1;
                                    int cellChiTietLichTrinhChoCaLamViecFilo;
                                    cellChiTietLichTrinhChoCaLamViecFilo = 3;
                                    while (true)
                                    {
                                        if (cellChiTietLichTrinhChoCaLamViecFilo < 13)
                                        {
                                            kiemTraVao = 0;
                                            kiemTraRa = 0;
                                            this.sFiloMaCaLamViec = dtNhanCaFilo.Rows[iChiTietLichTrinhChoCaLamViecFilo][cellChiTietLichTrinhChoCaLamViecFilo].ToString();
                                            new DataTable();
                                            DataTable dtFiloCa1;
                                            dtFiloCa1 = this._caLamViecBLL.CaLamViecGetByMaCaLamViec(sFiloMaCaLamViec);
                                            int iFiloCa1;
                                            iFiloCa1 = 0;
                                            while (iFiloCa1 < dtFiloCa1.Rows.Count)
                                            {
                                                string sGiayGioVao28;
                                                sGiayGioVao28 = dGioVaoFilo.Second.ToString();
                                                string sGiayGioRa28;
                                                sGiayGioRa28 = dGioRaFilo.Second.ToString();
                                                this.sFiloTenCaLamViec = dtFiloCa1.Rows[iFiloCa1]["CaLamViec"].ToString();
                                                DateTime dBatDauVaoFiloB;
                                                dBatDauVaoFiloB = Convert.ToDateTime(sNgayCham + " " + string.Format("{0:T}", Convert.ToDateTime(dtFiloCa1.Rows[iFiloCa1]["BatDauVao"].ToString())).Replace("00 ", sGiayGioVao28 + " "));
                                                DateTime dKetThucVaoFiloB;
                                                dKetThucVaoFiloB = Convert.ToDateTime(sNgayCham + " " + string.Format("{0:T}", Convert.ToDateTime(dtFiloCa1.Rows[iFiloCa1]["KetThucVao"].ToString())).Replace("00 ", sGiayGioVao28 + " "));
                                                DateTime dBatDauRaFiloB;
                                                dBatDauRaFiloB = Convert.ToDateTime(sNgayCham + " " + string.Format("{0:T}", Convert.ToDateTime(dtFiloCa1.Rows[iFiloCa1]["BatDauRa"].ToString())).Replace("00 ", sGiayGioRa28 + " "));
                                                DateTime dKetThucRaFiloB;
                                                dKetThucRaFiloB = Convert.ToDateTime(sNgayCham + " " + string.Format("{0:T}", Convert.ToDateTime(dtFiloCa1.Rows[iFiloCa1]["KetThucRa"].ToString())).Replace("00 ", sGiayGioRa28 + " "));
                                                if (dtFiloCa1.Rows[iFiloCa1]["TinhBuTru"].ToString() == "True")
                                                {
                                                    iTinhBuTru++;
                                                }
                                                if (dGioVaoFilo >= dBatDauVaoFiloB && dGioVaoFilo <= dKetThucVaoFiloB)
                                                {
                                                    kiemTraVao++;
                                                }
                                                if (dGioRaFilo >= dBatDauRaFiloB && dGioRaFilo <= dKetThucRaFiloB)
                                                {
                                                    kiemTraRa++;
                                                }
                                                if (kiemTraVao != 1 || kiemTraRa != 1)
                                                {
                                                    iFiloCa1++;
                                                    continue;
                                                }
                                                goto IL_2c31d;
                                            }
                                            if (!(this.sFiloMaCaLamViec == ""))
                                            {
                                                cellChiTietLichTrinhChoCaLamViecFilo++;
                                                continue;
                                            }
                                            this.DGVTinhCong.Rows[_nhanVien].Cells[4].Value = ca;
                                            this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = "0";
                                            this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = "0";
                                            this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = "0";
                                            this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = "0";
                                            this.DGVTinhCong.Rows[_nhanVien].Cells[11].Value = "0";
                                            this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = "0";
                                            this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                            this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                            this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                            this.DGVTinhCong.Rows[_nhanVien].Cells[16].Value = "0";
                                            this.DGVTinhCong.Rows[_nhanVien].Cells[17].Value = "0";
                                            this.DGVTinhCong.Rows[_nhanVien].Cells[18].Value = this.sKHVang;
                                            if (DateTimeProgress.XuatIDThu((int)dt.AddDays(dem).DayOfWeek) == "0")
                                            {
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[19].Value = "CN";
                                            }
                                            else
                                            {
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[19].Value = "NT";
                                            }
                                            this.DGVTinhCong.Rows[_nhanVien].Cells[20].Value = this.sMaChamCong;
                                            this.DGVTinhCong.Rows[_nhanVien].Cells[21].Value = this.sPhongBanTinhCong;
                                            break;
                                        }
                                        goto IL_2c31d;
                                    IL_2c31d:
                                        this.DGVTinhCong.Rows[_nhanVien].Cells[4].Value = this.sFiloTenCaLamViec;
                                        new DataTable();
                                        DataTable dtCaLamViecFilo2;
                                        dtCaLamViecFilo2 = this._caLamViecBLL.CaLamViecGetByMaCaLamViec(sFiloMaCaLamViec);
                                        for (int iCaLamViecFilo2 = 0; iCaLamViecFilo2 < dtCaLamViecFilo2.Rows.Count; iCaLamViecFilo2++)
                                        {
                                            string sGiayGioVao26;
                                            sGiayGioVao26 = dGioVaoFilo.Second.ToString();
                                            string sGiayGioRa25;
                                            sGiayGioRa25 = dGioRaFilo.Second.ToString();
                                            DateTime dGioVaoKhaiBaoFiloB3;
                                            dGioVaoKhaiBaoFiloB3 = Convert.ToDateTime(sNgayCham + " " + string.Format("{0:T}", Convert.ToDateTime(dtCaLamViecFilo2.Rows[iCaLamViecFilo2]["GioVaoLamViec"].ToString())).Replace("00 ", sGiayGioVao26 + " "));
                                            DateTime dGioRaKhaiBaoFiLoB2;
                                            dGioRaKhaiBaoFiLoB2 = Convert.ToDateTime(sNgayCham + " " + string.Format("{0:T}", Convert.ToDateTime(dtCaLamViecFilo2.Rows[iCaLamViecFilo2]["GioKetThucLamViec"].ToString())).Replace("00 ", sGiayGioRa25 + " "));
                                            string sXemCaNayLaTangCa9;
                                            sXemCaNayLaTangCa9 = dtCaLamViecFilo2.Rows[iCaLamViecFilo2]["XemCaNayLaTangCa"].ToString();
                                            int iTangCaMuc9;
                                            iTangCaMuc9 = Convert.ToInt32(dtCaLamViecFilo2.Rows[iCaLamViecFilo2]["TangCaMuc"].ToString());
                                            string sXemChuNhatLaTangCa4;
                                            sXemChuNhatLaTangCa4 = dtCaLamViecFilo2.Rows[iCaLamViecFilo2]["XemCuoiTuanLaTangCa"].ToString();
                                            int iTangCaChuNhatMuc4;
                                            iTangCaChuNhatMuc4 = Convert.ToInt32(dtCaLamViecFilo2.Rows[iCaLamViecFilo2]["TangCaCuoiTuanMuc"].ToString());
                                            if (sXemCaNayLaTangCa9 == "True")
                                            {
                                                dtCaLamViecFilo2.Rows[iCaLamViecFilo2]["TruGioDiTre"].ToString();
                                                dtCaLamViecFilo2.Rows[iCaLamViecFilo2]["BatDauTinhDiTre"].ToString();
                                                Convert.ToInt32(dtCaLamViecFilo2.Rows[iCaLamViecFilo2]["ChoPhepDiTre"].ToString());
                                                string sPhutTre21;
                                                sPhutTre21 = Convert.ToInt32((dGioVaoFilo - dGioVaoKhaiBaoFiloB3).TotalMinutes).ToString();
                                                if (Convert.ToInt32(sPhutTre21) < 0)
                                                {
                                                    sPhutTre21 = "0";
                                                }
                                                dtCaLamViecFilo2.Rows[iCaLamViecFilo2]["TruGioVeSom"].ToString();
                                                dtCaLamViecFilo2.Rows[iCaLamViecFilo2]["BatDauTinhVeSom"].ToString();
                                                Convert.ToInt32(dtCaLamViecFilo2.Rows[iCaLamViecFilo2]["ChoPhepVeSom"].ToString());
                                                string sPhutVeSom21;
                                                sPhutVeSom21 = Convert.ToInt32((dGioRaKhaiBaoFiLoB2 - dGioRaFilo).TotalMinutes).ToString();
                                                if (Convert.ToInt32(sPhutVeSom21) < 0)
                                                {
                                                    sPhutVeSom21 = "0";
                                                }
                                                double dTongGioTangCaFilo2;
                                                dTongGioTangCaFilo2 = Math.Round((Convert.ToDouble(dtCaLamViecFilo2.Rows[iCaLamViecFilo2]["TongGioTrongCaLamViec"]) * 60.0 - (Convert.ToDouble(sPhutTre21) + Convert.ToDouble(sPhutVeSom21))) / 60.0, this.iLamTronGio);
                                                if (iTangCaMuc9 == 1)
                                                {
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = dTongGioTangCaFilo2 * this.dTangCa1HeSo;
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[18].Value = this.sKHDungGio;
                                                }
                                                if (iTangCaMuc9 == 2)
                                                {
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = dTongGioTangCaFilo2 * this.dTangCa2HeSo;
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[18].Value = this.sKHDungGio;
                                                }
                                                if (iTangCaMuc9 == 3)
                                                {
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = dTongGioTangCaFilo2 * this.dTangCa3HeSo;
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[18].Value = this.sKHDungGio;
                                                }
                                                if (iTangCaMuc9 == 4)
                                                {
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = dTongGioTangCaFilo2 * this.dTangCa4HeSo;
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[18].Value = this.sKHDungGio;
                                                }
                                            }
                                            else if (DateTimeProgress.XuatIDThu((int)dt.AddDays(dem).DayOfWeek) == "0")
                                            {
                                                if (sXemChuNhatLaTangCa4 == "True")
                                                {
                                                    dtCaLamViecFilo2.Rows[iCaLamViecFilo2]["TruGioDiTre"].ToString();
                                                    dtCaLamViecFilo2.Rows[iCaLamViecFilo2]["BatDauTinhDiTre"].ToString();
                                                    Convert.ToInt32(dtCaLamViecFilo2.Rows[iCaLamViecFilo2]["ChoPhepDiTre"].ToString());
                                                    string sPhutTre24;
                                                    sPhutTre24 = Convert.ToInt32((dGioVaoFilo - dGioVaoKhaiBaoFiloB3).TotalMinutes).ToString();
                                                    if (Convert.ToInt32(sPhutTre24) < 0)
                                                    {
                                                        sPhutTre24 = "0";
                                                    }
                                                    dtCaLamViecFilo2.Rows[iCaLamViecFilo2]["TruGioVeSom"].ToString();
                                                    dtCaLamViecFilo2.Rows[iCaLamViecFilo2]["BatDauTinhVeSom"].ToString();
                                                    Convert.ToInt32(dtCaLamViecFilo2.Rows[iCaLamViecFilo2]["ChoPhepVeSom"].ToString());
                                                    string sPhutVeSom23;
                                                    sPhutVeSom23 = Convert.ToInt32((dGioRaKhaiBaoFiLoB2 - dGioRaFilo).TotalMinutes).ToString();
                                                    if (Convert.ToInt32(sPhutVeSom23) < 0)
                                                    {
                                                        sPhutVeSom23 = "0";
                                                    }
                                                    double dTongGioTangCaFiloA2;
                                                    dTongGioTangCaFiloA2 = Math.Round((Convert.ToDouble(dtCaLamViecFilo2.Rows[iCaLamViecFilo2]["TongGioTrongCaLamViec"]) * 60.0 - (Convert.ToDouble(sPhutTre24) + Convert.ToDouble(sPhutVeSom23))) / 60.0, this.iLamTronGio);
                                                    if (iTangCaChuNhatMuc4 == 1)
                                                    {
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = dTongGioTangCaFiloA2 * this.dTangCaChuNhatHeSo;
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[18].Value = this.sKHDungGio;
                                                    }
                                                    if (iTangCaChuNhatMuc4 == 2)
                                                    {
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = dTongGioTangCaFiloA2 * this.dTangCaChuNhatHeSo;
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[18].Value = this.sKHDungGio;
                                                    }
                                                    if (iTangCaChuNhatMuc4 == 3)
                                                    {
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = dTongGioTangCaFiloA2 * this.dTangCaChuNhatHeSo;
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[18].Value = this.sKHDungGio;
                                                    }
                                                    if (iTangCaChuNhatMuc4 == 4)
                                                    {
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = dTongGioTangCaFiloA2 * this.dTangCaChuNhatHeSo;
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[18].Value = this.sKHDungGio;
                                                    }
                                                }
                                                else
                                                {
                                                    string sTruGioDiTre20;
                                                    sTruGioDiTre20 = dtCaLamViecFilo2.Rows[iCaLamViecFilo2]["TruGioDiTre"].ToString();
                                                    string sBatDauTinhDiTre20;
                                                    sBatDauTinhDiTre20 = dtCaLamViecFilo2.Rows[iCaLamViecFilo2]["BatDauTinhDiTre"].ToString();
                                                    int iChoPhepDiTre17;
                                                    iChoPhepDiTre17 = Convert.ToInt32(dtCaLamViecFilo2.Rows[iCaLamViecFilo2]["ChoPhepDiTre"].ToString());
                                                    string sPhutTre25;
                                                    sPhutTre25 = Convert.ToInt32((dGioVaoFilo - dGioVaoKhaiBaoFiloB3).TotalMinutes).ToString();
                                                    if (sTruGioDiTre20 == "True")
                                                    {
                                                        if (Convert.ToInt32(sPhutTre25) < 0)
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = "0";
                                                        }
                                                        else
                                                        {
                                                            int iPhutTre17;
                                                            iPhutTre17 = Convert.ToInt32(sPhutTre25) - iChoPhepDiTre17;
                                                            if (sBatDauTinhDiTre20 == "True")
                                                            {
                                                                if (iPhutTre17 < 1)
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = "0";
                                                                }
                                                                else
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = iPhutTre17.ToString();
                                                                }
                                                            }
                                                            else if (iPhutTre17 < 1)
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = "0";
                                                            }
                                                            else
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = sPhutTre25;
                                                            }
                                                        }
                                                    }
                                                    else
                                                    {
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = "0";
                                                    }
                                                    string sTruGioVeSom20;
                                                    sTruGioVeSom20 = dtCaLamViecFilo2.Rows[iCaLamViecFilo2]["TruGioVeSom"].ToString();
                                                    string sBatDauTinhVeSom20;
                                                    sBatDauTinhVeSom20 = dtCaLamViecFilo2.Rows[iCaLamViecFilo2]["BatDauTinhVeSom"].ToString();
                                                    int iChoPhepVeSom17;
                                                    iChoPhepVeSom17 = Convert.ToInt32(dtCaLamViecFilo2.Rows[iCaLamViecFilo2]["ChoPhepVeSom"].ToString());
                                                    string sPhutVeSom25;
                                                    sPhutVeSom25 = Convert.ToInt32((dGioRaKhaiBaoFiLoB2 - dGioRaFilo).TotalMinutes).ToString();
                                                    if (sTruGioVeSom20 == "True")
                                                    {
                                                        if (Convert.ToInt32(sPhutVeSom25) < 0)
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = "0";
                                                        }
                                                        else
                                                        {
                                                            int iPhutVeSom17;
                                                            iPhutVeSom17 = Convert.ToInt32(sPhutVeSom25) - iChoPhepVeSom17;
                                                            if (iPhutVeSom17 < 1)
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = "0";
                                                            }
                                                            else if (sBatDauTinhVeSom20 == "True")
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = iPhutVeSom17.ToString();
                                                            }
                                                            else
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = sPhutVeSom25;
                                                            }
                                                        }
                                                    }
                                                    else
                                                    {
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = "0";
                                                    }
                                                    string sVeTre16;
                                                    sVeTre16 = Convert.ToInt32((dGioRaFilo - dGioRaKhaiBaoFiLoB2).TotalMinutes).ToString();
                                                    if (Convert.ToInt32(sVeTre16) > 0)
                                                    {
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[11].Value = sVeTre16;
                                                    }
                                                    else
                                                    {
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[11].Value = "0";
                                                    }
                                                    double dGio16;
                                                    dGio16 = Math.Round(Convert.ToDouble(Convert.ToSingle(dtCaLamViecFilo2.Rows[iCaLamViecFilo2]["TongGioTrongCaLamViec"]) * 60f - (float)(Convert.ToInt32(this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value.ToString()) + Convert.ToInt32(this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value))) / 60.0, this.iLamTronGio);
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = dGio16 * this.dTangCaChuNhatHeSo;
                                                    double iGio16;
                                                    iGio16 = Convert.ToDouble(dtCaLamViecFilo2.Rows[iCaLamViecFilo2]["TongGioTrongCaLamViec"].ToString());
                                                    double dCongTinh14;
                                                    dCongTinh14 = Convert.ToDouble(dtCaLamViecFilo2.Rows[iCaLamViecFilo2]["CongTinh"].ToString());
                                                    double dCong16;
                                                    dCong16 = Math.Round(dGio16 * dCongTinh14 / iGio16, this.iLamTronCong);
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = dCong16 * this.dTangCaChuNhatHeSo;
                                                    string sTangCaTruocGioLamViec8;
                                                    sTangCaTruocGioLamViec8 = dtCaLamViecFilo2.Rows[iCaLamViecFilo2]["TangCaTruocGioLamViec"].ToString();
                                                    string sTangCaSauGioLamViec8;
                                                    sTangCaSauGioLamViec8 = dtCaLamViecFilo2.Rows[iCaLamViecFilo2]["TangCaSauGioLamViec"].ToString();
                                                    if (sTangCaTruocGioLamViec8 == "False" && sTangCaSauGioLamViec8 == "False")
                                                    {
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                    }
                                                    if (sXemCaNayLaTangCa9 == "True")
                                                    {
                                                        if (iTangCaMuc9 == 1)
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = dGio16.ToString();
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                        }
                                                        if (iTangCaMuc9 == 2)
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = dGio16.ToString();
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                        }
                                                        if (iTangCaMuc9 == 3)
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = dGio16.ToString();
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                        }
                                                        if (iTangCaMuc9 == 4)
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = dGio16.ToString();
                                                        }
                                                    }
                                                    string sChoPhepTangCaTruocGioLamViecFiLo3;
                                                    sChoPhepTangCaTruocGioLamViecFiLo3 = dtCaLamViecFilo2.Rows[iCaLamViecFilo2]["TangCaTruocGioLamViec"].ToString();
                                                    int iPhutTangCaTruocGioLamViecFiLo3;
                                                    iPhutTangCaTruocGioLamViecFiLo3 = Convert.ToInt32(dtCaLamViecFilo2.Rows[iCaLamViecFilo2]["SoPhutTangCaTruocGioLamViec"].ToString());
                                                    int iPhutTangCaTruocGioLamViecDatDen19;
                                                    iPhutTangCaTruocGioLamViecDatDen19 = Convert.ToInt32(dtCaLamViecFilo2.Rows[iCaLamViecFilo2]["TangCaTruocGioLamViecDatDen"].ToString());
                                                    int iPhutTruTangCaTruoc19;
                                                    iPhutTruTangCaTruoc19 = Convert.ToInt32(dtCaLamViecFilo2.Rows[iCaLamViecFilo2]["PhutTruTangCaTruoc"].ToString());
                                                    string sChoPhepTangCaSauGioLamViecFiLo3;
                                                    sChoPhepTangCaSauGioLamViecFiLo3 = dtCaLamViecFilo2.Rows[iCaLamViecFilo2]["TangCaSauGioLamViec"].ToString();
                                                    int iPhutTangCaSauGioLamViecFiLo3;
                                                    iPhutTangCaSauGioLamViecFiLo3 = Convert.ToInt32(dtCaLamViecFilo2.Rows[iCaLamViecFilo2]["SoPhutTangCaSauGioLamViec"].ToString());
                                                    int iPhutTangCaSauGioLamViecDatDen19;
                                                    iPhutTangCaSauGioLamViecDatDen19 = Convert.ToInt32(dtCaLamViecFilo2.Rows[iCaLamViecFilo2]["TangCaSauGioLamViecDatDen"].ToString());
                                                    int iPhutTruTangCaSau19;
                                                    iPhutTruTangCaSau19 = Convert.ToInt32(dtCaLamViecFilo2.Rows[iCaLamViecFilo2]["PhutTruTangCaSau"].ToString());
                                                    int iGioiHanTC1FiLo3;
                                                    iGioiHanTC1FiLo3 = Convert.ToInt32(dtCaLamViecFilo2.Rows[iCaLamViecFilo2]["GioiHanTangCa1"].ToString());
                                                    int iGioiHanTC2FiLo3;
                                                    iGioiHanTC2FiLo3 = Convert.ToInt32(dtCaLamViecFilo2.Rows[iCaLamViecFilo2]["GioiHanTangCa2"].ToString());
                                                    int iGioiHanTC3FiLo3;
                                                    iGioiHanTC3FiLo3 = Convert.ToInt32(dtCaLamViecFilo2.Rows[iCaLamViecFilo2]["GioiHanTangCa3"].ToString());
                                                    int iGioiHanTC4FiLo3;
                                                    iGioiHanTC4FiLo3 = Convert.ToInt32(dtCaLamViecFilo2.Rows[iCaLamViecFilo2]["GioiHanTangCa4"].ToString());
                                                    int iTongGioTangCaSauFiLo3;
                                                    iTongGioTangCaSauFiLo3 = 0;
                                                    int iTongGioTangCaTruocFiLo3;
                                                    iTongGioTangCaTruocFiLo3 = 0;
                                                    if (sChoPhepTangCaTruocGioLamViecFiLo3 == "False" && sChoPhepTangCaSauGioLamViecFiLo3 == "False")
                                                    {
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                    }
                                                    else
                                                    {
                                                        if (sChoPhepTangCaTruocGioLamViecFiLo3 == "True")
                                                        {
                                                            int iThoiGianTruocGioLamFiLo3;
                                                            iThoiGianTruocGioLamFiLo3 = Convert.ToInt32(Convert.ToInt32((dGioVaoKhaiBaoFiloB3 - dGioVaoFilo).TotalMinutes).ToString());
                                                            if (iThoiGianTruocGioLamFiLo3 > 0 && iThoiGianTruocGioLamFiLo3 > iPhutTangCaTruocGioLamViecFiLo3 && iThoiGianTruocGioLamFiLo3 > iPhutTangCaTruocGioLamViecDatDen19)
                                                            {
                                                                iTongGioTangCaTruocFiLo3 = iThoiGianTruocGioLamFiLo3 - iPhutTruTangCaTruoc19;
                                                            }
                                                        }
                                                        if (sChoPhepTangCaSauGioLamViecFiLo3 == "True")
                                                        {
                                                            int iThoiGianSauGioLamViecFiLo3;
                                                            iThoiGianSauGioLamViecFiLo3 = Convert.ToInt32(Convert.ToInt32((dGioRaFilo - dGioRaKhaiBaoFiLoB2).TotalMinutes).ToString());
                                                            if (iThoiGianSauGioLamViecFiLo3 > 0 && iThoiGianSauGioLamViecFiLo3 > iPhutTangCaSauGioLamViecFiLo3 && iThoiGianSauGioLamViecFiLo3 > iPhutTangCaSauGioLamViecDatDen19)
                                                            {
                                                                iTongGioTangCaSauFiLo3 = iThoiGianSauGioLamViecFiLo3 - iPhutTruTangCaSau19;
                                                            }
                                                        }
                                                    }
                                                    double dTongThoiGianTangCaFiLo3;
                                                    dTongThoiGianTangCaFiLo3 = Convert.ToDouble(iTongGioTangCaTruocFiLo3 + iTongGioTangCaSauFiLo3);
                                                    if (dTongThoiGianTangCaFiLo3 > 0.0)
                                                    {
                                                        if (iGioiHanTC1FiLo3 == 0)
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = Math.Round(dTongThoiGianTangCaFiLo3 * this.dTangCa1HeSo / 60.0, this.iLamTronGio);
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                        }
                                                        if (iGioiHanTC1FiLo3 != 0 && iGioiHanTC2FiLo3 == 0)
                                                        {
                                                            if (dTongThoiGianTangCaFiLo3 < Convert.ToDouble(iGioiHanTC1FiLo3))
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = Math.Round(dTongThoiGianTangCaFiLo3 * this.dTangCa1HeSo / 60.0, this.iLamTronGio);
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                            }
                                                            else
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = Math.Round(Convert.ToDouble(iGioiHanTC1FiLo3) / 60.0 * this.dTangCa1HeSo, this.iLamTronGio);
                                                                if (dTongThoiGianTangCaFiLo3 - Convert.ToDouble(iGioiHanTC1FiLo3) > 0.0)
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = Math.Round((dTongThoiGianTangCaFiLo3 - Convert.ToDouble(iGioiHanTC1FiLo3)) * this.dTangCa2HeSo / 60.0, this.iLamTronGio);
                                                                }
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                            }
                                                        }
                                                        if (iGioiHanTC1FiLo3 != 0 && iGioiHanTC2FiLo3 != 0 && iGioiHanTC3FiLo3 == 0)
                                                        {
                                                            if (dTongThoiGianTangCaFiLo3 < Convert.ToDouble(iGioiHanTC1FiLo3))
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = Math.Round(dTongThoiGianTangCaFiLo3 * this.dTangCa1HeSo / 60.0, this.iLamTronGio);
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                            }
                                                            else
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = Math.Round(Convert.ToDouble(iGioiHanTC1FiLo3) * this.dTangCa1HeSo / 60.0, this.iLamTronGio);
                                                                if (dTongThoiGianTangCaFiLo3 - Convert.ToDouble(iGioiHanTC1FiLo3) < Convert.ToDouble(iGioiHanTC2FiLo3))
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = Math.Round((dTongThoiGianTangCaFiLo3 - Convert.ToDouble(iGioiHanTC1FiLo3)) * this.dTangCa2HeSo / 60.0, this.iLamTronGio);
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                                }
                                                                else
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = Math.Round(Convert.ToDouble(iGioiHanTC1FiLo3) * this.dTangCa1HeSo / 60.0, this.iLamTronGio);
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = Math.Round(Convert.ToDouble(iGioiHanTC2FiLo3) * this.dTangCa2HeSo / 60.0, this.iLamTronGio);
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = Math.Round((dTongThoiGianTangCaFiLo3 - Convert.ToDouble(iGioiHanTC1FiLo3) - Convert.ToDouble(iGioiHanTC2FiLo3)) * this.dTangCa3HeSo / 60.0, this.iLamTronGio);
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                                }
                                                            }
                                                        }
                                                        if (iGioiHanTC1FiLo3 != 0 && iGioiHanTC2FiLo3 != 0 && iGioiHanTC3FiLo3 != 0 && iGioiHanTC4FiLo3 != 0)
                                                        {
                                                        }
                                                    }
                                                    else
                                                    {
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                    }
                                                    string sTongGio8;
                                                    sTongGio8 = Math.Round(Convert.ToDouble(Convert.ToInt32((dGioRaFilo - dGioVaoFilo).TotalMinutes).ToString()) / 60.0, this.iLamTronGio).ToString();
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[16].Value = Convert.ToDouble(sTongGio8) * this.dTangCaChuNhatHeSo;
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[17].Value = Convert.ToDouble(dtCaLamViecFilo2.Rows[iCaLamViecFilo2]["CongTinh"].ToString()) * this.dTangCaChuNhatHeSo;
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[18].Value = this.sKHDungGio;
                                                }
                                            }
                                            else
                                            {
                                                string sTruGioDiTre21;
                                                sTruGioDiTre21 = dtCaLamViecFilo2.Rows[iCaLamViecFilo2]["TruGioDiTre"].ToString();
                                                string sBatDauTinhDiTre21;
                                                sBatDauTinhDiTre21 = dtCaLamViecFilo2.Rows[iCaLamViecFilo2]["BatDauTinhDiTre"].ToString();
                                                int iChoPhepDiTre18;
                                                iChoPhepDiTre18 = Convert.ToInt32(dtCaLamViecFilo2.Rows[iCaLamViecFilo2]["ChoPhepDiTre"].ToString());
                                                string sPhutTre26;
                                                sPhutTre26 = Convert.ToInt32((dGioVaoFilo - dGioVaoKhaiBaoFiloB3).TotalMinutes).ToString();
                                                if (sTruGioDiTre21 == "True")
                                                {
                                                    if (Convert.ToInt32(sPhutTre26) < 0)
                                                    {
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = "0";
                                                    }
                                                    else
                                                    {
                                                        int iPhutTre18;
                                                        iPhutTre18 = Convert.ToInt32(sPhutTre26) - iChoPhepDiTre18;
                                                        if (sBatDauTinhDiTre21 == "True")
                                                        {
                                                            if (iPhutTre18 < 1)
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = "0";
                                                            }
                                                            else
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[5].Style.BackColor = Color.Lime;
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = iPhutTre18.ToString();
                                                            }
                                                        }
                                                        else if (iPhutTre18 < 1)
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = "0";
                                                        }
                                                        else
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = sPhutTre26;
                                                        }
                                                    }
                                                }
                                                else
                                                {
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = "0";
                                                }
                                                string sTruGioVeSom21;
                                                sTruGioVeSom21 = dtCaLamViecFilo2.Rows[iCaLamViecFilo2]["TruGioVeSom"].ToString();
                                                string sBatDauTinhVeSom21;
                                                sBatDauTinhVeSom21 = dtCaLamViecFilo2.Rows[iCaLamViecFilo2]["BatDauTinhVeSom"].ToString();
                                                int iChoPhepVeSom18;
                                                iChoPhepVeSom18 = Convert.ToInt32(dtCaLamViecFilo2.Rows[iCaLamViecFilo2]["ChoPhepVeSom"].ToString());
                                                string sPhutVeSom26;
                                                sPhutVeSom26 = Convert.ToInt32((dGioRaKhaiBaoFiLoB2 - dGioRaFilo).TotalMinutes).ToString();
                                                if (sTruGioVeSom21 == "True")
                                                {
                                                    if (Convert.ToInt32(sPhutVeSom26) < 0)
                                                    {
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = "0";
                                                    }
                                                    else
                                                    {
                                                        int iPhutVeSom18;
                                                        iPhutVeSom18 = Convert.ToInt32(sPhutVeSom26) - iChoPhepVeSom18;
                                                        if (iPhutVeSom18 < 1)
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = "0";
                                                        }
                                                        else
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[6].Style.BackColor = Color.Yellow;
                                                            if (sBatDauTinhVeSom21 == "True")
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = iPhutVeSom18.ToString();
                                                            }
                                                            else
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = sPhutVeSom26;
                                                            }
                                                        }
                                                    }
                                                }
                                                else
                                                {
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = "0";
                                                }
                                                string sVeTre17;
                                                sVeTre17 = Convert.ToInt32((dGioRaFilo - dGioRaKhaiBaoFiLoB2).TotalMinutes).ToString();
                                                if (Convert.ToInt32(sVeTre17) > 0)
                                                {
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[11].Value = sVeTre17;
                                                }
                                                else
                                                {
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[11].Value = "0";
                                                }
                                                double dGio17;
                                                dGio17 = Math.Round(Convert.ToDouble(Convert.ToSingle(dtCaLamViecFilo2.Rows[iCaLamViecFilo2]["TongGioTrongCaLamViec"]) * 60f - (float)(Convert.ToInt32(this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value.ToString()) + Convert.ToInt32(this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value))) / 60.0, this.iLamTronGio);
                                                double dTongGioTrongCa4;
                                                dTongGioTrongCa4 = Convert.ToDouble(dtCaLamViecFilo2.Rows[iCaLamViecFilo2]["TongGioTrongCaLamViec"].ToString());
                                                if (iTinhBuTru != 0 && Convert.ToInt32(this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value) > 0 && Convert.ToInt32(this.DGVTinhCong.Rows[_nhanVien].Cells[11].Value) > 0)
                                                {
                                                    int iVeTre4;
                                                    iVeTre4 = Convert.ToInt32(this.DGVTinhCong.Rows[_nhanVien].Cells[11].Value);
                                                    dGio17 = Math.Round(dGio17 + Convert.ToDouble(iVeTre4) / 60.0, 2);
                                                    if (dGio17 > dTongGioTrongCa4)
                                                    {
                                                        iVeTre4 -= Convert.ToInt32(this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value);
                                                        dGio17 = dTongGioTrongCa4;
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[11].Value = iVeTre4;
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = dGio17.ToString();
                                                    }
                                                    else
                                                    {
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = dGio17.ToString();
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = Convert.ToInt32(sPhutTre26) - iVeTre4;
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[11].Value = "0";
                                                    }
                                                }
                                                else
                                                {
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = dGio17.ToString();
                                                }
                                                double iGio17;
                                                iGio17 = Convert.ToDouble(dtCaLamViecFilo2.Rows[iCaLamViecFilo2]["TongGioTrongCaLamViec"].ToString());
                                                double dCongTinh15;
                                                dCongTinh15 = Convert.ToDouble(dtCaLamViecFilo2.Rows[iCaLamViecFilo2]["CongTinh"].ToString());
                                                double dCong17;
                                                dCong17 = Math.Round(dGio17 * dCongTinh15 / iGio17, this.iLamTronCong);
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = dCong17.ToString();
                                                string sTangCaTruocGioLamViec9;
                                                sTangCaTruocGioLamViec9 = dtCaLamViecFilo2.Rows[iCaLamViecFilo2]["TangCaTruocGioLamViec"].ToString();
                                                string sTangCaSauGioLamViec9;
                                                sTangCaSauGioLamViec9 = dtCaLamViecFilo2.Rows[iCaLamViecFilo2]["TangCaSauGioLamViec"].ToString();
                                                if (sTangCaTruocGioLamViec9 == "False" && sTangCaSauGioLamViec9 == "False")
                                                {
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                }
                                                if (sXemCaNayLaTangCa9 == "True")
                                                {
                                                    if (iTangCaMuc9 == 1)
                                                    {
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = dGio17.ToString();
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                    }
                                                    if (iTangCaMuc9 == 2)
                                                    {
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = dGio17.ToString();
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                    }
                                                    if (iTangCaMuc9 == 3)
                                                    {
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = dGio17.ToString();
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                    }
                                                    if (iTangCaMuc9 == 4)
                                                    {
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = dGio17.ToString();
                                                    }
                                                }
                                                string sChoPhepTangCaTruocGioLamViecFiLo4;
                                                sChoPhepTangCaTruocGioLamViecFiLo4 = dtCaLamViecFilo2.Rows[iCaLamViecFilo2]["TangCaTruocGioLamViec"].ToString();
                                                int iPhutTangCaTruocGioLamViecFiLo4;
                                                iPhutTangCaTruocGioLamViecFiLo4 = Convert.ToInt32(dtCaLamViecFilo2.Rows[iCaLamViecFilo2]["SoPhutTangCaTruocGioLamViec"].ToString());
                                                int iPhutTangCaTruocGioLamViecDatDen20;
                                                iPhutTangCaTruocGioLamViecDatDen20 = Convert.ToInt32(dtCaLamViecFilo2.Rows[iCaLamViecFilo2]["TangCaTruocGioLamViecDatDen"].ToString());
                                                int iPhutTruTangCaTruoc20;
                                                iPhutTruTangCaTruoc20 = Convert.ToInt32(dtCaLamViecFilo2.Rows[iCaLamViecFilo2]["PhutTruTangCaTruoc"].ToString());
                                                string sChoPhepTangCaSauGioLamViecFiLo4;
                                                sChoPhepTangCaSauGioLamViecFiLo4 = dtCaLamViecFilo2.Rows[iCaLamViecFilo2]["TangCaSauGioLamViec"].ToString();
                                                int iPhutTangCaSauGioLamViecFiLo4;
                                                iPhutTangCaSauGioLamViecFiLo4 = Convert.ToInt32(dtCaLamViecFilo2.Rows[iCaLamViecFilo2]["SoPhutTangCaSauGioLamViec"].ToString());
                                                int iPhutTangCaSauGioLamViecDatDen20;
                                                iPhutTangCaSauGioLamViecDatDen20 = Convert.ToInt32(dtCaLamViecFilo2.Rows[iCaLamViecFilo2]["TangCaSauGioLamViecDatDen"].ToString());
                                                int iPhutTruTangCaSau20;
                                                iPhutTruTangCaSau20 = Convert.ToInt32(dtCaLamViecFilo2.Rows[iCaLamViecFilo2]["PhutTruTangCaSau"].ToString());
                                                int iGioiHanTC1FiLo4;
                                                iGioiHanTC1FiLo4 = Convert.ToInt32(dtCaLamViecFilo2.Rows[iCaLamViecFilo2]["GioiHanTangCa1"].ToString());
                                                int iGioiHanTC2FiLo4;
                                                iGioiHanTC2FiLo4 = Convert.ToInt32(dtCaLamViecFilo2.Rows[iCaLamViecFilo2]["GioiHanTangCa2"].ToString());
                                                int iGioiHanTC3FiLo4;
                                                iGioiHanTC3FiLo4 = Convert.ToInt32(dtCaLamViecFilo2.Rows[iCaLamViecFilo2]["GioiHanTangCa3"].ToString());
                                                int iGioiHanTC4FiLo4;
                                                iGioiHanTC4FiLo4 = Convert.ToInt32(dtCaLamViecFilo2.Rows[iCaLamViecFilo2]["GioiHanTangCa4"].ToString());
                                                int iTongGioTangCaSauFiLo4;
                                                iTongGioTangCaSauFiLo4 = 0;
                                                int iTongGioTangCaTruocFiLo4;
                                                iTongGioTangCaTruocFiLo4 = 0;
                                                if (sChoPhepTangCaTruocGioLamViecFiLo4 == "False" && sChoPhepTangCaSauGioLamViecFiLo4 == "False")
                                                {
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                }
                                                else
                                                {
                                                    if (sChoPhepTangCaTruocGioLamViecFiLo4 == "True")
                                                    {
                                                        int iThoiGianTruocGioLamFiLo4;
                                                        iThoiGianTruocGioLamFiLo4 = Convert.ToInt32(Convert.ToInt32((dGioVaoKhaiBaoFiloB3 - dGioVaoFilo).TotalMinutes).ToString());
                                                        if (iThoiGianTruocGioLamFiLo4 > 0 && iThoiGianTruocGioLamFiLo4 > iPhutTangCaTruocGioLamViecFiLo4 && iThoiGianTruocGioLamFiLo4 > iPhutTangCaTruocGioLamViecDatDen20)
                                                        {
                                                            iTongGioTangCaTruocFiLo4 = iThoiGianTruocGioLamFiLo4 - iPhutTruTangCaTruoc20;
                                                        }
                                                    }
                                                    if (sChoPhepTangCaSauGioLamViecFiLo4 == "True")
                                                    {
                                                        int iThoiGianSauGioLamViecFiLo4;
                                                        iThoiGianSauGioLamViecFiLo4 = Convert.ToInt32(this.DGVTinhCong.Rows[_nhanVien].Cells[11].Value);
                                                        if (iThoiGianSauGioLamViecFiLo4 > 0 && iThoiGianSauGioLamViecFiLo4 > iPhutTangCaSauGioLamViecFiLo4)
                                                        {
                                                            iTongGioTangCaSauFiLo4 = ((iThoiGianSauGioLamViecFiLo4 < iPhutTangCaSauGioLamViecDatDen20) ? iThoiGianSauGioLamViecFiLo4 : (iThoiGianSauGioLamViecFiLo4 - iPhutTruTangCaSau20));
                                                        }
                                                    }
                                                }
                                                double dTongThoiGianTangCaFiLo4;
                                                dTongThoiGianTangCaFiLo4 = Convert.ToDouble(iTongGioTangCaTruocFiLo4 + iTongGioTangCaSauFiLo4);
                                                if (dTongThoiGianTangCaFiLo4 > 0.0)
                                                {
                                                    if (iGioiHanTC1FiLo4 == 0)
                                                    {
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = Math.Round(dTongThoiGianTangCaFiLo4 * this.dTangCa1HeSo / 60.0, this.iLamTronGio);
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                    }
                                                    if (iGioiHanTC1FiLo4 != 0 && iGioiHanTC2FiLo4 == 0)
                                                    {
                                                        if (dTongThoiGianTangCaFiLo4 < Convert.ToDouble(iGioiHanTC1FiLo4))
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = Math.Round(dTongThoiGianTangCaFiLo4 * this.dTangCa1HeSo / 60.0, this.iLamTronGio);
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                        }
                                                        else
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = Math.Round(Convert.ToDouble(iGioiHanTC1FiLo4) / 60.0 * this.dTangCa1HeSo, this.iLamTronGio);
                                                            if (dTongThoiGianTangCaFiLo4 - Convert.ToDouble(iGioiHanTC1FiLo4) > 0.0)
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = Math.Round((dTongThoiGianTangCaFiLo4 - Convert.ToDouble(iGioiHanTC1FiLo4)) * this.dTangCa2HeSo / 60.0, this.iLamTronGio);
                                                            }
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                        }
                                                    }
                                                    if (iGioiHanTC1FiLo4 != 0 && iGioiHanTC2FiLo4 != 0 && iGioiHanTC3FiLo4 == 0)
                                                    {
                                                        if (dTongThoiGianTangCaFiLo4 < Convert.ToDouble(iGioiHanTC1FiLo4))
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = Math.Round(dTongThoiGianTangCaFiLo4 * this.dTangCa1HeSo / 60.0, this.iLamTronGio);
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                        }
                                                        else
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = Math.Round(Convert.ToDouble(iGioiHanTC1FiLo4) * this.dTangCa1HeSo / 60.0, this.iLamTronGio);
                                                            if (dTongThoiGianTangCaFiLo4 - Convert.ToDouble(iGioiHanTC1FiLo4) < Convert.ToDouble(iGioiHanTC2FiLo4))
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = Math.Round((dTongThoiGianTangCaFiLo4 - Convert.ToDouble(iGioiHanTC1FiLo4)) * this.dTangCa2HeSo / 60.0, this.iLamTronGio);
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                            }
                                                            else
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = Math.Round(Convert.ToDouble(iGioiHanTC1FiLo4) * this.dTangCa1HeSo / 60.0, this.iLamTronGio);
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = Math.Round(Convert.ToDouble(iGioiHanTC2FiLo4) * this.dTangCa2HeSo / 60.0, this.iLamTronGio);
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = Math.Round((dTongThoiGianTangCaFiLo4 - Convert.ToDouble(iGioiHanTC1FiLo4) - Convert.ToDouble(iGioiHanTC2FiLo4)) * this.dTangCa3HeSo / 60.0, this.iLamTronGio);
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                            }
                                                        }
                                                    }
                                                    if (iGioiHanTC1FiLo4 != 0 && iGioiHanTC2FiLo4 != 0 && iGioiHanTC3FiLo4 != 0 && iGioiHanTC4FiLo4 != 0)
                                                    {
                                                    }
                                                }
                                                else
                                                {
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                }
                                                string sTongGio9;
                                                sTongGio9 = Math.Round(Convert.ToDouble(Convert.ToInt32((dGioRaFilo - dGioVaoFilo).TotalMinutes).ToString()) / 60.0, this.iLamTronGio).ToString();
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[16].Value = sTongGio9;
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[17].Value = dtCaLamViecFilo2.Rows[iCaLamViecFilo2]["CongTinh"].ToString();
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[18].Value = this.sKHDungGio;
                                            }
                                            if (DateTimeProgress.XuatIDThu((int)dt.AddDays(dem).DayOfWeek) == "0")
                                            {
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[19].Value = "CN";
                                            }
                                            else
                                            {
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[19].Value = "NT";
                                            }
                                            this.DGVTinhCong.Rows[_nhanVien].Cells[20].Value = this.sMaChamCong;
                                            this.DGVTinhCong.Rows[_nhanVien].Cells[21].Value = this.sPhongBanTinhCong;
                                        }
                                        break;
                                    }
                                }
                                if (iCaTrongLIchtrinh4 == 0)
                                {
                                    this.DGVTinhCong.Rows[_nhanVien].Cells[4].Value = ca;
                                    this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = "0";
                                    this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = "0";
                                    this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = "0";
                                    this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = "0";
                                    this.DGVTinhCong.Rows[_nhanVien].Cells[11].Value = "0";
                                    this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = "0";
                                    this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                    this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                    this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                    this.DGVTinhCong.Rows[_nhanVien].Cells[16].Value = "0";
                                    this.DGVTinhCong.Rows[_nhanVien].Cells[17].Value = "0";
                                    this.DGVTinhCong.Rows[_nhanVien].Cells[18].Value = this.sKHVang;
                                    if (DateTimeProgress.XuatIDThu((int)dt.AddDays(dem).DayOfWeek) == "0")
                                    {
                                        this.DGVTinhCong.Rows[_nhanVien].Cells[19].Value = "CN";
                                    }
                                    else
                                    {
                                        this.DGVTinhCong.Rows[_nhanVien].Cells[19].Value = "NT";
                                    }
                                    this.DGVTinhCong.Rows[_nhanVien].Cells[20].Value = this.sMaChamCong;
                                    this.DGVTinhCong.Rows[_nhanVien].Cells[21].Value = this.sPhongBanTinhCong;
                                }
                            }
                            if (iLanChamFilo == 0)
                            {
                                this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = "0";
                                this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = "0";
                                this.DGVTinhCong.Rows[_nhanVien].Cells[17].Value = "0";
                                this.DGVTinhCong.Rows[_nhanVien].Cells[18].Value = this.sKHVang;
                                if (DateTimeProgress.XuatIDThu((int)dt.AddDays(dem).DayOfWeek) == "0")
                                {
                                    this.DGVTinhCong.Rows[_nhanVien].Cells[19].Value = "CN";
                                }
                                else
                                {
                                    this.DGVTinhCong.Rows[_nhanVien].Cells[19].Value = "NT";
                                }
                                this.DGVTinhCong.Rows[_nhanVien].Cells[20].Value = this.sMaChamCong;
                                this.DGVTinhCong.Rows[_nhanVien].Cells[21].Value = this.sPhongBanTinhCong;
                            }
                        }
                        if (iChonLichTrinh == 6)
                        {
                            int iKiemTraLanChamTinhTheoGioLichTrinhVaoRa;
                            iKiemTraLanChamTinhTheoGioLichTrinhVaoRa = 0;
                            int iKiemTraLanChamKhoangCachTinhTheoGioLichTrinhVaoRa;
                            iKiemTraLanChamKhoangCachTinhTheoGioLichTrinhVaoRa = 0;
                            int demTinhTheoGio;
                            demTinhTheoGio = 0;
                            int addTinhTheoGio;
                            addTinhTheoGio = 1;
                            int iDemLanChamCongTinhTheoGio;
                            iDemLanChamCongTinhTheoGio = 0;
                            DateTime dGioVaoTinhTheoGio;
                            dGioVaoTinhTheoGio = default(DateTime);
                            DateTime dGioRaTinhTheoGioLichTrinhVaoRa;
                            dGioRaTinhTheoGioLichTrinhVaoRa = default(DateTime);
                            DateTime dGioVaoTinhTheoGioLichTrinhVaoRa;
                            dGioVaoTinhTheoGioLichTrinhVaoRa = default(DateTime);
                            new DataTable();
                            DataTable dtTinhTheoGio;
                            dtTinhTheoGio = this._checkInOutBLL.getCheckInOutByMaChamCongAndNgayCham(Convert.ToInt32(this.sMaChamCong), Convert.ToDateTime(this.DGVTinhCong.Rows[_nhanVien].Cells[2].Value.ToString()));
                            for (int iTinhTheoGio = 0; iTinhTheoGio < dtTinhTheoGio.Rows.Count; iTinhTheoGio++)
                            {
                                iKiemTraLanChamTinhTheoGioLichTrinhVaoRa++;
                                if (iKiemTraLanChamTinhTheoGioLichTrinhVaoRa == 1)
                                {
                                    dGioVaoTinhTheoGioLichTrinhVaoRa = Convert.ToDateTime(dtTinhTheoGio.Rows[iTinhTheoGio]["GioCham"].ToString());
                                    if (dtTinhTheoGio.Rows.Count > 2 && iKiemTraLanChamKhoangCachTinhTheoGioLichTrinhVaoRa == 3)
                                    {
                                        if (Convert.ToInt32(Convert.ToInt32((dGioVaoTinhTheoGioLichTrinhVaoRa - dGioRaTinhTheoGioLichTrinhVaoRa).TotalMinutes).ToString()) < iKhoangCachGiuaHaiCapVaoRa)
                                        {
                                            iKiemTraLanChamTinhTheoGioLichTrinhVaoRa = 0;
                                            continue;
                                        }
                                        iKiemTraLanChamTinhTheoGioLichTrinhVaoRa = 1;
                                    }
                                }
                                if (iKiemTraLanChamTinhTheoGioLichTrinhVaoRa == 2)
                                {
                                    dGioRaTinhTheoGioLichTrinhVaoRa = Convert.ToDateTime(dtTinhTheoGio.Rows[iTinhTheoGio]["GioCham"].ToString());
                                    if (Convert.ToInt32(Convert.ToInt32((dGioRaTinhTheoGioLichTrinhVaoRa - dGioVaoTinhTheoGioLichTrinhVaoRa).TotalMinutes).ToString()) < iThoiGianNhoNhat)
                                    {
                                        iKiemTraLanChamTinhTheoGioLichTrinhVaoRa = 1;
                                        continue;
                                    }
                                }
                                iDemLanChamCongTinhTheoGio++;
                                if (iDemLanChamCongTinhTheoGio == 1)
                                {
                                    dGioVaoTinhTheoGio = Convert.ToDateTime(dtTinhTheoGio.Rows[iTinhTheoGio]["GioCham"].ToString());
                                    this.DGVTinhCong.Rows[_nhanVien].Cells[5].Value = string.Format(this.sDinhDangThoiGian, dGioVaoTinhTheoGio);
                                    if (dtTinhTheoGio.Rows.Count == 1)
                                    {
                                        this.DGVTinhCong.Rows[_nhanVien].Cells[0].Value = this.sMaNhanVien;
                                        this.DGVTinhCong.Rows[_nhanVien].Cells[1].Value = this.sTenNhanVien;
                                        this.DGVTinhCong.Rows[_nhanVien].Cells[2].Value = this.DGVTinhCong.Rows[_nhanVien].Cells[2].Value.ToString();
                                        this.DGVTinhCong.Rows[_nhanVien].Cells[3].Value = DateTimeProgress.XuatThuTinhCong((int)dt.AddDays(dem).DayOfWeek);
                                        this.DGVTinhCong.Rows[_nhanVien].Cells[4].Value = ca;
                                        this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = "0";
                                        this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = "0";
                                        this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = "0";
                                        this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = "0";
                                        this.DGVTinhCong.Rows[_nhanVien].Cells[11].Value = "0";
                                        this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = "0";
                                        this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                        this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                        this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                        this.DGVTinhCong.Rows[_nhanVien].Cells[16].Value = "0";
                                        this.DGVTinhCong.Rows[_nhanVien].Cells[17].Value = "0";
                                        this.DGVTinhCong.Rows[_nhanVien].Cells[18].Value = this.sKHVang;
                                        if (DateTimeProgress.XuatIDThu((int)dt.AddDays(dem).DayOfWeek) == "0")
                                        {
                                            this.DGVTinhCong.Rows[_nhanVien].Cells[19].Value = "CN";
                                        }
                                        else
                                        {
                                            this.DGVTinhCong.Rows[_nhanVien].Cells[19].Value = "NT";
                                        }
                                        this.DGVTinhCong.Rows[_nhanVien].Cells[20].Value = this.sMaChamCong;
                                        this.DGVTinhCong.Rows[_nhanVien].Cells[21].Value = this.sPhongBanTinhCong;
                                    }
                                    else
                                    {
                                        this.DGVTinhCong.Rows[_nhanVien].Cells[0].Value = this.sMaNhanVien;
                                        this.DGVTinhCong.Rows[_nhanVien].Cells[1].Value = this.sTenNhanVien;
                                        this.DGVTinhCong.Rows[_nhanVien].Cells[2].Value = this.DGVTinhCong.Rows[_nhanVien].Cells[2].Value.ToString();
                                        this.DGVTinhCong.Rows[_nhanVien].Cells[3].Value = DateTimeProgress.XuatThuTinhCong((int)dt.AddDays(dem).DayOfWeek);
                                        this.DGVTinhCong.Rows[_nhanVien].Cells[4].Value = ca;
                                        this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = "0";
                                        this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = "0";
                                        this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = "0";
                                        this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = "0";
                                        this.DGVTinhCong.Rows[_nhanVien].Cells[11].Value = "0";
                                        this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = "0";
                                        this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                        this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                        this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                        this.DGVTinhCong.Rows[_nhanVien].Cells[16].Value = "0";
                                        this.DGVTinhCong.Rows[_nhanVien].Cells[17].Value = "0";
                                        this.DGVTinhCong.Rows[_nhanVien].Cells[18].Value = this.sKHVang;
                                        if (DateTimeProgress.XuatIDThu((int)dt.AddDays(dem).DayOfWeek) == "0")
                                        {
                                            this.DGVTinhCong.Rows[_nhanVien].Cells[19].Value = "CN";
                                        }
                                        else
                                        {
                                            this.DGVTinhCong.Rows[_nhanVien].Cells[19].Value = "NT";
                                        }
                                        this.DGVTinhCong.Rows[_nhanVien].Cells[20].Value = this.sMaChamCong;
                                        this.DGVTinhCong.Rows[_nhanVien].Cells[21].Value = this.sPhongBanTinhCong;
                                    }
                                }
                                if (iDemLanChamCongTinhTheoGio == 2)
                                {
                                    DateTime dGioRaTinhTheoGio;
                                    dGioRaTinhTheoGio = Convert.ToDateTime(dtTinhTheoGio.Rows[iTinhTheoGio]["GioCham"].ToString());
                                    if (Convert.ToInt32(Convert.ToInt32((dGioRaTinhTheoGioLichTrinhVaoRa - dGioVaoTinhTheoGioLichTrinhVaoRa).TotalMinutes).ToString()) > iThoiGianLonNhat)
                                    {
                                        int addTinhTheoGioThoiGianLonNhat2;
                                        addTinhTheoGioThoiGianLonNhat2 = this.DGVTinhCong.Rows.Add();
                                        this.DGVTinhCong.Rows[addTinhTheoGioThoiGianLonNhat2].Cells[0].Value = this.sMaNhanVien;
                                        this.DGVTinhCong.Rows[addTinhTheoGioThoiGianLonNhat2].Cells[1].Value = this.sTenNhanVien;
                                        this.DGVTinhCong.Rows[addTinhTheoGioThoiGianLonNhat2].Cells[2].Value = this.DGVTinhCong.Rows[_nhanVien].Cells[2].Value.ToString();
                                        this.DGVTinhCong.Rows[addTinhTheoGioThoiGianLonNhat2].Cells[3].Value = DateTimeProgress.XuatThuTinhCong((int)dt.AddDays(dem).DayOfWeek);
                                        this.DGVTinhCong.Rows[addTinhTheoGioThoiGianLonNhat2].Cells[4].Value = ca;
                                        this.DGVTinhCong.Rows[addTinhTheoGioThoiGianLonNhat2].Cells[6].Value = string.Format(this.sDinhDangThoiGian, dGioRaTinhTheoGio);
                                        this.DGVTinhCong.Rows[addTinhTheoGioThoiGianLonNhat2].Cells[7].Value = "0";
                                        this.DGVTinhCong.Rows[addTinhTheoGioThoiGianLonNhat2].Cells[8].Value = "0";
                                        this.DGVTinhCong.Rows[addTinhTheoGioThoiGianLonNhat2].Cells[9].Value = "0";
                                        this.DGVTinhCong.Rows[addTinhTheoGioThoiGianLonNhat2].Cells[10].Value = "0";
                                        this.DGVTinhCong.Rows[addTinhTheoGioThoiGianLonNhat2].Cells[11].Value = "0";
                                        this.DGVTinhCong.Rows[addTinhTheoGioThoiGianLonNhat2].Cells[12].Value = "0";
                                        this.DGVTinhCong.Rows[addTinhTheoGioThoiGianLonNhat2].Cells[13].Value = "0";
                                        this.DGVTinhCong.Rows[addTinhTheoGioThoiGianLonNhat2].Cells[14].Value = "0";
                                        this.DGVTinhCong.Rows[addTinhTheoGioThoiGianLonNhat2].Cells[15].Value = "0";
                                        this.DGVTinhCong.Rows[addTinhTheoGioThoiGianLonNhat2].Cells[16].Value = "0";
                                        this.DGVTinhCong.Rows[addTinhTheoGioThoiGianLonNhat2].Cells[17].Value = "0";
                                        this.DGVTinhCong.Rows[addTinhTheoGioThoiGianLonNhat2].Cells[18].Value = this.sKHVang;
                                        if (DateTimeProgress.XuatIDThu((int)dt.AddDays(dem).DayOfWeek) == "0")
                                        {
                                            this.DGVTinhCong.Rows[addTinhTheoGioThoiGianLonNhat2].Cells[19].Value = "CN";
                                        }
                                        else
                                        {
                                            this.DGVTinhCong.Rows[addTinhTheoGioThoiGianLonNhat2].Cells[19].Value = "NT";
                                        }
                                        this.DGVTinhCong.Rows[addTinhTheoGioThoiGianLonNhat2].Cells[20].Value = this.sMaChamCong;
                                        this.DGVTinhCong.Rows[addTinhTheoGioThoiGianLonNhat2].Cells[21].Value = this.sPhongBanTinhCong;
                                    }
                                    else
                                    {
                                        this.DGVTinhCong.Rows[_nhanVien].Cells[6].Value = string.Format(this.sDinhDangThoiGian, dGioRaTinhTheoGio);
                                        int iCaTrongLIchtrinh2;
                                        iCaTrongLIchtrinh2 = 0;
                                        new DataTable();
                                        this._chiTietLichTrinhChoCalamViecDTO.MaLichTrinhCaLamViec = sLTCCLVNhanVien;
                                        this._chiTietLichTrinhChoCalamViecDTO.Thu = sThu;
                                        DataTable dtNhanCaTinhTheoGio2;
                                        dtNhanCaTinhTheoGio2 = this._chiTietLichTrinhChoCaLamViecBLL.ChiTietLichTrinhChoCaLamViecNhanCa(this._chiTietLichTrinhChoCalamViecDTO);
                                        int iChiTietLichTrinhChoCaLamViecTinhTheoGio2;
                                        iChiTietLichTrinhChoCaLamViecTinhTheoGio2 = 0;
                                        if (iChiTietLichTrinhChoCaLamViecTinhTheoGio2 < dtNhanCaTinhTheoGio2.Rows.Count)
                                        {
                                            iCaTrongLIchtrinh2 = 1;
                                            int cellChiTietLichTrinhChoCaLamViecTinhTheoGio2;
                                            cellChiTietLichTrinhChoCaLamViecTinhTheoGio2 = 3;
                                            while (true)
                                            {
                                                if (cellChiTietLichTrinhChoCaLamViecTinhTheoGio2 < 13)
                                                {
                                                    kiemTraVao = 0;
                                                    kiemTraRa = 0;
                                                    this.sTinhTheoGioMaCaLamViec = dtNhanCaTinhTheoGio2.Rows[iChiTietLichTrinhChoCaLamViecTinhTheoGio2][cellChiTietLichTrinhChoCaLamViecTinhTheoGio2].ToString();
                                                    new DataTable();
                                                    DataTable dtTinhTheoGioCa2;
                                                    dtTinhTheoGioCa2 = this._caLamViecBLL.CaLamViecGetByMaCaLamViec(sTinhTheoGioMaCaLamViec);
                                                    int iTinhTheoGioCa2;
                                                    iTinhTheoGioCa2 = 0;
                                                    while (iTinhTheoGioCa2 < dtTinhTheoGioCa2.Rows.Count)
                                                    {
                                                        string sGiayGioVao23;
                                                        sGiayGioVao23 = dGioVaoTinhTheoGio.Second.ToString();
                                                        string sGiayGioRa23;
                                                        sGiayGioRa23 = dGioRaTinhTheoGio.Second.ToString();
                                                        this.sTinhTheoGioTenCaLamViec = dtTinhTheoGioCa2.Rows[iTinhTheoGioCa2]["CaLamViec"].ToString();
                                                        DateTime dBatDauVaoTinhTheoGioB2;
                                                        dBatDauVaoTinhTheoGioB2 = Convert.ToDateTime(sNgayCham + " " + string.Format("{0:T}", Convert.ToDateTime(dtTinhTheoGioCa2.Rows[iTinhTheoGioCa2]["BatDauVao"].ToString())).Replace("00 ", sGiayGioVao23 + " "));
                                                        Convert.ToDateTime(sNgayCham + " " + string.Format("{0:T}", Convert.ToDateTime(dtTinhTheoGioCa2.Rows[iTinhTheoGioCa2]["KetThucVao"].ToString())).Replace("00 ", sGiayGioVao23 + " "));
                                                        Convert.ToDateTime(sNgayCham + " " + string.Format("{0:T}", Convert.ToDateTime(dtTinhTheoGioCa2.Rows[iTinhTheoGioCa2]["BatDauRa"].ToString())).Replace("00 ", sGiayGioRa23 + " "));
                                                        DateTime dKetThucRaTinhTheoGioB2;
                                                        dKetThucRaTinhTheoGioB2 = Convert.ToDateTime(sNgayCham + " " + string.Format("{0:T}", Convert.ToDateTime(dtTinhTheoGioCa2.Rows[iTinhTheoGioCa2]["KetThucRa"].ToString())).Replace("00 ", sGiayGioRa23 + " "));
                                                        if (dGioVaoTinhTheoGio >= dBatDauVaoTinhTheoGioB2 && dGioVaoTinhTheoGio <= dKetThucRaTinhTheoGioB2)
                                                        {
                                                            kiemTraVao++;
                                                        }
                                                        if (dGioRaTinhTheoGio >= dBatDauVaoTinhTheoGioB2 && dGioRaTinhTheoGio <= dKetThucRaTinhTheoGioB2)
                                                        {
                                                            kiemTraRa++;
                                                        }
                                                        if (kiemTraVao != 1 || kiemTraRa != 1)
                                                        {
                                                            iTinhTheoGioCa2++;
                                                            continue;
                                                        }
                                                        goto IL_31909;
                                                    }
                                                    if (!(this.sTinhTheoGioMaCaLamViec == ""))
                                                    {
                                                        cellChiTietLichTrinhChoCaLamViecTinhTheoGio2++;
                                                        continue;
                                                    }
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[4].Value = ca;
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[11].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[16].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[17].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[18].Value = this.sKHVang;
                                                    if (DateTimeProgress.XuatIDThu((int)dt.AddDays(dem).DayOfWeek) == "0")
                                                    {
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[19].Value = "CN";
                                                    }
                                                    else
                                                    {
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[19].Value = "NT";
                                                    }
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[20].Value = this.sMaChamCong;
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[21].Value = this.sPhongBanTinhCong;
                                                    break;
                                                }
                                                goto IL_31909;
                                            IL_31909:
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[4].Value = this.sTinhTheoGioTenCaLamViec;
                                                new DataTable();
                                                DataTable dtCaLamViecTinhTheoGio2;
                                                dtCaLamViecTinhTheoGio2 = this._caLamViecBLL.CaLamViecGetByMaCaLamViec(sTinhTheoGioMaCaLamViec);
                                                for (int iCaLamViecTinhTheoGio2 = 0; iCaLamViecTinhTheoGio2 < dtCaLamViecTinhTheoGio2.Rows.Count; iCaLamViecTinhTheoGio2++)
                                                {
                                                    string sGiayGioVao20;
                                                    sGiayGioVao20 = dGioVaoTinhTheoGio.Second.ToString();
                                                    string sGiayGioRa20;
                                                    sGiayGioRa20 = dGioRaTinhTheoGio.Second.ToString();
                                                    DateTime dGioVaoKhaiBaoTinhTheoGioB2;
                                                    dGioVaoKhaiBaoTinhTheoGioB2 = Convert.ToDateTime(sNgayCham + " " + string.Format("{0:T}", Convert.ToDateTime(dtCaLamViecTinhTheoGio2.Rows[iCaLamViecTinhTheoGio2]["GioVaoLamViec"].ToString())).Replace("00 ", sGiayGioVao20 + " "));
                                                    DateTime dGioRaKhaiBaoTinhTheoGioB2;
                                                    dGioRaKhaiBaoTinhTheoGioB2 = Convert.ToDateTime(sNgayCham + " " + string.Format("{0:T}", Convert.ToDateTime(dtCaLamViecTinhTheoGio2.Rows[iCaLamViecTinhTheoGio2]["GioKetThucLamViec"].ToString())).Replace("00 ", sGiayGioRa20 + " "));
                                                    string sTruGioDiTre15;
                                                    sTruGioDiTre15 = dtCaLamViecTinhTheoGio2.Rows[iCaLamViecTinhTheoGio2]["TruGioDiTre"].ToString();
                                                    string sBatDauTinhDiTre15;
                                                    sBatDauTinhDiTre15 = dtCaLamViecTinhTheoGio2.Rows[iCaLamViecTinhTheoGio2]["BatDauTinhDiTre"].ToString();
                                                    int iChoPhepDiTre12;
                                                    iChoPhepDiTre12 = Convert.ToInt32(dtCaLamViecTinhTheoGio2.Rows[iCaLamViecTinhTheoGio2]["ChoPhepDiTre"].ToString());
                                                    string sPhutTre13;
                                                    sPhutTre13 = Convert.ToInt32((dGioVaoTinhTheoGio - dGioVaoKhaiBaoTinhTheoGioB2).TotalMinutes).ToString();
                                                    if (sTruGioDiTre15 == "True")
                                                    {
                                                        if (Convert.ToInt32(sPhutTre13) < 0)
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = "0";
                                                        }
                                                        else
                                                        {
                                                            int iPhutTre12;
                                                            iPhutTre12 = Convert.ToInt32(sPhutTre13) - iChoPhepDiTre12;
                                                            if (sBatDauTinhDiTre15 == "True")
                                                            {
                                                                if (iPhutTre12 < 1)
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = "0";
                                                                }
                                                                else
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = iPhutTre12.ToString();
                                                                }
                                                            }
                                                            else if (iPhutTre12 < 1)
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = "0";
                                                            }
                                                            else
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = sPhutTre13;
                                                            }
                                                        }
                                                    }
                                                    else
                                                    {
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = "0";
                                                    }
                                                    string sTruGioVeSom15;
                                                    sTruGioVeSom15 = dtCaLamViecTinhTheoGio2.Rows[iCaLamViecTinhTheoGio2]["TruGioVeSom"].ToString();
                                                    string sBatDauTinhVeSom15;
                                                    sBatDauTinhVeSom15 = dtCaLamViecTinhTheoGio2.Rows[iCaLamViecTinhTheoGio2]["BatDauTinhVeSom"].ToString();
                                                    int iChoPhepVeSom12;
                                                    iChoPhepVeSom12 = Convert.ToInt32(dtCaLamViecTinhTheoGio2.Rows[iCaLamViecTinhTheoGio2]["ChoPhepVeSom"].ToString());
                                                    string sPhutVeSom12;
                                                    sPhutVeSom12 = Convert.ToInt32((dGioRaKhaiBaoTinhTheoGioB2 - dGioRaTinhTheoGio).TotalMinutes).ToString();
                                                    if (sTruGioVeSom15 == "True")
                                                    {
                                                        if (Convert.ToInt32(sPhutVeSom12) < 0)
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = "0";
                                                        }
                                                        else
                                                        {
                                                            int iPhutVeSom12;
                                                            iPhutVeSom12 = Convert.ToInt32(sPhutVeSom12) - iChoPhepVeSom12;
                                                            if (iPhutVeSom12 < 1)
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = "0";
                                                            }
                                                            else if (sBatDauTinhVeSom15 == "True")
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = iPhutVeSom12.ToString();
                                                            }
                                                            else
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = sPhutVeSom12;
                                                            }
                                                        }
                                                    }
                                                    else
                                                    {
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = "0";
                                                    }
                                                    string sVeTre11;
                                                    sVeTre11 = Convert.ToInt32((dGioRaTinhTheoGio - dGioRaKhaiBaoTinhTheoGioB2).TotalMinutes).ToString();
                                                    if (Convert.ToInt32(sVeTre11) > 0)
                                                    {
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[11].Value = sVeTre11;
                                                    }
                                                    else
                                                    {
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[11].Value = "0";
                                                    }
                                                    double dGio11;
                                                    dGio11 = Math.Round(Convert.ToDouble(Convert.ToSingle(dtCaLamViecTinhTheoGio2.Rows[iCaLamViecTinhTheoGio2]["TongGioTrongCaLamViec"]) * 60f - (float)(Convert.ToInt32(this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value.ToString()) + Convert.ToInt32(this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value))) / 60.0, this.iLamTronGio);
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = dGio11.ToString();
                                                    double iGio11;
                                                    iGio11 = Convert.ToDouble(dtCaLamViecTinhTheoGio2.Rows[iCaLamViecTinhTheoGio2]["TongGioTrongCaLamViec"].ToString());
                                                    double dCongTinh10;
                                                    dCongTinh10 = Convert.ToDouble(dtCaLamViecTinhTheoGio2.Rows[iCaLamViecTinhTheoGio2]["CongTinh"].ToString());
                                                    double dCong11;
                                                    dCong11 = Math.Round(dGio11 * dCongTinh10 / iGio11, this.iLamTronCong);
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = dCong11.ToString();
                                                    string sTangCaTruocGioLamViec5;
                                                    sTangCaTruocGioLamViec5 = dtCaLamViecTinhTheoGio2.Rows[iCaLamViecTinhTheoGio2]["TangCaTruocGioLamViec"].ToString();
                                                    string sTangCaSauGioLamViec5;
                                                    sTangCaSauGioLamViec5 = dtCaLamViecTinhTheoGio2.Rows[iCaLamViecTinhTheoGio2]["TangCaSauGioLamViec"].ToString();
                                                    if (sTangCaTruocGioLamViec5 == "False" && sTangCaSauGioLamViec5 == "False")
                                                    {
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                    }
                                                    string sXemCaNayLaTangCa6;
                                                    sXemCaNayLaTangCa6 = dtCaLamViecTinhTheoGio2.Rows[iCaLamViecTinhTheoGio2]["XemCaNayLaTangCa"].ToString();
                                                    int iTangCaMuc6;
                                                    iTangCaMuc6 = Convert.ToInt32(dtCaLamViecTinhTheoGio2.Rows[iCaLamViecTinhTheoGio2]["TangCaMuc"].ToString());
                                                    if (sXemCaNayLaTangCa6 == "True")
                                                    {
                                                        if (iTangCaMuc6 == 1)
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = dGio11.ToString();
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                        }
                                                        if (iTangCaMuc6 == 2)
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = dGio11.ToString();
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                        }
                                                        if (iTangCaMuc6 == 3)
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = dGio11.ToString();
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                        }
                                                        if (iTangCaMuc6 == 4)
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = dGio11.ToString();
                                                        }
                                                    }
                                                    string sChoPhepTangCaTruocGioLamViecTinhTheoGio2;
                                                    sChoPhepTangCaTruocGioLamViecTinhTheoGio2 = dtCaLamViecTinhTheoGio2.Rows[iCaLamViecTinhTheoGio2]["TangCaTruocGioLamViec"].ToString();
                                                    int iPhutTangCaTruocGioLamViecTinhTheoGio2;
                                                    iPhutTangCaTruocGioLamViecTinhTheoGio2 = Convert.ToInt32(dtCaLamViecTinhTheoGio2.Rows[iCaLamViecTinhTheoGio2]["SoPhutTangCaTruocGioLamViec"].ToString());
                                                    int iPhutTangCaTruocGioLamViecDatDen14;
                                                    iPhutTangCaTruocGioLamViecDatDen14 = Convert.ToInt32(dtCaLamViecTinhTheoGio2.Rows[iCaLamViecTinhTheoGio2]["TangCaTruocGioLamViecDatDen"].ToString());
                                                    int iPhutTruTangCaTruoc14;
                                                    iPhutTruTangCaTruoc14 = Convert.ToInt32(dtCaLamViecTinhTheoGio2.Rows[iCaLamViecTinhTheoGio2]["PhutTruTangCaTruoc"].ToString());
                                                    string sChoPhepTangCaSauGioLamViecTinhTheoGio2;
                                                    sChoPhepTangCaSauGioLamViecTinhTheoGio2 = dtCaLamViecTinhTheoGio2.Rows[iCaLamViecTinhTheoGio2]["TangCaSauGioLamViec"].ToString();
                                                    int iPhutTangCaSauGioLamViecTinhTheoGio2;
                                                    iPhutTangCaSauGioLamViecTinhTheoGio2 = Convert.ToInt32(dtCaLamViecTinhTheoGio2.Rows[iCaLamViecTinhTheoGio2]["SoPhutTangCaSauGioLamViec"].ToString());
                                                    int iPhutTangCaSauGioLamViecDatDen14;
                                                    iPhutTangCaSauGioLamViecDatDen14 = Convert.ToInt32(dtCaLamViecTinhTheoGio2.Rows[iCaLamViecTinhTheoGio2]["TangCaSauGioLamViecDatDen"].ToString());
                                                    int iPhutTruTangCaSau14;
                                                    iPhutTruTangCaSau14 = Convert.ToInt32(dtCaLamViecTinhTheoGio2.Rows[iCaLamViecTinhTheoGio2]["PhutTruTangCaSau"].ToString());
                                                    int iGioiHanTC1TinhTheoGio2;
                                                    iGioiHanTC1TinhTheoGio2 = Convert.ToInt32(dtCaLamViecTinhTheoGio2.Rows[iCaLamViecTinhTheoGio2]["GioiHanTangCa1"].ToString());
                                                    int iGioiHanTC2TinhTheoGio2;
                                                    iGioiHanTC2TinhTheoGio2 = Convert.ToInt32(dtCaLamViecTinhTheoGio2.Rows[iCaLamViecTinhTheoGio2]["GioiHanTangCa2"].ToString());
                                                    int iGioiHanTC3TinhTheoGio2;
                                                    iGioiHanTC3TinhTheoGio2 = Convert.ToInt32(dtCaLamViecTinhTheoGio2.Rows[iCaLamViecTinhTheoGio2]["GioiHanTangCa3"].ToString());
                                                    int iGioiHanTC4TinhTheoGio2;
                                                    iGioiHanTC4TinhTheoGio2 = Convert.ToInt32(dtCaLamViecTinhTheoGio2.Rows[iCaLamViecTinhTheoGio2]["GioiHanTangCa4"].ToString());
                                                    int iTongGioTangCaSauTinhTheoGio2;
                                                    iTongGioTangCaSauTinhTheoGio2 = 0;
                                                    int iTongGioTangCaTruocTinhTheoGio2;
                                                    iTongGioTangCaTruocTinhTheoGio2 = 0;
                                                    if (sChoPhepTangCaTruocGioLamViecTinhTheoGio2 == "False" && sChoPhepTangCaSauGioLamViecTinhTheoGio2 == "False")
                                                    {
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                    }
                                                    else
                                                    {
                                                        if (sChoPhepTangCaTruocGioLamViecTinhTheoGio2 == "True")
                                                        {
                                                            int iThoiGianTruocGioLamTinhTheoGio2;
                                                            iThoiGianTruocGioLamTinhTheoGio2 = Convert.ToInt32(Convert.ToInt32((dGioVaoKhaiBaoTinhTheoGioB2 - dGioVaoTinhTheoGio).TotalMinutes).ToString());
                                                            if (iThoiGianTruocGioLamTinhTheoGio2 > 0 && iThoiGianTruocGioLamTinhTheoGio2 > iPhutTangCaTruocGioLamViecTinhTheoGio2 && iThoiGianTruocGioLamTinhTheoGio2 > iPhutTangCaTruocGioLamViecDatDen14)
                                                            {
                                                                iTongGioTangCaTruocTinhTheoGio2 = iThoiGianTruocGioLamTinhTheoGio2 - iPhutTruTangCaTruoc14;
                                                            }
                                                        }
                                                        if (sChoPhepTangCaSauGioLamViecTinhTheoGio2 == "True")
                                                        {
                                                            int iThoiGianSauGioLamViecTinhTheoGio2;
                                                            iThoiGianSauGioLamViecTinhTheoGio2 = Convert.ToInt32(Convert.ToInt32((dGioRaTinhTheoGio - dGioRaKhaiBaoTinhTheoGioB2).TotalMinutes).ToString());
                                                            if (iThoiGianSauGioLamViecTinhTheoGio2 > 0 && iThoiGianSauGioLamViecTinhTheoGio2 > iPhutTangCaSauGioLamViecTinhTheoGio2 && iThoiGianSauGioLamViecTinhTheoGio2 > iPhutTangCaSauGioLamViecDatDen14)
                                                            {
                                                                iTongGioTangCaSauTinhTheoGio2 = iThoiGianSauGioLamViecTinhTheoGio2 - iPhutTruTangCaSau14;
                                                            }
                                                        }
                                                    }
                                                    double dTongThoiGianTangCaTinhTheoGio2;
                                                    dTongThoiGianTangCaTinhTheoGio2 = Convert.ToDouble(iTongGioTangCaTruocTinhTheoGio2 + iTongGioTangCaSauTinhTheoGio2);
                                                    if (dTongThoiGianTangCaTinhTheoGio2 > 0.0)
                                                    {
                                                        if (iGioiHanTC1TinhTheoGio2 == 0)
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = Math.Round(dTongThoiGianTangCaTinhTheoGio2 * this.dTangCa1HeSo / 60.0, this.iLamTronGio);
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                        }
                                                        if (iGioiHanTC1TinhTheoGio2 != 0 && iGioiHanTC2TinhTheoGio2 == 0)
                                                        {
                                                            if (dTongThoiGianTangCaTinhTheoGio2 < Convert.ToDouble(iGioiHanTC1TinhTheoGio2))
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = Math.Round(dTongThoiGianTangCaTinhTheoGio2 * this.dTangCa1HeSo / 60.0, this.iLamTronGio);
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                            }
                                                            else
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = Math.Round(Convert.ToDouble(iGioiHanTC1TinhTheoGio2) / 60.0 * this.dTangCa1HeSo, this.iLamTronGio);
                                                                if (dTongThoiGianTangCaTinhTheoGio2 - Convert.ToDouble(iGioiHanTC1TinhTheoGio2) > 0.0)
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = Math.Round((dTongThoiGianTangCaTinhTheoGio2 - Convert.ToDouble(iGioiHanTC1TinhTheoGio2)) * this.dTangCa2HeSo / 60.0, this.iLamTronGio);
                                                                }
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                            }
                                                        }
                                                        if (iGioiHanTC1TinhTheoGio2 != 0 && iGioiHanTC2TinhTheoGio2 != 0 && iGioiHanTC3TinhTheoGio2 == 0)
                                                        {
                                                            if (dTongThoiGianTangCaTinhTheoGio2 < Convert.ToDouble(iGioiHanTC1TinhTheoGio2))
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = Math.Round(dTongThoiGianTangCaTinhTheoGio2 * this.dTangCa1HeSo / 60.0, this.iLamTronGio);
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                            }
                                                            else
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = Math.Round(Convert.ToDouble(iGioiHanTC1TinhTheoGio2) * this.dTangCa1HeSo / 60.0, this.iLamTronGio);
                                                                if (dTongThoiGianTangCaTinhTheoGio2 - Convert.ToDouble(iGioiHanTC1TinhTheoGio2) < Convert.ToDouble(iGioiHanTC2TinhTheoGio2))
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = Math.Round((dTongThoiGianTangCaTinhTheoGio2 - Convert.ToDouble(iGioiHanTC1TinhTheoGio2)) * this.dTangCa2HeSo / 60.0, this.iLamTronGio);
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                                }
                                                                else
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = Math.Round(Convert.ToDouble(iGioiHanTC1TinhTheoGio2) * this.dTangCa1HeSo / 60.0, this.iLamTronGio);
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = Math.Round(Convert.ToDouble(iGioiHanTC2TinhTheoGio2) * this.dTangCa2HeSo / 60.0, this.iLamTronGio);
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = Math.Round((dTongThoiGianTangCaTinhTheoGio2 - Convert.ToDouble(iGioiHanTC1TinhTheoGio2) - Convert.ToDouble(iGioiHanTC2TinhTheoGio2)) * this.dTangCa3HeSo / 60.0, this.iLamTronGio);
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                                }
                                                            }
                                                        }
                                                        if (iGioiHanTC1TinhTheoGio2 != 0 && iGioiHanTC2TinhTheoGio2 != 0 && iGioiHanTC3TinhTheoGio2 != 0 && iGioiHanTC4TinhTheoGio2 != 0)
                                                        {
                                                        }
                                                    }
                                                    else
                                                    {
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                    }
                                                    string sTongGio5;
                                                    sTongGio5 = Math.Round(Convert.ToDouble(Convert.ToInt32((dGioRaTinhTheoGio - dGioVaoTinhTheoGio).TotalMinutes).ToString()) / 60.0, this.iLamTronGio).ToString();
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[16].Value = sTongGio5;
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[17].Value = dtCaLamViecTinhTheoGio2.Rows[iCaLamViecTinhTheoGio2]["CongTinh"].ToString();
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[18].Value = this.sKHDungGio;
                                                    if (DateTimeProgress.XuatIDThu((int)dt.AddDays(dem).DayOfWeek) == "0")
                                                    {
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[19].Value = "CN";
                                                    }
                                                    else
                                                    {
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[19].Value = "NT";
                                                    }
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[20].Value = this.sMaChamCong;
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[21].Value = this.sPhongBanTinhCong;
                                                }
                                                break;
                                            }
                                        }
                                        if (iCaTrongLIchtrinh2 == 0)
                                        {
                                            this.DGVTinhCong.Rows[_nhanVien].Cells[4].Value = ca;
                                            this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = "0";
                                            this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = "0";
                                            this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = "0";
                                            this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = "0";
                                            this.DGVTinhCong.Rows[_nhanVien].Cells[11].Value = "0";
                                            this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = "0";
                                            this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                            this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                            this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                            this.DGVTinhCong.Rows[_nhanVien].Cells[16].Value = "0";
                                            this.DGVTinhCong.Rows[_nhanVien].Cells[17].Value = "0";
                                            this.DGVTinhCong.Rows[_nhanVien].Cells[18].Value = this.sKHVang;
                                            if (DateTimeProgress.XuatIDThu((int)dt.AddDays(dem).DayOfWeek) == "0")
                                            {
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[19].Value = "CN";
                                            }
                                            else
                                            {
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[19].Value = "NT";
                                            }
                                            this.DGVTinhCong.Rows[_nhanVien].Cells[20].Value = this.sMaChamCong;
                                            this.DGVTinhCong.Rows[_nhanVien].Cells[21].Value = this.sPhongBanTinhCong;
                                        }
                                    }
                                }
                                if (iDemLanChamCongTinhTheoGio > 2)
                                {
                                    if (iDemLanChamCongTinhTheoGio % 2 != 0)
                                    {
                                        addTinhTheoGio = this.DGVTinhCong.Rows.Add();
                                        dGioVaoTinhTheoGio = Convert.ToDateTime(dtTinhTheoGio.Rows[iTinhTheoGio]["GioCham"].ToString());
                                        this.DGVTinhCong.Rows[addTinhTheoGio].Cells[5].Value = string.Format(this.sDinhDangThoiGian, dGioVaoTinhTheoGio);
                                        this.DGVTinhCong.Rows[addTinhTheoGio].Cells[0].Value = this.sMaNhanVien;
                                        this.DGVTinhCong.Rows[addTinhTheoGio].Cells[1].Value = this.sTenNhanVien;
                                        this.DGVTinhCong.Rows[addTinhTheoGio].Cells[2].Value = this.DGVTinhCong.Rows[_nhanVien].Cells[2].Value.ToString();
                                        this.DGVTinhCong.Rows[addTinhTheoGio].Cells[3].Value = DateTimeProgress.XuatThuTinhCong((int)dt.AddDays(dem).DayOfWeek);
                                        this.DGVTinhCong.Rows[addTinhTheoGio].Cells[4].Value = ca;
                                        this.DGVTinhCong.Rows[addTinhTheoGio].Cells[7].Value = "0";
                                        this.DGVTinhCong.Rows[addTinhTheoGio].Cells[8].Value = "0";
                                        this.DGVTinhCong.Rows[addTinhTheoGio].Cells[9].Value = "0";
                                        this.DGVTinhCong.Rows[addTinhTheoGio].Cells[10].Value = "0";
                                        this.DGVTinhCong.Rows[addTinhTheoGio].Cells[11].Value = "0";
                                        this.DGVTinhCong.Rows[addTinhTheoGio].Cells[12].Value = "0";
                                        this.DGVTinhCong.Rows[addTinhTheoGio].Cells[13].Value = "0";
                                        this.DGVTinhCong.Rows[addTinhTheoGio].Cells[14].Value = "0";
                                        this.DGVTinhCong.Rows[addTinhTheoGio].Cells[15].Value = "0";
                                        this.DGVTinhCong.Rows[addTinhTheoGio].Cells[16].Value = "0";
                                        this.DGVTinhCong.Rows[addTinhTheoGio].Cells[17].Value = "0";
                                        this.DGVTinhCong.Rows[addTinhTheoGio].Cells[18].Value = this.sKHVang;
                                        if (DateTimeProgress.XuatIDThu((int)dt.AddDays(dem).DayOfWeek) == "0")
                                        {
                                            this.DGVTinhCong.Rows[addTinhTheoGio].Cells[19].Value = "CN";
                                        }
                                        else
                                        {
                                            this.DGVTinhCong.Rows[addTinhTheoGio].Cells[19].Value = "NT";
                                        }
                                        this.DGVTinhCong.Rows[addTinhTheoGio].Cells[20].Value = this.sMaChamCong;
                                        this.DGVTinhCong.Rows[addTinhTheoGio].Cells[21].Value = this.sPhongBanTinhCong;
                                    }
                                    if (iDemLanChamCongTinhTheoGio % 2 == 0)
                                    {
                                        DateTime dGioRaTinhTheoGio;
                                        dGioRaTinhTheoGio = Convert.ToDateTime(dtTinhTheoGio.Rows[iTinhTheoGio]["GioCham"].ToString());
                                        if (Convert.ToInt32(Convert.ToInt32((dGioRaTinhTheoGioLichTrinhVaoRa - dGioVaoTinhTheoGioLichTrinhVaoRa).TotalMinutes).ToString()) > iThoiGianLonNhat)
                                        {
                                            int addTinhTheoGioThoiGianLonNhat;
                                            addTinhTheoGioThoiGianLonNhat = this.DGVTinhCong.Rows.Add();
                                            this.DGVTinhCong.Rows[addTinhTheoGioThoiGianLonNhat].Cells[0].Value = this.sMaNhanVien;
                                            this.DGVTinhCong.Rows[addTinhTheoGioThoiGianLonNhat].Cells[1].Value = this.sTenNhanVien;
                                            this.DGVTinhCong.Rows[addTinhTheoGioThoiGianLonNhat].Cells[2].Value = this.DGVTinhCong.Rows[_nhanVien].Cells[2].Value.ToString();
                                            this.DGVTinhCong.Rows[addTinhTheoGioThoiGianLonNhat].Cells[3].Value = DateTimeProgress.XuatThuTinhCong((int)dt.AddDays(dem).DayOfWeek);
                                            this.DGVTinhCong.Rows[addTinhTheoGioThoiGianLonNhat].Cells[4].Value = ca;
                                            this.DGVTinhCong.Rows[addTinhTheoGioThoiGianLonNhat].Cells[6].Value = string.Format(this.sDinhDangThoiGian, dGioRaTinhTheoGio);
                                            this.DGVTinhCong.Rows[addTinhTheoGioThoiGianLonNhat].Cells[7].Value = "0";
                                            this.DGVTinhCong.Rows[addTinhTheoGioThoiGianLonNhat].Cells[8].Value = "0";
                                            this.DGVTinhCong.Rows[addTinhTheoGioThoiGianLonNhat].Cells[9].Value = "0";
                                            this.DGVTinhCong.Rows[addTinhTheoGioThoiGianLonNhat].Cells[10].Value = "0";
                                            this.DGVTinhCong.Rows[addTinhTheoGioThoiGianLonNhat].Cells[11].Value = "0";
                                            this.DGVTinhCong.Rows[addTinhTheoGioThoiGianLonNhat].Cells[12].Value = "0";
                                            this.DGVTinhCong.Rows[addTinhTheoGioThoiGianLonNhat].Cells[13].Value = "0";
                                            this.DGVTinhCong.Rows[addTinhTheoGioThoiGianLonNhat].Cells[14].Value = "0";
                                            this.DGVTinhCong.Rows[addTinhTheoGioThoiGianLonNhat].Cells[15].Value = "0";
                                            this.DGVTinhCong.Rows[addTinhTheoGioThoiGianLonNhat].Cells[16].Value = "0";
                                            this.DGVTinhCong.Rows[addTinhTheoGioThoiGianLonNhat].Cells[17].Value = "0";
                                            this.DGVTinhCong.Rows[addTinhTheoGioThoiGianLonNhat].Cells[18].Value = this.sKHVang;
                                            if (DateTimeProgress.XuatIDThu((int)dt.AddDays(dem).DayOfWeek) == "0")
                                            {
                                                this.DGVTinhCong.Rows[addTinhTheoGioThoiGianLonNhat].Cells[19].Value = "CN";
                                            }
                                            else
                                            {
                                                this.DGVTinhCong.Rows[addTinhTheoGioThoiGianLonNhat].Cells[19].Value = "NT";
                                            }
                                            this.DGVTinhCong.Rows[addTinhTheoGioThoiGianLonNhat].Cells[20].Value = this.sMaChamCong;
                                            this.DGVTinhCong.Rows[addTinhTheoGioThoiGianLonNhat].Cells[21].Value = this.sPhongBanTinhCong;
                                        }
                                        else
                                        {
                                            this.DGVTinhCong.Rows[addTinhTheoGio].Cells[6].Value = string.Format(this.sDinhDangThoiGian, dGioRaTinhTheoGio);
                                            int iCaTrongLIchtrinh;
                                            iCaTrongLIchtrinh = 0;
                                            new DataTable();
                                            this._chiTietLichTrinhChoCalamViecDTO.MaLichTrinhCaLamViec = sLTCCLVNhanVien;
                                            this._chiTietLichTrinhChoCalamViecDTO.Thu = sThu;
                                            DataTable dtNhanCaTinhTheoGio;
                                            dtNhanCaTinhTheoGio = this._chiTietLichTrinhChoCaLamViecBLL.ChiTietLichTrinhChoCaLamViecNhanCa(this._chiTietLichTrinhChoCalamViecDTO);
                                            int iChiTietLichTrinhChoCaLamViecTinhTheoGio;
                                            iChiTietLichTrinhChoCaLamViecTinhTheoGio = 0;
                                            if (iChiTietLichTrinhChoCaLamViecTinhTheoGio < dtNhanCaTinhTheoGio.Rows.Count)
                                            {
                                                iCaTrongLIchtrinh = 1;
                                                int cellChiTietLichTrinhChoCaLamViecTinhTheoGio;
                                                cellChiTietLichTrinhChoCaLamViecTinhTheoGio = 3;
                                                while (true)
                                                {
                                                    if (cellChiTietLichTrinhChoCaLamViecTinhTheoGio < 13)
                                                    {
                                                        kiemTraVao = 0;
                                                        kiemTraRa = 0;
                                                        this.sTinhTheoGioMaCaLamViec = dtNhanCaTinhTheoGio.Rows[iChiTietLichTrinhChoCaLamViecTinhTheoGio][cellChiTietLichTrinhChoCaLamViecTinhTheoGio].ToString();
                                                        new DataTable();
                                                        DataTable dtTinhTheoGioCa1;
                                                        dtTinhTheoGioCa1 = this._caLamViecBLL.CaLamViecGetByMaCaLamViec(sTinhTheoGioMaCaLamViec);
                                                        int iTinhTheoGioCa1;
                                                        iTinhTheoGioCa1 = 0;
                                                        while (iTinhTheoGioCa1 < dtTinhTheoGioCa1.Rows.Count)
                                                        {
                                                            string sGiayGioVao19;
                                                            sGiayGioVao19 = dGioVaoTinhTheoGio.Second.ToString();
                                                            string sGiayGioRa19;
                                                            sGiayGioRa19 = dGioRaTinhTheoGio.Second.ToString();
                                                            this.sTinhTheoGioTenCaLamViec = dtTinhTheoGioCa1.Rows[iTinhTheoGioCa1]["CaLamViec"].ToString();
                                                            DateTime dBatDauVaoTinhTheoGioB;
                                                            dBatDauVaoTinhTheoGioB = Convert.ToDateTime(sNgayCham + " " + string.Format("{0:T}", Convert.ToDateTime(dtTinhTheoGioCa1.Rows[iTinhTheoGioCa1]["BatDauVao"].ToString())).Replace("00 ", sGiayGioVao19 + " "));
                                                            Convert.ToDateTime(sNgayCham + " " + string.Format("{0:T}", Convert.ToDateTime(dtTinhTheoGioCa1.Rows[iTinhTheoGioCa1]["KetThucVao"].ToString())).Replace("00 ", sGiayGioVao19 + " "));
                                                            Convert.ToDateTime(sNgayCham + " " + string.Format("{0:T}", Convert.ToDateTime(dtTinhTheoGioCa1.Rows[iTinhTheoGioCa1]["BatDauRa"].ToString())).Replace("00 ", sGiayGioRa19 + " "));
                                                            DateTime dKetThucRaTinhTheoGioB;
                                                            dKetThucRaTinhTheoGioB = Convert.ToDateTime(sNgayCham + " " + string.Format("{0:T}", Convert.ToDateTime(dtTinhTheoGioCa1.Rows[iTinhTheoGioCa1]["KetThucRa"].ToString())).Replace("00 ", sGiayGioRa19 + " "));
                                                            if (dGioVaoTinhTheoGio >= dBatDauVaoTinhTheoGioB && dGioVaoTinhTheoGio <= dKetThucRaTinhTheoGioB)
                                                            {
                                                                kiemTraVao++;
                                                            }
                                                            if (dGioRaTinhTheoGio >= dBatDauVaoTinhTheoGioB && dGioRaTinhTheoGio <= dKetThucRaTinhTheoGioB)
                                                            {
                                                                kiemTraRa++;
                                                            }
                                                            if (kiemTraVao != 1 || kiemTraRa != 1)
                                                            {
                                                                iTinhTheoGioCa1++;
                                                                continue;
                                                            }
                                                            goto IL_34528;
                                                        }
                                                        if (!(this.sTinhTheoGioMaCaLamViec == ""))
                                                        {
                                                            cellChiTietLichTrinhChoCaLamViecTinhTheoGio++;
                                                            continue;
                                                        }
                                                        this.DGVTinhCong.Rows[addTinhTheoGio].Cells[4].Value = ca;
                                                        this.DGVTinhCong.Rows[addTinhTheoGio].Cells[7].Value = "0";
                                                        this.DGVTinhCong.Rows[addTinhTheoGio].Cells[8].Value = "0";
                                                        this.DGVTinhCong.Rows[addTinhTheoGio].Cells[9].Value = "0";
                                                        this.DGVTinhCong.Rows[addTinhTheoGio].Cells[10].Value = "0";
                                                        this.DGVTinhCong.Rows[addTinhTheoGio].Cells[11].Value = "0";
                                                        this.DGVTinhCong.Rows[addTinhTheoGio].Cells[12].Value = "0";
                                                        this.DGVTinhCong.Rows[addTinhTheoGio].Cells[13].Value = "0";
                                                        this.DGVTinhCong.Rows[addTinhTheoGio].Cells[14].Value = "0";
                                                        this.DGVTinhCong.Rows[addTinhTheoGio].Cells[15].Value = "0";
                                                        this.DGVTinhCong.Rows[addTinhTheoGio].Cells[16].Value = "0";
                                                        this.DGVTinhCong.Rows[addTinhTheoGio].Cells[17].Value = "0";
                                                        this.DGVTinhCong.Rows[addTinhTheoGio].Cells[18].Value = this.sKHVang;
                                                        if (DateTimeProgress.XuatIDThu((int)dt.AddDays(dem).DayOfWeek) == "0")
                                                        {
                                                            this.DGVTinhCong.Rows[addTinhTheoGio].Cells[19].Value = "CN";
                                                        }
                                                        else
                                                        {
                                                            this.DGVTinhCong.Rows[addTinhTheoGio].Cells[19].Value = "NT";
                                                        }
                                                        this.DGVTinhCong.Rows[addTinhTheoGio].Cells[20].Value = this.sMaChamCong;
                                                        this.DGVTinhCong.Rows[addTinhTheoGio].Cells[21].Value = this.sPhongBanTinhCong;
                                                        break;
                                                    }
                                                    goto IL_34528;
                                                IL_34528:
                                                    this.DGVTinhCong.Rows[addTinhTheoGio].Cells[4].Value = this.sTinhTheoGioTenCaLamViec;
                                                    new DataTable();
                                                    DataTable dtCaLamViecTinhTheoGio;
                                                    dtCaLamViecTinhTheoGio = this._caLamViecBLL.CaLamViecGetByMaCaLamViec(sTinhTheoGioMaCaLamViec);
                                                    for (int iCaLamViecTinhTheoGio = 0; iCaLamViecTinhTheoGio < dtCaLamViecTinhTheoGio.Rows.Count; iCaLamViecTinhTheoGio++)
                                                    {
                                                        string sGiayGioVao18;
                                                        sGiayGioVao18 = dGioVaoTinhTheoGio.Second.ToString();
                                                        string sGiayGioRa18;
                                                        sGiayGioRa18 = dGioRaTinhTheoGio.Second.ToString();
                                                        DateTime dGioVaoKhaiBaoTinhTheoGioB;
                                                        dGioVaoKhaiBaoTinhTheoGioB = Convert.ToDateTime(sNgayCham + " " + string.Format("{0:T}", Convert.ToDateTime(dtCaLamViecTinhTheoGio.Rows[iCaLamViecTinhTheoGio]["GioVaoLamViec"].ToString())).Replace("00 ", sGiayGioVao18 + " "));
                                                        DateTime dGioRaKhaiBaoTinhTheoGioB;
                                                        dGioRaKhaiBaoTinhTheoGioB = Convert.ToDateTime(sNgayCham + " " + string.Format("{0:T}", Convert.ToDateTime(dtCaLamViecTinhTheoGio.Rows[iCaLamViecTinhTheoGio]["GioKetThucLamViec"].ToString())).Replace("00 ", sGiayGioRa18 + " "));
                                                        string sTruGioDiTre13;
                                                        sTruGioDiTre13 = dtCaLamViecTinhTheoGio.Rows[iCaLamViecTinhTheoGio]["TruGioDiTre"].ToString();
                                                        string sBatDauTinhDiTre13;
                                                        sBatDauTinhDiTre13 = dtCaLamViecTinhTheoGio.Rows[iCaLamViecTinhTheoGio]["BatDauTinhDiTre"].ToString();
                                                        int iChoPhepDiTre10;
                                                        iChoPhepDiTre10 = Convert.ToInt32(dtCaLamViecTinhTheoGio.Rows[iCaLamViecTinhTheoGio]["ChoPhepDiTre"].ToString());
                                                        string sPhutTre10;
                                                        sPhutTre10 = Convert.ToInt32((dGioVaoTinhTheoGio - dGioVaoKhaiBaoTinhTheoGioB).TotalMinutes).ToString();
                                                        if (sTruGioDiTre13 == "True")
                                                        {
                                                            if (Convert.ToInt32(sPhutTre10) < 0)
                                                            {
                                                                this.DGVTinhCong.Rows[addTinhTheoGio].Cells[9].Value = "0";
                                                            }
                                                            else
                                                            {
                                                                int iPhutTre10;
                                                                iPhutTre10 = Convert.ToInt32(sPhutTre10) - iChoPhepDiTre10;
                                                                if (sBatDauTinhDiTre13 == "True")
                                                                {
                                                                    if (iPhutTre10 < 1)
                                                                    {
                                                                        this.DGVTinhCong.Rows[addTinhTheoGio].Cells[9].Value = "0";
                                                                    }
                                                                    else
                                                                    {
                                                                        this.DGVTinhCong.Rows[addTinhTheoGio].Cells[9].Value = iPhutTre10.ToString();
                                                                    }
                                                                }
                                                                else if (iPhutTre10 < 1)
                                                                {
                                                                    this.DGVTinhCong.Rows[addTinhTheoGio].Cells[9].Value = "0";
                                                                }
                                                                else
                                                                {
                                                                    this.DGVTinhCong.Rows[addTinhTheoGio].Cells[9].Value = sPhutTre10;
                                                                }
                                                            }
                                                        }
                                                        else
                                                        {
                                                            this.DGVTinhCong.Rows[addTinhTheoGio].Cells[9].Value = "0";
                                                        }
                                                        string sTruGioVeSom13;
                                                        sTruGioVeSom13 = dtCaLamViecTinhTheoGio.Rows[iCaLamViecTinhTheoGio]["TruGioVeSom"].ToString();
                                                        string sBatDauTinhVeSom13;
                                                        sBatDauTinhVeSom13 = dtCaLamViecTinhTheoGio.Rows[iCaLamViecTinhTheoGio]["BatDauTinhVeSom"].ToString();
                                                        int iChoPhepVeSom10;
                                                        iChoPhepVeSom10 = Convert.ToInt32(dtCaLamViecTinhTheoGio.Rows[iCaLamViecTinhTheoGio]["ChoPhepVeSom"].ToString());
                                                        string sPhutVeSom10;
                                                        sPhutVeSom10 = Convert.ToInt32((dGioRaKhaiBaoTinhTheoGioB - dGioRaTinhTheoGio).TotalMinutes).ToString();
                                                        if (sTruGioVeSom13 == "True")
                                                        {
                                                            if (Convert.ToInt32(sPhutVeSom10) < 0)
                                                            {
                                                                this.DGVTinhCong.Rows[addTinhTheoGio].Cells[10].Value = "0";
                                                            }
                                                            else
                                                            {
                                                                int iPhutVeSom10;
                                                                iPhutVeSom10 = Convert.ToInt32(sPhutVeSom10) - iChoPhepVeSom10;
                                                                if (iPhutVeSom10 < 1)
                                                                {
                                                                    this.DGVTinhCong.Rows[addTinhTheoGio].Cells[10].Value = "0";
                                                                }
                                                                else if (sBatDauTinhVeSom13 == "True")
                                                                {
                                                                    this.DGVTinhCong.Rows[addTinhTheoGio].Cells[10].Value = iPhutVeSom10.ToString();
                                                                }
                                                                else
                                                                {
                                                                    this.DGVTinhCong.Rows[addTinhTheoGio].Cells[10].Value = sPhutVeSom10;
                                                                }
                                                            }
                                                        }
                                                        else
                                                        {
                                                            this.DGVTinhCong.Rows[addTinhTheoGio].Cells[10].Value = "0";
                                                        }
                                                        string sVeTre9;
                                                        sVeTre9 = Convert.ToInt32((dGioRaTinhTheoGio - dGioRaKhaiBaoTinhTheoGioB).TotalMinutes).ToString();
                                                        if (Convert.ToInt32(sVeTre9) > 0)
                                                        {
                                                            this.DGVTinhCong.Rows[addTinhTheoGio].Cells[11].Value = sVeTre9;
                                                        }
                                                        else
                                                        {
                                                            this.DGVTinhCong.Rows[addTinhTheoGio].Cells[11].Value = "0";
                                                        }
                                                        double dGio9;
                                                        dGio9 = Math.Round(Convert.ToDouble(Convert.ToSingle(dtCaLamViecTinhTheoGio.Rows[iCaLamViecTinhTheoGio]["TongGioTrongCaLamViec"]) * 60f - (float)(Convert.ToInt32(this.DGVTinhCong.Rows[addTinhTheoGio].Cells[9].Value.ToString()) + Convert.ToInt32(this.DGVTinhCong.Rows[addTinhTheoGio].Cells[10].Value))) / 60.0, this.iLamTronGio);
                                                        this.DGVTinhCong.Rows[addTinhTheoGio].Cells[8].Value = dGio9.ToString();
                                                        double iGio8;
                                                        iGio8 = Convert.ToDouble(dtCaLamViecTinhTheoGio.Rows[iCaLamViecTinhTheoGio]["TongGioTrongCaLamViec"].ToString());
                                                        double dCongTinh8;
                                                        dCongTinh8 = Convert.ToDouble(dtCaLamViecTinhTheoGio.Rows[iCaLamViecTinhTheoGio]["CongTinh"].ToString());
                                                        double dCong8;
                                                        dCong8 = Math.Round(dGio9 * dCongTinh8 / iGio8, this.iLamTronCong);
                                                        this.DGVTinhCong.Rows[addTinhTheoGio].Cells[7].Value = dCong8.ToString();
                                                        string sTangCaTruocGioLamViec4;
                                                        sTangCaTruocGioLamViec4 = dtCaLamViecTinhTheoGio.Rows[iCaLamViecTinhTheoGio]["TangCaTruocGioLamViec"].ToString();
                                                        string sTangCaSauGioLamViec4;
                                                        sTangCaSauGioLamViec4 = dtCaLamViecTinhTheoGio.Rows[iCaLamViecTinhTheoGio]["TangCaSauGioLamViec"].ToString();
                                                        if (sTangCaTruocGioLamViec4 == "False" && sTangCaSauGioLamViec4 == "False")
                                                        {
                                                            this.DGVTinhCong.Rows[addTinhTheoGio].Cells[12].Value = "0";
                                                            this.DGVTinhCong.Rows[addTinhTheoGio].Cells[13].Value = "0";
                                                            this.DGVTinhCong.Rows[addTinhTheoGio].Cells[14].Value = "0";
                                                            this.DGVTinhCong.Rows[addTinhTheoGio].Cells[15].Value = "0";
                                                        }
                                                        string sXemCaNayLaTangCa5;
                                                        sXemCaNayLaTangCa5 = dtCaLamViecTinhTheoGio.Rows[iCaLamViecTinhTheoGio]["XemCaNayLaTangCa"].ToString();
                                                        int iTangCaMuc5;
                                                        iTangCaMuc5 = Convert.ToInt32(dtCaLamViecTinhTheoGio.Rows[iCaLamViecTinhTheoGio]["TangCaMuc"].ToString());
                                                        if (sXemCaNayLaTangCa5 == "True")
                                                        {
                                                            if (iTangCaMuc5 == 1)
                                                            {
                                                                this.DGVTinhCong.Rows[addTinhTheoGio].Cells[7].Value = "0";
                                                                this.DGVTinhCong.Rows[addTinhTheoGio].Cells[8].Value = "0";
                                                                this.DGVTinhCong.Rows[addTinhTheoGio].Cells[12].Value = dGio9.ToString();
                                                                this.DGVTinhCong.Rows[addTinhTheoGio].Cells[13].Value = "0";
                                                                this.DGVTinhCong.Rows[addTinhTheoGio].Cells[14].Value = "0";
                                                                this.DGVTinhCong.Rows[addTinhTheoGio].Cells[15].Value = "0";
                                                            }
                                                            if (iTangCaMuc5 == 2)
                                                            {
                                                                this.DGVTinhCong.Rows[addTinhTheoGio].Cells[7].Value = "0";
                                                                this.DGVTinhCong.Rows[addTinhTheoGio].Cells[8].Value = "0";
                                                                this.DGVTinhCong.Rows[addTinhTheoGio].Cells[12].Value = "0";
                                                                this.DGVTinhCong.Rows[addTinhTheoGio].Cells[13].Value = dGio9.ToString();
                                                                this.DGVTinhCong.Rows[addTinhTheoGio].Cells[14].Value = "0";
                                                                this.DGVTinhCong.Rows[addTinhTheoGio].Cells[15].Value = "0";
                                                            }
                                                            if (iTangCaMuc5 == 3)
                                                            {
                                                                this.DGVTinhCong.Rows[addTinhTheoGio].Cells[7].Value = "0";
                                                                this.DGVTinhCong.Rows[addTinhTheoGio].Cells[8].Value = "0";
                                                                this.DGVTinhCong.Rows[addTinhTheoGio].Cells[12].Value = "0";
                                                                this.DGVTinhCong.Rows[addTinhTheoGio].Cells[13].Value = "0";
                                                                this.DGVTinhCong.Rows[addTinhTheoGio].Cells[14].Value = dGio9.ToString();
                                                                this.DGVTinhCong.Rows[addTinhTheoGio].Cells[15].Value = "0";
                                                            }
                                                            if (iTangCaMuc5 == 4)
                                                            {
                                                                this.DGVTinhCong.Rows[addTinhTheoGio].Cells[7].Value = "0";
                                                                this.DGVTinhCong.Rows[addTinhTheoGio].Cells[8].Value = "0";
                                                                this.DGVTinhCong.Rows[addTinhTheoGio].Cells[12].Value = "0";
                                                                this.DGVTinhCong.Rows[addTinhTheoGio].Cells[13].Value = "0";
                                                                this.DGVTinhCong.Rows[addTinhTheoGio].Cells[14].Value = "0";
                                                                this.DGVTinhCong.Rows[addTinhTheoGio].Cells[15].Value = dGio9.ToString();
                                                            }
                                                        }
                                                        string sChoPhepTangCaTruocGioLamViecTinhTheoGio;
                                                        sChoPhepTangCaTruocGioLamViecTinhTheoGio = dtCaLamViecTinhTheoGio.Rows[iCaLamViecTinhTheoGio]["TangCaTruocGioLamViec"].ToString();
                                                        int iPhutTangCaTruocGioLamViecTinhTheoGio;
                                                        iPhutTangCaTruocGioLamViecTinhTheoGio = Convert.ToInt32(dtCaLamViecTinhTheoGio.Rows[iCaLamViecTinhTheoGio]["SoPhutTangCaTruocGioLamViec"].ToString());
                                                        int iPhutTangCaTruocGioLamViecDatDen11;
                                                        iPhutTangCaTruocGioLamViecDatDen11 = Convert.ToInt32(dtCaLamViecTinhTheoGio.Rows[iCaLamViecTinhTheoGio]["TangCaTruocGioLamViecDatDen"].ToString());
                                                        int iPhutTruTangCaTruoc11;
                                                        iPhutTruTangCaTruoc11 = Convert.ToInt32(dtCaLamViecTinhTheoGio.Rows[iCaLamViecTinhTheoGio]["PhutTruTangCaTruoc"].ToString());
                                                        string sChoPhepTangCaSauGioLamViecTinhTheoGio;
                                                        sChoPhepTangCaSauGioLamViecTinhTheoGio = dtCaLamViecTinhTheoGio.Rows[iCaLamViecTinhTheoGio]["TangCaSauGioLamViec"].ToString();
                                                        int iPhutTangCaSauGioLamViecTinhTheoGio;
                                                        iPhutTangCaSauGioLamViecTinhTheoGio = Convert.ToInt32(dtCaLamViecTinhTheoGio.Rows[iCaLamViecTinhTheoGio]["SoPhutTangCaSauGioLamViec"].ToString());
                                                        int iPhutTangCaSauGioLamViecDatDen11;
                                                        iPhutTangCaSauGioLamViecDatDen11 = Convert.ToInt32(dtCaLamViecTinhTheoGio.Rows[iCaLamViecTinhTheoGio]["TangCaSauGioLamViecDatDen"].ToString());
                                                        int iPhutTruTangCaSau11;
                                                        iPhutTruTangCaSau11 = Convert.ToInt32(dtCaLamViecTinhTheoGio.Rows[iCaLamViecTinhTheoGio]["PhutTruTangCaSau"].ToString());
                                                        int iGioiHanTC1TinhTheoGio;
                                                        iGioiHanTC1TinhTheoGio = Convert.ToInt32(dtCaLamViecTinhTheoGio.Rows[iCaLamViecTinhTheoGio]["GioiHanTangCa1"].ToString());
                                                        int iGioiHanTC2TinhTheoGio;
                                                        iGioiHanTC2TinhTheoGio = Convert.ToInt32(dtCaLamViecTinhTheoGio.Rows[iCaLamViecTinhTheoGio]["GioiHanTangCa2"].ToString());
                                                        int iGioiHanTC3TinhTheoGio;
                                                        iGioiHanTC3TinhTheoGio = Convert.ToInt32(dtCaLamViecTinhTheoGio.Rows[iCaLamViecTinhTheoGio]["GioiHanTangCa3"].ToString());
                                                        int iGioiHanTC4TinhTheoGio;
                                                        iGioiHanTC4TinhTheoGio = Convert.ToInt32(dtCaLamViecTinhTheoGio.Rows[iCaLamViecTinhTheoGio]["GioiHanTangCa4"].ToString());
                                                        int iTongGioTangCaSauTinhTheoGio;
                                                        iTongGioTangCaSauTinhTheoGio = 0;
                                                        int iTongGioTangCaTruocTinhTheoGio;
                                                        iTongGioTangCaTruocTinhTheoGio = 0;
                                                        if (sChoPhepTangCaTruocGioLamViecTinhTheoGio == "False" && sChoPhepTangCaSauGioLamViecTinhTheoGio == "False")
                                                        {
                                                            this.DGVTinhCong.Rows[addTinhTheoGio].Cells[12].Value = "0";
                                                            this.DGVTinhCong.Rows[addTinhTheoGio].Cells[13].Value = "0";
                                                            this.DGVTinhCong.Rows[addTinhTheoGio].Cells[14].Value = "0";
                                                            this.DGVTinhCong.Rows[addTinhTheoGio].Cells[15].Value = "0";
                                                        }
                                                        else
                                                        {
                                                            if (sChoPhepTangCaTruocGioLamViecTinhTheoGio == "True")
                                                            {
                                                                int iThoiGianTruocGioLamTinhTheoGio;
                                                                iThoiGianTruocGioLamTinhTheoGio = Convert.ToInt32(Convert.ToInt32((dGioVaoKhaiBaoTinhTheoGioB - dGioVaoTinhTheoGio).TotalMinutes).ToString());
                                                                if (iThoiGianTruocGioLamTinhTheoGio > 0 && iThoiGianTruocGioLamTinhTheoGio > iPhutTangCaTruocGioLamViecTinhTheoGio && iThoiGianTruocGioLamTinhTheoGio > iPhutTangCaTruocGioLamViecDatDen11)
                                                                {
                                                                    iTongGioTangCaTruocTinhTheoGio = iThoiGianTruocGioLamTinhTheoGio - iPhutTruTangCaTruoc11;
                                                                }
                                                            }
                                                            if (sChoPhepTangCaSauGioLamViecTinhTheoGio == "True")
                                                            {
                                                                int iThoiGianSauGioLamViecTinhTheoGio;
                                                                iThoiGianSauGioLamViecTinhTheoGio = Convert.ToInt32(Convert.ToInt32((dGioRaTinhTheoGio - dGioRaKhaiBaoTinhTheoGioB).TotalMinutes).ToString());
                                                                if (iThoiGianSauGioLamViecTinhTheoGio > 0 && iThoiGianSauGioLamViecTinhTheoGio > iPhutTangCaSauGioLamViecTinhTheoGio && iThoiGianSauGioLamViecTinhTheoGio > iPhutTangCaSauGioLamViecDatDen11)
                                                                {
                                                                    iTongGioTangCaSauTinhTheoGio = iThoiGianSauGioLamViecTinhTheoGio - iPhutTruTangCaSau11;
                                                                }
                                                            }
                                                        }
                                                        double dTongThoiGianTangCaTinhTheoGio;
                                                        dTongThoiGianTangCaTinhTheoGio = Convert.ToDouble(iTongGioTangCaTruocTinhTheoGio + iTongGioTangCaSauTinhTheoGio);
                                                        if (dTongThoiGianTangCaTinhTheoGio > 0.0)
                                                        {
                                                            if (iGioiHanTC1TinhTheoGio == 0)
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = Math.Round(dTongThoiGianTangCaTinhTheoGio * this.dTangCa1HeSo / 60.0, this.iLamTronGio);
                                                                this.DGVTinhCong.Rows[addTinhTheoGio].Cells[13].Value = "0";
                                                                this.DGVTinhCong.Rows[addTinhTheoGio].Cells[14].Value = "0";
                                                                this.DGVTinhCong.Rows[addTinhTheoGio].Cells[15].Value = "0";
                                                            }
                                                            if (iGioiHanTC1TinhTheoGio != 0 && iGioiHanTC2TinhTheoGio == 0)
                                                            {
                                                                if (dTongThoiGianTangCaTinhTheoGio < Convert.ToDouble(iGioiHanTC1TinhTheoGio))
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = Math.Round(dTongThoiGianTangCaTinhTheoGio * this.dTangCa1HeSo / 60.0, this.iLamTronGio);
                                                                    this.DGVTinhCong.Rows[addTinhTheoGio].Cells[13].Value = "0";
                                                                    this.DGVTinhCong.Rows[addTinhTheoGio].Cells[14].Value = "0";
                                                                    this.DGVTinhCong.Rows[addTinhTheoGio].Cells[15].Value = "0";
                                                                }
                                                                else
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = Math.Round(Convert.ToDouble(iGioiHanTC1TinhTheoGio) / 60.0 * this.dTangCa1HeSo, this.iLamTronGio);
                                                                    if (dTongThoiGianTangCaTinhTheoGio - Convert.ToDouble(iGioiHanTC1TinhTheoGio) > 0.0)
                                                                    {
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = Math.Round((dTongThoiGianTangCaTinhTheoGio - Convert.ToDouble(iGioiHanTC1TinhTheoGio)) * this.dTangCa2HeSo / 60.0, this.iLamTronGio);
                                                                    }
                                                                    this.DGVTinhCong.Rows[addTinhTheoGio].Cells[14].Value = "0";
                                                                    this.DGVTinhCong.Rows[addTinhTheoGio].Cells[15].Value = "0";
                                                                }
                                                            }
                                                            if (iGioiHanTC1TinhTheoGio != 0 && iGioiHanTC2TinhTheoGio != 0 && iGioiHanTC3TinhTheoGio == 0)
                                                            {
                                                                if (dTongThoiGianTangCaTinhTheoGio < Convert.ToDouble(iGioiHanTC1TinhTheoGio))
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = Math.Round(dTongThoiGianTangCaTinhTheoGio * this.dTangCa1HeSo / 60.0, this.iLamTronGio);
                                                                    this.DGVTinhCong.Rows[addTinhTheoGio].Cells[13].Value = "0";
                                                                    this.DGVTinhCong.Rows[addTinhTheoGio].Cells[14].Value = "0";
                                                                    this.DGVTinhCong.Rows[addTinhTheoGio].Cells[15].Value = "0";
                                                                }
                                                                else
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = Math.Round(Convert.ToDouble(iGioiHanTC1TinhTheoGio) * this.dTangCa1HeSo / 60.0, this.iLamTronGio);
                                                                    if (dTongThoiGianTangCaTinhTheoGio - Convert.ToDouble(iGioiHanTC1TinhTheoGio) < Convert.ToDouble(iGioiHanTC2TinhTheoGio))
                                                                    {
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = Math.Round((dTongThoiGianTangCaTinhTheoGio - Convert.ToDouble(iGioiHanTC1TinhTheoGio)) * this.dTangCa2HeSo / 60.0, this.iLamTronGio);
                                                                        this.DGVTinhCong.Rows[addTinhTheoGio].Cells[14].Value = "0";
                                                                        this.DGVTinhCong.Rows[addTinhTheoGio].Cells[15].Value = "0";
                                                                    }
                                                                    else
                                                                    {
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = Math.Round(Convert.ToDouble(iGioiHanTC1TinhTheoGio) * this.dTangCa1HeSo / 60.0, this.iLamTronGio);
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = Math.Round(Convert.ToDouble(iGioiHanTC2TinhTheoGio) * this.dTangCa2HeSo / 60.0, this.iLamTronGio);
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = Math.Round((dTongThoiGianTangCaTinhTheoGio - Convert.ToDouble(iGioiHanTC1TinhTheoGio) - Convert.ToDouble(iGioiHanTC2TinhTheoGio)) * this.dTangCa3HeSo / 60.0, this.iLamTronGio);
                                                                        this.DGVTinhCong.Rows[addTinhTheoGio].Cells[15].Value = "0";
                                                                    }
                                                                }
                                                            }
                                                            if (iGioiHanTC1TinhTheoGio != 0 && iGioiHanTC2TinhTheoGio != 0 && iGioiHanTC3TinhTheoGio != 0 && iGioiHanTC4TinhTheoGio != 0)
                                                            {
                                                            }
                                                        }
                                                        else
                                                        {
                                                            this.DGVTinhCong.Rows[addTinhTheoGio].Cells[12].Value = "0";
                                                            this.DGVTinhCong.Rows[addTinhTheoGio].Cells[13].Value = "0";
                                                            this.DGVTinhCong.Rows[addTinhTheoGio].Cells[14].Value = "0";
                                                            this.DGVTinhCong.Rows[addTinhTheoGio].Cells[15].Value = "0";
                                                        }
                                                        string sTongGio4;
                                                        sTongGio4 = Math.Round(Convert.ToDouble(Convert.ToInt32((dGioRaTinhTheoGio - dGioVaoTinhTheoGio).TotalMinutes).ToString()) / 60.0, this.iLamTronGio).ToString();
                                                        this.DGVTinhCong.Rows[addTinhTheoGio].Cells[16].Value = sTongGio4;
                                                        this.DGVTinhCong.Rows[addTinhTheoGio].Cells[17].Value = dtCaLamViecTinhTheoGio.Rows[iCaLamViecTinhTheoGio]["CongTinh"].ToString();
                                                        this.DGVTinhCong.Rows[addTinhTheoGio].Cells[18].Value = this.sKHDungGio;
                                                        if (DateTimeProgress.XuatIDThu((int)dt.AddDays(dem).DayOfWeek) == "0")
                                                        {
                                                            this.DGVTinhCong.Rows[addTinhTheoGio].Cells[19].Value = "CN";
                                                        }
                                                        else
                                                        {
                                                            this.DGVTinhCong.Rows[addTinhTheoGio].Cells[19].Value = "NT";
                                                        }
                                                        this.DGVTinhCong.Rows[addTinhTheoGio].Cells[20].Value = this.sMaChamCong;
                                                        this.DGVTinhCong.Rows[addTinhTheoGio].Cells[21].Value = this.sPhongBanTinhCong;
                                                    }
                                                    break;
                                                }
                                            }
                                            if (iCaTrongLIchtrinh == 0)
                                            {
                                                this.DGVTinhCong.Rows[addTinhTheoGio].Cells[4].Value = ca;
                                                this.DGVTinhCong.Rows[addTinhTheoGio].Cells[7].Value = "0";
                                                this.DGVTinhCong.Rows[addTinhTheoGio].Cells[8].Value = "0";
                                                this.DGVTinhCong.Rows[addTinhTheoGio].Cells[9].Value = "0";
                                                this.DGVTinhCong.Rows[addTinhTheoGio].Cells[10].Value = "0";
                                                this.DGVTinhCong.Rows[addTinhTheoGio].Cells[11].Value = "0";
                                                this.DGVTinhCong.Rows[addTinhTheoGio].Cells[12].Value = "0";
                                                this.DGVTinhCong.Rows[addTinhTheoGio].Cells[13].Value = "0";
                                                this.DGVTinhCong.Rows[addTinhTheoGio].Cells[14].Value = "0";
                                                this.DGVTinhCong.Rows[addTinhTheoGio].Cells[15].Value = "0";
                                                this.DGVTinhCong.Rows[addTinhTheoGio].Cells[16].Value = "0";
                                                this.DGVTinhCong.Rows[addTinhTheoGio].Cells[17].Value = "0";
                                                this.DGVTinhCong.Rows[addTinhTheoGio].Cells[18].Value = this.sKHVang;
                                                if (DateTimeProgress.XuatIDThu((int)dt.AddDays(dem).DayOfWeek) == "0")
                                                {
                                                    this.DGVTinhCong.Rows[addTinhTheoGio].Cells[19].Value = "CN";
                                                }
                                                else
                                                {
                                                    this.DGVTinhCong.Rows[addTinhTheoGio].Cells[19].Value = "NT";
                                                }
                                                this.DGVTinhCong.Rows[addTinhTheoGio].Cells[20].Value = this.sMaChamCong;
                                                this.DGVTinhCong.Rows[addTinhTheoGio].Cells[21].Value = this.sPhongBanTinhCong;
                                            }
                                        }
                                    }
                                }
                                demTinhTheoGio++;
                            }
                            if (demTinhTheoGio == 0)
                            {
                                this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = "0";
                                this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = "0";
                                this.DGVTinhCong.Rows[_nhanVien].Cells[17].Value = "0";
                                this.DGVTinhCong.Rows[_nhanVien].Cells[18].Value = this.sKHVang;
                                this.DGVTinhCong.Rows[_nhanVien].Cells[20].Value = this.sMaChamCong;
                                this.DGVTinhCong.Rows[_nhanVien].Cells[21].Value = this.sPhongBanTinhCong;
                            }
                        }
                        if (iChonLichTrinh == 7)
                        {
                            int iKiemTraLanChamLichTrinhVaoRa2;
                            iKiemTraLanChamLichTrinhVaoRa2 = 0;
                            int iKiemTraLanChamKhoangCachTuDongQuaDemLichTrinhVaoRa2;
                            iKiemTraLanChamKhoangCachTuDongQuaDemLichTrinhVaoRa2 = 0;
                            int demTuDongQuaDem;
                            demTuDongQuaDem = 0;
                            int addTuDongQuaDem;
                            addTuDongQuaDem = 0;
                            int addTuDongQuaDemB;
                            addTuDongQuaDemB = 0;
                            DateTime dGioVaoTuDongQuaDem;
                            dGioVaoTuDongQuaDem = default(DateTime);
                            DateTime dGioRaTuDongQuaDem;
                            dGioRaTuDongQuaDem = default(DateTime);
                            DateTime dGioVaoTuDongQuaDemKiemTraLichTrinhVaoRa2;
                            dGioVaoTuDongQuaDemKiemTraLichTrinhVaoRa2 = default(DateTime);
                            DateTime dGioRaTuDongQuaDemKiemTraLichTrinhVaoRa2;
                            dGioRaTuDongQuaDemKiemTraLichTrinhVaoRa2 = default(DateTime);
                            new DataTable();
                            DataTable dtTuDongQuaDem;
                            dtTuDongQuaDem = this._checkInOutBLL.getCheckInOutByMaChamCongAndNgayCham(Convert.ToInt32(this.sMaChamCong), Convert.ToDateTime(this.DGVTinhCong.Rows[_nhanVien].Cells[2].Value.ToString()));
                            for (int iTuDongQuaDem = 0; iTuDongQuaDem < dtTuDongQuaDem.Rows.Count; iTuDongQuaDem++)
                            {
                                iKiemTraLanChamLichTrinhVaoRa2++;
                                if (iKiemTraLanChamLichTrinhVaoRa2 == 1)
                                {
                                    if (bCheckGioRaCaTruoc)
                                    {
                                        DateTime dCheckNgay;
                                        dCheckNgay = Convert.ToDateTime(this.dateTimeTuNgay.Text);
                                        DateTime dFromGio;
                                        dFromGio = new DateTime(dCheckNgay.Year, dCheckNgay.Month, dCheckNgay.Day, dTuGioLoc.Hour, dTuGioLoc.Minute, 0);
                                        DateTime dToGio;
                                        dToGio = new DateTime(dCheckNgay.Year, dCheckNgay.Month, dCheckNgay.Day, dDenGioLoc.Hour, dDenGioLoc.Minute, 0);
                                        dGioVaoTuDongQuaDemKiemTraLichTrinhVaoRa2 = Convert.ToDateTime(dtTuDongQuaDem.Rows[iTuDongQuaDem]["GioCham"].ToString());
                                        if (dGioVaoTuDongQuaDemKiemTraLichTrinhVaoRa2 >= dFromGio && dGioVaoTuDongQuaDemKiemTraLichTrinhVaoRa2 <= dToGio && iCheckCaDemThangTruoc == 0)
                                        {
                                            iCheckCaDemThangTruoc++;
                                            continue;
                                        }
                                    }
                                    else
                                    {
                                        dGioVaoTuDongQuaDemKiemTraLichTrinhVaoRa2 = Convert.ToDateTime(dtTuDongQuaDem.Rows[iTuDongQuaDem]["GioCham"].ToString());
                                    }
                                    if (dtTuDongQuaDem.Rows.Count > 2 && iKiemTraLanChamKhoangCachTuDongQuaDemLichTrinhVaoRa2 == 3)
                                    {
                                        if (Convert.ToInt32(Convert.ToInt32((dGioVaoTuDongQuaDemKiemTraLichTrinhVaoRa2 - dGioRaTuDongQuaDemKiemTraLichTrinhVaoRa2).TotalMinutes).ToString()) < iKhoangCachGiuaHaiCapVaoRa)
                                        {
                                            iKiemTraLanChamLichTrinhVaoRa2 = 0;
                                            continue;
                                        }
                                        iKiemTraLanChamLichTrinhVaoRa2 = 1;
                                    }
                                }
                                if (iKiemTraLanChamLichTrinhVaoRa2 == 2)
                                {
                                    dGioRaTuDongQuaDemKiemTraLichTrinhVaoRa2 = Convert.ToDateTime(dtTuDongQuaDem.Rows[iTuDongQuaDem]["GioCham"].ToString());
                                    if (Convert.ToInt32(Convert.ToInt32((dGioRaTuDongQuaDemKiemTraLichTrinhVaoRa2 - dGioVaoTuDongQuaDemKiemTraLichTrinhVaoRa2).TotalMinutes).ToString()) < iThoiGianNhoNhat)
                                    {
                                        iKiemTraLanChamLichTrinhVaoRa2 = 1;
                                        continue;
                                    }
                                    iKiemTraLanChamLichTrinhVaoRa2 = 0;
                                    iKiemTraLanChamKhoangCachTuDongQuaDemLichTrinhVaoRa2 = 3;
                                }
                                demTuDongQuaDem++;
                                if (this._checkInOutDTO.NgayCham == this.dateTimeTuNgay.Value)
                                {
                                    if (demTuDongQuaDem == 1)
                                    {
                                        dGioVaoTuDongQuaDem = Convert.ToDateTime(dtTuDongQuaDem.Rows[iTuDongQuaDem]["GioCham"].ToString());
                                        this.DGVTinhCong.Rows[_nhanVien].Cells[5].Value = string.Format(this.sDinhDangThoiGian, dGioVaoTuDongQuaDem);
                                        new DataTable();
                                        this._chiTietLichTrinhChoCalamViecDTO.MaLichTrinhCaLamViec = sLTCCLVNhanVien;
                                        this._chiTietLichTrinhChoCalamViecDTO.Thu = sThu;
                                        DataTable dtNhanCaTuDongQuaDem3;
                                        dtNhanCaTuDongQuaDem3 = this._chiTietLichTrinhChoCaLamViecBLL.ChiTietLichTrinhChoCaLamViecNhanCa(this._chiTietLichTrinhChoCalamViecDTO);
                                        int iChiTietLichTrinhChoCaLamViecTuDongQuaDem3;
                                        iChiTietLichTrinhChoCaLamViecTuDongQuaDem3 = 0;
                                        if (iChiTietLichTrinhChoCaLamViecTuDongQuaDem3 < dtNhanCaTuDongQuaDem3.Rows.Count)
                                        {
                                            int cellChiTietLichTrinhChoCaLamViecTuDongQuaDem3;
                                            cellChiTietLichTrinhChoCaLamViecTuDongQuaDem3 = 3;
                                            while (true)
                                            {
                                                if (cellChiTietLichTrinhChoCaLamViecTuDongQuaDem3 < 13)
                                                {
                                                    kiemTraVao = 0;
                                                    kiemTraRa = 0;
                                                    this.sTuDongQuaDemMaCaLamViec = dtNhanCaTuDongQuaDem3.Rows[iChiTietLichTrinhChoCaLamViecTuDongQuaDem3][cellChiTietLichTrinhChoCaLamViecTuDongQuaDem3].ToString();
                                                    new DataTable();
                                                    DataTable dtTuDongQuaDemCa3;
                                                    dtTuDongQuaDemCa3 = this._caLamViecBLL.CaLamViecGetByMaCaLamViec(sTuDongQuaDemMaCaLamViec);
                                                    int iTuDongQuaDemCa3;
                                                    iTuDongQuaDemCa3 = 0;
                                                    while (iTuDongQuaDemCa3 < dtTuDongQuaDemCa3.Rows.Count)
                                                    {
                                                        this.sTuDongQuaDemTenCaLamViec = dtTuDongQuaDemCa3.Rows[iTuDongQuaDemCa3]["CaLamViec"].ToString();
                                                        DateTime dBatDauVaoB3;
                                                        dBatDauVaoB3 = Convert.ToDateTime(sNgayCham + " " + string.Format("{0:T}", Convert.ToDateTime(dtTuDongQuaDemCa3.Rows[iTuDongQuaDemCa3]["BatDauVao"].ToString())));
                                                        DateTime dKetThucVaoB3;
                                                        dKetThucVaoB3 = Convert.ToDateTime(sNgayCham + " " + string.Format("{0:T}", Convert.ToDateTime(dtTuDongQuaDemCa3.Rows[iTuDongQuaDemCa3]["KetThucVao"].ToString())));
                                                        DateTime dBatDauRaB3;
                                                        dBatDauRaB3 = Convert.ToDateTime(sNgayCham + " " + string.Format("{0:T}", Convert.ToDateTime(dtTuDongQuaDemCa3.Rows[iTuDongQuaDemCa3]["BatDauRa"].ToString())));
                                                        DateTime dKetThucRaB3;
                                                        dKetThucRaB3 = Convert.ToDateTime(sNgayCham + " " + string.Format("{0:T}", Convert.ToDateTime(dtTuDongQuaDemCa3.Rows[iTuDongQuaDemCa3]["KetThucRa"].ToString())));
                                                        if (dGioVaoTuDongQuaDem >= dBatDauVaoB3 && dGioVaoTuDongQuaDem <= dKetThucVaoB3)
                                                        {
                                                            kiemTraVao++;
                                                        }
                                                        if (dGioRaTuDongQuaDem >= dBatDauRaB3 && dGioRaTuDongQuaDem <= dKetThucRaB3)
                                                        {
                                                            kiemTraRa++;
                                                        }
                                                        if (kiemTraVao != 1 || kiemTraRa != 0)
                                                        {
                                                            iTuDongQuaDemCa3++;
                                                            continue;
                                                        }
                                                        goto IL_36c3b;
                                                    }
                                                    if (!(this.sTuDongQuaDemMaCaLamViec == ""))
                                                    {
                                                        cellChiTietLichTrinhChoCaLamViecTuDongQuaDem3++;
                                                        continue;
                                                    }
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[4].Value = ca;
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[11].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[16].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[17].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[18].Value = this.sKHVang;
                                                    if (DateTimeProgress.XuatIDThu((int)dt.AddDays(dem).DayOfWeek) == "0")
                                                    {
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[19].Value = "CN";
                                                    }
                                                    else
                                                    {
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[19].Value = "NT";
                                                    }
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[20].Value = this.sMaChamCong;
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[21].Value = this.sPhongBanTinhCong;
                                                    break;
                                                }
                                                goto IL_36c3b;
                                            IL_36c3b:
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[4].Value = this.sTuDongQuaDemTenCaLamViec;
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[11].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[16].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[17].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[18].Value = this.sKHVang;
                                                if (DateTimeProgress.XuatIDThu((int)dt.AddDays(dem).DayOfWeek) == "0")
                                                {
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[19].Value = "CN";
                                                }
                                                else
                                                {
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[19].Value = "NT";
                                                }
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[20].Value = this.sMaChamCong;
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[21].Value = this.sPhongBanTinhCong;
                                                break;
                                            }
                                        }
                                    }
                                    if (demTuDongQuaDem == 2)
                                    {
                                        dGioRaTuDongQuaDem = Convert.ToDateTime(dtTuDongQuaDem.Rows[iTuDongQuaDem]["GioCham"].ToString());
                                        this.DGVTinhCong.Rows[_nhanVien].Cells[6].Value = string.Format(this.sDinhDangThoiGian, dGioRaTuDongQuaDem);
                                        new DataTable();
                                        this._chiTietLichTrinhChoCalamViecDTO.MaLichTrinhCaLamViec = sLTCCLVNhanVien;
                                        this._chiTietLichTrinhChoCalamViecDTO.Thu = sThu;
                                        DataTable dtNhanCaTuDongQuaDem2;
                                        dtNhanCaTuDongQuaDem2 = this._chiTietLichTrinhChoCaLamViecBLL.ChiTietLichTrinhChoCaLamViecNhanCa(this._chiTietLichTrinhChoCalamViecDTO);
                                        int iChiTietLichTrinhChoCaLamViecTuDongQuaDem2;
                                        iChiTietLichTrinhChoCaLamViecTuDongQuaDem2 = 0;
                                        if (iChiTietLichTrinhChoCaLamViecTuDongQuaDem2 < dtNhanCaTuDongQuaDem2.Rows.Count)
                                        {
                                            int cellChiTietLichTrinhChoCaLamViecTuDongQuaDem2;
                                            cellChiTietLichTrinhChoCaLamViecTuDongQuaDem2 = 3;
                                            while (true)
                                            {
                                                if (cellChiTietLichTrinhChoCaLamViecTuDongQuaDem2 < 13)
                                                {
                                                    kiemTraVao = 0;
                                                    kiemTraRa = 0;
                                                    this.sTuDongQuaDemMaCaLamViec = dtNhanCaTuDongQuaDem2.Rows[iChiTietLichTrinhChoCaLamViecTuDongQuaDem2][cellChiTietLichTrinhChoCaLamViecTuDongQuaDem2].ToString();
                                                    new DataTable();
                                                    DataTable dtTuDongQuaDemCa2;
                                                    dtTuDongQuaDemCa2 = this._caLamViecBLL.CaLamViecGetByMaCaLamViec(sTuDongQuaDemMaCaLamViec);
                                                    int iTuDongQuaDemCa2;
                                                    iTuDongQuaDemCa2 = 0;
                                                    while (iTuDongQuaDemCa2 < dtTuDongQuaDemCa2.Rows.Count)
                                                    {
                                                        string sGiayGioVao5;
                                                        sGiayGioVao5 = dGioVaoTuDongQuaDem.Second.ToString();
                                                        string sGiayGioRa5;
                                                        sGiayGioRa5 = dGioRaTuDongQuaDem.Second.ToString();
                                                        this.sTuDongQuaDemTenCaLamViec = dtTuDongQuaDemCa2.Rows[iTuDongQuaDemCa2]["CaLamViec"].ToString();
                                                        DateTime dBatDauVaoB2;
                                                        dBatDauVaoB2 = Convert.ToDateTime(sNgayCham + " " + string.Format("{0:T}", Convert.ToDateTime(dtTuDongQuaDemCa2.Rows[iTuDongQuaDemCa2]["BatDauVao"].ToString())).Replace("00 ", sGiayGioVao5 + " "));
                                                        DateTime dKetThucVaoB2;
                                                        dKetThucVaoB2 = Convert.ToDateTime(sNgayCham + " " + string.Format("{0:T}", Convert.ToDateTime(dtTuDongQuaDemCa2.Rows[iTuDongQuaDemCa2]["KetThucVao"].ToString())).Replace("00 ", sGiayGioVao5 + " "));
                                                        DateTime dBatDauRaB2;
                                                        dBatDauRaB2 = Convert.ToDateTime(sNgayCham + " " + string.Format("{0:T}", Convert.ToDateTime(dtTuDongQuaDemCa2.Rows[iTuDongQuaDemCa2]["BatDauRa"].ToString())).Replace("00 ", sGiayGioRa5 + " "));
                                                        DateTime dKetThucRaB2;
                                                        dKetThucRaB2 = Convert.ToDateTime(sNgayCham + " " + string.Format("{0:T}", Convert.ToDateTime(dtTuDongQuaDemCa2.Rows[iTuDongQuaDemCa2]["KetThucRa"].ToString())).Replace("00 ", sGiayGioRa5 + " "));
                                                        if (dGioVaoTuDongQuaDem >= dBatDauVaoB2 && dGioVaoTuDongQuaDem <= dKetThucVaoB2)
                                                        {
                                                            kiemTraVao++;
                                                        }
                                                        if (dGioRaTuDongQuaDem >= dBatDauRaB2 && dGioRaTuDongQuaDem <= dKetThucRaB2)
                                                        {
                                                            kiemTraRa++;
                                                        }
                                                        if (kiemTraVao != 1 || kiemTraRa != 1)
                                                        {
                                                            iTuDongQuaDemCa2++;
                                                            continue;
                                                        }
                                                        goto IL_375f9;
                                                    }
                                                    if (!(this.sTuDongQuaDemMaCaLamViec == ""))
                                                    {
                                                        cellChiTietLichTrinhChoCaLamViecTuDongQuaDem2++;
                                                        continue;
                                                    }
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[4].Value = ca;
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[11].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[16].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[17].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[18].Value = this.sKHVang;
                                                    if (DateTimeProgress.XuatIDThu((int)dt.AddDays(dem).DayOfWeek) == "0")
                                                    {
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[19].Value = "CN";
                                                    }
                                                    else
                                                    {
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[19].Value = "NT";
                                                    }
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[20].Value = this.sMaChamCong;
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[21].Value = this.sPhongBanTinhCong;
                                                    break;
                                                }
                                                goto IL_375f9;
                                            IL_375f9:
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[4].Value = this.sTuDongQuaDemTenCaLamViec;
                                                new DataTable();
                                                DataTable dtCaLamViecTuDongQuaDem2;
                                                dtCaLamViecTuDongQuaDem2 = this._caLamViecBLL.CaLamViecGetByMaCaLamViec(sTuDongQuaDemMaCaLamViec);
                                                for (int iCaLamViecTuDongQuaDem2 = 0; iCaLamViecTuDongQuaDem2 < dtCaLamViecTuDongQuaDem2.Rows.Count; iCaLamViecTuDongQuaDem2++)
                                                {
                                                    string sGiayGioVao4;
                                                    sGiayGioVao4 = dGioVaoTuDongQuaDem.Second.ToString();
                                                    string sGiayGioRa4;
                                                    sGiayGioRa4 = dGioRaTuDongQuaDem.Second.ToString();
                                                    DateTime dGioVaoKhaiBaoTuDongQuaDemB2;
                                                    dGioVaoKhaiBaoTuDongQuaDemB2 = Convert.ToDateTime(sNgayCham + " " + string.Format("{0:T}", Convert.ToDateTime(dtCaLamViecTuDongQuaDem2.Rows[iCaLamViecTuDongQuaDem2]["GioVaoLamViec"].ToString())).Replace("00 ", sGiayGioVao4 + " "));
                                                    DateTime dGioRaKhaiBaoTuDongQuaDemB2;
                                                    dGioRaKhaiBaoTuDongQuaDemB2 = Convert.ToDateTime(sNgayCham + " " + string.Format("{0:T}", Convert.ToDateTime(dtCaLamViecTuDongQuaDem2.Rows[iCaLamViecTuDongQuaDem2]["GioKetThucLamViec"].ToString())).Replace("00 ", sGiayGioRa4 + " "));
                                                    string sTruGioDiTre3;
                                                    sTruGioDiTre3 = dtCaLamViecTuDongQuaDem2.Rows[iCaLamViecTuDongQuaDem2]["TruGioDiTre"].ToString();
                                                    string sBatDauTinhDiTre3;
                                                    sBatDauTinhDiTre3 = dtCaLamViecTuDongQuaDem2.Rows[iCaLamViecTuDongQuaDem2]["BatDauTinhDiTre"].ToString();
                                                    int iChoPhepDiTre3;
                                                    iChoPhepDiTre3 = Convert.ToInt32(dtCaLamViecTuDongQuaDem2.Rows[iCaLamViecTuDongQuaDem2]["ChoPhepDiTre"].ToString());
                                                    string sPhutTre3;
                                                    sPhutTre3 = Convert.ToInt32((dGioVaoTuDongQuaDem - dGioVaoKhaiBaoTuDongQuaDemB2).TotalMinutes).ToString();
                                                    if (sTruGioDiTre3 == "True")
                                                    {
                                                        if (Convert.ToInt32(sPhutTre3) < 0)
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = "0";
                                                        }
                                                        else
                                                        {
                                                            int iPhutTre3;
                                                            iPhutTre3 = Convert.ToInt32(sPhutTre3) - iChoPhepDiTre3;
                                                            if (sBatDauTinhDiTre3 == "True")
                                                            {
                                                                if (iPhutTre3 < 1)
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = "0";
                                                                }
                                                                else
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[5].Style.BackColor = Color.Lime;
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = iPhutTre3.ToString();
                                                                }
                                                            }
                                                            else if (iPhutTre3 < 1)
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = "0";
                                                            }
                                                            else
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = sPhutTre3;
                                                            }
                                                        }
                                                    }
                                                    else
                                                    {
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = "0";
                                                    }
                                                    string sTruGioVeSom3;
                                                    sTruGioVeSom3 = dtCaLamViecTuDongQuaDem2.Rows[iCaLamViecTuDongQuaDem2]["TruGioVeSom"].ToString();
                                                    string sBatDauTinhVeSom3;
                                                    sBatDauTinhVeSom3 = dtCaLamViecTuDongQuaDem2.Rows[iCaLamViecTuDongQuaDem2]["BatDauTinhVeSom"].ToString();
                                                    int iChoPhepVeSom3;
                                                    iChoPhepVeSom3 = Convert.ToInt32(dtCaLamViecTuDongQuaDem2.Rows[iCaLamViecTuDongQuaDem2]["ChoPhepVeSom"].ToString());
                                                    string sPhutVeSom3;
                                                    sPhutVeSom3 = Convert.ToInt32((dGioRaKhaiBaoTuDongQuaDemB2 - dGioRaTuDongQuaDem).TotalMinutes).ToString();
                                                    if (sTruGioVeSom3 == "True")
                                                    {
                                                        if (Convert.ToInt32(sPhutVeSom3) < 0)
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = "0";
                                                        }
                                                        else
                                                        {
                                                            int iPhutVeSom3;
                                                            iPhutVeSom3 = Convert.ToInt32(sPhutVeSom3) - iChoPhepVeSom3;
                                                            if (iPhutVeSom3 < 1)
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = "0";
                                                            }
                                                            else if (sBatDauTinhVeSom3 == "True")
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[6].Style.BackColor = Color.Yellow;
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = iPhutVeSom3.ToString();
                                                            }
                                                            else
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = sPhutVeSom3;
                                                            }
                                                        }
                                                    }
                                                    else
                                                    {
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = "0";
                                                    }
                                                    string sVeTre3;
                                                    sVeTre3 = Convert.ToInt32((dGioRaTuDongQuaDem - dGioRaKhaiBaoTuDongQuaDemB2).TotalMinutes).ToString();
                                                    if (Convert.ToInt32(sVeTre3) > 0)
                                                    {
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[11].Value = sVeTre3;
                                                    }
                                                    else
                                                    {
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[11].Value = "0";
                                                    }
                                                    double dGio3;
                                                    dGio3 = Math.Round(Convert.ToDouble(Convert.ToSingle(dtCaLamViecTuDongQuaDem2.Rows[iCaLamViecTuDongQuaDem2]["TongGioTrongCaLamViec"]) * 60f - (float)(Convert.ToInt32(this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value.ToString()) + Convert.ToInt32(this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value))) / 60.0, this.iLamTronGio);
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = dGio3.ToString();
                                                    double iGio3;
                                                    iGio3 = Convert.ToDouble(dtCaLamViecTuDongQuaDem2.Rows[iCaLamViecTuDongQuaDem2]["TongGioTrongCaLamViec"].ToString());
                                                    double dCongTinh3;
                                                    dCongTinh3 = Convert.ToDouble(dtCaLamViecTuDongQuaDem2.Rows[iCaLamViecTuDongQuaDem2]["CongTinh"].ToString());
                                                    double dCong3;
                                                    dCong3 = Math.Round(dGio3 * dCongTinh3 / iGio3, this.iLamTronCong);
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = dCong3.ToString();
                                                    double dTongGioThucTeTuDongQuaDem2;
                                                    dTongGioThucTeTuDongQuaDem2 = Math.Round(Convert.ToDouble(Convert.ToInt32((dGioRaTuDongQuaDem - dGioVaoTuDongQuaDem).TotalMinutes).ToString()) / 60.0, this.iLamTronGio);
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[16].Value = dTongGioThucTeTuDongQuaDem2.ToString();
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[17].Value = dtCaLamViecTuDongQuaDem2.Rows[iCaLamViecTuDongQuaDem2]["CongTinh"].ToString();
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[18].Value = this.sKHDungGio;
                                                    string sChoPhepTangCaTruocGioLamViecTuDongQuaDem2;
                                                    sChoPhepTangCaTruocGioLamViecTuDongQuaDem2 = dtCaLamViecTuDongQuaDem2.Rows[iCaLamViecTuDongQuaDem2]["TangCaTruocGioLamViec"].ToString();
                                                    int iPhutTangCaTruocGioLamViecTuDongQuaDem2;
                                                    iPhutTangCaTruocGioLamViecTuDongQuaDem2 = Convert.ToInt32(dtCaLamViecTuDongQuaDem2.Rows[iCaLamViecTuDongQuaDem2]["SoPhutTangCaTruocGioLamViec"].ToString());
                                                    int iPhutTangCaTruocGioLamViecDatDen2;
                                                    iPhutTangCaTruocGioLamViecDatDen2 = Convert.ToInt32(dtCaLamViecTuDongQuaDem2.Rows[iCaLamViecTuDongQuaDem2]["TangCaTruocGioLamViecDatDen"].ToString());
                                                    int iPhutTruTangCaTruoc2;
                                                    iPhutTruTangCaTruoc2 = Convert.ToInt32(dtCaLamViecTuDongQuaDem2.Rows[iCaLamViecTuDongQuaDem2]["PhutTruTangCaTruoc"].ToString());
                                                    string sChoPhepTangCaSauGioLamViecTuDongQuaDem2;
                                                    sChoPhepTangCaSauGioLamViecTuDongQuaDem2 = dtCaLamViecTuDongQuaDem2.Rows[iCaLamViecTuDongQuaDem2]["TangCaSauGioLamViec"].ToString();
                                                    int iPhutTangCaSauGioLamViecTuDongQuaDem2;
                                                    iPhutTangCaSauGioLamViecTuDongQuaDem2 = Convert.ToInt32(dtCaLamViecTuDongQuaDem2.Rows[iCaLamViecTuDongQuaDem2]["SoPhutTangCaSauGioLamViec"].ToString());
                                                    int iPhutTangCaSauGioLamViecDatDen2;
                                                    iPhutTangCaSauGioLamViecDatDen2 = Convert.ToInt32(dtCaLamViecTuDongQuaDem2.Rows[iCaLamViecTuDongQuaDem2]["TangCaSauGioLamViecDatDen"].ToString());
                                                    int iPhutTruTangCaSau2;
                                                    iPhutTruTangCaSau2 = Convert.ToInt32(dtCaLamViecTuDongQuaDem2.Rows[iCaLamViecTuDongQuaDem2]["PhutTruTangCaSau"].ToString());
                                                    int iGioiHanTC1TuDongQuaDem2;
                                                    iGioiHanTC1TuDongQuaDem2 = Convert.ToInt32(dtCaLamViecTuDongQuaDem2.Rows[iCaLamViecTuDongQuaDem2]["GioiHanTangCa1"].ToString());
                                                    int iGioiHanTC2TuDongQuaDem2;
                                                    iGioiHanTC2TuDongQuaDem2 = Convert.ToInt32(dtCaLamViecTuDongQuaDem2.Rows[iCaLamViecTuDongQuaDem2]["GioiHanTangCa2"].ToString());
                                                    int iGioiHanTC3TuDongQuaDem2;
                                                    iGioiHanTC3TuDongQuaDem2 = Convert.ToInt32(dtCaLamViecTuDongQuaDem2.Rows[iCaLamViecTuDongQuaDem2]["GioiHanTangCa3"].ToString());
                                                    int iGioiHanTC4TuDongQuaDem2;
                                                    iGioiHanTC4TuDongQuaDem2 = Convert.ToInt32(dtCaLamViecTuDongQuaDem2.Rows[iCaLamViecTuDongQuaDem2]["GioiHanTangCa4"].ToString());
                                                    int iTongGioTangCaSauTuDongQuaDem2;
                                                    iTongGioTangCaSauTuDongQuaDem2 = 0;
                                                    int iTongGioTangCaTruocTuDongQuaDem2;
                                                    iTongGioTangCaTruocTuDongQuaDem2 = 0;
                                                    if (sChoPhepTangCaTruocGioLamViecTuDongQuaDem2 == "False" && sChoPhepTangCaSauGioLamViecTuDongQuaDem2 == "False")
                                                    {
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                    }
                                                    else
                                                    {
                                                        if (sChoPhepTangCaTruocGioLamViecTuDongQuaDem2 == "True")
                                                        {
                                                            int iThoiGianTruocGioLamTuDongQuaDem2;
                                                            iThoiGianTruocGioLamTuDongQuaDem2 = Convert.ToInt32(Convert.ToInt32((dGioVaoKhaiBaoTuDongQuaDemB2 - dGioVaoTuDongQuaDem).TotalMinutes).ToString());
                                                            if (iThoiGianTruocGioLamTuDongQuaDem2 > 0 && iThoiGianTruocGioLamTuDongQuaDem2 > iPhutTangCaTruocGioLamViecTuDongQuaDem2 && iThoiGianTruocGioLamTuDongQuaDem2 > iPhutTangCaTruocGioLamViecDatDen2)
                                                            {
                                                                iTongGioTangCaTruocTuDongQuaDem2 = iThoiGianTruocGioLamTuDongQuaDem2 - iPhutTruTangCaTruoc2;
                                                            }
                                                        }
                                                        if (sChoPhepTangCaSauGioLamViecTuDongQuaDem2 == "True")
                                                        {
                                                            int iThoiGianSauGioLamViecTuDongQuaDem2;
                                                            iThoiGianSauGioLamViecTuDongQuaDem2 = Convert.ToInt32(Convert.ToInt32((dGioRaTuDongQuaDem - dGioRaKhaiBaoTuDongQuaDemB2).TotalMinutes).ToString());
                                                            if (iThoiGianSauGioLamViecTuDongQuaDem2 > 0 && iThoiGianSauGioLamViecTuDongQuaDem2 > iPhutTangCaSauGioLamViecTuDongQuaDem2 && iThoiGianSauGioLamViecTuDongQuaDem2 > iPhutTangCaSauGioLamViecDatDen2)
                                                            {
                                                                iTongGioTangCaSauTuDongQuaDem2 = iThoiGianSauGioLamViecTuDongQuaDem2 - iPhutTruTangCaSau2;
                                                            }
                                                        }
                                                    }
                                                    double dTongThoiGianTangCaTuDongQuaDem2;
                                                    dTongThoiGianTangCaTuDongQuaDem2 = Convert.ToDouble(iTongGioTangCaTruocTuDongQuaDem2 + iTongGioTangCaSauTuDongQuaDem2);
                                                    if (dTongThoiGianTangCaTuDongQuaDem2 > 0.0)
                                                    {
                                                        if (iGioiHanTC1TuDongQuaDem2 == 0)
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = Math.Round(dTongThoiGianTangCaTuDongQuaDem2 * this.dTangCa1HeSo / 60.0, this.iLamTronGio);
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                        }
                                                        if (iGioiHanTC1TuDongQuaDem2 != 0 && iGioiHanTC2TuDongQuaDem2 == 0)
                                                        {
                                                            if (dTongThoiGianTangCaTuDongQuaDem2 < Convert.ToDouble(iGioiHanTC1TuDongQuaDem2))
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = Math.Round(dTongThoiGianTangCaTuDongQuaDem2 * this.dTangCa1HeSo / 60.0, this.iLamTronGio);
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                            }
                                                            else
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = Math.Round(Convert.ToDouble(iGioiHanTC1TuDongQuaDem2) / 60.0 * this.dTangCa1HeSo, this.iLamTronGio);
                                                                if (dTongThoiGianTangCaTuDongQuaDem2 - Convert.ToDouble(iGioiHanTC1TuDongQuaDem2) > 0.0)
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = Math.Round((dTongThoiGianTangCaTuDongQuaDem2 - Convert.ToDouble(iGioiHanTC1TuDongQuaDem2)) * this.dTangCa2HeSo / 60.0, this.iLamTronGio);
                                                                }
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                            }
                                                        }
                                                        if (iGioiHanTC1TuDongQuaDem2 != 0 && iGioiHanTC2TuDongQuaDem2 != 0 && iGioiHanTC3TuDongQuaDem2 == 0)
                                                        {
                                                            if (dTongThoiGianTangCaTuDongQuaDem2 < Convert.ToDouble(iGioiHanTC1TuDongQuaDem2))
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = Math.Round(dTongThoiGianTangCaTuDongQuaDem2 * this.dTangCa1HeSo / 60.0, this.iLamTronGio);
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                            }
                                                            else
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = Math.Round(Convert.ToDouble(iGioiHanTC1TuDongQuaDem2) * this.dTangCa1HeSo / 60.0, this.iLamTronGio);
                                                                if (dTongThoiGianTangCaTuDongQuaDem2 - Convert.ToDouble(iGioiHanTC1TuDongQuaDem2) < Convert.ToDouble(iGioiHanTC2TuDongQuaDem2))
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = Math.Round((dTongThoiGianTangCaTuDongQuaDem2 - Convert.ToDouble(iGioiHanTC1TuDongQuaDem2)) * this.dTangCa2HeSo / 60.0, this.iLamTronGio);
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                                }
                                                                else
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = Math.Round(Convert.ToDouble(iGioiHanTC1TuDongQuaDem2) * this.dTangCa1HeSo / 60.0, this.iLamTronGio);
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = Math.Round(Convert.ToDouble(iGioiHanTC2TuDongQuaDem2) * this.dTangCa2HeSo / 60.0, this.iLamTronGio);
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = Math.Round((dTongThoiGianTangCaTuDongQuaDem2 - Convert.ToDouble(iGioiHanTC1TuDongQuaDem2) - Convert.ToDouble(iGioiHanTC2TuDongQuaDem2)) * this.dTangCa3HeSo / 60.0, this.iLamTronGio);
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                                }
                                                            }
                                                        }
                                                        if (iGioiHanTC1TuDongQuaDem2 != 0 && iGioiHanTC2TuDongQuaDem2 != 0 && iGioiHanTC3TuDongQuaDem2 != 0 && iGioiHanTC4TuDongQuaDem2 != 0)
                                                        {
                                                        }
                                                    }
                                                    else
                                                    {
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                    }
                                                }
                                                if (DateTimeProgress.XuatIDThu((int)dt.AddDays(dem).DayOfWeek) == "0")
                                                {
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[19].Value = "CN";
                                                }
                                                else
                                                {
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[19].Value = "NT";
                                                }
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[20].Value = this.sMaChamCong;
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[21].Value = this.sPhongBanTinhCong;
                                                break;
                                            }
                                        }
                                    }
                                    if (demTuDongQuaDem % 2 != 0 && demTuDongQuaDem != 1)
                                    {
                                        addTuDongQuaDem = this.DGVTinhCong.Rows.Add();
                                        dGioVaoTuDongQuaDem = Convert.ToDateTime(dtTuDongQuaDem.Rows[iTuDongQuaDem]["GioCham"].ToString());
                                        this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[5].Value = string.Format(this.sDinhDangThoiGian, dGioVaoTuDongQuaDem);
                                        this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[0].Value = this.sMaNhanVien;
                                        this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[1].Value = this.sTenNhanVien;
                                        this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[2].Value = this.DGVTinhCong.Rows[_nhanVien].Cells[2].Value.ToString();
                                        this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[3].Value = DateTimeProgress.XuatThuTinhCong((int)dt.AddDays(dem).DayOfWeek);
                                        this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[4].Value = ca;
                                        this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[7].Value = "0";
                                        this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[8].Value = "0";
                                        this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[9].Value = "0";
                                        this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[10].Value = "0";
                                        this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[11].Value = "0";
                                        this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[12].Value = "0";
                                        this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[13].Value = "0";
                                        this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[14].Value = "0";
                                        this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[15].Value = "0";
                                        this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[16].Value = "0";
                                        this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[17].Value = "0";
                                        this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[18].Value = this.sKHVang;
                                        if (DateTimeProgress.XuatIDThu((int)dt.AddDays(dem).DayOfWeek) == "0")
                                        {
                                            this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[19].Value = "CN";
                                        }
                                        else
                                        {
                                            this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[19].Value = "NT";
                                        }
                                        this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[20].Value = this.sMaChamCong;
                                        this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[21].Value = this.sPhongBanTinhCong;
                                    }
                                    if (demTuDongQuaDem % 2 != 0 || demTuDongQuaDem == 2)
                                    {
                                        continue;
                                    }
                                    dGioRaTuDongQuaDem = Convert.ToDateTime(dtTuDongQuaDem.Rows[iTuDongQuaDem]["GioCham"].ToString());
                                    this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[6].Value = string.Format(this.sDinhDangThoiGian, dGioRaTuDongQuaDem);
                                    new DataTable();
                                    this._chiTietLichTrinhChoCalamViecDTO.MaLichTrinhCaLamViec = sLTCCLVNhanVien;
                                    this._chiTietLichTrinhChoCalamViecDTO.Thu = sThu;
                                    DataTable dtNhanCaTuDongQuaDem;
                                    dtNhanCaTuDongQuaDem = this._chiTietLichTrinhChoCaLamViecBLL.ChiTietLichTrinhChoCaLamViecNhanCa(this._chiTietLichTrinhChoCalamViecDTO);
                                    int iChiTietLichTrinhChoCaLamViecTuDongQuaDem;
                                    iChiTietLichTrinhChoCaLamViecTuDongQuaDem = 0;
                                    if (iChiTietLichTrinhChoCaLamViecTuDongQuaDem >= dtNhanCaTuDongQuaDem.Rows.Count)
                                    {
                                        continue;
                                    }
                                    int cellChiTietLichTrinhChoCaLamViecTuDongQuaDem;
                                    cellChiTietLichTrinhChoCaLamViecTuDongQuaDem = 3;
                                    while (true)
                                    {
                                        if (cellChiTietLichTrinhChoCaLamViecTuDongQuaDem < 13)
                                        {
                                            kiemTraVao = 0;
                                            kiemTraRa = 0;
                                            this.sTuDongQuaDemMaCaLamViec = dtNhanCaTuDongQuaDem.Rows[iChiTietLichTrinhChoCaLamViecTuDongQuaDem][cellChiTietLichTrinhChoCaLamViecTuDongQuaDem].ToString();
                                            new DataTable();
                                            DataTable dtTuDongQuaDemCa;
                                            dtTuDongQuaDemCa = this._caLamViecBLL.CaLamViecGetByMaCaLamViec(sTuDongQuaDemMaCaLamViec);
                                            int iTuDongQuaDemCa;
                                            iTuDongQuaDemCa = 0;
                                            while (iTuDongQuaDemCa < dtTuDongQuaDemCa.Rows.Count)
                                            {
                                                this.sTuDongQuaDemTenCaLamViec = dtTuDongQuaDemCa.Rows[iTuDongQuaDemCa]["CaLamViec"].ToString();
                                                string sGiayGioVao3;
                                                sGiayGioVao3 = dGioVaoTuDongQuaDem.Second.ToString();
                                                string sGiayGioRa3;
                                                sGiayGioRa3 = dGioRaTuDongQuaDem.Second.ToString();
                                                DateTime dBatDauVaoB;
                                                dBatDauVaoB = Convert.ToDateTime(sNgayCham + " " + string.Format("{0:T}", Convert.ToDateTime(dtTuDongQuaDemCa.Rows[iTuDongQuaDemCa]["BatDauVao"].ToString())).Replace("00 ", sGiayGioVao3 + " "));
                                                DateTime dKetThucVaoB;
                                                dKetThucVaoB = Convert.ToDateTime(sNgayCham + " " + string.Format("{0:T}", Convert.ToDateTime(dtTuDongQuaDemCa.Rows[iTuDongQuaDemCa]["KetThucVao"].ToString())).Replace("00 ", sGiayGioVao3 + " "));
                                                DateTime dBatDauRaB;
                                                dBatDauRaB = Convert.ToDateTime(sNgayCham + " " + string.Format("{0:T}", Convert.ToDateTime(dtTuDongQuaDemCa.Rows[iTuDongQuaDemCa]["BatDauRa"].ToString())).Replace("00 ", sGiayGioRa3 + " "));
                                                DateTime dKetThucRaB;
                                                dKetThucRaB = Convert.ToDateTime(sNgayCham + " " + string.Format("{0:T}", Convert.ToDateTime(dtTuDongQuaDemCa.Rows[iTuDongQuaDemCa]["KetThucRa"].ToString())).Replace("00 ", sGiayGioRa3 + " "));
                                                if (dGioVaoTuDongQuaDem >= dBatDauVaoB && dGioVaoTuDongQuaDem <= dKetThucVaoB)
                                                {
                                                    kiemTraVao++;
                                                }
                                                if (dGioRaTuDongQuaDem >= dBatDauRaB && dGioRaTuDongQuaDem <= dKetThucRaB)
                                                {
                                                    kiemTraRa++;
                                                }
                                                if (kiemTraVao != 1 || kiemTraRa != 1)
                                                {
                                                    iTuDongQuaDemCa++;
                                                    continue;
                                                }
                                                goto IL_3957f;
                                            }
                                            if (!(this.sTuDongQuaDemMaCaLamViec == ""))
                                            {
                                                cellChiTietLichTrinhChoCaLamViecTuDongQuaDem++;
                                                continue;
                                            }
                                            this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[4].Value = ca;
                                            this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[7].Value = "0";
                                            this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[8].Value = "0";
                                            this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[9].Value = "0";
                                            this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[10].Value = "0";
                                            this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[11].Value = "0";
                                            this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[12].Value = "0";
                                            this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[13].Value = "0";
                                            this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[14].Value = "0";
                                            this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[15].Value = "0";
                                            this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[16].Value = "0";
                                            this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[17].Value = "0";
                                            this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[18].Value = this.sKHVang;
                                            if (DateTimeProgress.XuatIDThu((int)dt.AddDays(dem).DayOfWeek) == "0")
                                            {
                                                this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[19].Value = "CN";
                                            }
                                            else
                                            {
                                                this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[19].Value = "NT";
                                            }
                                            this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[20].Value = this.sMaChamCong;
                                            this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[21].Value = this.sPhongBanTinhCong;
                                            break;
                                        }
                                        goto IL_3957f;
                                    IL_3957f:
                                        this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[4].Value = this.sTuDongQuaDemTenCaLamViec;
                                        new DataTable();
                                        DataTable dtCaLamViecTuDongQuaDem;
                                        dtCaLamViecTuDongQuaDem = this._caLamViecBLL.CaLamViecGetByMaCaLamViec(sTuDongQuaDemMaCaLamViec);
                                        for (int iCaLamViecTuDongQuaDem = 0; iCaLamViecTuDongQuaDem < dtCaLamViecTuDongQuaDem.Rows.Count; iCaLamViecTuDongQuaDem++)
                                        {
                                            string sGiayGioVao;
                                            sGiayGioVao = dGioVaoTuDongQuaDem.Second.ToString();
                                            string sGiayGioRa;
                                            sGiayGioRa = dGioRaTuDongQuaDem.Second.ToString();
                                            DateTime dGioVaoKhaiBaoTuDongQuaDemB;
                                            dGioVaoKhaiBaoTuDongQuaDemB = Convert.ToDateTime(sNgayCham + " " + string.Format("{0:T}", Convert.ToDateTime(dtCaLamViecTuDongQuaDem.Rows[iCaLamViecTuDongQuaDem]["GioVaoLamViec"].ToString())).Replace("00 ", sGiayGioVao + " "));
                                            DateTime dGioRaKhaiBaoTuDongQuaDemB;
                                            dGioRaKhaiBaoTuDongQuaDemB = Convert.ToDateTime(sNgayCham + " " + string.Format("{0:T}", Convert.ToDateTime(dtCaLamViecTuDongQuaDem.Rows[iCaLamViecTuDongQuaDem]["GioKetThucLamViec"].ToString())).Replace("00 ", sGiayGioRa + " "));
                                            string sTruGioDiTre;
                                            sTruGioDiTre = dtCaLamViecTuDongQuaDem.Rows[iCaLamViecTuDongQuaDem]["TruGioDiTre"].ToString();
                                            string sBatDauTinhDiTre;
                                            sBatDauTinhDiTre = dtCaLamViecTuDongQuaDem.Rows[iCaLamViecTuDongQuaDem]["BatDauTinhDiTre"].ToString();
                                            int iChoPhepDiTre;
                                            iChoPhepDiTre = Convert.ToInt32(dtCaLamViecTuDongQuaDem.Rows[iCaLamViecTuDongQuaDem]["ChoPhepDiTre"].ToString());
                                            string sPhutTre;
                                            sPhutTre = Convert.ToInt32((dGioVaoTuDongQuaDem - dGioVaoKhaiBaoTuDongQuaDemB).TotalMinutes).ToString();
                                            if (sTruGioDiTre == "True")
                                            {
                                                if (Convert.ToInt32(sPhutTre) < 0)
                                                {
                                                    this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[9].Value = "0";
                                                }
                                                else
                                                {
                                                    int iPhutTre;
                                                    iPhutTre = Convert.ToInt32(sPhutTre) - iChoPhepDiTre;
                                                    if (sBatDauTinhDiTre == "True")
                                                    {
                                                        if (iPhutTre < 1)
                                                        {
                                                            this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[5].Style.BackColor = Color.Lime;
                                                            this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[9].Value = "0";
                                                        }
                                                        else
                                                        {
                                                            this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[9].Value = iPhutTre.ToString();
                                                        }
                                                    }
                                                    else if (iPhutTre < 1)
                                                    {
                                                        this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[9].Value = "0";
                                                    }
                                                    else
                                                    {
                                                        this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[9].Value = sPhutTre;
                                                    }
                                                }
                                            }
                                            else
                                            {
                                                this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[9].Value = "0";
                                            }
                                            string sTruGioVeSom;
                                            sTruGioVeSom = dtCaLamViecTuDongQuaDem.Rows[iCaLamViecTuDongQuaDem]["TruGioVeSom"].ToString();
                                            string sBatDauTinhVeSom;
                                            sBatDauTinhVeSom = dtCaLamViecTuDongQuaDem.Rows[iCaLamViecTuDongQuaDem]["BatDauTinhVeSom"].ToString();
                                            int iChoPhepVeSom;
                                            iChoPhepVeSom = Convert.ToInt32(dtCaLamViecTuDongQuaDem.Rows[iCaLamViecTuDongQuaDem]["ChoPhepVeSom"].ToString());
                                            string sPhutVeSom;
                                            sPhutVeSom = Convert.ToInt32((dGioRaKhaiBaoTuDongQuaDemB - dGioRaTuDongQuaDem).TotalMinutes).ToString();
                                            if (sTruGioVeSom == "True")
                                            {
                                                if (Convert.ToInt32(sPhutVeSom) < 0)
                                                {
                                                    this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[10].Value = "0";
                                                }
                                                else
                                                {
                                                    int iPhutVeSom;
                                                    iPhutVeSom = Convert.ToInt32(sPhutVeSom) - iChoPhepVeSom;
                                                    if (iPhutVeSom < 1)
                                                    {
                                                        this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[10].Value = "0";
                                                    }
                                                    else if (sBatDauTinhVeSom == "True")
                                                    {
                                                        this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[6].Style.BackColor = Color.Yellow;
                                                        this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[10].Value = iPhutVeSom.ToString();
                                                    }
                                                    else
                                                    {
                                                        this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[10].Value = sPhutVeSom;
                                                    }
                                                }
                                            }
                                            else
                                            {
                                                this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[10].Value = "0";
                                            }
                                            string sVeTre;
                                            sVeTre = Convert.ToInt32((dGioRaTuDongQuaDem - dGioRaKhaiBaoTuDongQuaDemB).TotalMinutes).ToString();
                                            if (Convert.ToInt32(sVeTre) > 0)
                                            {
                                                this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[11].Value = sVeTre;
                                            }
                                            else
                                            {
                                                this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[11].Value = "0";
                                            }
                                            double dGio;
                                            dGio = Math.Round(Convert.ToDouble(Convert.ToSingle(dtCaLamViecTuDongQuaDem.Rows[iCaLamViecTuDongQuaDem]["TongGioTrongCaLamViec"]) * 60f - (float)(Convert.ToInt32(this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[9].Value.ToString()) + Convert.ToInt32(this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[10].Value))) / 60.0, this.iLamTronGio);
                                            this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[8].Value = dGio.ToString();
                                            double iGio;
                                            iGio = Convert.ToDouble(dtCaLamViecTuDongQuaDem.Rows[iCaLamViecTuDongQuaDem]["TongGioTrongCaLamViec"].ToString());
                                            double dCongTinh;
                                            dCongTinh = Convert.ToDouble(dtCaLamViecTuDongQuaDem.Rows[iCaLamViecTuDongQuaDem]["CongTinh"].ToString());
                                            double dCong;
                                            dCong = Math.Round(dGio * dCongTinh / iGio, this.iLamTronCong);
                                            this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[7].Value = dCong.ToString();
                                            double dTongGioThucTeTuDongQuaDem;
                                            dTongGioThucTeTuDongQuaDem = Math.Round(Convert.ToDouble(Convert.ToInt32((dGioRaTuDongQuaDem - dGioVaoTuDongQuaDem).TotalMinutes).ToString()) / 60.0, this.iLamTronGio);
                                            this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[16].Value = dTongGioThucTeTuDongQuaDem.ToString();
                                            this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[17].Value = dtCaLamViecTuDongQuaDem.Rows[iCaLamViecTuDongQuaDem]["CongTinh"].ToString();
                                            this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[18].Value = this.sKHDungGio;
                                            string sChoPhepTangCaTruocGioLamViecTuDongQuaDem;
                                            sChoPhepTangCaTruocGioLamViecTuDongQuaDem = dtCaLamViecTuDongQuaDem.Rows[iCaLamViecTuDongQuaDem]["TangCaTruocGioLamViec"].ToString();
                                            int iPhutTangCaTruocGioLamViecTuDongQuaDem;
                                            iPhutTangCaTruocGioLamViecTuDongQuaDem = Convert.ToInt32(dtCaLamViecTuDongQuaDem.Rows[iCaLamViecTuDongQuaDem]["SoPhutTangCaTruocGioLamViec"].ToString());
                                            int iPhutTangCaTruocGioLamViecDatDen;
                                            iPhutTangCaTruocGioLamViecDatDen = Convert.ToInt32(dtCaLamViecTuDongQuaDem.Rows[iCaLamViecTuDongQuaDem]["TangCaTruocGioLamViecDatDen"].ToString());
                                            int iPhutTruTangCaTruoc;
                                            iPhutTruTangCaTruoc = Convert.ToInt32(dtCaLamViecTuDongQuaDem.Rows[iCaLamViecTuDongQuaDem]["PhutTruTangCaTruoc"].ToString());
                                            string sChoPhepTangCaSauGioLamViecTuDongQuaDem;
                                            sChoPhepTangCaSauGioLamViecTuDongQuaDem = dtCaLamViecTuDongQuaDem.Rows[iCaLamViecTuDongQuaDem]["TangCaSauGioLamViec"].ToString();
                                            int iPhutTangCaSauGioLamViecTuDongQuaDem;
                                            iPhutTangCaSauGioLamViecTuDongQuaDem = Convert.ToInt32(dtCaLamViecTuDongQuaDem.Rows[iCaLamViecTuDongQuaDem]["SoPhutTangCaSauGioLamViec"].ToString());
                                            int iPhutTangCaSauGioLamViecDatDen;
                                            iPhutTangCaSauGioLamViecDatDen = Convert.ToInt32(dtCaLamViecTuDongQuaDem.Rows[iCaLamViecTuDongQuaDem]["TangCaSauGioLamViecDatDen"].ToString());
                                            int iPhutTruTangCaSau;
                                            iPhutTruTangCaSau = Convert.ToInt32(dtCaLamViecTuDongQuaDem.Rows[iCaLamViecTuDongQuaDem]["PhutTruTangCaSau"].ToString());
                                            int iGioiHanTC1TuDongQuaDem;
                                            iGioiHanTC1TuDongQuaDem = Convert.ToInt32(dtCaLamViecTuDongQuaDem.Rows[iCaLamViecTuDongQuaDem]["GioiHanTangCa1"].ToString());
                                            int iGioiHanTC2TuDongQuaDem;
                                            iGioiHanTC2TuDongQuaDem = Convert.ToInt32(dtCaLamViecTuDongQuaDem.Rows[iCaLamViecTuDongQuaDem]["GioiHanTangCa2"].ToString());
                                            int iGioiHanTC3TuDongQuaDem;
                                            iGioiHanTC3TuDongQuaDem = Convert.ToInt32(dtCaLamViecTuDongQuaDem.Rows[iCaLamViecTuDongQuaDem]["GioiHanTangCa3"].ToString());
                                            int iGioiHanTC4TuDongQuaDem;
                                            iGioiHanTC4TuDongQuaDem = Convert.ToInt32(dtCaLamViecTuDongQuaDem.Rows[iCaLamViecTuDongQuaDem]["GioiHanTangCa4"].ToString());
                                            int iTongGioTangCaSauTuDongQuaDem;
                                            iTongGioTangCaSauTuDongQuaDem = 0;
                                            int iTongGioTangCaTruocTuDongQuaDem;
                                            iTongGioTangCaTruocTuDongQuaDem = 0;
                                            if (sChoPhepTangCaTruocGioLamViecTuDongQuaDem == "False" && sChoPhepTangCaSauGioLamViecTuDongQuaDem == "False")
                                            {
                                                this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[12].Value = "0";
                                                this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[13].Value = "0";
                                                this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[14].Value = "0";
                                                this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[15].Value = "0";
                                            }
                                            else
                                            {
                                                if (sChoPhepTangCaTruocGioLamViecTuDongQuaDem == "True")
                                                {
                                                    int iThoiGianTruocGioLamTuDongQuaDem;
                                                    iThoiGianTruocGioLamTuDongQuaDem = Convert.ToInt32(Convert.ToInt32((dGioVaoKhaiBaoTuDongQuaDemB - dGioVaoTuDongQuaDem).TotalMinutes).ToString());
                                                    if (iThoiGianTruocGioLamTuDongQuaDem > 0 && iThoiGianTruocGioLamTuDongQuaDem > iPhutTangCaTruocGioLamViecTuDongQuaDem && iThoiGianTruocGioLamTuDongQuaDem > iPhutTangCaTruocGioLamViecDatDen)
                                                    {
                                                        iTongGioTangCaTruocTuDongQuaDem = iThoiGianTruocGioLamTuDongQuaDem - iPhutTruTangCaTruoc;
                                                    }
                                                }
                                                if (sChoPhepTangCaSauGioLamViecTuDongQuaDem == "True")
                                                {
                                                    int iThoiGianSauGioLamViecTuDongQuaDem;
                                                    iThoiGianSauGioLamViecTuDongQuaDem = Convert.ToInt32(Convert.ToInt32((dGioRaTuDongQuaDem - dGioRaKhaiBaoTuDongQuaDemB).TotalMinutes).ToString());
                                                    if (iThoiGianSauGioLamViecTuDongQuaDem > 0 && iThoiGianSauGioLamViecTuDongQuaDem > iPhutTangCaSauGioLamViecTuDongQuaDem && iThoiGianSauGioLamViecTuDongQuaDem > iPhutTangCaSauGioLamViecDatDen)
                                                    {
                                                        iTongGioTangCaSauTuDongQuaDem = iThoiGianSauGioLamViecTuDongQuaDem - iPhutTruTangCaSau;
                                                    }
                                                }
                                            }
                                            double dTongThoiGianTangCaTuDongQuaDem;
                                            dTongThoiGianTangCaTuDongQuaDem = Convert.ToDouble(iTongGioTangCaTruocTuDongQuaDem + iTongGioTangCaSauTuDongQuaDem);
                                            if (dTongThoiGianTangCaTuDongQuaDem > 0.0)
                                            {
                                                if (iGioiHanTC1TuDongQuaDem == 0)
                                                {
                                                    this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[12].Value = Math.Round(dTongThoiGianTangCaTuDongQuaDem * this.dTangCa1HeSo / 60.0, this.iLamTronGio);
                                                    this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[13].Value = "0";
                                                    this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[14].Value = "0";
                                                    this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[15].Value = "0";
                                                }
                                                if (iGioiHanTC1TuDongQuaDem != 0 && iGioiHanTC2TuDongQuaDem == 0)
                                                {
                                                    if (dTongThoiGianTangCaTuDongQuaDem < Convert.ToDouble(iGioiHanTC1TuDongQuaDem))
                                                    {
                                                        this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[12].Value = Math.Round(dTongThoiGianTangCaTuDongQuaDem * this.dTangCa1HeSo / 60.0, this.iLamTronGio);
                                                        this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[13].Value = "0";
                                                        this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[14].Value = "0";
                                                        this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[15].Value = "0";
                                                    }
                                                    else
                                                    {
                                                        this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[12].Value = Math.Round(Convert.ToDouble(iGioiHanTC1TuDongQuaDem) / 60.0 * this.dTangCa1HeSo, this.iLamTronGio);
                                                        if (dTongThoiGianTangCaTuDongQuaDem - Convert.ToDouble(iGioiHanTC1TuDongQuaDem) > 0.0)
                                                        {
                                                            this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[13].Value = Math.Round((dTongThoiGianTangCaTuDongQuaDem - Convert.ToDouble(iGioiHanTC1TuDongQuaDem)) * this.dTangCa2HeSo / 60.0, this.iLamTronGio);
                                                        }
                                                        this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[14].Value = "0";
                                                        this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[15].Value = "0";
                                                    }
                                                }
                                                if (iGioiHanTC1TuDongQuaDem != 0 && iGioiHanTC2TuDongQuaDem != 0 && iGioiHanTC3TuDongQuaDem == 0)
                                                {
                                                    if (dTongThoiGianTangCaTuDongQuaDem < Convert.ToDouble(iGioiHanTC1TuDongQuaDem))
                                                    {
                                                        this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[12].Value = Math.Round(dTongThoiGianTangCaTuDongQuaDem * this.dTangCa1HeSo / 60.0, this.iLamTronGio);
                                                        this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[13].Value = "0";
                                                        this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[14].Value = "0";
                                                        this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[15].Value = "0";
                                                    }
                                                    else
                                                    {
                                                        this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[12].Value = Math.Round(Convert.ToDouble(iGioiHanTC1TuDongQuaDem) * this.dTangCa1HeSo / 60.0, this.iLamTronGio);
                                                        if (dTongThoiGianTangCaTuDongQuaDem - Convert.ToDouble(iGioiHanTC1TuDongQuaDem) < Convert.ToDouble(iGioiHanTC2TuDongQuaDem))
                                                        {
                                                            this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[13].Value = Math.Round((dTongThoiGianTangCaTuDongQuaDem - Convert.ToDouble(iGioiHanTC1TuDongQuaDem)) * this.dTangCa2HeSo / 60.0, this.iLamTronGio);
                                                            this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[14].Value = "0";
                                                            this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[15].Value = "0";
                                                        }
                                                        else
                                                        {
                                                            this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[12].Value = Math.Round(Convert.ToDouble(iGioiHanTC1TuDongQuaDem) * this.dTangCa1HeSo / 60.0, this.iLamTronGio);
                                                            this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[13].Value = Math.Round(Convert.ToDouble(iGioiHanTC2TuDongQuaDem) * this.dTangCa2HeSo / 60.0, this.iLamTronGio);
                                                            this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[14].Value = Math.Round((dTongThoiGianTangCaTuDongQuaDem - Convert.ToDouble(iGioiHanTC1TuDongQuaDem) - Convert.ToDouble(iGioiHanTC2TuDongQuaDem)) * this.dTangCa3HeSo / 60.0, this.iLamTronGio);
                                                            this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[15].Value = "0";
                                                        }
                                                    }
                                                }
                                                if (iGioiHanTC1TuDongQuaDem != 0 && iGioiHanTC2TuDongQuaDem != 0 && iGioiHanTC3TuDongQuaDem != 0 && iGioiHanTC4TuDongQuaDem != 0)
                                                {
                                                }
                                            }
                                            else
                                            {
                                                this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[12].Value = "0";
                                                this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[13].Value = "0";
                                                this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[14].Value = "0";
                                                this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[15].Value = "0";
                                            }
                                        }
                                        if (DateTimeProgress.XuatIDThu((int)dt.AddDays(dem).DayOfWeek) == "0")
                                        {
                                            this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[19].Value = "CN";
                                        }
                                        else
                                        {
                                            this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[19].Value = "NT";
                                        }
                                        this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[20].Value = this.sMaChamCong;
                                        this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[21].Value = this.sPhongBanTinhCong;
                                        break;
                                    }
                                    continue;
                                }
                                DateTime dGioNgayHomTruoc2;
                                dGioNgayHomTruoc2 = default(DateTime);
                                DateTime dNgayTruocTuDongQuaDem;
                                dNgayTruocTuDongQuaDem = Convert.ToDateTime(dt.AddDays(dem - 1).ToString());
                                new DataTable();
                                DataTable dtNgayTruocTuDongQuaDem;
                                dtNgayTruocTuDongQuaDem = this._checkInOutBLL.getCheckInOutByMaChamCongAndNgayCham(Convert.ToInt32(this.sMaChamCong), dNgayTruocTuDongQuaDem);
                                for (int iNgayTruocTuDongQuaDem = 0; iNgayTruocTuDongQuaDem < dtNgayTruocTuDongQuaDem.Rows.Count; iNgayTruocTuDongQuaDem++)
                                {
                                    dGioNgayHomTruoc2 = Convert.ToDateTime(dtNgayTruocTuDongQuaDem.Rows[iNgayTruocTuDongQuaDem]["GioCham"].ToString());
                                }
                                if (dtNgayTruocTuDongQuaDem.Rows.Count != 0 && this.DGVTinhCong.Rows[_nhanVien - 1].Cells[5].Value != null && this.DGVTinhCong.Rows[_nhanVien - 1].Cells[6].Value == null)
                                {
                                    if (dtNgayTruocTuDongQuaDem.Rows.Count % 2 != 0 && this.DGVTinhCong.Rows[_nhanVien - 1].Cells[5].Value != null && this.DGVTinhCong.Rows[_nhanVien - 1].Cells[6].Value == null)
                                    {
                                        DateTime dGioRaNgayTruocTuDongQuaDem;
                                        dGioRaNgayTruocTuDongQuaDem = Convert.ToDateTime(dtTuDongQuaDem.Rows[iTuDongQuaDem]["GioCham"].ToString());
                                        this.DGVTinhCong.Rows[_nhanVien - 1].Cells[6].Value = string.Format(this.sDinhDangThoiGian, dGioRaNgayTruocTuDongQuaDem);
                                        demTuDongQuaDem--;
                                        new DataTable();
                                        this._chiTietLichTrinhChoCalamViecDTO.MaLichTrinhCaLamViec = sLTCCLVNhanVien;
                                        this._chiTietLichTrinhChoCalamViecDTO.Thu = sThu;
                                        DataTable dtNhanCaTuDongQuaDem4;
                                        dtNhanCaTuDongQuaDem4 = this._chiTietLichTrinhChoCaLamViecBLL.ChiTietLichTrinhChoCaLamViecNhanCa(this._chiTietLichTrinhChoCalamViecDTO);
                                        int iChiTietLichTrinhChoCaLamViecTuDongQuaDem4;
                                        iChiTietLichTrinhChoCaLamViecTuDongQuaDem4 = 0;
                                        if (iChiTietLichTrinhChoCaLamViecTuDongQuaDem4 >= dtNhanCaTuDongQuaDem4.Rows.Count)
                                        {
                                            continue;
                                        }
                                        int cellChiTietLichTrinhChoCaLamViecTuDongQuaDem4;
                                        cellChiTietLichTrinhChoCaLamViecTuDongQuaDem4 = 3;
                                        while (true)
                                        {
                                            if (cellChiTietLichTrinhChoCaLamViecTuDongQuaDem4 < 13)
                                            {
                                                kiemTraVao = 0;
                                                kiemTraRa = 0;
                                                this.sTuDongQuaDemMaCaLamViec = dtNhanCaTuDongQuaDem4.Rows[iChiTietLichTrinhChoCaLamViecTuDongQuaDem4][cellChiTietLichTrinhChoCaLamViecTuDongQuaDem4].ToString();
                                                new DataTable();
                                                DataTable dtTuDongQuaDemCa11;
                                                dtTuDongQuaDemCa11 = this._caLamViecBLL.CaLamViecGetByMaCaLamViec(sTuDongQuaDemMaCaLamViec);
                                                int iTuDongQuaDemCa11;
                                                iTuDongQuaDemCa11 = 0;
                                                while (iTuDongQuaDemCa11 < dtTuDongQuaDemCa11.Rows.Count)
                                                {
                                                    this.sTuDongQuaDemTenCaLamViec = dtTuDongQuaDemCa11.Rows[iTuDongQuaDemCa11]["CaLamViec"].ToString();
                                                    DateTime dBatDauVaoTuDongQuaDemB;
                                                    dBatDauVaoTuDongQuaDemB = Convert.ToDateTime(sNgayCham + " " + string.Format("{0:T}", Convert.ToDateTime(dtTuDongQuaDemCa11.Rows[iTuDongQuaDemCa11]["BatDauVao"].ToString()))).AddDays(-1.0);
                                                    DateTime dKetThucVaoTuDongQuaDemB;
                                                    dKetThucVaoTuDongQuaDemB = Convert.ToDateTime(sNgayCham + " " + string.Format("{0:T}", Convert.ToDateTime(dtTuDongQuaDemCa11.Rows[iTuDongQuaDemCa11]["KetThucVao"].ToString()))).AddDays(-1.0);
                                                    string sBatDauRaTuDongQuaDemA;
                                                    sBatDauRaTuDongQuaDemA = string.Format("{0:T}", Convert.ToDateTime(dtTuDongQuaDemCa11.Rows[iTuDongQuaDemCa11]["BatDauRa"].ToString()));
                                                    string sBatDauRaTuDongQuaDemB;
                                                    sBatDauRaTuDongQuaDemB = sNgayCham + " " + sBatDauRaTuDongQuaDemA;
                                                    DateTime dBatDauRaTuDongQuaDemB;
                                                    dBatDauRaTuDongQuaDemB = Convert.ToDateTime(sBatDauRaTuDongQuaDemB).AddDays(-1.0);
                                                    dBatDauRaTuDongQuaDemB = ((!(sBatDauRaTuDongQuaDemA == "12:01:00 AM")) ? Convert.ToDateTime(sBatDauRaTuDongQuaDemB) : Convert.ToDateTime(dBatDauRaTuDongQuaDemB.AddDays(1.0).ToString()));
                                                    string sKetThucRaTuDongQuaDemB;
                                                    sKetThucRaTuDongQuaDemB = sNgayCham + " " + string.Format("{0:T}", Convert.ToDateTime(dtTuDongQuaDemCa11.Rows[iTuDongQuaDemCa11]["KetThucRa"].ToString()));
                                                    DateTime dKetThucRaTuDongQuaDemB;
                                                    dKetThucRaTuDongQuaDemB = Convert.ToDateTime(sKetThucRaTuDongQuaDemB).AddDays(-1.0);
                                                    dKetThucRaTuDongQuaDemB = ((!(sBatDauRaTuDongQuaDemA == "12:01:00 AM")) ? Convert.ToDateTime(sKetThucRaTuDongQuaDemB) : Convert.ToDateTime(dKetThucRaTuDongQuaDemB.AddDays(1.0).ToString()));
                                                    if (dGioNgayHomTruoc2 >= dBatDauVaoTuDongQuaDemB && dGioNgayHomTruoc2 <= dKetThucVaoTuDongQuaDemB)
                                                    {
                                                        kiemTraVao++;
                                                    }
                                                    if (dGioRaNgayTruocTuDongQuaDem >= dBatDauRaTuDongQuaDemB && dGioRaNgayTruocTuDongQuaDem <= dKetThucRaTuDongQuaDemB)
                                                    {
                                                        kiemTraRa++;
                                                    }
                                                    if (kiemTraVao != 1 || kiemTraRa != 1)
                                                    {
                                                        iTuDongQuaDemCa11++;
                                                        continue;
                                                    }
                                                    goto IL_3b2d9;
                                                }
                                                if (!(this.sTuDongQuaDemMaCaLamViec == ""))
                                                {
                                                    cellChiTietLichTrinhChoCaLamViecTuDongQuaDem4++;
                                                    continue;
                                                }
                                                this.DGVTinhCong.Rows[_nhanVien - 1].Cells[4].Value = ca;
                                                this.DGVTinhCong.Rows[_nhanVien - 1].Cells[7].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien - 1].Cells[8].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien - 1].Cells[9].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien - 1].Cells[10].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien - 1].Cells[11].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien - 1].Cells[12].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien - 1].Cells[13].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien - 1].Cells[14].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien - 1].Cells[15].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien - 1].Cells[16].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien - 1].Cells[17].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien - 1].Cells[18].Value = this.sKHVang;
                                                if (DateTimeProgress.XuatThuQuaDem((int)dt.AddDays(dem).DayOfWeek) == "1")
                                                {
                                                    this.DGVTinhCong.Rows[_nhanVien - 1].Cells[19].Value = "CN";
                                                }
                                                else
                                                {
                                                    this.DGVTinhCong.Rows[_nhanVien - 1].Cells[19].Value = "NT";
                                                }
                                                this.DGVTinhCong.Rows[_nhanVien - 1].Cells[20].Value = this.sMaChamCong;
                                                this.DGVTinhCong.Rows[_nhanVien - 1].Cells[21].Value = this.sPhongBanTinhCong;
                                                break;
                                            }
                                            goto IL_3b2d9;
                                        IL_3b2d9:
                                            this.DGVTinhCong.Rows[_nhanVien - 1].Cells[4].Value = this.sTuDongQuaDemTenCaLamViec;
                                            new DataTable();
                                            DataTable dtThongSoCaLamViecTuDongQuaDem;
                                            dtThongSoCaLamViecTuDongQuaDem = this._caLamViecBLL.CaLamViecGetByMaCaLamViec(sTuDongQuaDemMaCaLamViec);
                                            for (int iThongSoCaLamViecTuDongQuaDem = 0; iThongSoCaLamViecTuDongQuaDem < dtThongSoCaLamViecTuDongQuaDem.Rows.Count; iThongSoCaLamViecTuDongQuaDem++)
                                            {
                                                double dTongGioTuDongQuaDem;
                                                dTongGioTuDongQuaDem = Math.Round(Convert.ToDouble(Convert.ToInt32((dGioRaNgayTruocTuDongQuaDem - dGioNgayHomTruoc2).TotalMinutes)) / 60.0, this.iLamTronGio);
                                                this.DGVTinhCong.Rows[_nhanVien - 1].Cells[16].Value = dTongGioTuDongQuaDem.ToString();
                                                this.DGVTinhCong.Rows[_nhanVien - 1].Cells[17].Value = dtThongSoCaLamViecTuDongQuaDem.Rows[iThongSoCaLamViecTuDongQuaDem]["CongTinh"].ToString();
                                                string sGiayGioVao7;
                                                sGiayGioVao7 = dGioNgayHomTruoc2.Second.ToString();
                                                string sGiayGioRa7;
                                                sGiayGioRa7 = dGioRaNgayTruocTuDongQuaDem.Second.ToString();
                                                string sGioVaoKhaiBaoTuDongQuaDemB;
                                                sGioVaoKhaiBaoTuDongQuaDemB = sNgayCham + " " + string.Format("{0:T}", Convert.ToDateTime(dtThongSoCaLamViecTuDongQuaDem.Rows[iThongSoCaLamViecTuDongQuaDem]["GioVaoLamViec"].ToString())).Replace("00 ", sGiayGioVao7 + " ");
                                                string sGioRaKhaiBaoTuDongQuaDemB;
                                                sGioRaKhaiBaoTuDongQuaDemB = sNgayCham + " " + string.Format("{0:T}", Convert.ToDateTime(dtThongSoCaLamViecTuDongQuaDem.Rows[iThongSoCaLamViecTuDongQuaDem]["GioKetThucLamViec"].ToString())).Replace("00 ", sGiayGioRa7 + " ");
                                                string sCatChuoi;
                                                sCatChuoi = sGioRaKhaiBaoTuDongQuaDemB.Substring(sGioRaKhaiBaoTuDongQuaDemB.Length - 2);
                                                string sTruGioDiTre5;
                                                sTruGioDiTre5 = dtThongSoCaLamViecTuDongQuaDem.Rows[iThongSoCaLamViecTuDongQuaDem]["TruGioDiTre"].ToString();
                                                string sBatDauTinhDiTre5;
                                                sBatDauTinhDiTre5 = dtThongSoCaLamViecTuDongQuaDem.Rows[iThongSoCaLamViecTuDongQuaDem]["BatDauTinhDiTre"].ToString();
                                                if (sTruGioDiTre5 == "True")
                                                {
                                                    int iChoPhepTreTuDongQuaDem;
                                                    iChoPhepTreTuDongQuaDem = Convert.ToInt32(dtThongSoCaLamViecTuDongQuaDem.Rows[iThongSoCaLamViecTuDongQuaDem]["ChoPhepDiTre"].ToString());
                                                    if (sBatDauTinhDiTre5 == "True")
                                                    {
                                                        int iPhutTreTuDongQuaDem;
                                                        iPhutTreTuDongQuaDem = Convert.ToInt32((dGioNgayHomTruoc2 - Convert.ToDateTime(sGioVaoKhaiBaoTuDongQuaDemB).AddDays(-1.0)).TotalMinutes) - iChoPhepTreTuDongQuaDem;
                                                        if (iPhutTreTuDongQuaDem > 0)
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien - 1].Cells[5].Style.BackColor = Color.Lime;
                                                            this.DGVTinhCong.Rows[_nhanVien - 1].Cells[9].Value = iPhutTreTuDongQuaDem.ToString();
                                                        }
                                                        else
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien - 1].Cells[9].Value = "0";
                                                        }
                                                    }
                                                    else if (Convert.ToInt32((dGioNgayHomTruoc2 - Convert.ToDateTime(sGioVaoKhaiBaoTuDongQuaDemB).AddDays(-1.0)).TotalMinutes) - iChoPhepTreTuDongQuaDem > 0)
                                                    {
                                                        this.DGVTinhCong.Rows[_nhanVien - 1].Cells[9].Value = Convert.ToInt32((dGioNgayHomTruoc2 - Convert.ToDateTime(sGioVaoKhaiBaoTuDongQuaDemB).AddDays(-1.0)).TotalMinutes).ToString();
                                                    }
                                                    else
                                                    {
                                                        this.DGVTinhCong.Rows[_nhanVien - 1].Cells[9].Value = "0";
                                                    }
                                                }
                                                else
                                                {
                                                    this.DGVTinhCong.Rows[_nhanVien - 1].Cells[9].Value = "0";
                                                }
                                                string sTruGioVeSom5;
                                                sTruGioVeSom5 = dtThongSoCaLamViecTuDongQuaDem.Rows[iThongSoCaLamViecTuDongQuaDem]["TruGioVeSom"].ToString();
                                                string sBatDauTinhVeSom5;
                                                sBatDauTinhVeSom5 = dtThongSoCaLamViecTuDongQuaDem.Rows[iThongSoCaLamViecTuDongQuaDem]["BatDauTinhVeSom"].ToString();
                                                if (sTruGioVeSom5 == "True")
                                                {
                                                    int iChoPhepVeSomTuDongQuaDem;
                                                    iChoPhepVeSomTuDongQuaDem = Convert.ToInt32(dtThongSoCaLamViecTuDongQuaDem.Rows[iThongSoCaLamViecTuDongQuaDem]["ChoPhepVeSom"].ToString());
                                                    if (sBatDauTinhVeSom5 == "True")
                                                    {
                                                        if (sCatChuoi == "PM")
                                                        {
                                                            int iPhutVeSomTuDongQuaDem;
                                                            iPhutVeSomTuDongQuaDem = Convert.ToInt32((Convert.ToDateTime(sGioRaKhaiBaoTuDongQuaDemB).AddDays(-1.0) - dGioRaNgayTruocTuDongQuaDem).TotalMinutes) - iChoPhepVeSomTuDongQuaDem;
                                                            if (iPhutVeSomTuDongQuaDem > 0)
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien - 1].Cells[6].Style.BackColor = Color.Yellow;
                                                                this.DGVTinhCong.Rows[_nhanVien - 1].Cells[10].Value = iPhutVeSomTuDongQuaDem.ToString();
                                                            }
                                                            else
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien - 1].Cells[10].Value = "0";
                                                            }
                                                        }
                                                        else
                                                        {
                                                            int iPhutVeSomTuDongQuaDem2;
                                                            iPhutVeSomTuDongQuaDem2 = Convert.ToInt32((Convert.ToDateTime(sGioRaKhaiBaoTuDongQuaDemB) - dGioRaNgayTruocTuDongQuaDem).TotalMinutes) - iChoPhepVeSomTuDongQuaDem;
                                                            if (iPhutVeSomTuDongQuaDem2 > 0)
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien - 1].Cells[6].Style.BackColor = Color.Yellow;
                                                                this.DGVTinhCong.Rows[_nhanVien - 1].Cells[10].Value = iPhutVeSomTuDongQuaDem2.ToString();
                                                            }
                                                            else
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien - 1].Cells[10].Value = "0";
                                                            }
                                                        }
                                                    }
                                                    else if (Convert.ToInt32((Convert.ToDateTime(sGioRaKhaiBaoTuDongQuaDemB) - dGioRaNgayTruocTuDongQuaDem).TotalMinutes) - iChoPhepVeSomTuDongQuaDem > 0)
                                                    {
                                                        this.DGVTinhCong.Rows[_nhanVien - 1].Cells[10].Value = Convert.ToInt32((Convert.ToDateTime(sGioRaKhaiBaoTuDongQuaDemB) - dGioRaNgayTruocTuDongQuaDem).TotalMinutes).ToString();
                                                    }
                                                    else
                                                    {
                                                        this.DGVTinhCong.Rows[_nhanVien - 1].Cells[10].Value = "0";
                                                    }
                                                }
                                                else
                                                {
                                                    this.DGVTinhCong.Rows[_nhanVien - 1].Cells[10].Value = "0";
                                                }
                                                if (sCatChuoi == "PM")
                                                {
                                                    int iPhutVeTre;
                                                    iPhutVeTre = Convert.ToInt32((dGioRaNgayTruocTuDongQuaDem - Convert.ToDateTime(sGioRaKhaiBaoTuDongQuaDemB).AddDays(-1.0)).TotalMinutes);
                                                    if (iPhutVeTre > 0)
                                                    {
                                                        this.DGVTinhCong.Rows[_nhanVien - 1].Cells[11].Value = iPhutVeTre;
                                                    }
                                                    else
                                                    {
                                                        this.DGVTinhCong.Rows[_nhanVien - 1].Cells[11].Value = "0";
                                                    }
                                                }
                                                else
                                                {
                                                    int iPhutVeTre2;
                                                    iPhutVeTre2 = Convert.ToInt32((dGioRaNgayTruocTuDongQuaDem - Convert.ToDateTime(sGioRaKhaiBaoTuDongQuaDemB)).TotalMinutes);
                                                    if (iPhutVeTre2 > 0)
                                                    {
                                                        this.DGVTinhCong.Rows[_nhanVien - 1].Cells[11].Value = iPhutVeTre2;
                                                    }
                                                    else
                                                    {
                                                        this.DGVTinhCong.Rows[_nhanVien - 1].Cells[11].Value = "0";
                                                    }
                                                }
                                                double dTongGioTrongCaTuDongQuaDem;
                                                dTongGioTrongCaTuDongQuaDem = Convert.ToDouble(dtThongSoCaLamViecTuDongQuaDem.Rows[iThongSoCaLamViecTuDongQuaDem]["TongGioTrongCaLamViec"].ToString());
                                                double dTongCongTrongCaTuDongQuaDem;
                                                dTongCongTrongCaTuDongQuaDem = Convert.ToDouble(dtThongSoCaLamViecTuDongQuaDem.Rows[iThongSoCaLamViecTuDongQuaDem]["CongTinh"].ToString());
                                                double dTongPhutTreSomTuDongQuaDem;
                                                dTongPhutTreSomTuDongQuaDem = Convert.ToDouble(this.DGVTinhCong.Rows[_nhanVien - 1].Cells[9].Value.ToString()) + Convert.ToDouble(this.DGVTinhCong.Rows[_nhanVien - 1].Cells[10].Value.ToString());
                                                this.DGVTinhCong.Rows[_nhanVien - 1].Cells[8].Value = Math.Round((dTongGioTrongCaTuDongQuaDem * 60.0 - dTongPhutTreSomTuDongQuaDem) / 60.0, this.iLamTronGio);
                                                this.DGVTinhCong.Rows[_nhanVien - 1].Cells[7].Value = Math.Round(Convert.ToDouble(this.DGVTinhCong.Rows[_nhanVien - 1].Cells[8].Value.ToString()) * dTongCongTrongCaTuDongQuaDem / dTongGioTrongCaTuDongQuaDem, this.iLamTronCong);
                                                string sChoPhepTangCaTruocGioLamViecTuDongQuaDem3;
                                                sChoPhepTangCaTruocGioLamViecTuDongQuaDem3 = dtThongSoCaLamViecTuDongQuaDem.Rows[iThongSoCaLamViecTuDongQuaDem]["TangCaTruocGioLamViec"].ToString();
                                                int iPhutTangCaTruocGioLamViecTuDongQuaDem3;
                                                iPhutTangCaTruocGioLamViecTuDongQuaDem3 = Convert.ToInt32(dtThongSoCaLamViecTuDongQuaDem.Rows[iThongSoCaLamViecTuDongQuaDem]["SoPhutTangCaTruocGioLamViec"].ToString());
                                                int iPhutTangCaTruocGioLamViecDatDen4;
                                                iPhutTangCaTruocGioLamViecDatDen4 = Convert.ToInt32(dtThongSoCaLamViecTuDongQuaDem.Rows[iThongSoCaLamViecTuDongQuaDem]["TangCaTruocGioLamViecDatDen"].ToString());
                                                int iPhutTruTangCaTruoc4;
                                                iPhutTruTangCaTruoc4 = Convert.ToInt32(dtThongSoCaLamViecTuDongQuaDem.Rows[iThongSoCaLamViecTuDongQuaDem]["PhutTruTangCaTruoc"].ToString());
                                                string sChoPhepTangCaSauGioLamViecTuDongQuaDem3;
                                                sChoPhepTangCaSauGioLamViecTuDongQuaDem3 = dtThongSoCaLamViecTuDongQuaDem.Rows[iThongSoCaLamViecTuDongQuaDem]["TangCaSauGioLamViec"].ToString();
                                                int iPhutTangCaSauGioLamViecTuDongQuaDem3;
                                                iPhutTangCaSauGioLamViecTuDongQuaDem3 = Convert.ToInt32(dtThongSoCaLamViecTuDongQuaDem.Rows[iThongSoCaLamViecTuDongQuaDem]["SoPhutTangCaSauGioLamViec"].ToString());
                                                int iPhutTangCaSauGioLamViecDatDen4;
                                                iPhutTangCaSauGioLamViecDatDen4 = Convert.ToInt32(dtThongSoCaLamViecTuDongQuaDem.Rows[iThongSoCaLamViecTuDongQuaDem]["TangCaSauGioLamViecDatDen"].ToString());
                                                int iPhutTruTangCaSau4;
                                                iPhutTruTangCaSau4 = Convert.ToInt32(dtThongSoCaLamViecTuDongQuaDem.Rows[iThongSoCaLamViecTuDongQuaDem]["PhutTruTangCaSau"].ToString());
                                                int iGioiHanTC1TuDongQuaDem3;
                                                iGioiHanTC1TuDongQuaDem3 = Convert.ToInt32(dtThongSoCaLamViecTuDongQuaDem.Rows[iThongSoCaLamViecTuDongQuaDem]["GioiHanTangCa1"].ToString());
                                                int iGioiHanTC2TuDongQuaDem3;
                                                iGioiHanTC2TuDongQuaDem3 = Convert.ToInt32(dtThongSoCaLamViecTuDongQuaDem.Rows[iThongSoCaLamViecTuDongQuaDem]["GioiHanTangCa2"].ToString());
                                                int iGioiHanTC3TuDongQuaDem3;
                                                iGioiHanTC3TuDongQuaDem3 = Convert.ToInt32(dtThongSoCaLamViecTuDongQuaDem.Rows[iThongSoCaLamViecTuDongQuaDem]["GioiHanTangCa3"].ToString());
                                                int iGioiHanTC4TuDongQuaDem3;
                                                iGioiHanTC4TuDongQuaDem3 = Convert.ToInt32(dtThongSoCaLamViecTuDongQuaDem.Rows[iThongSoCaLamViecTuDongQuaDem]["GioiHanTangCa4"].ToString());
                                                int iTongGioTangCaSauTuDongQuaDem3;
                                                iTongGioTangCaSauTuDongQuaDem3 = 0;
                                                int iTongGioTangCaTruocTuDongQuaDem3;
                                                iTongGioTangCaTruocTuDongQuaDem3 = 0;
                                                if (sChoPhepTangCaTruocGioLamViecTuDongQuaDem3 == "False" && sChoPhepTangCaSauGioLamViecTuDongQuaDem3 == "False")
                                                {
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                }
                                                else
                                                {
                                                    if (sChoPhepTangCaTruocGioLamViecTuDongQuaDem3 == "True")
                                                    {
                                                        int iThoiGianTruocGioLamTuDongQuaDem3;
                                                        iThoiGianTruocGioLamTuDongQuaDem3 = Convert.ToInt32(Convert.ToInt32((Convert.ToDateTime(sGioVaoKhaiBaoTuDongQuaDemB).AddDays(-1.0) - dGioNgayHomTruoc2).TotalMinutes).ToString());
                                                        if (iThoiGianTruocGioLamTuDongQuaDem3 > 0 && iThoiGianTruocGioLamTuDongQuaDem3 > iPhutTangCaTruocGioLamViecTuDongQuaDem3 && iThoiGianTruocGioLamTuDongQuaDem3 > iPhutTangCaTruocGioLamViecDatDen4)
                                                        {
                                                            iTongGioTangCaTruocTuDongQuaDem3 = iThoiGianTruocGioLamTuDongQuaDem3 - iPhutTruTangCaTruoc4;
                                                        }
                                                    }
                                                    if (sChoPhepTangCaSauGioLamViecTuDongQuaDem3 == "True")
                                                    {
                                                        if (sCatChuoi == "PM")
                                                        {
                                                            int iThoiGianSauGioLamViecTuDongQuaDem3;
                                                            iThoiGianSauGioLamViecTuDongQuaDem3 = Convert.ToInt32(Convert.ToInt32((dGioRaNgayTruocTuDongQuaDem - Convert.ToDateTime(sGioRaKhaiBaoTuDongQuaDemB).AddDays(-1.0)).TotalMinutes).ToString());
                                                            if (iThoiGianSauGioLamViecTuDongQuaDem3 > 0 && iThoiGianSauGioLamViecTuDongQuaDem3 > iPhutTangCaSauGioLamViecTuDongQuaDem3 && iThoiGianSauGioLamViecTuDongQuaDem3 > iPhutTangCaSauGioLamViecDatDen4)
                                                            {
                                                                iTongGioTangCaSauTuDongQuaDem3 = iThoiGianSauGioLamViecTuDongQuaDem3 - iPhutTruTangCaSau4;
                                                            }
                                                        }
                                                        else
                                                        {
                                                            int iThoiGianSauGioLamViecTuDongQuaDem4;
                                                            iThoiGianSauGioLamViecTuDongQuaDem4 = Convert.ToInt32(Convert.ToInt32((dGioRaNgayTruocTuDongQuaDem - Convert.ToDateTime(sGioRaKhaiBaoTuDongQuaDemB)).TotalMinutes).ToString());
                                                            if (iThoiGianSauGioLamViecTuDongQuaDem4 > 0 && iThoiGianSauGioLamViecTuDongQuaDem4 > iPhutTangCaSauGioLamViecTuDongQuaDem3 && iThoiGianSauGioLamViecTuDongQuaDem4 > iPhutTangCaSauGioLamViecDatDen4)
                                                            {
                                                                iTongGioTangCaSauTuDongQuaDem3 = iThoiGianSauGioLamViecTuDongQuaDem4 - iPhutTruTangCaSau4;
                                                            }
                                                        }
                                                    }
                                                }
                                                double dTongThoiGianTangCaTuDongQuaDem3;
                                                dTongThoiGianTangCaTuDongQuaDem3 = Convert.ToDouble(iTongGioTangCaTruocTuDongQuaDem3 + iTongGioTangCaSauTuDongQuaDem3);
                                                if (dTongThoiGianTangCaTuDongQuaDem3 > 0.0)
                                                {
                                                    if (iGioiHanTC1TuDongQuaDem3 == 0)
                                                    {
                                                        this.DGVTinhCong.Rows[_nhanVien - 1].Cells[12].Value = Math.Round(dTongThoiGianTangCaTuDongQuaDem3 * this.dTangCa1HeSo / 60.0, this.iLamTronGio);
                                                        this.DGVTinhCong.Rows[_nhanVien - 1].Cells[13].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien - 1].Cells[14].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien - 1].Cells[15].Value = "0";
                                                    }
                                                    if (iGioiHanTC1TuDongQuaDem3 != 0 && iGioiHanTC2TuDongQuaDem3 == 0)
                                                    {
                                                        if (dTongThoiGianTangCaTuDongQuaDem3 < Convert.ToDouble(iGioiHanTC1TuDongQuaDem3))
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien - 1].Cells[12].Value = Math.Round(dTongThoiGianTangCaTuDongQuaDem3 * this.dTangCa1HeSo / 60.0, this.iLamTronGio);
                                                            this.DGVTinhCong.Rows[_nhanVien - 1].Cells[13].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien - 1].Cells[14].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien - 1].Cells[15].Value = "0";
                                                        }
                                                        else
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien - 1].Cells[12].Value = Math.Round(Convert.ToDouble(iGioiHanTC1TuDongQuaDem3) / 60.0 * this.dTangCa1HeSo, this.iLamTronGio);
                                                            if (dTongThoiGianTangCaTuDongQuaDem3 - Convert.ToDouble(iGioiHanTC1TuDongQuaDem3) > 0.0)
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien - 1].Cells[13].Value = Math.Round((dTongThoiGianTangCaTuDongQuaDem3 - Convert.ToDouble(iGioiHanTC1TuDongQuaDem3)) * this.dTangCa2HeSo / 60.0, this.iLamTronGio);
                                                            }
                                                            this.DGVTinhCong.Rows[_nhanVien - 1].Cells[14].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien - 1].Cells[15].Value = "0";
                                                        }
                                                    }
                                                    if (iGioiHanTC1TuDongQuaDem3 != 0 && iGioiHanTC2TuDongQuaDem3 != 0 && iGioiHanTC3TuDongQuaDem3 == 0)
                                                    {
                                                        if (dTongThoiGianTangCaTuDongQuaDem3 < Convert.ToDouble(iGioiHanTC1TuDongQuaDem3))
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien - 1].Cells[12].Value = Math.Round(dTongThoiGianTangCaTuDongQuaDem3 * this.dTangCa1HeSo / 60.0, this.iLamTronGio);
                                                            this.DGVTinhCong.Rows[_nhanVien - 1].Cells[13].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien - 1].Cells[14].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien - 1].Cells[15].Value = "0";
                                                        }
                                                        else
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien - 1].Cells[12].Value = Math.Round(Convert.ToDouble(iGioiHanTC1TuDongQuaDem3) * this.dTangCa1HeSo / 60.0, this.iLamTronGio);
                                                            if (dTongThoiGianTangCaTuDongQuaDem3 - Convert.ToDouble(iGioiHanTC1TuDongQuaDem3) < Convert.ToDouble(iGioiHanTC2TuDongQuaDem3))
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien - 1].Cells[13].Value = Math.Round((dTongThoiGianTangCaTuDongQuaDem3 - Convert.ToDouble(iGioiHanTC1TuDongQuaDem3)) * this.dTangCa2HeSo / 60.0, this.iLamTronGio);
                                                                this.DGVTinhCong.Rows[_nhanVien - 1].Cells[14].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien - 1].Cells[15].Value = "0";
                                                            }
                                                            else
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien - 1].Cells[12].Value = Math.Round(Convert.ToDouble(iGioiHanTC1TuDongQuaDem3) * this.dTangCa1HeSo / 60.0, this.iLamTronGio);
                                                                this.DGVTinhCong.Rows[_nhanVien - 1].Cells[13].Value = Math.Round(Convert.ToDouble(iGioiHanTC2TuDongQuaDem3) * this.dTangCa2HeSo / 60.0, this.iLamTronGio);
                                                                this.DGVTinhCong.Rows[_nhanVien - 1].Cells[14].Value = Math.Round((dTongThoiGianTangCaTuDongQuaDem3 - Convert.ToDouble(iGioiHanTC1TuDongQuaDem3) - Convert.ToDouble(iGioiHanTC2TuDongQuaDem3)) * this.dTangCa3HeSo / 60.0, this.iLamTronGio);
                                                                this.DGVTinhCong.Rows[_nhanVien - 1].Cells[15].Value = "0";
                                                            }
                                                        }
                                                    }
                                                    if (iGioiHanTC1TuDongQuaDem3 != 0 && iGioiHanTC2TuDongQuaDem3 != 0 && iGioiHanTC3TuDongQuaDem3 != 0 && iGioiHanTC4TuDongQuaDem3 != 0)
                                                    {
                                                    }
                                                }
                                                else
                                                {
                                                    this.DGVTinhCong.Rows[_nhanVien - 1].Cells[12].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien - 1].Cells[13].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien - 1].Cells[14].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien - 1].Cells[15].Value = "0";
                                                }
                                                this.DGVTinhCong.Rows[_nhanVien - 1].Cells[18].Value = this.sKHDungGio;
                                                if (DateTimeProgress.XuatThuQuaDem((int)dt.AddDays(dem).DayOfWeek) == "1")
                                                {
                                                    this.DGVTinhCong.Rows[_nhanVien - 1].Cells[19].Value = "CN";
                                                }
                                                else
                                                {
                                                    this.DGVTinhCong.Rows[_nhanVien - 1].Cells[19].Value = "NT";
                                                }
                                                this.DGVTinhCong.Rows[_nhanVien - 1].Cells[20].Value = this.sMaChamCong;
                                                this.DGVTinhCong.Rows[_nhanVien - 1].Cells[21].Value = this.sPhongBanTinhCong;
                                            }
                                            break;
                                        }
                                    }
                                    else if (dtNgayTruocTuDongQuaDem.Rows.Count % 2 == 0 && this.DGVTinhCong.Rows[_nhanVien - 1].Cells[5].Value != null && this.DGVTinhCong.Rows[_nhanVien - 1].Cells[6].Value == null)
                                    {
                                        DateTime dGioRaNgayTruocTuDongQuaDem2;
                                        dGioRaNgayTruocTuDongQuaDem2 = Convert.ToDateTime(dtTuDongQuaDem.Rows[iTuDongQuaDem]["GioCham"].ToString());
                                        this.DGVTinhCong.Rows[_nhanVien - 1].Cells[6].Value = string.Format(this.sDinhDangThoiGian, dGioRaNgayTruocTuDongQuaDem2);
                                        demTuDongQuaDem--;
                                        new DataTable();
                                        this._chiTietLichTrinhChoCalamViecDTO.MaLichTrinhCaLamViec = sLTCCLVNhanVien;
                                        this._chiTietLichTrinhChoCalamViecDTO.Thu = sThu;
                                        DataTable dtNhanCaTuDongQuaDem5;
                                        dtNhanCaTuDongQuaDem5 = this._chiTietLichTrinhChoCaLamViecBLL.ChiTietLichTrinhChoCaLamViecNhanCa(this._chiTietLichTrinhChoCalamViecDTO);
                                        int iChiTietLichTrinhChoCaLamViecTuDongQuaDem5;
                                        iChiTietLichTrinhChoCaLamViecTuDongQuaDem5 = 0;
                                        if (iChiTietLichTrinhChoCaLamViecTuDongQuaDem5 >= dtNhanCaTuDongQuaDem5.Rows.Count)
                                        {
                                            continue;
                                        }
                                        int cellChiTietLichTrinhChoCaLamViecTuDongQuaDem5;
                                        cellChiTietLichTrinhChoCaLamViecTuDongQuaDem5 = 3;
                                        while (true)
                                        {
                                            if (cellChiTietLichTrinhChoCaLamViecTuDongQuaDem5 < 13)
                                            {
                                                kiemTraVao = 0;
                                                kiemTraRa = 0;
                                                this.sTuDongQuaDemMaCaLamViec = dtNhanCaTuDongQuaDem5.Rows[iChiTietLichTrinhChoCaLamViecTuDongQuaDem5][cellChiTietLichTrinhChoCaLamViecTuDongQuaDem5].ToString();
                                                new DataTable();
                                                DataTable dtTuDongQuaDemCa12;
                                                dtTuDongQuaDemCa12 = this._caLamViecBLL.CaLamViecGetByMaCaLamViec(sTuDongQuaDemMaCaLamViec);
                                                int iTuDongQuaDemCa12;
                                                iTuDongQuaDemCa12 = 0;
                                                while (iTuDongQuaDemCa12 < dtTuDongQuaDemCa12.Rows.Count)
                                                {
                                                    this.sTuDongQuaDemTenCaLamViec = dtTuDongQuaDemCa12.Rows[iTuDongQuaDemCa12]["CaLamViec"].ToString();
                                                    DateTime dBatDauVaoTuDongQuaDemB2;
                                                    dBatDauVaoTuDongQuaDemB2 = Convert.ToDateTime(sNgayCham + " " + string.Format("{0:T}", Convert.ToDateTime(dtTuDongQuaDemCa12.Rows[iTuDongQuaDemCa12]["BatDauVao"].ToString()))).AddDays(-1.0);
                                                    DateTime dKetThucVaoTuDongQuaDemB2;
                                                    dKetThucVaoTuDongQuaDemB2 = Convert.ToDateTime(sNgayCham + " " + string.Format("{0:T}", Convert.ToDateTime(dtTuDongQuaDemCa12.Rows[iTuDongQuaDemCa12]["KetThucVao"].ToString()))).AddDays(-1.0);
                                                    string sBatDauRaTuDongQuaDemA2;
                                                    sBatDauRaTuDongQuaDemA2 = string.Format("{0:T}", Convert.ToDateTime(dtTuDongQuaDemCa12.Rows[iTuDongQuaDemCa12]["BatDauRa"].ToString()));
                                                    string sBatDauRaTuDongQuaDemB2;
                                                    sBatDauRaTuDongQuaDemB2 = sNgayCham + " " + sBatDauRaTuDongQuaDemA2;
                                                    DateTime dBatDauRaTuDongQuaDemB2;
                                                    dBatDauRaTuDongQuaDemB2 = Convert.ToDateTime(sBatDauRaTuDongQuaDemB2).AddDays(-1.0);
                                                    dBatDauRaTuDongQuaDemB2 = ((!(sBatDauRaTuDongQuaDemA2 == "12:01:00 AM")) ? Convert.ToDateTime(sBatDauRaTuDongQuaDemB2) : Convert.ToDateTime(dBatDauRaTuDongQuaDemB2.AddDays(1.0).ToString()));
                                                    string sKetThucRaTuDongQuaDemB2;
                                                    sKetThucRaTuDongQuaDemB2 = sNgayCham + " " + string.Format("{0:T}", Convert.ToDateTime(dtTuDongQuaDemCa12.Rows[iTuDongQuaDemCa12]["KetThucRa"].ToString()));
                                                    DateTime dKetThucRaTuDongQuaDemB2;
                                                    dKetThucRaTuDongQuaDemB2 = Convert.ToDateTime(sKetThucRaTuDongQuaDemB2).AddDays(-1.0);
                                                    dKetThucRaTuDongQuaDemB2 = ((!(sBatDauRaTuDongQuaDemA2 == "12:01:00 AM")) ? Convert.ToDateTime(sKetThucRaTuDongQuaDemB2) : Convert.ToDateTime(dKetThucRaTuDongQuaDemB2.AddDays(1.0).ToString()));
                                                    if (dGioNgayHomTruoc2 >= dBatDauVaoTuDongQuaDemB2 && dGioNgayHomTruoc2 <= dKetThucVaoTuDongQuaDemB2)
                                                    {
                                                        kiemTraVao++;
                                                    }
                                                    if (dGioRaNgayTruocTuDongQuaDem2 >= dBatDauRaTuDongQuaDemB2 && dGioRaNgayTruocTuDongQuaDem2 <= dKetThucRaTuDongQuaDemB2)
                                                    {
                                                        kiemTraRa++;
                                                    }
                                                    if (kiemTraVao != 1 || kiemTraRa != 1)
                                                    {
                                                        iTuDongQuaDemCa12++;
                                                        continue;
                                                    }
                                                    goto IL_3d1fa;
                                                }
                                                if (!(this.sTuDongQuaDemMaCaLamViec == ""))
                                                {
                                                    cellChiTietLichTrinhChoCaLamViecTuDongQuaDem5++;
                                                    continue;
                                                }
                                                this.DGVTinhCong.Rows[_nhanVien - 1].Cells[4].Value = ca;
                                                this.DGVTinhCong.Rows[_nhanVien - 1].Cells[7].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien - 1].Cells[8].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien - 1].Cells[9].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien - 1].Cells[10].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien - 1].Cells[11].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien - 1].Cells[12].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien - 1].Cells[13].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien - 1].Cells[14].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien - 1].Cells[15].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien - 1].Cells[16].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien - 1].Cells[17].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien - 1].Cells[18].Value = this.sKHVang;
                                                if (DateTimeProgress.XuatThuQuaDem((int)dt.AddDays(dem).DayOfWeek) == "1")
                                                {
                                                    this.DGVTinhCong.Rows[_nhanVien - 1].Cells[19].Value = "CN";
                                                }
                                                else
                                                {
                                                    this.DGVTinhCong.Rows[_nhanVien - 1].Cells[19].Value = "NT";
                                                }
                                                this.DGVTinhCong.Rows[_nhanVien - 1].Cells[20].Value = this.sMaChamCong;
                                                this.DGVTinhCong.Rows[_nhanVien - 1].Cells[21].Value = this.sPhongBanTinhCong;
                                                break;
                                            }
                                            goto IL_3d1fa;
                                        IL_3d1fa:
                                            this.DGVTinhCong.Rows[_nhanVien - 1].Cells[4].Value = this.sTuDongQuaDemTenCaLamViec;
                                            new DataTable();
                                            DataTable dtThongSoCaLamViecTuDongQuaDem2;
                                            dtThongSoCaLamViecTuDongQuaDem2 = this._caLamViecBLL.CaLamViecGetByMaCaLamViec(sTuDongQuaDemMaCaLamViec);
                                            for (int iThongSoCaLamViecTuDongQuaDem2 = 0; iThongSoCaLamViecTuDongQuaDem2 < dtThongSoCaLamViecTuDongQuaDem2.Rows.Count; iThongSoCaLamViecTuDongQuaDem2++)
                                            {
                                                double dTongGioTuDongQuaDem2;
                                                dTongGioTuDongQuaDem2 = Math.Round(Convert.ToDouble(Convert.ToInt32((dGioRaNgayTruocTuDongQuaDem2 - dGioNgayHomTruoc2).TotalMinutes)) / 60.0, this.iLamTronGio);
                                                this.DGVTinhCong.Rows[_nhanVien - 1].Cells[16].Value = dTongGioTuDongQuaDem2.ToString();
                                                this.DGVTinhCong.Rows[_nhanVien - 1].Cells[17].Value = dtThongSoCaLamViecTuDongQuaDem2.Rows[iThongSoCaLamViecTuDongQuaDem2]["CongTinh"].ToString();
                                                string sGiayGioVao9;
                                                sGiayGioVao9 = dGioNgayHomTruoc2.Second.ToString();
                                                string sGiayGioRa9;
                                                sGiayGioRa9 = dGioRaNgayTruocTuDongQuaDem2.Second.ToString();
                                                string sGioVaoKhaiBaoTuDongQuaDemB2;
                                                sGioVaoKhaiBaoTuDongQuaDemB2 = sNgayCham + " " + string.Format("{0:T}", Convert.ToDateTime(dtThongSoCaLamViecTuDongQuaDem2.Rows[iThongSoCaLamViecTuDongQuaDem2]["GioVaoLamViec"].ToString())).Replace("00 ", sGiayGioVao9 + " ");
                                                string sGioRaKhaiBaoTuDongQuaDemB2;
                                                sGioRaKhaiBaoTuDongQuaDemB2 = sNgayCham + " " + string.Format("{0:T}", Convert.ToDateTime(dtThongSoCaLamViecTuDongQuaDem2.Rows[iThongSoCaLamViecTuDongQuaDem2]["GioKetThucLamViec"].ToString())).Replace("00 ", sGiayGioRa9 + " ");
                                                string sCatChuoi2;
                                                sCatChuoi2 = sGioRaKhaiBaoTuDongQuaDemB2.Substring(sGioRaKhaiBaoTuDongQuaDemB2.Length - 2);
                                                string sTruGioDiTre7;
                                                sTruGioDiTre7 = dtThongSoCaLamViecTuDongQuaDem2.Rows[iThongSoCaLamViecTuDongQuaDem2]["TruGioDiTre"].ToString();
                                                string sBatDauTinhDiTre7;
                                                sBatDauTinhDiTre7 = dtThongSoCaLamViecTuDongQuaDem2.Rows[iThongSoCaLamViecTuDongQuaDem2]["BatDauTinhDiTre"].ToString();
                                                if (sTruGioDiTre7 == "True")
                                                {
                                                    int iChoPhepTreTuDongQuaDem2;
                                                    iChoPhepTreTuDongQuaDem2 = Convert.ToInt32(dtThongSoCaLamViecTuDongQuaDem2.Rows[iThongSoCaLamViecTuDongQuaDem2]["ChoPhepDiTre"].ToString());
                                                    if (sBatDauTinhDiTre7 == "True")
                                                    {
                                                        int iPhutTreTuDongQuaDem2;
                                                        iPhutTreTuDongQuaDem2 = Convert.ToInt32((dGioNgayHomTruoc2 - Convert.ToDateTime(sGioVaoKhaiBaoTuDongQuaDemB2).AddDays(-1.0)).TotalMinutes) - iChoPhepTreTuDongQuaDem2;
                                                        if (iPhutTreTuDongQuaDem2 > 0)
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien - 1].Cells[9].Value = iPhutTreTuDongQuaDem2.ToString();
                                                            this.DGVTinhCong.Rows[_nhanVien - 1].Cells[5].Style.BackColor = Color.Lime;
                                                        }
                                                        else
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien - 1].Cells[9].Value = "0";
                                                        }
                                                    }
                                                    else if (Convert.ToInt32((dGioNgayHomTruoc2 - Convert.ToDateTime(sGioVaoKhaiBaoTuDongQuaDemB2).AddDays(-1.0)).TotalMinutes) - iChoPhepTreTuDongQuaDem2 > 0)
                                                    {
                                                        this.DGVTinhCong.Rows[_nhanVien - 1].Cells[5].Style.BackColor = Color.Lime;
                                                        this.DGVTinhCong.Rows[_nhanVien - 1].Cells[9].Value = Convert.ToInt32((dGioNgayHomTruoc2 - Convert.ToDateTime(sGioVaoKhaiBaoTuDongQuaDemB2).AddDays(-1.0)).TotalMinutes).ToString();
                                                    }
                                                    else
                                                    {
                                                        this.DGVTinhCong.Rows[_nhanVien - 1].Cells[9].Value = "0";
                                                    }
                                                }
                                                else
                                                {
                                                    this.DGVTinhCong.Rows[_nhanVien - 1].Cells[9].Value = "0";
                                                }
                                                string sTruGioVeSom7;
                                                sTruGioVeSom7 = dtThongSoCaLamViecTuDongQuaDem2.Rows[iThongSoCaLamViecTuDongQuaDem2]["TruGioVeSom"].ToString();
                                                string sBatDauTinhVeSom7;
                                                sBatDauTinhVeSom7 = dtThongSoCaLamViecTuDongQuaDem2.Rows[iThongSoCaLamViecTuDongQuaDem2]["BatDauTinhVeSom"].ToString();
                                                if (sTruGioVeSom7 == "True")
                                                {
                                                    int iChoPhepVeSomTuDongQuaDem2;
                                                    iChoPhepVeSomTuDongQuaDem2 = Convert.ToInt32(dtThongSoCaLamViecTuDongQuaDem2.Rows[iThongSoCaLamViecTuDongQuaDem2]["ChoPhepVeSom"].ToString());
                                                    if (sBatDauTinhVeSom7 == "True")
                                                    {
                                                        if (sCatChuoi2 == "PM")
                                                        {
                                                            int iPhutVeSomTuDongQuaDem3;
                                                            iPhutVeSomTuDongQuaDem3 = Convert.ToInt32((Convert.ToDateTime(sGioRaKhaiBaoTuDongQuaDemB2).AddDays(-1.0) - dGioRaNgayTruocTuDongQuaDem2).TotalMinutes) - iChoPhepVeSomTuDongQuaDem2;
                                                            if (iPhutVeSomTuDongQuaDem3 > 0)
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien - 1].Cells[5].Style.BackColor = Color.Lime;
                                                                this.DGVTinhCong.Rows[_nhanVien - 1].Cells[10].Value = iPhutVeSomTuDongQuaDem3.ToString();
                                                            }
                                                            else
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien - 1].Cells[10].Value = "0";
                                                            }
                                                        }
                                                        else
                                                        {
                                                            int iPhutVeSomTuDongQuaDem4;
                                                            iPhutVeSomTuDongQuaDem4 = Convert.ToInt32((Convert.ToDateTime(sGioRaKhaiBaoTuDongQuaDemB2) - dGioRaNgayTruocTuDongQuaDem2).TotalMinutes) - iChoPhepVeSomTuDongQuaDem2;
                                                            if (iPhutVeSomTuDongQuaDem4 > 0)
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien - 1].Cells[6].Style.BackColor = Color.Yellow;
                                                                this.DGVTinhCong.Rows[_nhanVien - 1].Cells[10].Value = iPhutVeSomTuDongQuaDem4.ToString();
                                                            }
                                                            else
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien - 1].Cells[10].Value = "0";
                                                            }
                                                        }
                                                    }
                                                    else if (Convert.ToInt32((Convert.ToDateTime(sGioRaKhaiBaoTuDongQuaDemB2) - dGioRaNgayTruocTuDongQuaDem2).TotalMinutes) - iChoPhepVeSomTuDongQuaDem2 > 0)
                                                    {
                                                        this.DGVTinhCong.Rows[_nhanVien - 1].Cells[10].Value = Convert.ToInt32((Convert.ToDateTime(sGioRaKhaiBaoTuDongQuaDemB2) - dGioRaNgayTruocTuDongQuaDem2).TotalMinutes).ToString();
                                                    }
                                                    else
                                                    {
                                                        this.DGVTinhCong.Rows[_nhanVien - 1].Cells[10].Value = "0";
                                                    }
                                                }
                                                else
                                                {
                                                    this.DGVTinhCong.Rows[_nhanVien - 1].Cells[10].Value = "0";
                                                }
                                                if (sCatChuoi2 == "PM")
                                                {
                                                    int iPhutVeTre3;
                                                    iPhutVeTre3 = Convert.ToInt32((dGioRaNgayTruocTuDongQuaDem2 - Convert.ToDateTime(sGioRaKhaiBaoTuDongQuaDemB2).AddDays(-1.0)).TotalMinutes);
                                                    if (iPhutVeTre3 > 0)
                                                    {
                                                        this.DGVTinhCong.Rows[_nhanVien - 1].Cells[11].Value = iPhutVeTre3;
                                                    }
                                                    else
                                                    {
                                                        this.DGVTinhCong.Rows[_nhanVien - 1].Cells[11].Value = "0";
                                                    }
                                                }
                                                else
                                                {
                                                    int iPhutVeTre4;
                                                    iPhutVeTre4 = Convert.ToInt32((dGioRaNgayTruocTuDongQuaDem2 - Convert.ToDateTime(sGioRaKhaiBaoTuDongQuaDemB2)).TotalMinutes);
                                                    if (iPhutVeTre4 > 0)
                                                    {
                                                        this.DGVTinhCong.Rows[_nhanVien - 1].Cells[11].Value = iPhutVeTre4;
                                                    }
                                                    else
                                                    {
                                                        this.DGVTinhCong.Rows[_nhanVien - 1].Cells[11].Value = "0";
                                                    }
                                                }
                                                double dTongGioTrongCaTuDongQuaDem2;
                                                dTongGioTrongCaTuDongQuaDem2 = Convert.ToDouble(dtThongSoCaLamViecTuDongQuaDem2.Rows[iThongSoCaLamViecTuDongQuaDem2]["TongGioTrongCaLamViec"].ToString());
                                                double dTongCongTrongCaTuDongQuaDem2;
                                                dTongCongTrongCaTuDongQuaDem2 = Convert.ToDouble(dtThongSoCaLamViecTuDongQuaDem2.Rows[iThongSoCaLamViecTuDongQuaDem2]["CongTinh"].ToString());
                                                double dTongPhutTreSomTuDongQuaDem2;
                                                dTongPhutTreSomTuDongQuaDem2 = Convert.ToDouble(this.DGVTinhCong.Rows[_nhanVien - 1].Cells[9].Value.ToString()) + Convert.ToDouble(this.DGVTinhCong.Rows[_nhanVien - 1].Cells[10].Value.ToString());
                                                this.DGVTinhCong.Rows[_nhanVien - 1].Cells[8].Value = Math.Round((dTongGioTrongCaTuDongQuaDem2 * 60.0 - dTongPhutTreSomTuDongQuaDem2) / 60.0, this.iLamTronGio);
                                                this.DGVTinhCong.Rows[_nhanVien - 1].Cells[7].Value = Math.Round(Convert.ToDouble(this.DGVTinhCong.Rows[_nhanVien - 1].Cells[8].Value.ToString()) * dTongCongTrongCaTuDongQuaDem2 / dTongGioTrongCaTuDongQuaDem2, this.iLamTronCong);
                                                string sChoPhepTangCaTruocGioLamViecTuDongQuaDem4;
                                                sChoPhepTangCaTruocGioLamViecTuDongQuaDem4 = dtThongSoCaLamViecTuDongQuaDem2.Rows[iThongSoCaLamViecTuDongQuaDem2]["TangCaTruocGioLamViec"].ToString();
                                                int iPhutTangCaTruocGioLamViecTuDongQuaDem4;
                                                iPhutTangCaTruocGioLamViecTuDongQuaDem4 = Convert.ToInt32(dtThongSoCaLamViecTuDongQuaDem2.Rows[iThongSoCaLamViecTuDongQuaDem2]["SoPhutTangCaTruocGioLamViec"].ToString());
                                                int iPhutTangCaTruocGioLamViecDatDen6;
                                                iPhutTangCaTruocGioLamViecDatDen6 = Convert.ToInt32(dtThongSoCaLamViecTuDongQuaDem2.Rows[iThongSoCaLamViecTuDongQuaDem2]["TangCaTruocGioLamViecDatDen"].ToString());
                                                int iPhutTruTangCaTruoc6;
                                                iPhutTruTangCaTruoc6 = Convert.ToInt32(dtThongSoCaLamViecTuDongQuaDem2.Rows[iThongSoCaLamViecTuDongQuaDem2]["PhutTruTangCaTruoc"].ToString());
                                                string sChoPhepTangCaSauGioLamViecTuDongQuaDem4;
                                                sChoPhepTangCaSauGioLamViecTuDongQuaDem4 = dtThongSoCaLamViecTuDongQuaDem2.Rows[iThongSoCaLamViecTuDongQuaDem2]["TangCaSauGioLamViec"].ToString();
                                                int iPhutTangCaSauGioLamViecTuDongQuaDem4;
                                                iPhutTangCaSauGioLamViecTuDongQuaDem4 = Convert.ToInt32(dtThongSoCaLamViecTuDongQuaDem2.Rows[iThongSoCaLamViecTuDongQuaDem2]["SoPhutTangCaSauGioLamViec"].ToString());
                                                int iPhutTangCaSauGioLamViecDatDen6;
                                                iPhutTangCaSauGioLamViecDatDen6 = Convert.ToInt32(dtThongSoCaLamViecTuDongQuaDem2.Rows[iThongSoCaLamViecTuDongQuaDem2]["TangCaSauGioLamViecDatDen"].ToString());
                                                int iPhutTruTangCaSau6;
                                                iPhutTruTangCaSau6 = Convert.ToInt32(dtThongSoCaLamViecTuDongQuaDem2.Rows[iThongSoCaLamViecTuDongQuaDem2]["PhutTruTangCaSau"].ToString());
                                                int iGioiHanTC1TuDongQuaDem4;
                                                iGioiHanTC1TuDongQuaDem4 = Convert.ToInt32(dtThongSoCaLamViecTuDongQuaDem2.Rows[iThongSoCaLamViecTuDongQuaDem2]["GioiHanTangCa1"].ToString());
                                                int iGioiHanTC2TuDongQuaDem4;
                                                iGioiHanTC2TuDongQuaDem4 = Convert.ToInt32(dtThongSoCaLamViecTuDongQuaDem2.Rows[iThongSoCaLamViecTuDongQuaDem2]["GioiHanTangCa2"].ToString());
                                                int iGioiHanTC3TuDongQuaDem4;
                                                iGioiHanTC3TuDongQuaDem4 = Convert.ToInt32(dtThongSoCaLamViecTuDongQuaDem2.Rows[iThongSoCaLamViecTuDongQuaDem2]["GioiHanTangCa3"].ToString());
                                                int iGioiHanTC4TuDongQuaDem4;
                                                iGioiHanTC4TuDongQuaDem4 = Convert.ToInt32(dtThongSoCaLamViecTuDongQuaDem2.Rows[iThongSoCaLamViecTuDongQuaDem2]["GioiHanTangCa4"].ToString());
                                                int iTongGioTangCaSauTuDongQuaDem4;
                                                iTongGioTangCaSauTuDongQuaDem4 = 0;
                                                int iTongGioTangCaTruocTuDongQuaDem4;
                                                iTongGioTangCaTruocTuDongQuaDem4 = 0;
                                                if (sChoPhepTangCaTruocGioLamViecTuDongQuaDem4 == "False" && sChoPhepTangCaSauGioLamViecTuDongQuaDem4 == "False")
                                                {
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                }
                                                else
                                                {
                                                    if (sChoPhepTangCaTruocGioLamViecTuDongQuaDem4 == "True")
                                                    {
                                                        int iThoiGianTruocGioLamTuDongQuaDem4;
                                                        iThoiGianTruocGioLamTuDongQuaDem4 = Convert.ToInt32(Convert.ToInt32((Convert.ToDateTime(sGioVaoKhaiBaoTuDongQuaDemB2).AddDays(-1.0) - dGioNgayHomTruoc2).TotalMinutes).ToString());
                                                        if (iThoiGianTruocGioLamTuDongQuaDem4 > 0 && iThoiGianTruocGioLamTuDongQuaDem4 > iPhutTangCaTruocGioLamViecTuDongQuaDem4 && iThoiGianTruocGioLamTuDongQuaDem4 > iPhutTangCaTruocGioLamViecDatDen6)
                                                        {
                                                            iTongGioTangCaTruocTuDongQuaDem4 = iThoiGianTruocGioLamTuDongQuaDem4 - iPhutTruTangCaTruoc6;
                                                        }
                                                    }
                                                    if (sChoPhepTangCaSauGioLamViecTuDongQuaDem4 == "True")
                                                    {
                                                        if (sCatChuoi2 == "PM")
                                                        {
                                                            int iThoiGianSauGioLamViecTuDongQuaDem5;
                                                            iThoiGianSauGioLamViecTuDongQuaDem5 = Convert.ToInt32(Convert.ToInt32((dGioRaNgayTruocTuDongQuaDem2 - Convert.ToDateTime(sGioRaKhaiBaoTuDongQuaDemB2).AddDays(-1.0)).TotalMinutes).ToString());
                                                            if (iThoiGianSauGioLamViecTuDongQuaDem5 > 0 && iThoiGianSauGioLamViecTuDongQuaDem5 > iPhutTangCaSauGioLamViecTuDongQuaDem4 && iThoiGianSauGioLamViecTuDongQuaDem5 > iPhutTangCaSauGioLamViecDatDen6)
                                                            {
                                                                iTongGioTangCaSauTuDongQuaDem4 = iThoiGianSauGioLamViecTuDongQuaDem5 - iPhutTruTangCaSau6;
                                                            }
                                                        }
                                                        else
                                                        {
                                                            int iThoiGianSauGioLamViecTuDongQuaDem6;
                                                            iThoiGianSauGioLamViecTuDongQuaDem6 = Convert.ToInt32(Convert.ToInt32((dGioRaNgayTruocTuDongQuaDem2 - Convert.ToDateTime(sGioRaKhaiBaoTuDongQuaDemB2)).TotalMinutes).ToString());
                                                            if (iThoiGianSauGioLamViecTuDongQuaDem6 > 0 && iThoiGianSauGioLamViecTuDongQuaDem6 > iPhutTangCaSauGioLamViecTuDongQuaDem4 && iThoiGianSauGioLamViecTuDongQuaDem6 > iPhutTangCaSauGioLamViecDatDen6)
                                                            {
                                                                iTongGioTangCaSauTuDongQuaDem4 = iThoiGianSauGioLamViecTuDongQuaDem6 - iPhutTruTangCaSau6;
                                                            }
                                                        }
                                                    }
                                                }
                                                double dTongThoiGianTangCaTuDongQuaDem4;
                                                dTongThoiGianTangCaTuDongQuaDem4 = Convert.ToDouble(iTongGioTangCaTruocTuDongQuaDem4 + iTongGioTangCaSauTuDongQuaDem4);
                                                if (dTongThoiGianTangCaTuDongQuaDem4 > 0.0)
                                                {
                                                    if (iGioiHanTC1TuDongQuaDem4 == 0)
                                                    {
                                                        this.DGVTinhCong.Rows[_nhanVien - 1].Cells[12].Value = Math.Round(dTongThoiGianTangCaTuDongQuaDem4 * this.dTangCa1HeSo / 60.0, this.iLamTronGio);
                                                        this.DGVTinhCong.Rows[_nhanVien - 1].Cells[13].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien - 1].Cells[14].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien - 1].Cells[15].Value = "0";
                                                    }
                                                    if (iGioiHanTC1TuDongQuaDem4 != 0 && iGioiHanTC2TuDongQuaDem4 == 0)
                                                    {
                                                        if (dTongThoiGianTangCaTuDongQuaDem4 < Convert.ToDouble(iGioiHanTC1TuDongQuaDem4))
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien - 1].Cells[12].Value = Math.Round(dTongThoiGianTangCaTuDongQuaDem4 * this.dTangCa1HeSo / 60.0, this.iLamTronGio);
                                                            this.DGVTinhCong.Rows[_nhanVien - 1].Cells[13].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien - 1].Cells[14].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien - 1].Cells[15].Value = "0";
                                                        }
                                                        else
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien - 1].Cells[12].Value = Math.Round(Convert.ToDouble(iGioiHanTC1TuDongQuaDem4) / 60.0 * this.dTangCa1HeSo, this.iLamTronGio);
                                                            if (dTongThoiGianTangCaTuDongQuaDem4 - Convert.ToDouble(iGioiHanTC1TuDongQuaDem4) > 0.0)
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien - 1].Cells[13].Value = Math.Round((dTongThoiGianTangCaTuDongQuaDem4 - Convert.ToDouble(iGioiHanTC1TuDongQuaDem4)) * this.dTangCa2HeSo / 60.0, this.iLamTronGio);
                                                            }
                                                            this.DGVTinhCong.Rows[_nhanVien - 1].Cells[14].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien - 1].Cells[15].Value = "0";
                                                        }
                                                    }
                                                    if (iGioiHanTC1TuDongQuaDem4 != 0 && iGioiHanTC2TuDongQuaDem4 != 0 && iGioiHanTC3TuDongQuaDem4 == 0)
                                                    {
                                                        if (dTongThoiGianTangCaTuDongQuaDem4 < Convert.ToDouble(iGioiHanTC1TuDongQuaDem4))
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien - 1].Cells[12].Value = Math.Round(dTongThoiGianTangCaTuDongQuaDem4 * this.dTangCa1HeSo / 60.0, this.iLamTronGio);
                                                            this.DGVTinhCong.Rows[_nhanVien - 1].Cells[13].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien - 1].Cells[14].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien - 1].Cells[15].Value = "0";
                                                        }
                                                        else
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien - 1].Cells[12].Value = Math.Round(Convert.ToDouble(iGioiHanTC1TuDongQuaDem4) * this.dTangCa1HeSo / 60.0, this.iLamTronGio);
                                                            if (dTongThoiGianTangCaTuDongQuaDem4 - Convert.ToDouble(iGioiHanTC1TuDongQuaDem4) < Convert.ToDouble(iGioiHanTC2TuDongQuaDem4))
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien - 1].Cells[13].Value = Math.Round((dTongThoiGianTangCaTuDongQuaDem4 - Convert.ToDouble(iGioiHanTC1TuDongQuaDem4)) * this.dTangCa2HeSo / 60.0, this.iLamTronGio);
                                                                this.DGVTinhCong.Rows[_nhanVien - 1].Cells[14].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien - 1].Cells[15].Value = "0";
                                                            }
                                                            else
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien - 1].Cells[12].Value = Math.Round(Convert.ToDouble(iGioiHanTC1TuDongQuaDem4) * this.dTangCa1HeSo / 60.0, this.iLamTronGio);
                                                                this.DGVTinhCong.Rows[_nhanVien - 1].Cells[13].Value = Math.Round(Convert.ToDouble(iGioiHanTC2TuDongQuaDem4) * this.dTangCa2HeSo / 60.0, this.iLamTronGio);
                                                                this.DGVTinhCong.Rows[_nhanVien - 1].Cells[14].Value = Math.Round((dTongThoiGianTangCaTuDongQuaDem4 - Convert.ToDouble(iGioiHanTC1TuDongQuaDem4) - Convert.ToDouble(iGioiHanTC2TuDongQuaDem4)) * this.dTangCa3HeSo / 60.0, this.iLamTronGio);
                                                                this.DGVTinhCong.Rows[_nhanVien - 1].Cells[15].Value = "0";
                                                            }
                                                        }
                                                    }
                                                    if (iGioiHanTC1TuDongQuaDem4 != 0 && iGioiHanTC2TuDongQuaDem4 != 0 && iGioiHanTC3TuDongQuaDem4 != 0 && iGioiHanTC4TuDongQuaDem4 != 0)
                                                    {
                                                    }
                                                }
                                                else
                                                {
                                                    this.DGVTinhCong.Rows[_nhanVien - 1].Cells[12].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien - 1].Cells[13].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien - 1].Cells[14].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien - 1].Cells[15].Value = "0";
                                                }
                                                this.DGVTinhCong.Rows[_nhanVien - 1].Cells[18].Value = this.sKHDungGio;
                                                if (DateTimeProgress.XuatThuQuaDem((int)dt.AddDays(dem).DayOfWeek) == "1")
                                                {
                                                    this.DGVTinhCong.Rows[_nhanVien - 1].Cells[19].Value = "CN";
                                                }
                                                else
                                                {
                                                    this.DGVTinhCong.Rows[_nhanVien - 1].Cells[19].Value = "NT";
                                                }
                                                this.DGVTinhCong.Rows[_nhanVien - 1].Cells[20].Value = this.sMaChamCong;
                                                this.DGVTinhCong.Rows[_nhanVien - 1].Cells[21].Value = this.sPhongBanTinhCong;
                                            }
                                            break;
                                        }
                                    }
                                    else
                                    {
                                        DateTime dGioVaoNgayTruocTuDongQuaDem;
                                        dGioVaoNgayTruocTuDongQuaDem = Convert.ToDateTime(dtTuDongQuaDem.Rows[iTuDongQuaDem]["GioCham"].ToString());
                                        this.DGVTinhCong.Rows[_nhanVien].Cells[5].Value = string.Format(this.sDinhDangThoiGian, dGioVaoNgayTruocTuDongQuaDem);
                                    }
                                    continue;
                                }
                                if (demTuDongQuaDem == 1)
                                {
                                    dGioVaoTuDongQuaDem = Convert.ToDateTime(dtTuDongQuaDem.Rows[iTuDongQuaDem]["GioCham"].ToString());
                                    this.DGVTinhCong.Rows[_nhanVien].Cells[5].Value = string.Format(this.sDinhDangThoiGian, dGioVaoTuDongQuaDem);
                                    new DataTable();
                                    this._chiTietLichTrinhChoCalamViecDTO.MaLichTrinhCaLamViec = sLTCCLVNhanVien;
                                    this._chiTietLichTrinhChoCalamViecDTO.Thu = sThu;
                                    DataTable dtNhanCaTuDongQuaDem8;
                                    dtNhanCaTuDongQuaDem8 = this._chiTietLichTrinhChoCaLamViecBLL.ChiTietLichTrinhChoCaLamViecNhanCa(this._chiTietLichTrinhChoCalamViecDTO);
                                    int iChiTietLichTrinhChoCaLamViecTuDongQuaDem8;
                                    iChiTietLichTrinhChoCaLamViecTuDongQuaDem8 = 0;
                                    if (iChiTietLichTrinhChoCaLamViecTuDongQuaDem8 < dtNhanCaTuDongQuaDem8.Rows.Count)
                                    {
                                        int cellChiTietLichTrinhChoCaLamViecTuDongQuaDem8;
                                        cellChiTietLichTrinhChoCaLamViecTuDongQuaDem8 = 3;
                                        while (true)
                                        {
                                            if (cellChiTietLichTrinhChoCaLamViecTuDongQuaDem8 < 13)
                                            {
                                                kiemTraVao = 0;
                                                kiemTraRa = 0;
                                                this.sTuDongQuaDemMaCaLamViec = dtNhanCaTuDongQuaDem8.Rows[iChiTietLichTrinhChoCaLamViecTuDongQuaDem8][cellChiTietLichTrinhChoCaLamViecTuDongQuaDem8].ToString();
                                                new DataTable();
                                                DataTable dtTuDongQuaDemCa8;
                                                dtTuDongQuaDemCa8 = this._caLamViecBLL.CaLamViecGetByMaCaLamViec(sTuDongQuaDemMaCaLamViec);
                                                int iTuDongQuaDemCa8;
                                                iTuDongQuaDemCa8 = 0;
                                                while (iTuDongQuaDemCa8 < dtTuDongQuaDemCa8.Rows.Count)
                                                {
                                                    this.sTuDongQuaDemTenCaLamViec = dtTuDongQuaDemCa8.Rows[iTuDongQuaDemCa8]["CaLamViec"].ToString();
                                                    DateTime dBatDauVaoB8;
                                                    dBatDauVaoB8 = Convert.ToDateTime(sNgayCham + " " + string.Format("{0:T}", Convert.ToDateTime(dtTuDongQuaDemCa8.Rows[iTuDongQuaDemCa8]["BatDauVao"].ToString())));
                                                    DateTime dKetThucVaoB8;
                                                    dKetThucVaoB8 = Convert.ToDateTime(sNgayCham + " " + string.Format("{0:T}", Convert.ToDateTime(dtTuDongQuaDemCa8.Rows[iTuDongQuaDemCa8]["KetThucVao"].ToString())));
                                                    DateTime dBatDauRaB7;
                                                    dBatDauRaB7 = Convert.ToDateTime(sNgayCham + " " + string.Format("{0:T}", Convert.ToDateTime(dtTuDongQuaDemCa8.Rows[iTuDongQuaDemCa8]["BatDauRa"].ToString())));
                                                    DateTime dKetThucRaB7;
                                                    dKetThucRaB7 = Convert.ToDateTime(sNgayCham + " " + string.Format("{0:T}", Convert.ToDateTime(dtTuDongQuaDemCa8.Rows[iTuDongQuaDemCa8]["KetThucRa"].ToString())));
                                                    if (dGioVaoTuDongQuaDem >= dBatDauVaoB8 && dGioVaoTuDongQuaDem <= dKetThucVaoB8)
                                                    {
                                                        kiemTraVao++;
                                                    }
                                                    if (dGioRaTuDongQuaDem >= dBatDauRaB7 && dGioRaTuDongQuaDem <= dKetThucRaB7)
                                                    {
                                                        kiemTraRa++;
                                                    }
                                                    if (kiemTraVao != 1 || kiemTraRa != 0)
                                                    {
                                                        iTuDongQuaDemCa8++;
                                                        continue;
                                                    }
                                                    goto IL_3f055;
                                                }
                                                if (!(this.sTuDongQuaDemMaCaLamViec == ""))
                                                {
                                                    cellChiTietLichTrinhChoCaLamViecTuDongQuaDem8++;
                                                    continue;
                                                }
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[4].Value = ca;
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[11].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[16].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[17].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[18].Value = this.sKHVang;
                                                if (DateTimeProgress.XuatIDThu((int)dt.AddDays(dem).DayOfWeek) == "0")
                                                {
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[19].Value = "CN";
                                                }
                                                else
                                                {
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[19].Value = "NT";
                                                }
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[20].Value = this.sMaChamCong;
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[21].Value = this.sPhongBanTinhCong;
                                                break;
                                            }
                                            goto IL_3f055;
                                        IL_3f055:
                                            this.DGVTinhCong.Rows[_nhanVien].Cells[4].Value = this.sTuDongQuaDemTenCaLamViec;
                                            this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = "0";
                                            this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = "0";
                                            this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = "0";
                                            this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = "0";
                                            this.DGVTinhCong.Rows[_nhanVien].Cells[11].Value = "0";
                                            this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = "0";
                                            this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                            this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                            this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                            this.DGVTinhCong.Rows[_nhanVien].Cells[16].Value = "0";
                                            this.DGVTinhCong.Rows[_nhanVien].Cells[17].Value = "0";
                                            this.DGVTinhCong.Rows[_nhanVien].Cells[18].Value = this.sKHVang;
                                            if (DateTimeProgress.XuatIDThu((int)dt.AddDays(dem).DayOfWeek) == "0")
                                            {
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[19].Value = "CN";
                                            }
                                            else
                                            {
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[19].Value = "NT";
                                            }
                                            this.DGVTinhCong.Rows[_nhanVien].Cells[20].Value = this.sMaChamCong;
                                            this.DGVTinhCong.Rows[_nhanVien].Cells[21].Value = this.sPhongBanTinhCong;
                                            break;
                                        }
                                    }
                                }
                                if (demTuDongQuaDem == 2)
                                {
                                    dGioRaTuDongQuaDem = Convert.ToDateTime(dtTuDongQuaDem.Rows[iTuDongQuaDem]["GioCham"].ToString());
                                    this.DGVTinhCong.Rows[_nhanVien].Cells[6].Value = string.Format(this.sDinhDangThoiGian, dGioRaTuDongQuaDem);
                                    new DataTable();
                                    this._chiTietLichTrinhChoCalamViecDTO.MaLichTrinhCaLamViec = sLTCCLVNhanVien;
                                    this._chiTietLichTrinhChoCalamViecDTO.Thu = sThu;
                                    DataTable dtNhanCaTuDongQuaDem7;
                                    dtNhanCaTuDongQuaDem7 = this._chiTietLichTrinhChoCaLamViecBLL.ChiTietLichTrinhChoCaLamViecNhanCa(this._chiTietLichTrinhChoCalamViecDTO);
                                    int iChiTietLichTrinhChoCaLamViecTuDongQuaDem7;
                                    iChiTietLichTrinhChoCaLamViecTuDongQuaDem7 = 0;
                                    if (iChiTietLichTrinhChoCaLamViecTuDongQuaDem7 < dtNhanCaTuDongQuaDem7.Rows.Count)
                                    {
                                        int cellChiTietLichTrinhChoCaLamViecTuDongQuaDem7;
                                        cellChiTietLichTrinhChoCaLamViecTuDongQuaDem7 = 3;
                                        while (true)
                                        {
                                            if (cellChiTietLichTrinhChoCaLamViecTuDongQuaDem7 < 13)
                                            {
                                                kiemTraVao = 0;
                                                kiemTraRa = 0;
                                                this.sTuDongQuaDemMaCaLamViec = dtNhanCaTuDongQuaDem7.Rows[iChiTietLichTrinhChoCaLamViecTuDongQuaDem7][cellChiTietLichTrinhChoCaLamViecTuDongQuaDem7].ToString();
                                                new DataTable();
                                                DataTable dtTuDongQuaDemCa6;
                                                dtTuDongQuaDemCa6 = this._caLamViecBLL.CaLamViecGetByMaCaLamViec(sTuDongQuaDemMaCaLamViec);
                                                int iTuDongQuaDemCa6;
                                                iTuDongQuaDemCa6 = 0;
                                                while (iTuDongQuaDemCa6 < dtTuDongQuaDemCa6.Rows.Count)
                                                {
                                                    string sGiayGioVao15;
                                                    sGiayGioVao15 = dGioVaoTuDongQuaDem.Second.ToString();
                                                    string sGiayGioRa15;
                                                    sGiayGioRa15 = dGioRaTuDongQuaDem.Second.ToString();
                                                    this.sTuDongQuaDemTenCaLamViec = dtTuDongQuaDemCa6.Rows[iTuDongQuaDemCa6]["CaLamViec"].ToString();
                                                    DateTime dBatDauVaoB6;
                                                    dBatDauVaoB6 = Convert.ToDateTime(sNgayCham + " " + string.Format("{0:T}", Convert.ToDateTime(dtTuDongQuaDemCa6.Rows[iTuDongQuaDemCa6]["BatDauVao"].ToString())).Replace("00 ", sGiayGioVao15 + " "));
                                                    DateTime dKetThucVaoB6;
                                                    dKetThucVaoB6 = Convert.ToDateTime(sNgayCham + " " + string.Format("{0:T}", Convert.ToDateTime(dtTuDongQuaDemCa6.Rows[iTuDongQuaDemCa6]["KetThucVao"].ToString())).Replace("00 ", sGiayGioVao15 + " "));
                                                    DateTime dBatDauRaB6;
                                                    dBatDauRaB6 = Convert.ToDateTime(sNgayCham + " " + string.Format("{0:T}", Convert.ToDateTime(dtTuDongQuaDemCa6.Rows[iTuDongQuaDemCa6]["BatDauRa"].ToString())).Replace("00 ", sGiayGioRa15 + " "));
                                                    DateTime dKetThucRaB6;
                                                    dKetThucRaB6 = Convert.ToDateTime(sNgayCham + " " + string.Format("{0:T}", Convert.ToDateTime(dtTuDongQuaDemCa6.Rows[iTuDongQuaDemCa6]["KetThucRa"].ToString())).Replace("00 ", sGiayGioRa15 + " "));
                                                    if (dGioVaoTuDongQuaDem >= dBatDauVaoB6 && dGioVaoTuDongQuaDem <= dKetThucVaoB6)
                                                    {
                                                        kiemTraVao++;
                                                    }
                                                    if (dGioRaTuDongQuaDem >= dBatDauRaB6 && dGioRaTuDongQuaDem <= dKetThucRaB6)
                                                    {
                                                        kiemTraRa++;
                                                    }
                                                    if (kiemTraVao != 1 || kiemTraRa != 1)
                                                    {
                                                        iTuDongQuaDemCa6++;
                                                        continue;
                                                    }
                                                    goto IL_3fa13;
                                                }
                                                if (!(this.sTuDongQuaDemMaCaLamViec == ""))
                                                {
                                                    cellChiTietLichTrinhChoCaLamViecTuDongQuaDem7++;
                                                    continue;
                                                }
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[4].Value = ca;
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[11].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[16].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[17].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[18].Value = this.sKHVang;
                                                if (DateTimeProgress.XuatIDThu((int)dt.AddDays(dem).DayOfWeek) == "0")
                                                {
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[19].Value = "CN";
                                                }
                                                else
                                                {
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[19].Value = "NT";
                                                }
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[20].Value = this.sMaChamCong;
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[21].Value = this.sPhongBanTinhCong;
                                                break;
                                            }
                                            goto IL_3fa13;
                                        IL_3fa13:
                                            this.DGVTinhCong.Rows[_nhanVien].Cells[4].Value = this.sTuDongQuaDemTenCaLamViec;
                                            new DataTable();
                                            DataTable dtCaLamViecTuDongQuaDem4;
                                            dtCaLamViecTuDongQuaDem4 = this._caLamViecBLL.CaLamViecGetByMaCaLamViec(sTuDongQuaDemMaCaLamViec);
                                            for (int iCaLamViecTuDongQuaDem4 = 0; iCaLamViecTuDongQuaDem4 < dtCaLamViecTuDongQuaDem4.Rows.Count; iCaLamViecTuDongQuaDem4++)
                                            {
                                                string sGiayGioVao14;
                                                sGiayGioVao14 = dGioVaoTuDongQuaDem.Second.ToString();
                                                string sGiayGioRa13;
                                                sGiayGioRa13 = dGioRaTuDongQuaDem.Second.ToString();
                                                DateTime dGioVaoKhaiBaoTuDongQuaDemB4;
                                                dGioVaoKhaiBaoTuDongQuaDemB4 = Convert.ToDateTime(sNgayCham + " " + string.Format("{0:T}", Convert.ToDateTime(dtCaLamViecTuDongQuaDem4.Rows[iCaLamViecTuDongQuaDem4]["GioVaoLamViec"].ToString())).Replace("00 ", sGiayGioVao14 + " "));
                                                DateTime dGioRaKhaiBaoTuDongQuaDemB4;
                                                dGioRaKhaiBaoTuDongQuaDemB4 = Convert.ToDateTime(sNgayCham + " " + string.Format("{0:T}", Convert.ToDateTime(dtCaLamViecTuDongQuaDem4.Rows[iCaLamViecTuDongQuaDem4]["GioKetThucLamViec"].ToString())).Replace("00 ", sGiayGioRa13 + " "));
                                                string sTruGioDiTre10;
                                                sTruGioDiTre10 = dtCaLamViecTuDongQuaDem4.Rows[iCaLamViecTuDongQuaDem4]["TruGioDiTre"].ToString();
                                                string sBatDauTinhDiTre10;
                                                sBatDauTinhDiTre10 = dtCaLamViecTuDongQuaDem4.Rows[iCaLamViecTuDongQuaDem4]["BatDauTinhDiTre"].ToString();
                                                int iChoPhepDiTre7;
                                                iChoPhepDiTre7 = Convert.ToInt32(dtCaLamViecTuDongQuaDem4.Rows[iCaLamViecTuDongQuaDem4]["ChoPhepDiTre"].ToString());
                                                string sPhutTre7;
                                                sPhutTre7 = Convert.ToInt32((dGioVaoTuDongQuaDem - dGioVaoKhaiBaoTuDongQuaDemB4).TotalMinutes).ToString();
                                                if (sTruGioDiTre10 == "True")
                                                {
                                                    if (Convert.ToInt32(sPhutTre7) < 0)
                                                    {
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = "0";
                                                    }
                                                    else
                                                    {
                                                        int iPhutTre7;
                                                        iPhutTre7 = Convert.ToInt32(sPhutTre7) - iChoPhepDiTre7;
                                                        if (sBatDauTinhDiTre10 == "True")
                                                        {
                                                            if (iPhutTre7 < 1)
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = "0";
                                                            }
                                                            else
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[5].Style.BackColor = Color.Lime;
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = iPhutTre7.ToString();
                                                            }
                                                        }
                                                        else if (iPhutTre7 < 1)
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = "0";
                                                        }
                                                        else
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = sPhutTre7;
                                                        }
                                                    }
                                                }
                                                else
                                                {
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = "0";
                                                }
                                                string sTruGioVeSom10;
                                                sTruGioVeSom10 = dtCaLamViecTuDongQuaDem4.Rows[iCaLamViecTuDongQuaDem4]["TruGioVeSom"].ToString();
                                                string sBatDauTinhVeSom10;
                                                sBatDauTinhVeSom10 = dtCaLamViecTuDongQuaDem4.Rows[iCaLamViecTuDongQuaDem4]["BatDauTinhVeSom"].ToString();
                                                int iChoPhepVeSom7;
                                                iChoPhepVeSom7 = Convert.ToInt32(dtCaLamViecTuDongQuaDem4.Rows[iCaLamViecTuDongQuaDem4]["ChoPhepVeSom"].ToString());
                                                string sPhutVeSom7;
                                                sPhutVeSom7 = Convert.ToInt32((dGioRaKhaiBaoTuDongQuaDemB4 - dGioRaTuDongQuaDem).TotalMinutes).ToString();
                                                if (sTruGioVeSom10 == "True")
                                                {
                                                    if (Convert.ToInt32(sPhutVeSom7) < 0)
                                                    {
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = "0";
                                                    }
                                                    else
                                                    {
                                                        int iPhutVeSom7;
                                                        iPhutVeSom7 = Convert.ToInt32(sPhutVeSom7) - iChoPhepVeSom7;
                                                        if (iPhutVeSom7 < 1)
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = "0";
                                                        }
                                                        else if (sBatDauTinhVeSom10 == "True")
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[6].Style.BackColor = Color.Yellow;
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = iPhutVeSom7.ToString();
                                                        }
                                                        else
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = sPhutVeSom7;
                                                        }
                                                    }
                                                }
                                                else
                                                {
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = "0";
                                                }
                                                string sVeTre7;
                                                sVeTre7 = Convert.ToInt32((dGioRaTuDongQuaDem - dGioRaKhaiBaoTuDongQuaDemB4).TotalMinutes).ToString();
                                                if (Convert.ToInt32(sVeTre7) > 0)
                                                {
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[11].Value = sVeTre7;
                                                }
                                                else
                                                {
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[11].Value = "0";
                                                }
                                                double dGio7;
                                                dGio7 = Math.Round(Convert.ToDouble(Convert.ToSingle(dtCaLamViecTuDongQuaDem4.Rows[iCaLamViecTuDongQuaDem4]["TongGioTrongCaLamViec"]) * 60f - (float)(Convert.ToInt32(this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value.ToString()) + Convert.ToInt32(this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value))) / 60.0, this.iLamTronGio);
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = dGio7.ToString();
                                                double iGio7;
                                                iGio7 = Convert.ToDouble(dtCaLamViecTuDongQuaDem4.Rows[iCaLamViecTuDongQuaDem4]["TongGioTrongCaLamViec"].ToString());
                                                double dCongTinh7;
                                                dCongTinh7 = Convert.ToDouble(dtCaLamViecTuDongQuaDem4.Rows[iCaLamViecTuDongQuaDem4]["CongTinh"].ToString());
                                                double dCong7;
                                                dCong7 = Math.Round(dGio7 * dCongTinh7 / iGio7, this.iLamTronCong);
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = dCong7.ToString();
                                                double dTongGioThucTeTuDongQuaDem4;
                                                dTongGioThucTeTuDongQuaDem4 = Math.Round(Convert.ToDouble(Convert.ToInt32((dGioRaTuDongQuaDem - dGioVaoTuDongQuaDem).TotalMinutes).ToString()) / 60.0, this.iLamTronGio);
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[16].Value = dTongGioThucTeTuDongQuaDem4.ToString();
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[17].Value = dtCaLamViecTuDongQuaDem4.Rows[iCaLamViecTuDongQuaDem4]["CongTinh"].ToString();
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[18].Value = this.sKHDungGio;
                                                string sChoPhepTangCaTruocGioLamViecTuDongQuaDem6;
                                                sChoPhepTangCaTruocGioLamViecTuDongQuaDem6 = dtCaLamViecTuDongQuaDem4.Rows[iCaLamViecTuDongQuaDem4]["TangCaTruocGioLamViec"].ToString();
                                                int iPhutTangCaTruocGioLamViecTuDongQuaDem6;
                                                iPhutTangCaTruocGioLamViecTuDongQuaDem6 = Convert.ToInt32(dtCaLamViecTuDongQuaDem4.Rows[iCaLamViecTuDongQuaDem4]["SoPhutTangCaTruocGioLamViec"].ToString());
                                                int iPhutTangCaTruocGioLamViecDatDen10;
                                                iPhutTangCaTruocGioLamViecDatDen10 = Convert.ToInt32(dtCaLamViecTuDongQuaDem4.Rows[iCaLamViecTuDongQuaDem4]["TangCaTruocGioLamViecDatDen"].ToString());
                                                int iPhutTruTangCaTruoc10;
                                                iPhutTruTangCaTruoc10 = Convert.ToInt32(dtCaLamViecTuDongQuaDem4.Rows[iCaLamViecTuDongQuaDem4]["PhutTruTangCaTruoc"].ToString());
                                                string sChoPhepTangCaSauGioLamViecTuDongQuaDem6;
                                                sChoPhepTangCaSauGioLamViecTuDongQuaDem6 = dtCaLamViecTuDongQuaDem4.Rows[iCaLamViecTuDongQuaDem4]["TangCaSauGioLamViec"].ToString();
                                                int iPhutTangCaSauGioLamViecTuDongQuaDem6;
                                                iPhutTangCaSauGioLamViecTuDongQuaDem6 = Convert.ToInt32(dtCaLamViecTuDongQuaDem4.Rows[iCaLamViecTuDongQuaDem4]["SoPhutTangCaSauGioLamViec"].ToString());
                                                int iPhutTangCaSauGioLamViecDatDen10;
                                                iPhutTangCaSauGioLamViecDatDen10 = Convert.ToInt32(dtCaLamViecTuDongQuaDem4.Rows[iCaLamViecTuDongQuaDem4]["TangCaSauGioLamViecDatDen"].ToString());
                                                int iPhutTruTangCaSau10;
                                                iPhutTruTangCaSau10 = Convert.ToInt32(dtCaLamViecTuDongQuaDem4.Rows[iCaLamViecTuDongQuaDem4]["PhutTruTangCaSau"].ToString());
                                                int iGioiHanTC1TuDongQuaDem6;
                                                iGioiHanTC1TuDongQuaDem6 = Convert.ToInt32(dtCaLamViecTuDongQuaDem4.Rows[iCaLamViecTuDongQuaDem4]["GioiHanTangCa1"].ToString());
                                                int iGioiHanTC2TuDongQuaDem6;
                                                iGioiHanTC2TuDongQuaDem6 = Convert.ToInt32(dtCaLamViecTuDongQuaDem4.Rows[iCaLamViecTuDongQuaDem4]["GioiHanTangCa2"].ToString());
                                                int iGioiHanTC3TuDongQuaDem6;
                                                iGioiHanTC3TuDongQuaDem6 = Convert.ToInt32(dtCaLamViecTuDongQuaDem4.Rows[iCaLamViecTuDongQuaDem4]["GioiHanTangCa3"].ToString());
                                                int iGioiHanTC4TuDongQuaDem6;
                                                iGioiHanTC4TuDongQuaDem6 = Convert.ToInt32(dtCaLamViecTuDongQuaDem4.Rows[iCaLamViecTuDongQuaDem4]["GioiHanTangCa4"].ToString());
                                                int iTongGioTangCaSauTuDongQuaDem6;
                                                iTongGioTangCaSauTuDongQuaDem6 = 0;
                                                int iTongGioTangCaTruocTuDongQuaDem6;
                                                iTongGioTangCaTruocTuDongQuaDem6 = 0;
                                                if (sChoPhepTangCaTruocGioLamViecTuDongQuaDem6 == "False" && sChoPhepTangCaSauGioLamViecTuDongQuaDem6 == "False")
                                                {
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                }
                                                else
                                                {
                                                    if (sChoPhepTangCaTruocGioLamViecTuDongQuaDem6 == "True")
                                                    {
                                                        int iThoiGianTruocGioLamTuDongQuaDem6;
                                                        iThoiGianTruocGioLamTuDongQuaDem6 = Convert.ToInt32(Convert.ToInt32((dGioVaoKhaiBaoTuDongQuaDemB4 - dGioVaoTuDongQuaDem).TotalMinutes).ToString());
                                                        if (iThoiGianTruocGioLamTuDongQuaDem6 > 0 && iThoiGianTruocGioLamTuDongQuaDem6 > iPhutTangCaTruocGioLamViecTuDongQuaDem6 && iThoiGianTruocGioLamTuDongQuaDem6 > iPhutTangCaTruocGioLamViecDatDen10)
                                                        {
                                                            iTongGioTangCaTruocTuDongQuaDem6 = iThoiGianTruocGioLamTuDongQuaDem6 - iPhutTruTangCaTruoc10;
                                                        }
                                                    }
                                                    if (sChoPhepTangCaSauGioLamViecTuDongQuaDem6 == "True")
                                                    {
                                                        int iThoiGianSauGioLamViecTuDongQuaDem8;
                                                        iThoiGianSauGioLamViecTuDongQuaDem8 = Convert.ToInt32(Convert.ToInt32((dGioRaTuDongQuaDem - dGioRaKhaiBaoTuDongQuaDemB4).TotalMinutes).ToString());
                                                        if (iThoiGianSauGioLamViecTuDongQuaDem8 > 0 && iThoiGianSauGioLamViecTuDongQuaDem8 > iPhutTangCaSauGioLamViecTuDongQuaDem6 && iThoiGianSauGioLamViecTuDongQuaDem8 > iPhutTangCaSauGioLamViecDatDen10)
                                                        {
                                                            iTongGioTangCaSauTuDongQuaDem6 = iThoiGianSauGioLamViecTuDongQuaDem8 - iPhutTruTangCaSau10;
                                                        }
                                                    }
                                                }
                                                double dTongThoiGianTangCaTuDongQuaDem6;
                                                dTongThoiGianTangCaTuDongQuaDem6 = Convert.ToDouble(iTongGioTangCaTruocTuDongQuaDem6 + iTongGioTangCaSauTuDongQuaDem6);
                                                if (dTongThoiGianTangCaTuDongQuaDem6 > 0.0)
                                                {
                                                    if (iGioiHanTC1TuDongQuaDem6 == 0)
                                                    {
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = Math.Round(dTongThoiGianTangCaTuDongQuaDem6 * this.dTangCa1HeSo / 60.0, this.iLamTronGio);
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                    }
                                                    if (iGioiHanTC1TuDongQuaDem6 != 0 && iGioiHanTC2TuDongQuaDem6 == 0)
                                                    {
                                                        if (dTongThoiGianTangCaTuDongQuaDem6 < Convert.ToDouble(iGioiHanTC1TuDongQuaDem6))
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = Math.Round(dTongThoiGianTangCaTuDongQuaDem6 * this.dTangCa1HeSo / 60.0, this.iLamTronGio);
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                        }
                                                        else
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = Math.Round(Convert.ToDouble(iGioiHanTC1TuDongQuaDem6) / 60.0 * this.dTangCa1HeSo, this.iLamTronGio);
                                                            if (dTongThoiGianTangCaTuDongQuaDem6 - Convert.ToDouble(iGioiHanTC1TuDongQuaDem6) > 0.0)
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = Math.Round((dTongThoiGianTangCaTuDongQuaDem6 - Convert.ToDouble(iGioiHanTC1TuDongQuaDem6)) * this.dTangCa2HeSo / 60.0, this.iLamTronGio);
                                                            }
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                        }
                                                    }
                                                    if (iGioiHanTC1TuDongQuaDem6 != 0 && iGioiHanTC2TuDongQuaDem6 != 0 && iGioiHanTC3TuDongQuaDem6 == 0)
                                                    {
                                                        if (dTongThoiGianTangCaTuDongQuaDem6 < Convert.ToDouble(iGioiHanTC1TuDongQuaDem6))
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = Math.Round(dTongThoiGianTangCaTuDongQuaDem6 * this.dTangCa1HeSo / 60.0, this.iLamTronGio);
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                        }
                                                        else
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = Math.Round(Convert.ToDouble(iGioiHanTC1TuDongQuaDem6) * this.dTangCa1HeSo / 60.0, this.iLamTronGio);
                                                            if (dTongThoiGianTangCaTuDongQuaDem6 - Convert.ToDouble(iGioiHanTC1TuDongQuaDem6) < Convert.ToDouble(iGioiHanTC2TuDongQuaDem6))
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = Math.Round((dTongThoiGianTangCaTuDongQuaDem6 - Convert.ToDouble(iGioiHanTC1TuDongQuaDem6)) * this.dTangCa2HeSo / 60.0, this.iLamTronGio);
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                            }
                                                            else
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = Math.Round(Convert.ToDouble(iGioiHanTC1TuDongQuaDem6) * this.dTangCa1HeSo / 60.0, this.iLamTronGio);
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = Math.Round(Convert.ToDouble(iGioiHanTC2TuDongQuaDem6) * this.dTangCa2HeSo / 60.0, this.iLamTronGio);
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = Math.Round((dTongThoiGianTangCaTuDongQuaDem6 - Convert.ToDouble(iGioiHanTC1TuDongQuaDem6) - Convert.ToDouble(iGioiHanTC2TuDongQuaDem6)) * this.dTangCa3HeSo / 60.0, this.iLamTronGio);
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                            }
                                                        }
                                                    }
                                                    if (iGioiHanTC1TuDongQuaDem6 != 0 && iGioiHanTC2TuDongQuaDem6 != 0 && iGioiHanTC3TuDongQuaDem6 != 0 && iGioiHanTC4TuDongQuaDem6 != 0)
                                                    {
                                                    }
                                                }
                                                else
                                                {
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                }
                                            }
                                            if (DateTimeProgress.XuatIDThu((int)dt.AddDays(dem).DayOfWeek) == "0")
                                            {
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[19].Value = "CN";
                                            }
                                            else
                                            {
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[19].Value = "NT";
                                            }
                                            this.DGVTinhCong.Rows[_nhanVien].Cells[20].Value = this.sMaChamCong;
                                            this.DGVTinhCong.Rows[_nhanVien].Cells[21].Value = this.sPhongBanTinhCong;
                                            break;
                                        }
                                    }
                                }
                                if (demTuDongQuaDem % 2 != 0 && demTuDongQuaDem != 1)
                                {
                                    addTuDongQuaDemB = this.DGVTinhCong.Rows.Add();
                                    dGioVaoTuDongQuaDem = Convert.ToDateTime(dtTuDongQuaDem.Rows[iTuDongQuaDem]["GioCham"].ToString());
                                    this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[5].Value = string.Format(this.sDinhDangThoiGian, dGioVaoTuDongQuaDem);
                                    this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[0].Value = this.sMaNhanVien;
                                    this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[1].Value = this.sTenNhanVien;
                                    this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[2].Value = this.DGVTinhCong.Rows[_nhanVien].Cells[2].Value.ToString();
                                    this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[3].Value = DateTimeProgress.XuatThuTinhCong((int)dt.AddDays(dem).DayOfWeek);
                                    this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[4].Value = ca;
                                    this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[7].Value = "0";
                                    this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[8].Value = "0";
                                    this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[9].Value = "0";
                                    this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[10].Value = "0";
                                    this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[11].Value = "0";
                                    this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[12].Value = "0";
                                    this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[13].Value = "0";
                                    this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[14].Value = "0";
                                    this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[15].Value = "0";
                                    this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[16].Value = "0";
                                    this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[17].Value = "0";
                                    this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[18].Value = this.sKHVang;
                                    if (DateTimeProgress.XuatIDThu((int)dt.AddDays(dem).DayOfWeek) == "0")
                                    {
                                        this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[19].Value = "CN";
                                    }
                                    else
                                    {
                                        this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[19].Value = "NT";
                                    }
                                    this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[20].Value = this.sMaChamCong;
                                    this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[21].Value = this.sPhongBanTinhCong;
                                }
                                if (demTuDongQuaDem % 2 != 0 || demTuDongQuaDem == 2)
                                {
                                    continue;
                                }
                                dGioRaTuDongQuaDem = Convert.ToDateTime(dtTuDongQuaDem.Rows[iTuDongQuaDem]["GioCham"].ToString());
                                this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[6].Value = string.Format(this.sDinhDangThoiGian, dGioRaTuDongQuaDem);
                                new DataTable();
                                this._chiTietLichTrinhChoCalamViecDTO.MaLichTrinhCaLamViec = sLTCCLVNhanVien;
                                this._chiTietLichTrinhChoCalamViecDTO.Thu = sThu;
                                DataTable dtNhanCaTuDongQuaDem6;
                                dtNhanCaTuDongQuaDem6 = this._chiTietLichTrinhChoCaLamViecBLL.ChiTietLichTrinhChoCaLamViecNhanCa(this._chiTietLichTrinhChoCalamViecDTO);
                                int iChiTietLichTrinhChoCaLamViecTuDongQuaDem6;
                                iChiTietLichTrinhChoCaLamViecTuDongQuaDem6 = 0;
                                if (iChiTietLichTrinhChoCaLamViecTuDongQuaDem6 >= dtNhanCaTuDongQuaDem6.Rows.Count)
                                {
                                    continue;
                                }
                                int cellChiTietLichTrinhChoCaLamViecTuDongQuaDem6;
                                cellChiTietLichTrinhChoCaLamViecTuDongQuaDem6 = 3;
                                while (true)
                                {
                                    if (cellChiTietLichTrinhChoCaLamViecTuDongQuaDem6 < 13)
                                    {
                                        kiemTraVao = 0;
                                        kiemTraRa = 0;
                                        this.sTuDongQuaDemMaCaLamViec = dtNhanCaTuDongQuaDem6.Rows[iChiTietLichTrinhChoCaLamViecTuDongQuaDem6][cellChiTietLichTrinhChoCaLamViecTuDongQuaDem6].ToString();
                                        new DataTable();
                                        DataTable dtTuDongQuaDemCa4;
                                        dtTuDongQuaDemCa4 = this._caLamViecBLL.CaLamViecGetByMaCaLamViec(sTuDongQuaDemMaCaLamViec);
                                        int iTuDongQuaDemCa4;
                                        iTuDongQuaDemCa4 = 0;
                                        while (iTuDongQuaDemCa4 < dtTuDongQuaDemCa4.Rows.Count)
                                        {
                                            string sGiayGioVao12;
                                            sGiayGioVao12 = dGioVaoTuDongQuaDem.Second.ToString();
                                            string sGiayGioRa12;
                                            sGiayGioRa12 = dGioRaTuDongQuaDem.Second.ToString();
                                            this.sTuDongQuaDemTenCaLamViec = dtTuDongQuaDemCa4.Rows[iTuDongQuaDemCa4]["CaLamViec"].ToString();
                                            DateTime dBatDauVaoB4;
                                            dBatDauVaoB4 = Convert.ToDateTime(sNgayCham + " " + string.Format("{0:T}", Convert.ToDateTime(dtTuDongQuaDemCa4.Rows[iTuDongQuaDemCa4]["BatDauVao"].ToString())).Replace("00 ", sGiayGioVao12 + " "));
                                            DateTime dKetThucVaoB4;
                                            dKetThucVaoB4 = Convert.ToDateTime(sNgayCham + " " + string.Format("{0:T}", Convert.ToDateTime(dtTuDongQuaDemCa4.Rows[iTuDongQuaDemCa4]["KetThucVao"].ToString())).Replace("00 ", sGiayGioVao12 + " "));
                                            DateTime dBatDauRaB4;
                                            dBatDauRaB4 = Convert.ToDateTime(sNgayCham + " " + string.Format("{0:T}", Convert.ToDateTime(dtTuDongQuaDemCa4.Rows[iTuDongQuaDemCa4]["BatDauRa"].ToString())).Replace("00 ", sGiayGioRa12 + " "));
                                            DateTime dKetThucRaB4;
                                            dKetThucRaB4 = Convert.ToDateTime(sNgayCham + " " + string.Format("{0:T}", Convert.ToDateTime(dtTuDongQuaDemCa4.Rows[iTuDongQuaDemCa4]["KetThucRa"].ToString())).Replace("00 ", sGiayGioRa12 + " "));
                                            if (dGioVaoTuDongQuaDem >= dBatDauVaoB4 && dGioVaoTuDongQuaDem <= dKetThucVaoB4)
                                            {
                                                kiemTraVao++;
                                            }
                                            if (dGioRaTuDongQuaDem >= dBatDauRaB4 && dGioRaTuDongQuaDem <= dKetThucRaB4)
                                            {
                                                kiemTraRa++;
                                            }
                                            if (kiemTraVao != 1 || kiemTraRa != 1)
                                            {
                                                iTuDongQuaDemCa4++;
                                                continue;
                                            }
                                            goto IL_41999;
                                        }
                                        if (!(this.sTuDongQuaDemMaCaLamViec == ""))
                                        {
                                            cellChiTietLichTrinhChoCaLamViecTuDongQuaDem6++;
                                            continue;
                                        }
                                        this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[4].Value = ca;
                                        this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[7].Value = "0";
                                        this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[8].Value = "0";
                                        this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[9].Value = "0";
                                        this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[10].Value = "0";
                                        this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[11].Value = "0";
                                        this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[12].Value = "0";
                                        this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[13].Value = "0";
                                        this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[14].Value = "0";
                                        this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[15].Value = "0";
                                        this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[16].Value = "0";
                                        this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[17].Value = "0";
                                        this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[18].Value = this.sKHVang;
                                        if (DateTimeProgress.XuatIDThu((int)dt.AddDays(dem).DayOfWeek) == "0")
                                        {
                                            this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[19].Value = "CN";
                                        }
                                        else
                                        {
                                            this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[19].Value = "NT";
                                        }
                                        this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[20].Value = this.sMaChamCong;
                                        this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[21].Value = this.sPhongBanTinhCong;
                                        break;
                                    }
                                    goto IL_41999;
                                IL_41999:
                                    this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[4].Value = this.sTuDongQuaDemTenCaLamViec;
                                    new DataTable();
                                    DataTable dtCaLamViecTuDongQuaDem3;
                                    dtCaLamViecTuDongQuaDem3 = this._caLamViecBLL.CaLamViecGetByMaCaLamViec(sTuDongQuaDemMaCaLamViec);
                                    for (int iCaLamViecTuDongQuaDem3 = 0; iCaLamViecTuDongQuaDem3 < dtCaLamViecTuDongQuaDem3.Rows.Count; iCaLamViecTuDongQuaDem3++)
                                    {
                                        string sGiayGioVao11;
                                        sGiayGioVao11 = dGioVaoTuDongQuaDem.Second.ToString();
                                        string sGiayGioRa11;
                                        sGiayGioRa11 = dGioRaTuDongQuaDem.Second.ToString();
                                        DateTime dGioVaoKhaiBaoTuDongQuaDemB3;
                                        dGioVaoKhaiBaoTuDongQuaDemB3 = Convert.ToDateTime(sNgayCham + " " + string.Format("{0:T}", Convert.ToDateTime(dtCaLamViecTuDongQuaDem3.Rows[iCaLamViecTuDongQuaDem3]["GioVaoLamViec"].ToString())).Replace("00 ", sGiayGioVao11 + " "));
                                        DateTime dGioRaKhaiBaoTuDongQuaDemB3;
                                        dGioRaKhaiBaoTuDongQuaDemB3 = Convert.ToDateTime(sNgayCham + " " + string.Format("{0:T}", Convert.ToDateTime(dtCaLamViecTuDongQuaDem3.Rows[iCaLamViecTuDongQuaDem3]["GioKetThucLamViec"].ToString())).Replace("00 ", sGiayGioRa11 + " "));
                                        string sTruGioDiTre9;
                                        sTruGioDiTre9 = dtCaLamViecTuDongQuaDem3.Rows[iCaLamViecTuDongQuaDem3]["TruGioDiTre"].ToString();
                                        string sBatDauTinhDiTre9;
                                        sBatDauTinhDiTre9 = dtCaLamViecTuDongQuaDem3.Rows[iCaLamViecTuDongQuaDem3]["BatDauTinhDiTre"].ToString();
                                        int iChoPhepDiTre6;
                                        iChoPhepDiTre6 = Convert.ToInt32(dtCaLamViecTuDongQuaDem3.Rows[iCaLamViecTuDongQuaDem3]["ChoPhepDiTre"].ToString());
                                        string sPhutTre6;
                                        sPhutTre6 = Convert.ToInt32((dGioVaoTuDongQuaDem - dGioVaoKhaiBaoTuDongQuaDemB3).TotalMinutes).ToString();
                                        if (sTruGioDiTre9 == "True")
                                        {
                                            if (Convert.ToInt32(sPhutTre6) < 0)
                                            {
                                                this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[9].Value = "0";
                                            }
                                            else
                                            {
                                                int iPhutTre6;
                                                iPhutTre6 = Convert.ToInt32(sPhutTre6) - iChoPhepDiTre6;
                                                if (sBatDauTinhDiTre9 == "True")
                                                {
                                                    if (iPhutTre6 < 1)
                                                    {
                                                        this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[9].Value = "0";
                                                    }
                                                    else
                                                    {
                                                        this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[5].Style.BackColor = Color.Lime;
                                                        this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[9].Value = iPhutTre6.ToString();
                                                    }
                                                }
                                                else if (iPhutTre6 < 1)
                                                {
                                                    this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[9].Value = "0";
                                                }
                                                else
                                                {
                                                    this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[9].Value = sPhutTre6;
                                                }
                                            }
                                        }
                                        else
                                        {
                                            this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[9].Value = "0";
                                        }
                                        string sTruGioVeSom9;
                                        sTruGioVeSom9 = dtCaLamViecTuDongQuaDem3.Rows[iCaLamViecTuDongQuaDem3]["TruGioVeSom"].ToString();
                                        string sBatDauTinhVeSom9;
                                        sBatDauTinhVeSom9 = dtCaLamViecTuDongQuaDem3.Rows[iCaLamViecTuDongQuaDem3]["BatDauTinhVeSom"].ToString();
                                        int iChoPhepVeSom6;
                                        iChoPhepVeSom6 = Convert.ToInt32(dtCaLamViecTuDongQuaDem3.Rows[iCaLamViecTuDongQuaDem3]["ChoPhepVeSom"].ToString());
                                        string sPhutVeSom6;
                                        sPhutVeSom6 = Convert.ToInt32((dGioRaKhaiBaoTuDongQuaDemB3 - dGioRaTuDongQuaDem).TotalMinutes).ToString();
                                        if (sTruGioVeSom9 == "True")
                                        {
                                            if (Convert.ToInt32(sPhutVeSom6) < 0)
                                            {
                                                this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[10].Value = "0";
                                            }
                                            else
                                            {
                                                int iPhutVeSom6;
                                                iPhutVeSom6 = Convert.ToInt32(sPhutVeSom6) - iChoPhepVeSom6;
                                                if (iPhutVeSom6 < 1)
                                                {
                                                    this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[10].Value = "0";
                                                }
                                                else if (sBatDauTinhVeSom9 == "True")
                                                {
                                                    this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[6].Style.BackColor = Color.Yellow;
                                                    this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[10].Value = iPhutVeSom6.ToString();
                                                }
                                                else
                                                {
                                                    this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[10].Value = sPhutVeSom6;
                                                }
                                            }
                                        }
                                        else
                                        {
                                            this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[10].Value = "0";
                                        }
                                        string sVeTre6;
                                        sVeTre6 = Convert.ToInt32((dGioRaTuDongQuaDem - dGioRaKhaiBaoTuDongQuaDemB3).TotalMinutes).ToString();
                                        if (Convert.ToInt32(sVeTre6) > 0)
                                        {
                                            this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[11].Value = sVeTre6;
                                        }
                                        else
                                        {
                                            this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[11].Value = "0";
                                        }
                                        double dGio6;
                                        dGio6 = Math.Round(Convert.ToDouble(Convert.ToSingle(dtCaLamViecTuDongQuaDem3.Rows[iCaLamViecTuDongQuaDem3]["TongGioTrongCaLamViec"]) * 60f - (float)(Convert.ToInt32(this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[9].Value.ToString()) + Convert.ToInt32(this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[10].Value))) / 60.0, this.iLamTronGio);
                                        this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[8].Value = dGio6.ToString();
                                        double iGio6;
                                        iGio6 = Convert.ToDouble(dtCaLamViecTuDongQuaDem3.Rows[iCaLamViecTuDongQuaDem3]["TongGioTrongCaLamViec"].ToString());
                                        double dCongTinh6;
                                        dCongTinh6 = Convert.ToDouble(dtCaLamViecTuDongQuaDem3.Rows[iCaLamViecTuDongQuaDem3]["CongTinh"].ToString());
                                        double dCong6;
                                        dCong6 = Math.Round(dGio6 * dCongTinh6 / iGio6, this.iLamTronCong);
                                        this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[7].Value = dCong6.ToString();
                                        double dTongGioThucTeTuDongQuaDem3;
                                        dTongGioThucTeTuDongQuaDem3 = Math.Round(Convert.ToDouble(Convert.ToInt32((dGioRaTuDongQuaDem - dGioVaoTuDongQuaDem).TotalMinutes).ToString()) / 60.0, this.iLamTronGio);
                                        this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[16].Value = dTongGioThucTeTuDongQuaDem3.ToString();
                                        this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[17].Value = dtCaLamViecTuDongQuaDem3.Rows[iCaLamViecTuDongQuaDem3]["CongTinh"].ToString();
                                        this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[18].Value = this.sKHDungGio;
                                        string sChoPhepTangCaTruocGioLamViecTuDongQuaDem5;
                                        sChoPhepTangCaTruocGioLamViecTuDongQuaDem5 = dtCaLamViecTuDongQuaDem3.Rows[iCaLamViecTuDongQuaDem3]["TangCaTruocGioLamViec"].ToString();
                                        int iPhutTangCaTruocGioLamViecTuDongQuaDem5;
                                        iPhutTangCaTruocGioLamViecTuDongQuaDem5 = Convert.ToInt32(dtCaLamViecTuDongQuaDem3.Rows[iCaLamViecTuDongQuaDem3]["SoPhutTangCaTruocGioLamViec"].ToString());
                                        int iPhutTangCaTruocGioLamViecDatDen8;
                                        iPhutTangCaTruocGioLamViecDatDen8 = Convert.ToInt32(dtCaLamViecTuDongQuaDem3.Rows[iCaLamViecTuDongQuaDem3]["TangCaTruocGioLamViecDatDen"].ToString());
                                        int iPhutTruTangCaTruoc8;
                                        iPhutTruTangCaTruoc8 = Convert.ToInt32(dtCaLamViecTuDongQuaDem3.Rows[iCaLamViecTuDongQuaDem3]["PhutTruTangCaTruoc"].ToString());
                                        string sChoPhepTangCaSauGioLamViecTuDongQuaDem5;
                                        sChoPhepTangCaSauGioLamViecTuDongQuaDem5 = dtCaLamViecTuDongQuaDem3.Rows[iCaLamViecTuDongQuaDem3]["TangCaSauGioLamViec"].ToString();
                                        int iPhutTangCaSauGioLamViecTuDongQuaDem5;
                                        iPhutTangCaSauGioLamViecTuDongQuaDem5 = Convert.ToInt32(dtCaLamViecTuDongQuaDem3.Rows[iCaLamViecTuDongQuaDem3]["SoPhutTangCaSauGioLamViec"].ToString());
                                        int iPhutTangCaSauGioLamViecDatDen8;
                                        iPhutTangCaSauGioLamViecDatDen8 = Convert.ToInt32(dtCaLamViecTuDongQuaDem3.Rows[iCaLamViecTuDongQuaDem3]["TangCaSauGioLamViecDatDen"].ToString());
                                        int iPhutTruTangCaSau8;
                                        iPhutTruTangCaSau8 = Convert.ToInt32(dtCaLamViecTuDongQuaDem3.Rows[iCaLamViecTuDongQuaDem3]["PhutTruTangCaSau"].ToString());
                                        int iGioiHanTC1TuDongQuaDem5;
                                        iGioiHanTC1TuDongQuaDem5 = Convert.ToInt32(dtCaLamViecTuDongQuaDem3.Rows[iCaLamViecTuDongQuaDem3]["GioiHanTangCa1"].ToString());
                                        int iGioiHanTC2TuDongQuaDem5;
                                        iGioiHanTC2TuDongQuaDem5 = Convert.ToInt32(dtCaLamViecTuDongQuaDem3.Rows[iCaLamViecTuDongQuaDem3]["GioiHanTangCa2"].ToString());
                                        int iGioiHanTC3TuDongQuaDem5;
                                        iGioiHanTC3TuDongQuaDem5 = Convert.ToInt32(dtCaLamViecTuDongQuaDem3.Rows[iCaLamViecTuDongQuaDem3]["GioiHanTangCa3"].ToString());
                                        int iGioiHanTC4TuDongQuaDem5;
                                        iGioiHanTC4TuDongQuaDem5 = Convert.ToInt32(dtCaLamViecTuDongQuaDem3.Rows[iCaLamViecTuDongQuaDem3]["GioiHanTangCa4"].ToString());
                                        int iTongGioTangCaSauTuDongQuaDem5;
                                        iTongGioTangCaSauTuDongQuaDem5 = 0;
                                        int iTongGioTangCaTruocTuDongQuaDem5;
                                        iTongGioTangCaTruocTuDongQuaDem5 = 0;
                                        if (sChoPhepTangCaTruocGioLamViecTuDongQuaDem5 == "False" && sChoPhepTangCaSauGioLamViecTuDongQuaDem5 == "False")
                                        {
                                            this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[12].Value = "0";
                                            this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[13].Value = "0";
                                            this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[14].Value = "0";
                                            this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[15].Value = "0";
                                        }
                                        else
                                        {
                                            if (sChoPhepTangCaTruocGioLamViecTuDongQuaDem5 == "True")
                                            {
                                                int iThoiGianTruocGioLamTuDongQuaDem5;
                                                iThoiGianTruocGioLamTuDongQuaDem5 = Convert.ToInt32(Convert.ToInt32((dGioVaoKhaiBaoTuDongQuaDemB3 - dGioVaoTuDongQuaDem).TotalMinutes).ToString());
                                                if (iThoiGianTruocGioLamTuDongQuaDem5 > 0 && iThoiGianTruocGioLamTuDongQuaDem5 > iPhutTangCaTruocGioLamViecTuDongQuaDem5 && iThoiGianTruocGioLamTuDongQuaDem5 > iPhutTangCaTruocGioLamViecDatDen8)
                                                {
                                                    iTongGioTangCaTruocTuDongQuaDem5 = iThoiGianTruocGioLamTuDongQuaDem5 - iPhutTruTangCaTruoc8;
                                                }
                                            }
                                            if (sChoPhepTangCaSauGioLamViecTuDongQuaDem5 == "True")
                                            {
                                                int iThoiGianSauGioLamViecTuDongQuaDem7;
                                                iThoiGianSauGioLamViecTuDongQuaDem7 = Convert.ToInt32(Convert.ToInt32((dGioRaTuDongQuaDem - dGioRaKhaiBaoTuDongQuaDemB3).TotalMinutes).ToString());
                                                if (iThoiGianSauGioLamViecTuDongQuaDem7 > 0 && iThoiGianSauGioLamViecTuDongQuaDem7 > iPhutTangCaSauGioLamViecTuDongQuaDem5 && iThoiGianSauGioLamViecTuDongQuaDem7 > iPhutTangCaSauGioLamViecDatDen8)
                                                {
                                                    iTongGioTangCaSauTuDongQuaDem5 = iThoiGianSauGioLamViecTuDongQuaDem7 - iPhutTruTangCaSau8;
                                                }
                                            }
                                        }
                                        double dTongThoiGianTangCaTuDongQuaDem5;
                                        dTongThoiGianTangCaTuDongQuaDem5 = Convert.ToDouble(iTongGioTangCaTruocTuDongQuaDem5 + iTongGioTangCaSauTuDongQuaDem5);
                                        if (dTongThoiGianTangCaTuDongQuaDem5 > 0.0)
                                        {
                                            if (iGioiHanTC1TuDongQuaDem5 == 0)
                                            {
                                                this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[12].Value = Math.Round(dTongThoiGianTangCaTuDongQuaDem5 * this.dTangCa1HeSo / 60.0, this.iLamTronGio);
                                                this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[13].Value = "0";
                                                this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[14].Value = "0";
                                                this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[15].Value = "0";
                                            }
                                            if (iGioiHanTC1TuDongQuaDem5 != 0 && iGioiHanTC2TuDongQuaDem5 == 0)
                                            {
                                                if (dTongThoiGianTangCaTuDongQuaDem5 < Convert.ToDouble(iGioiHanTC1TuDongQuaDem5))
                                                {
                                                    this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[12].Value = Math.Round(dTongThoiGianTangCaTuDongQuaDem5 * this.dTangCa1HeSo / 60.0, this.iLamTronGio);
                                                    this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[13].Value = "0";
                                                    this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[14].Value = "0";
                                                    this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[15].Value = "0";
                                                }
                                                else
                                                {
                                                    this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[12].Value = Math.Round(Convert.ToDouble(iGioiHanTC1TuDongQuaDem5) / 60.0 * this.dTangCa1HeSo, this.iLamTronGio);
                                                    if (dTongThoiGianTangCaTuDongQuaDem5 - Convert.ToDouble(iGioiHanTC1TuDongQuaDem5) > 0.0)
                                                    {
                                                        this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[13].Value = Math.Round((dTongThoiGianTangCaTuDongQuaDem5 - Convert.ToDouble(iGioiHanTC1TuDongQuaDem5)) * this.dTangCa2HeSo / 60.0, this.iLamTronGio);
                                                    }
                                                    this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[14].Value = "0";
                                                    this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[15].Value = "0";
                                                }
                                            }
                                            if (iGioiHanTC1TuDongQuaDem5 != 0 && iGioiHanTC2TuDongQuaDem5 != 0 && iGioiHanTC3TuDongQuaDem5 == 0)
                                            {
                                                if (dTongThoiGianTangCaTuDongQuaDem5 < Convert.ToDouble(iGioiHanTC1TuDongQuaDem5))
                                                {
                                                    this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[12].Value = Math.Round(dTongThoiGianTangCaTuDongQuaDem5 * this.dTangCa1HeSo / 60.0, this.iLamTronGio);
                                                    this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[13].Value = "0";
                                                    this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[14].Value = "0";
                                                    this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[15].Value = "0";
                                                }
                                                else
                                                {
                                                    this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[12].Value = Math.Round(Convert.ToDouble(iGioiHanTC1TuDongQuaDem5) * this.dTangCa1HeSo / 60.0, this.iLamTronGio);
                                                    if (dTongThoiGianTangCaTuDongQuaDem5 - Convert.ToDouble(iGioiHanTC1TuDongQuaDem5) < Convert.ToDouble(iGioiHanTC2TuDongQuaDem5))
                                                    {
                                                        this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[13].Value = Math.Round((dTongThoiGianTangCaTuDongQuaDem5 - Convert.ToDouble(iGioiHanTC1TuDongQuaDem5)) * this.dTangCa2HeSo / 60.0, this.iLamTronGio);
                                                        this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[14].Value = "0";
                                                        this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[15].Value = "0";
                                                    }
                                                    else
                                                    {
                                                        this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[12].Value = Math.Round(Convert.ToDouble(iGioiHanTC1TuDongQuaDem5) * this.dTangCa1HeSo / 60.0, this.iLamTronGio);
                                                        this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[13].Value = Math.Round(Convert.ToDouble(iGioiHanTC2TuDongQuaDem5) * this.dTangCa2HeSo / 60.0, this.iLamTronGio);
                                                        this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[14].Value = Math.Round((dTongThoiGianTangCaTuDongQuaDem5 - Convert.ToDouble(iGioiHanTC1TuDongQuaDem5) - Convert.ToDouble(iGioiHanTC2TuDongQuaDem5)) * this.dTangCa3HeSo / 60.0, this.iLamTronGio);
                                                        this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[15].Value = "0";
                                                    }
                                                }
                                            }
                                            if (iGioiHanTC1TuDongQuaDem5 != 0 && iGioiHanTC2TuDongQuaDem5 != 0 && iGioiHanTC3TuDongQuaDem5 != 0 && iGioiHanTC4TuDongQuaDem5 != 0)
                                            {
                                            }
                                        }
                                        else
                                        {
                                            this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[12].Value = "0";
                                            this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[13].Value = "0";
                                            this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[14].Value = "0";
                                            this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[15].Value = "0";
                                        }
                                    }
                                    if (DateTimeProgress.XuatIDThu((int)dt.AddDays(dem).DayOfWeek) == "0")
                                    {
                                        this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[19].Value = "CN";
                                    }
                                    else
                                    {
                                        this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[19].Value = "NT";
                                    }
                                    this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[20].Value = this.sMaChamCong;
                                    this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[21].Value = this.sPhongBanTinhCong;
                                    break;
                                }
                            }
                            if (demTuDongQuaDem == 0)
                            {
                                this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = "0";
                                this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = "0";
                                this.DGVTinhCong.Rows[_nhanVien].Cells[17].Value = "0";
                                this.DGVTinhCong.Rows[_nhanVien].Cells[18].Value = this.sKHVang;
                                if (DateTimeProgress.XuatIDThu((int)dt.AddDays(dem).DayOfWeek) == "0")
                                {
                                    this.DGVTinhCong.Rows[_nhanVien].Cells[19].Value = "CN";
                                }
                                else
                                {
                                    this.DGVTinhCong.Rows[_nhanVien].Cells[19].Value = "NT";
                                }
                                this.DGVTinhCong.Rows[_nhanVien].Cells[20].Value = this.sMaChamCong;
                                this.DGVTinhCong.Rows[_nhanVien].Cells[21].Value = this.sPhongBanTinhCong;
                            }
                            try
                            {
                                if (this.DGVTinhCong.Rows[_nhanVien - 1].Cells[4].Value == "***")
                                {
                                    this.DGVTinhCong.Rows[_nhanVien - 1].Cells[4].Style.BackColor = Color.Yellow;
                                }
                                if (this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[4].Value == "***")
                                {
                                    this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[4].Style.BackColor = Color.Yellow;
                                }
                            }
                            catch
                            {
                            }
                        }
                    }
                    else
                    {
                        this.DGVTinhCong.Rows[_nhanVien].Cells[4].Style.BackColor = Color.Red;
                        this.DGVTinhCong.Rows[_nhanVien].Cells[4].Value = "Chưa xếp ca!";
                        this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = "0";
                        this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = "0";
                        this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = "0";
                        this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = "0";
                        this.DGVTinhCong.Rows[_nhanVien].Cells[11].Value = "0";
                        this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = "0";
                        this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                        this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                        this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                        this.DGVTinhCong.Rows[_nhanVien].Cells[16].Value = "0";
                        this.DGVTinhCong.Rows[_nhanVien].Cells[17].Value = "0";
                        this.DGVTinhCong.Rows[_nhanVien].Cells[18].Value = this.sKHVang;
                        if (DateTimeProgress.XuatIDThu((int)dt.AddDays(dem).DayOfWeek) == "0")
                        {
                            this.DGVTinhCong.Rows[_nhanVien].Cells[19].Value = "CN";
                        }
                        else
                        {
                            this.DGVTinhCong.Rows[_nhanVien].Cells[19].Value = "NT";
                        }
                        this.DGVTinhCong.Rows[_nhanVien].Cells[20].Value = this.sMaChamCong;
                        this.DGVTinhCong.Rows[_nhanVien].Cells[21].Value = this.sPhongBanTinhCong;
                        for (int iChuaXepCa = 0; iChuaXepCa < 19; iChuaXepCa++)
                        {
                            this.DGVTinhCong.Rows[_nhanVien].Cells[iChuaXepCa].Style.ForeColor = Color.Black;
                        }
                        iKiemTraSapXepCa = 1;
                    }
                    if (iKiemTraSapXepCa == 0)
                    {
                        new DataTable();
                        DataTable dtKiemTraChamCong;
                        dtKiemTraChamCong = this._checkInOutBLL.getCheckInOutByMaChamCongAndNgayCham(Convert.ToInt32(this.sMaChamCong), Convert.ToDateTime(this.DGVTinhCong.Rows[_nhanVien].Cells[2].Value.ToString()));
                        int iKiemTraNghi;
                        iKiemTraNghi = 0;
                        new DataTable();
                        DataTable dtNgayLe;
                        dtNgayLe = this._ngayLeBLL.NgayLeGetTinhCong(Convert.ToDateTime(this.DGVTinhCong.Rows[_nhanVien].Cells[2].Value.ToString()));
                        for (int iNgayLe = 0; iNgayLe < dtNgayLe.Rows.Count; iNgayLe++)
                        {
                            if (dtKiemTraChamCong.Rows.Count == 0)
                            {
                                double fCongTinh;
                                fCongTinh = Convert.ToDouble(dtNgayLe.Rows[iNgayLe]["CongTinh"].ToString());
                                double fGio;
                                fGio = Convert.ToDouble(dtNgayLe.Rows[iNgayLe]["Gio"].ToString());
                                if (dtNgayLe.Rows[iNgayLe]["XacNhan"].ToString() == "True")
                                {
                                    this.DGVTinhCong.Rows[_nhanVien].Cells[0].Value = this.sMaNhanVien;
                                    this.DGVTinhCong.Rows[_nhanVien].Cells[1].Value = this.sTenNhanVien;
                                    this.DGVTinhCong.Rows[_nhanVien].Cells[2].Value = $"{Convert.ToDateTime(dt.AddDays(dem).ToString()):d}";
                                    this.DGVTinhCong.Rows[_nhanVien].Cells[3].Value = DateTimeProgress.XuatThuTinhCong((int)dt.AddDays(dem).DayOfWeek);
                                    this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = fCongTinh;
                                    this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = fGio;
                                    this.DGVTinhCong.Rows[_nhanVien].Cells[17].Value = "";
                                    this.DGVTinhCong.Rows[_nhanVien].Cells[18].Value = this.sKHLe;
                                    this.DGVTinhCong.Rows[_nhanVien].Cells[20].Value = this.sMaChamCong;
                                    iKiemTraNghi++;
                                }
                                continue;
                            }
                            double fCongTinh2;
                            fCongTinh2 = Convert.ToDouble(dtNgayLe.Rows[iNgayLe]["CongTinh"].ToString());
                            double fGio2;
                            fGio2 = Convert.ToDouble(dtNgayLe.Rows[iNgayLe]["Gio"].ToString());
                            if (dtNgayLe.Rows[iNgayLe]["XacNhan"].ToString() == "True")
                            {
                                int addNgayLe;
                                addNgayLe = this.DGVTinhCong.Rows.Add();
                                this.DGVTinhCong.Rows[addNgayLe].Cells[0].Value = this.sMaNhanVien;
                                this.DGVTinhCong.Rows[addNgayLe].Cells[1].Value = this.sTenNhanVien;
                                this.DGVTinhCong.Rows[addNgayLe].Cells[2].Value = $"{Convert.ToDateTime(dt.AddDays(dem).ToString()):d}";
                                this.DGVTinhCong.Rows[addNgayLe].Cells[3].Value = DateTimeProgress.XuatThuTinhCong((int)dt.AddDays(dem).DayOfWeek);
                                this.DGVTinhCong.Rows[addNgayLe].Cells[7].Value = fCongTinh2;
                                this.DGVTinhCong.Rows[addNgayLe].Cells[8].Value = fGio2;
                                this.DGVTinhCong.Rows[addNgayLe].Cells[17].Value = "";
                                this.DGVTinhCong.Rows[addNgayLe].Cells[18].Value = this.sKHLe;
                                this.DGVTinhCong.Rows[addNgayLe].Cells[20].Value = this.sMaChamCong;
                                iKiemTraNghi++;
                            }
                        }
                        new DataTable();
                        DataTable dtCongTac;
                        dtCongTac = this._chiTietDiCongTacBLL.ChiTietDiCongTacGetTinhCong(Convert.ToInt32(this.sMaChamCong), Convert.ToDateTime(this.DGVTinhCong.Rows[_nhanVien].Cells[2].Value.ToString()));
                        for (int iCongTac = 0; iCongTac < dtCongTac.Rows.Count; iCongTac++)
                        {
                            if (dtKiemTraChamCong.Rows.Count == 0 && iKiemTraNghi == 0)
                            {
                                this.DGVTinhCong.Rows[_nhanVien].Cells[0].Value = this.sMaNhanVien;
                                this.DGVTinhCong.Rows[_nhanVien].Cells[1].Value = this.sTenNhanVien;
                                this.DGVTinhCong.Rows[_nhanVien].Cells[2].Value = $"{Convert.ToDateTime(dt.AddDays(dem).ToString()):d}";
                                this.DGVTinhCong.Rows[_nhanVien].Cells[3].Value = DateTimeProgress.XuatThuTinhCong((int)dt.AddDays(dem).DayOfWeek);
                                this.DGVTinhCong.Rows[_nhanVien].Cells[5].Value = string.Format("{0:HH:mm}", Convert.ToDateTime(dtCongTac.Rows[iCongTac]["GioDi"].ToString()));
                                this.DGVTinhCong.Rows[_nhanVien].Cells[6].Value = string.Format("{0:HH:mm}", Convert.ToDateTime(dtCongTac.Rows[iCongTac]["GioVe"].ToString()));
                                this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = Math.Round(Convert.ToDouble(dtCongTac.Rows[iCongTac]["CongTinhCongTac"].ToString()), this.iLamTronCong);
                                this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = Math.Round(Convert.ToDouble(dtCongTac.Rows[iCongTac]["TongGioCongTac"].ToString()), this.iLamTronGio);
                                this.DGVTinhCong.Rows[_nhanVien].Cells[17].Value = "";
                                this.DGVTinhCong.Rows[_nhanVien].Cells[18].Value = this.sKHCongTac;
                                this.DGVTinhCong.Rows[_nhanVien].Cells[20].Value = this.sMaChamCong;
                                iKiemTraNghi++;
                            }
                            else
                            {
                                int addCongTac;
                                addCongTac = this.DGVTinhCong.Rows.Add();
                                this.DGVTinhCong.Rows[addCongTac].Cells[0].Value = this.sMaNhanVien;
                                this.DGVTinhCong.Rows[addCongTac].Cells[1].Value = this.sTenNhanVien;
                                this.DGVTinhCong.Rows[addCongTac].Cells[2].Value = $"{Convert.ToDateTime(dt.AddDays(dem).ToString()):d}";
                                this.DGVTinhCong.Rows[addCongTac].Cells[3].Value = DateTimeProgress.XuatThuTinhCong((int)dt.AddDays(dem).DayOfWeek);
                                this.DGVTinhCong.Rows[addCongTac].Cells[5].Value = string.Format("{0:HH:mm}", Convert.ToDateTime(dtCongTac.Rows[iCongTac]["GioDi"].ToString()));
                                this.DGVTinhCong.Rows[addCongTac].Cells[6].Value = string.Format("{0:HH:mm}", Convert.ToDateTime(dtCongTac.Rows[iCongTac]["GioVe"].ToString()));
                                this.DGVTinhCong.Rows[addCongTac].Cells[7].Value = Math.Round(Convert.ToDouble(dtCongTac.Rows[iCongTac]["CongTinhCongTac"].ToString()), this.iLamTronCong);
                                this.DGVTinhCong.Rows[addCongTac].Cells[8].Value = Math.Round(Convert.ToDouble(dtCongTac.Rows[iCongTac]["TongGioCongTac"].ToString()), this.iLamTronGio);
                                this.DGVTinhCong.Rows[addCongTac].Cells[17].Value = "";
                                this.DGVTinhCong.Rows[addCongTac].Cells[18].Value = this.sKHCongTac;
                                this.DGVTinhCong.Rows[addCongTac].Cells[20].Value = this.sMaChamCong;
                                iKiemTraNghi++;
                            }
                        }
                        new DataTable();
                        DataTable dtPhepNam;
                        dtPhepNam = this._phepNamBLL.PhepNamGetTinhCong(Convert.ToInt32(this.sMaChamCong), Convert.ToDateTime(this.DGVTinhCong.Rows[_nhanVien].Cells[2].Value.ToString()));
                        for (int iPhepNam = 0; iPhepNam < dtPhepNam.Rows.Count; iPhepNam++)
                        {
                            if (dtKiemTraChamCong.Rows.Count == 0 && iKiemTraNghi == 0)
                            {
                                this.DGVTinhCong.Rows[_nhanVien].Cells[0].Value = this.sMaNhanVien;
                                this.DGVTinhCong.Rows[_nhanVien].Cells[1].Value = this.sTenNhanVien;
                                this.DGVTinhCong.Rows[_nhanVien].Cells[2].Value = $"{Convert.ToDateTime(dt.AddDays(dem).ToString()):d}";
                                this.DGVTinhCong.Rows[_nhanVien].Cells[3].Value = DateTimeProgress.XuatThuTinhCong((int)dt.AddDays(dem).DayOfWeek);
                                this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = dtPhepNam.Rows[iPhepNam]["DemCong"].ToString();
                                this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = dtPhepNam.Rows[iPhepNam]["DemGio"].ToString();
                                this.DGVTinhCong.Rows[_nhanVien].Cells[17].Value = "";
                                this.DGVTinhCong.Rows[_nhanVien].Cells[18].Value = this.sKHPhepNam;
                                this.DGVTinhCong.Rows[_nhanVien].Cells[20].Value = this.sMaChamCong;
                                iKiemTraNghi++;
                            }
                            else
                            {
                                int addPhepNam;
                                addPhepNam = this.DGVTinhCong.Rows.Add();
                                this.DGVTinhCong.Rows[addPhepNam].Cells[0].Value = this.sMaNhanVien;
                                this.DGVTinhCong.Rows[addPhepNam].Cells[1].Value = this.sTenNhanVien;
                                this.DGVTinhCong.Rows[addPhepNam].Cells[2].Value = $"{Convert.ToDateTime(dt.AddDays(dem).ToString()):d}";
                                this.DGVTinhCong.Rows[addPhepNam].Cells[3].Value = DateTimeProgress.XuatThuTinhCong((int)dt.AddDays(dem).DayOfWeek);
                                this.DGVTinhCong.Rows[addPhepNam].Cells[7].Value = dtPhepNam.Rows[iPhepNam]["DemCong"].ToString();
                                this.DGVTinhCong.Rows[addPhepNam].Cells[8].Value = dtPhepNam.Rows[iPhepNam]["DemGio"].ToString();
                                this.DGVTinhCong.Rows[addPhepNam].Cells[17].Value = "";
                                this.DGVTinhCong.Rows[addPhepNam].Cells[18].Value = this.sKHPhepNam;
                                this.DGVTinhCong.Rows[addPhepNam].Cells[20].Value = this.sMaChamCong;
                                iKiemTraNghi++;
                            }
                        }
                        new DataTable();
                        this._khaiBaoVangChoNhanVienDTO.MaChamCong = Convert.ToInt32(this.sMaChamCong);
                        DateTime NgayThang = Convert.ToDateTime(this.DGVTinhCong.Rows[_nhanVien].Cells[2].Value.ToString());
                        DataTable dtNhanVienVang;
                        dtNhanVienVang = this._khaiBaoVangChoNhanVienBLL.CacLoaiVangGetTinhCong(Convert.ToInt32(this.sMaChamCong), NgayThang);
                        for (int iLoaiVangNhanVien = 0; iLoaiVangNhanVien < dtNhanVienVang.Rows.Count; iLoaiVangNhanVien++)
                        {
                            if (dtKiemTraChamCong.Rows.Count == 0 && iKiemTraNghi == 0)
                            {
                                this.DGVTinhCong.Rows[_nhanVien].Cells[0].Value = this.sMaNhanVien;
                                this.DGVTinhCong.Rows[_nhanVien].Cells[1].Value = this.sTenNhanVien;
                                this.DGVTinhCong.Rows[_nhanVien].Cells[2].Value = $"{Convert.ToDateTime(dt.AddDays(dem).ToString()):d}";
                                this.DGVTinhCong.Rows[_nhanVien].Cells[3].Value = DateTimeProgress.XuatThuTinhCong((int)dt.AddDays(dem).DayOfWeek);
                                if (dtNhanVienVang.Rows[iLoaiVangNhanVien]["DuocHuongLuong"].ToString() == "True")
                                {
                                    this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = dtNhanVienVang.Rows[iLoaiVangNhanVien]["NgayCong"].ToString();
                                    this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = dtNhanVienVang.Rows[iLoaiVangNhanVien]["TongPhut"].ToString();
                                }
                                else
                                {
                                    this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = "0";
                                    this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = 0;
                                }
                                string sMaCacLoaiVang;
                                sMaCacLoaiVang = dtNhanVienVang.Rows[iLoaiVangNhanVien]["MaCacLoaiVang"].ToString();
                                new DataTable();
                                DataTable dtCacLoaiVang;
                                dtCacLoaiVang = this._cacLoaiVangBLL.CacLoaiVangGetByMaCacLoaiVang(sMaCacLoaiVang);
                                for (int iCacLoaiVang = 0; iCacLoaiVang < dtCacLoaiVang.Rows.Count; iCacLoaiVang++)
                                {
                                    this.DGVTinhCong.Rows[_nhanVien].Cells[18].Value = dtCacLoaiVang.Rows[iCacLoaiVang]["KyHieu"].ToString();
                                }
                                this.DGVTinhCong.Rows[_nhanVien].Cells[20].Value = this.sMaChamCong;
                                iKiemTraNghi++;
                                continue;
                            }
                            int addCacLoaiVang;
                            addCacLoaiVang = this.DGVTinhCong.Rows.Add();
                            this.DGVTinhCong.Rows[addCacLoaiVang].Cells[0].Value = this.sMaNhanVien;
                            this.DGVTinhCong.Rows[addCacLoaiVang].Cells[1].Value = this.sTenNhanVien;
                            this.DGVTinhCong.Rows[addCacLoaiVang].Cells[2].Value = $"{Convert.ToDateTime(dt.AddDays(dem).ToString()):d}";
                            this.DGVTinhCong.Rows[addCacLoaiVang].Cells[3].Value = DateTimeProgress.XuatThuTinhCong((int)dt.AddDays(dem).DayOfWeek);
                            if (dtNhanVienVang.Rows[iLoaiVangNhanVien]["DuocHuongLuong"].ToString() == "True")
                            {
                                this.DGVTinhCong.Rows[addCacLoaiVang].Cells[7].Value = dtNhanVienVang.Rows[iLoaiVangNhanVien]["NgayCong"].ToString();
                                this.DGVTinhCong.Rows[addCacLoaiVang].Cells[8].Value = dtNhanVienVang.Rows[iLoaiVangNhanVien]["TongPhut"].ToString();
                            }
                            else
                            {
                                this.DGVTinhCong.Rows[addCacLoaiVang].Cells[7].Value = "0";
                                this.DGVTinhCong.Rows[addCacLoaiVang].Cells[8].Value = 0;
                            }
                            string sMaCacLoaiVang2;
                            sMaCacLoaiVang2 = dtNhanVienVang.Rows[iLoaiVangNhanVien]["MaCacLoaiVang"].ToString();
                            new DataTable();
                            DataTable dtCacLoaiVang2;
                            dtCacLoaiVang2 = this._cacLoaiVangBLL.CacLoaiVangGetByMaCacLoaiVang(sMaCacLoaiVang2);
                            for (int iCacLoaiVang2 = 0; iCacLoaiVang2 < dtCacLoaiVang2.Rows.Count; iCacLoaiVang2++)
                            {
                                this.DGVTinhCong.Rows[addCacLoaiVang].Cells[18].Value = dtCacLoaiVang2.Rows[iCacLoaiVang2]["KyHieu"].ToString();
                            }
                            this.DGVTinhCong.Rows[addCacLoaiVang].Cells[20].Value = this.sMaChamCong;
                            iKiemTraNghi++;
                        }
                    }
                    this.DGVTinhCong.Rows[_nhanVien].Cells[3].Value = DateTimeProgress.XuatThuTinhCong((int)dt.AddDays(dem).DayOfWeek);
                    if (this.sGioVao != null)
                    {
                        _ = this.sGioRa;
                    }
                    dem++;
                    if (this.checkBoxCoTinhLuong.Checked)
                    {
                        new DataTable();
                        this._chiTietPhuCapNhanVienDTO.MaChamCong = Convert.ToInt32(this.sMaChamCong);
                        this._chiTietPhuCapNhanVienDTO.Ngay = Convert.ToDateTime(this.DGVTinhCong.Rows[_nhanVien].Cells[2].Value.ToString());
                        this._chiTietPhuCapNhanVienDTO.KyHieuPhuCap = "PCTC";
                        DataTable dtChiTietPhuCapTienCom;
                        dtChiTietPhuCapTienCom = this._chiTietPhuCapNhanVienBLL.ChiTietPhuCapNhanVienGetByMaChamCongAndNgayAndKyHieuPhuCap(this._chiTietPhuCapNhanVienDTO);
                        for (int iChiTietPhuCapTienCom = 0; iChiTietPhuCapTienCom < dtChiTietPhuCapTienCom.Rows.Count; iChiTietPhuCapTienCom++)
                        {
                            this.dTongTienPhuCapTienCom += Convert.ToDouble(dtChiTietPhuCapTienCom.Rows[iChiTietPhuCapTienCom]["SoTien"].ToString());
                        }
                        new DataTable();
                        this._chiTietPhuCapNhanVienDTO.MaChamCong = Convert.ToInt32(this.sMaChamCong);
                        this._chiTietPhuCapNhanVienDTO.Ngay = Convert.ToDateTime(this.DGVTinhCong.Rows[_nhanVien].Cells[2].Value.ToString());
                        this._chiTietPhuCapNhanVienDTO.KyHieuPhuCap = "PCK";
                        DataTable dtChiTietPhuCapKhac;
                        dtChiTietPhuCapKhac = this._chiTietPhuCapNhanVienBLL.ChiTietPhuCapNhanVienGetByMaChamCongAndNgayAndKyHieuPhuCap(this._chiTietPhuCapNhanVienDTO);
                        for (int iChiTietPhuCapKhac = 0; iChiTietPhuCapKhac < dtChiTietPhuCapKhac.Rows.Count; iChiTietPhuCapKhac++)
                        {
                            this.dTongTienPhuCapKhac += Convert.ToDouble(dtChiTietPhuCapKhac.Rows[iChiTietPhuCapKhac]["SoTien"].ToString());
                        }
                        new DataTable();
                        this._chiTietTamUngLuongDTO.MaChamCong = Convert.ToInt32(this.sMaChamCong);
                        this._chiTietTamUngLuongDTO.NgayTamUng = Convert.ToDateTime(this.DGVTinhCong.Rows[_nhanVien].Cells[2].Value.ToString());
                        DataTable dtChiTietTamUngLuong;
                        dtChiTietTamUngLuong = this._chiTietTamUngLuongBLL.ChiTietTamUngLuongGetMaChamCongAndNgayTamUng(this._chiTietTamUngLuongDTO);
                        for (int iChiTietTamUngLuong = 0; iChiTietTamUngLuong < dtChiTietTamUngLuong.Rows.Count; iChiTietTamUngLuong++)
                        {
                            this.dTongTienTamUng += Convert.ToDouble(dtChiTietTamUngLuong.Rows[iChiTietTamUngLuong]["SoTien"].ToString());
                        }
                        new DataTable();
                        this._viPhamDTO.MaChamCong = Convert.ToInt32(this.sMaChamCong);
                        this._viPhamDTO.NgayThang = Convert.ToDateTime(this.DGVTinhCong.Rows[_nhanVien].Cells[2].Value.ToString());
                        DataTable dtChiTietViPham;
                        dtChiTietViPham = this._viPhamBLL.ViPhamGetMaChamCongAndNgayThang(this._viPhamDTO);
                        for (int iChiTietViPham = 0; iChiTietViPham < dtChiTietViPham.Rows.Count; iChiTietViPham++)
                        {
                            this.dTongTienViPham += Convert.ToDouble(dtChiTietViPham.Rows[iChiTietViPham]["TienPhat"].ToString());
                        }
                        new DataTable();
                        this._thuongDTO.MaChamCong = Convert.ToInt32(this.sMaChamCong);
                        this._thuongDTO.NgayThuong = Convert.ToDateTime(this.DGVTinhCong.Rows[_nhanVien].Cells[2].Value.ToString());
                        DataTable dtChiTietThuong;
                        dtChiTietThuong = this._thuongBLL.ThuongGetByMaChamCongAndNgayThuong(this._thuongDTO);
                        for (int iChiTietThuong = 0; iChiTietThuong < dtChiTietThuong.Rows.Count; iChiTietThuong++)
                        {
                            this.dTongTienThuong += Convert.ToDouble(dtChiTietThuong.Rows[iChiTietThuong]["TienThuong"].ToString());
                        }
                    }
                }
                demNhanVienDuocChon++;
                if (this.checkBoxCoTinhLuong.Checked)
                {
                    this._chiTietCongTruLuongDTO.MaChamCong = Convert.ToInt32(this.sMaChamCong);
                    this._chiTietCongTruLuongDTO.ChiTietPhuCapCom = this.dTongTienPhuCapTienCom.ToString();
                    this._chiTietCongTruLuongDTO.ChiTietPhuCapKhac = this.dTongTienPhuCapKhac.ToString();
                    this._chiTietCongTruLuongDTO.ChiTietTamUngLuong = this.dTongTienTamUng.ToString();
                    this._chiTietCongTruLuongDTO.ChiTietViPham = this.dTongTienViPham.ToString();
                    this._chiTietCongTruLuongDTO.ChiTietThuong = this.dTongTienThuong.ToString();
                    this._chiTietCongTruLuongBLL.ChiTietCongTruLuongInsert(this._chiTietCongTruLuongDTO);
                }
                _loadTinhCong.progressBarX1.Maximum = TestDemNhanVien;
                testProcess--;
                demProcess++;
                _loadTinhCong.progressBarX1.Text = (demProcess + 1) * 100 / TestDemNhanVien + "%";
                _loadTinhCong.lbDangTinh.Text = "Đang tính công";
                System.Windows.Forms.Application.DoEvents();
                if (TestDemNhanVien >= 0)
                {
                    _loadTinhCong.progressBarX1.Value = TestDemNhanVien - testProcess;
                }
            }
            if (demNhanVienDuocChon == 0)
            {
                _loadTinhCong.Close();
                MessageBox.Show("Bạn chưa chọn nhân viên để tính công");
                return;
            }
            this.lbNhanVienDuocChon.Text = "Tổng số nhân viên chọn tính công: " + demNhanVienDuocChon;
            this.lbTongSoDongTinhCong.Text = "Tổng số dòng tính công: " + this.DGVTinhCong.Rows.Count;
            this.lbTongSoNgayTinhCong.Text = "Tổng số ngày tính công: " + (Convert.ToInt32(this.sTongNgayTinh) + 1);
            this.Cursor = Cursors.Default;
            for (int iLuuTinhCong = 0; iLuuTinhCong < this.DGVTinhCong.Rows.Count; iLuuTinhCong++)
            {
                _loadTinhCong.lbDangTinh.Text = "Đang lưu tính công";
                Application.DoEvents();
                this._tinhCongDTO.MaNhanVien = this.DGVTinhCong.Rows[iLuuTinhCong].Cells[0].Value.ToString();
                this._tinhCongDTO.TenNhanVien = this.DGVTinhCong.Rows[iLuuTinhCong].Cells[1].Value.ToString();
                this._tinhCongDTO.Ngay = DateTime.Parse(this.DGVTinhCong.Rows[iLuuTinhCong].Cells[2].Value.ToString());
                this._tinhCongDTO.Thu = this.DGVTinhCong.Rows[iLuuTinhCong].Cells[3].Value.ToString();
                if (this.DGVTinhCong.Rows[iLuuTinhCong].Cells[4].Value == null)
                {
                    this._tinhCongDTO.Ca = "***";
                }
                else
                {
                    this._tinhCongDTO.Ca = this.DGVTinhCong.Rows[iLuuTinhCong].Cells[4].Value.ToString();
                }
                if (this.DGVTinhCong.Rows[iLuuTinhCong].Cells[5].Value == null)
                {
                    this._tinhCongDTO.GioVao = "";
                }
                else
                {
                    this._tinhCongDTO.GioVao = this.DGVTinhCong.Rows[iLuuTinhCong].Cells[5].Value.ToString();
                }
                if (this.DGVTinhCong.Rows[iLuuTinhCong].Cells[6].Value == null)
                {
                    this._tinhCongDTO.GioRa = "";
                }
                else
                {
                    this._tinhCongDTO.GioRa = this.DGVTinhCong.Rows[iLuuTinhCong].Cells[6].Value.ToString();
                }
                if (this.DGVTinhCong.Rows[iLuuTinhCong].Cells[7].Value == null)
                {
                    this._tinhCongDTO.Cong = "";
                }
                else
                {
                    this._tinhCongDTO.Cong = this.DGVTinhCong.Rows[iLuuTinhCong].Cells[7].Value.ToString();
                }
                if (this.DGVTinhCong.Rows[iLuuTinhCong].Cells[8].Value == null)
                {
                    this._tinhCongDTO.Gio = "";
                }
                else
                {
                    this._tinhCongDTO.Gio = this.DGVTinhCong.Rows[iLuuTinhCong].Cells[8].Value.ToString();
                }
                if (this.DGVTinhCong.Rows[iLuuTinhCong].Cells[9].Value == null)
                {
                    this._tinhCongDTO.Tre = 0;
                }
                else
                {
                    this._tinhCongDTO.Tre = Convert.ToInt32(this.DGVTinhCong.Rows[iLuuTinhCong].Cells[9].Value.ToString());
                }
                if (this.DGVTinhCong.Rows[iLuuTinhCong].Cells[10].Value == null)
                {
                    this._tinhCongDTO.VeSom = 0;
                }
                else
                {
                    this._tinhCongDTO.VeSom = Convert.ToInt32(this.DGVTinhCong.Rows[iLuuTinhCong].Cells[10].Value.ToString());
                }
                if (this.DGVTinhCong.Rows[iLuuTinhCong].Cells[11].Value == null)
                {
                    this._tinhCongDTO.VeTre = 0;
                }
                else
                {
                    this._tinhCongDTO.VeTre = Convert.ToInt32(this.DGVTinhCong.Rows[iLuuTinhCong].Cells[11].Value.ToString());
                }
                if (this.DGVTinhCong.Rows[iLuuTinhCong].Cells[12].Value == null)
                {
                    this._tinhCongDTO.TC1 = "0";
                }
                else
                {
                    this._tinhCongDTO.TC1 = this.DGVTinhCong.Rows[iLuuTinhCong].Cells[12].Value.ToString();
                }
                if (this.DGVTinhCong.Rows[iLuuTinhCong].Cells[13].Value == null)
                {
                    this._tinhCongDTO.TC2 = "0";
                }
                else
                {
                    this._tinhCongDTO.TC2 = this.DGVTinhCong.Rows[iLuuTinhCong].Cells[13].Value.ToString();
                }
                if (this.DGVTinhCong.Rows[iLuuTinhCong].Cells[14].Value == null)
                {
                    this._tinhCongDTO.TC3 = "0";
                }
                else
                {
                    this._tinhCongDTO.TC3 = this.DGVTinhCong.Rows[iLuuTinhCong].Cells[14].Value.ToString();
                }
                if (this.DGVTinhCong.Rows[iLuuTinhCong].Cells[15].Value == null)
                {
                    this._tinhCongDTO.TC4 = "0";
                }
                else
                {
                    this._tinhCongDTO.TC4 = this.DGVTinhCong.Rows[iLuuTinhCong].Cells[15].Value.ToString();
                }
                if (this.DGVTinhCong.Rows[iLuuTinhCong].Cells[16].Value == null)
                {
                    this._tinhCongDTO.TongGio = "0";
                }
                else
                {
                    this._tinhCongDTO.TongGio = this.DGVTinhCong.Rows[iLuuTinhCong].Cells[16].Value.ToString();
                }
                if (this.DGVTinhCong.Rows[iLuuTinhCong].Cells[17].Value == null)
                {
                    this._tinhCongDTO.DemCong = "0";
                }
                else
                {
                    this._tinhCongDTO.DemCong = this.DGVTinhCong.Rows[iLuuTinhCong].Cells[17].Value.ToString();
                }
                if (this.DGVTinhCong.Rows[iLuuTinhCong].Cells[18].Value == null)
                {
                    this._tinhCongDTO.KyHieu = "";
                }
                else
                {
                    this._tinhCongDTO.KyHieu = this.DGVTinhCong.Rows[iLuuTinhCong].Cells[18].Value.ToString();
                }
                if (this.DGVTinhCong.Rows[iLuuTinhCong].Cells[20].Value == null)
                {
                    this._tinhCongDTO.MaChamCong = 0;
                }
                else
                {
                    this._tinhCongDTO.MaChamCong = Convert.ToInt32(this.DGVTinhCong.Rows[iLuuTinhCong].Cells[20].Value.ToString());
                }
                if (this.DGVTinhCong.Rows[iLuuTinhCong].Cells[19].Value == null)
                {
                    this._tinhCongDTO.KyHieuPhu = "";
                }
                else
                {
                    this._tinhCongDTO.KyHieuPhu = this.DGVTinhCong.Rows[iLuuTinhCong].Cells[19].Value.ToString();
                }
                if (this.DGVTinhCong.Rows[iLuuTinhCong].Cells[21].Value == null)
                {
                    this._tinhCongDTO.PhongBan = "";
                }
                else
                {
                    this._tinhCongDTO.PhongBan = this.DGVTinhCong.Rows[iLuuTinhCong].Cells[21].Value.ToString();
                }
                this._tinhCongBLL.TinhCongInsert(this._tinhCongDTO);
            }
            if (this.checkBoxCoTinhLuong.Checked)
            {
                _loadTinhCong.lbDangTinh.Text = "Đang tính lương";
                System.Windows.Forms.Application.DoEvents();
                int iMaChamCongTinhCongTinhLuong;
                iMaChamCongTinhCongTinhLuong = 0;
                new DataTable();
                this._tinhCongDTO.Ngay = Convert.ToDateTime(this.dateTimeTuNgay.Text);
                DataTable dtTinhCongTinhLuong;
                dtTinhCongTinhLuong = this._tinhCongBLL.TinhCongGetNgay(this._tinhCongDTO);
                for (int iTinhCongTinhLuong = 0; iTinhCongTinhLuong < dtTinhCongTinhLuong.Rows.Count; iTinhCongTinhLuong++)
                {
                    string sDangKyThamGiaBaoHiem;
                    sDangKyThamGiaBaoHiem = "";
                    int iMaChamCongTinhCongTinhLuongKiemTra;
                    iMaChamCongTinhCongTinhLuongKiemTra = Convert.ToInt32(dtTinhCongTinhLuong.Rows[iTinhCongTinhLuong]["MaChamCong"].ToString());
                    if (iMaChamCongTinhCongTinhLuong != iMaChamCongTinhCongTinhLuongKiemTra)
                    {
                        iMaChamCongTinhCongTinhLuong = Convert.ToInt32(dtTinhCongTinhLuong.Rows[iTinhCongTinhLuong]["MaChamCong"].ToString());
                        int addLuongNhanVien;
                        addLuongNhanVien = this.DGVChiTietLuong.Rows.Add();
                        this.DGVChiTietLuong.Rows[addLuongNhanVien].Cells[0].Value = dtTinhCongTinhLuong.Rows[iTinhCongTinhLuong]["MaNhanVien"].ToString();
                        this.DGVChiTietLuong.Rows[addLuongNhanVien].Cells[1].Value = dtTinhCongTinhLuong.Rows[iTinhCongTinhLuong]["TenNhanVien"].ToString();
                        this.DGVChiTietLuong.Rows[addLuongNhanVien].Cells[2].Value = iMaChamCongTinhCongTinhLuong;
                        double dTienLuongHopDongNhanVien;
                        dTienLuongHopDongNhanVien = 0.0;
                        new DataTable();
                        DataTable dtNhanVienGetTinhLuong;
                        dtNhanVienGetTinhLuong = this._nhanVienBLL.NhanVienGetByMaChamCong(iMaChamCongTinhCongTinhLuong.ToString());
                        for (int iNhanVienGetTinhLuong = 0; iNhanVienGetTinhLuong < dtNhanVienGetTinhLuong.Rows.Count; iNhanVienGetTinhLuong++)
                        {
                            double dTienLuongNhanVien;
                            dTienLuongNhanVien = Convert.ToDouble(dtNhanVienGetTinhLuong.Rows[iNhanVienGetTinhLuong]["TienLuong"].ToString());
                            this.DGVChiTietLuong.Rows[addLuongNhanVien].Cells[3].Value = this._convertMoney.chendau(Convert.ToInt32(dTienLuongNhanVien).ToString());
                            dTienLuongHopDongNhanVien = Convert.ToDouble(dtNhanVienGetTinhLuong.Rows[iNhanVienGetTinhLuong]["LuongHopDong"].ToString());
                            this.DGVChiTietLuong.Rows[addLuongNhanVien].Cells[4].Value = this._convertMoney.chendau(Convert.ToInt32(dTienLuongHopDongNhanVien).ToString());
                            this.DGVChiTietLuong.Rows[addLuongNhanVien].Cells[5].Value = this.txtNgayCongTinh.Text;
                            sDangKyThamGiaBaoHiem = dtNhanVienGetTinhLuong.Rows[iNhanVienGetTinhLuong]["DangThamGiaBaoHiem"].ToString();
                        }
                        double dTongCongLamDuocTinhLuong;
                        dTongCongLamDuocTinhLuong = 0.0;
                        double dTongTangCaLamDuocTinhLuong;
                        dTongTangCaLamDuocTinhLuong = 0.0;
                        new DataTable();
                        this._tinhCongDTO.MaChamCong = iMaChamCongTinhCongTinhLuong;
                        DataTable dtNhanVienChiTietTinhLuong;
                        dtNhanVienChiTietTinhLuong = this._tinhCongBLL.TinhCongGetByMaChamCong(this._tinhCongDTO);
                        for (int iNhanVienChiTietTinhLuong = 0; iNhanVienChiTietTinhLuong < dtNhanVienChiTietTinhLuong.Rows.Count; iNhanVienChiTietTinhLuong++)
                        {
                            dTongCongLamDuocTinhLuong += Convert.ToDouble(dtNhanVienChiTietTinhLuong.Rows[iNhanVienChiTietTinhLuong]["Cong"].ToString());
                            dTongTangCaLamDuocTinhLuong += Convert.ToDouble(dtNhanVienChiTietTinhLuong.Rows[iNhanVienChiTietTinhLuong]["TC1"].ToString()) + Convert.ToDouble(dtNhanVienChiTietTinhLuong.Rows[iNhanVienChiTietTinhLuong]["TC2"].ToString()) + Convert.ToDouble(dtNhanVienChiTietTinhLuong.Rows[iNhanVienChiTietTinhLuong]["TC3"].ToString()) + Convert.ToDouble(dtNhanVienChiTietTinhLuong.Rows[iNhanVienChiTietTinhLuong]["TC4"].ToString());
                        }
                        this.DGVChiTietLuong.Rows[addLuongNhanVien].Cells[6].Value = dTongCongLamDuocTinhLuong.ToString();
                        this.DGVChiTietLuong.Rows[addLuongNhanVien].Cells[7].Value = dTongTangCaLamDuocTinhLuong.ToString();
                        double dLuongTheoNgayCongLamDuoc;
                        dLuongTheoNgayCongLamDuoc = Math.Round(Convert.ToDouble(this._convertMoney.loaidau(this.DGVChiTietLuong.Rows[addLuongNhanVien].Cells[4].Value.ToString())) / Convert.ToDouble(this.txtNgayCongTinh.Text), 0) * dTongCongLamDuocTinhLuong;
                        this.DGVChiTietLuong.Rows[addLuongNhanVien].Cells[8].Value = this._convertMoney.chendau(Convert.ToInt32(dLuongTheoNgayCongLamDuoc).ToString());
                        double dTienTangCaLamDuoc;
                        dTienTangCaLamDuoc = Math.Round(Math.Round(dTienLuongHopDongNhanVien / Convert.ToDouble(this.txtNgayCongTinh.Text), 0) / 8.0, 0) * dTongTangCaLamDuocTinhLuong;
                        this.DGVChiTietLuong.Rows[addLuongNhanVien].Cells[9].Value = this._convertMoney.chendau(Convert.ToInt32(dTienTangCaLamDuoc).ToString());
                        double dTongTienPhuCapComTinhLuong;
                        dTongTienPhuCapComTinhLuong = 0.0;
                        double dTongTienPhuCapKhacTinhLuong;
                        dTongTienPhuCapKhacTinhLuong = 0.0;
                        double dTongTienTamUngTinhLuong;
                        dTongTienTamUngTinhLuong = 0.0;
                        double dTongTienViPhamTinhLuong;
                        dTongTienViPhamTinhLuong = 0.0;
                        double dTongTienThuongTinhLuong;
                        dTongTienThuongTinhLuong = 0.0;
                        new DataTable();
                        this._chiTietCongTruLuongDTO.MaChamCong = iMaChamCongTinhCongTinhLuong;
                        DataTable dtCongTruLuongPhuCapTienCom;
                        dtCongTruLuongPhuCapTienCom = this._chiTietCongTruLuongBLL.ChiTietCongTruLuongGetByMaChamCong(iMaChamCongTinhCongTinhLuong);
                        for (int iCongTruLuongPhuCapTienCom = 0; iCongTruLuongPhuCapTienCom < dtCongTruLuongPhuCapTienCom.Rows.Count; iCongTruLuongPhuCapTienCom++)
                        {
                            this.DGVChiTietLuong.Rows[addLuongNhanVien].Cells[10].Value = this._convertMoney.chendau(Convert.ToInt32(dtCongTruLuongPhuCapTienCom.Rows[iCongTruLuongPhuCapTienCom]["ChiTietPhuCapCom"]).ToString());
                            dTongTienPhuCapComTinhLuong = Math.Round(Convert.ToDouble(dtCongTruLuongPhuCapTienCom.Rows[iCongTruLuongPhuCapTienCom]["ChiTietPhuCapCom"].ToString()) / Convert.ToDouble(this.txtNgayCongTinh.Text), 0) * dTongCongLamDuocTinhLuong;
                            this.DGVChiTietLuong.Rows[addLuongNhanVien].Cells[11].Value = this._convertMoney.chendau(Convert.ToInt32(dTongTienPhuCapComTinhLuong).ToString());
                            dTongTienPhuCapKhacTinhLuong = Convert.ToDouble(dtCongTruLuongPhuCapTienCom.Rows[iCongTruLuongPhuCapTienCom]["ChiTietPhuCapKhac"].ToString());
                            this.DGVChiTietLuong.Rows[addLuongNhanVien].Cells[12].Value = this._convertMoney.chendau(Convert.ToInt32(dTongTienPhuCapKhacTinhLuong).ToString());
                            dTongTienTamUngTinhLuong = Convert.ToDouble(dtCongTruLuongPhuCapTienCom.Rows[iCongTruLuongPhuCapTienCom]["ChiTietTamUngLuong"].ToString());
                            this.DGVChiTietLuong.Rows[addLuongNhanVien].Cells[18].Value = this._convertMoney.chendau(Convert.ToInt32(dTongTienTamUngTinhLuong).ToString());
                            dTongTienViPhamTinhLuong = Convert.ToDouble(dtCongTruLuongPhuCapTienCom.Rows[iCongTruLuongPhuCapTienCom]["ChiTietViPham"].ToString());
                            this.DGVChiTietLuong.Rows[addLuongNhanVien].Cells[19].Value = this._convertMoney.chendau(Convert.ToInt32(dTongTienViPhamTinhLuong).ToString());
                            dTongTienThuongTinhLuong = Convert.ToDouble(dtCongTruLuongPhuCapTienCom.Rows[iCongTruLuongPhuCapTienCom]["ChiTietThuong"].ToString());
                            this.DGVChiTietLuong.Rows[addLuongNhanVien].Cells[13].Value = this._convertMoney.chendau(Convert.ToInt32(dTongTienThuongTinhLuong).ToString());
                        }
                        double dTongLuongTinhLuong;
                        dTongLuongTinhLuong = dLuongTheoNgayCongLamDuoc + dTongTienPhuCapComTinhLuong + dTongTienPhuCapKhacTinhLuong + dTienTangCaLamDuoc + dTongTienThuongTinhLuong;
                        this.DGVChiTietLuong.Rows[addLuongNhanVien].Cells[14].Value = this._convertMoney.chendau(Convert.ToInt32(dTongLuongTinhLuong).ToString());
                        double dTienBaoHiemXaHoi;
                        dTienBaoHiemXaHoi = 0.0;
                        double dTienBaoHiemyTe;
                        dTienBaoHiemyTe = 0.0;
                        double dTienBaoHiemThatNghiep;
                        dTienBaoHiemThatNghiep = 0.0;
                        if (sDangKyThamGiaBaoHiem == "True")
                        {
                            dTienBaoHiemXaHoi = Math.Round(Convert.ToDouble(this._convertMoney.loaidau(this.DGVChiTietLuong.Rows[addLuongNhanVien].Cells[3].Value.ToString())) * this.dHeSoBaoHiemXaHoi / 100.0);
                            this.DGVChiTietLuong.Rows[addLuongNhanVien].Cells[15].Value = this._convertMoney.chendau(Convert.ToInt32(dTienBaoHiemXaHoi).ToString());
                            dTienBaoHiemyTe = Math.Round(Convert.ToDouble(this._convertMoney.loaidau(this.DGVChiTietLuong.Rows[addLuongNhanVien].Cells[3].Value.ToString())) * this.dHeSoBaoHiemYTe / 100.0);
                            this.DGVChiTietLuong.Rows[addLuongNhanVien].Cells[16].Value = this._convertMoney.chendau(Convert.ToInt32(dTienBaoHiemyTe).ToString());
                            dTienBaoHiemThatNghiep = Math.Round(Convert.ToDouble(this._convertMoney.loaidau(this.DGVChiTietLuong.Rows[addLuongNhanVien].Cells[3].Value.ToString())) * this.dHeSoBaoHiemThatNghiep / 100.0);
                            this.DGVChiTietLuong.Rows[addLuongNhanVien].Cells[17].Value = this._convertMoney.chendau(Convert.ToInt32(dTienBaoHiemThatNghiep).ToString());
                        }
                        else
                        {
                            this.DGVChiTietLuong.Rows[addLuongNhanVien].Cells[15].Value = this._convertMoney.chendau(Convert.ToInt32(dTienBaoHiemXaHoi).ToString());
                            this.DGVChiTietLuong.Rows[addLuongNhanVien].Cells[16].Value = this._convertMoney.chendau(Convert.ToInt32(dTienBaoHiemyTe).ToString());
                            this.DGVChiTietLuong.Rows[addLuongNhanVien].Cells[17].Value = this._convertMoney.chendau(Convert.ToInt32(dTienBaoHiemThatNghiep).ToString());
                        }
                        double dTongTienTruVaoLuong;
                        dTongTienTruVaoLuong = dTienBaoHiemXaHoi + dTienBaoHiemyTe + dTienBaoHiemThatNghiep + dTongTienTamUngTinhLuong + dTongTienViPhamTinhLuong;
                        this.DGVChiTietLuong.Rows[addLuongNhanVien].Cells[20].Value = this._convertMoney.chendau(Convert.ToInt32(dTongTienTruVaoLuong).ToString());
                        this.DGVChiTietLuong.Rows[addLuongNhanVien].Cells[21].Value = this._convertMoney.chendau(Convert.ToInt32(dTongLuongTinhLuong - dTongTienTruVaoLuong).ToString());
                    }
                }
            }
            if (this.checkBoxCoTinhLuong.Checked)
            {
                for (int iLuuTinhLuong = 0; iLuuTinhLuong < this.DGVChiTietLuong.Rows.Count; iLuuTinhLuong++)
                {
                    this._tinhLuongDTO.MaNhanVien = this.DGVChiTietLuong.Rows[iLuuTinhLuong].Cells[0].Value.ToString();
                    this._tinhLuongDTO.TenNhanVien = this.DGVChiTietLuong.Rows[iLuuTinhLuong].Cells[1].Value.ToString();
                    this._tinhLuongDTO.MaChamCong = Convert.ToInt32(this.DGVChiTietLuong.Rows[iLuuTinhLuong].Cells[2].Value.ToString());
                    this._tinhLuongDTO.LuongCoBanBaoHiem = this._convertMoney.loaidau(this.DGVChiTietLuong.Rows[iLuuTinhLuong].Cells[3].Value.ToString());
                    this._tinhLuongDTO.LuongHopDong = this._convertMoney.loaidau(this.DGVChiTietLuong.Rows[iLuuTinhLuong].Cells[4].Value.ToString());
                    this._tinhLuongDTO.NgayCongTinh = this.DGVChiTietLuong.Rows[iLuuTinhLuong].Cells[5].Value.ToString();
                    this._tinhLuongDTO.NgayCongLamDuoc = this.DGVChiTietLuong.Rows[iLuuTinhLuong].Cells[6].Value.ToString();
                    this._tinhLuongDTO.SoGioTangCa = this.DGVChiTietLuong.Rows[iLuuTinhLuong].Cells[7].Value.ToString();
                    this._tinhLuongDTO.LuongNgayCongLamDuoc = this._convertMoney.loaidau(this.DGVChiTietLuong.Rows[iLuuTinhLuong].Cells[8].Value.ToString());
                    this._tinhLuongDTO.TienTangCa = this._convertMoney.loaidau(this.DGVChiTietLuong.Rows[iLuuTinhLuong].Cells[9].Value.ToString());
                    this._tinhLuongDTO.PhuCapTienCom = this._convertMoney.loaidau(this.DGVChiTietLuong.Rows[iLuuTinhLuong].Cells[10].Value.ToString());
                    this._tinhLuongDTO.PhuCapTienComTheoNgayCong = this._convertMoney.loaidau(this.DGVChiTietLuong.Rows[iLuuTinhLuong].Cells[11].Value.ToString());
                    this._tinhLuongDTO.PhuCapKhac = this._convertMoney.loaidau(this.DGVChiTietLuong.Rows[iLuuTinhLuong].Cells[12].Value.ToString());
                    this._tinhLuongDTO.Thuong = this._convertMoney.loaidau(this.DGVChiTietLuong.Rows[iLuuTinhLuong].Cells[13].Value.ToString());
                    this._tinhLuongDTO.TongLuong = this._convertMoney.loaidau(this.DGVChiTietLuong.Rows[iLuuTinhLuong].Cells[14].Value.ToString());
                    this._tinhLuongDTO.BHXH = this._convertMoney.loaidau(this.DGVChiTietLuong.Rows[iLuuTinhLuong].Cells[15].Value.ToString());
                    this._tinhLuongDTO.BHYT = this._convertMoney.loaidau(this.DGVChiTietLuong.Rows[iLuuTinhLuong].Cells[16].Value.ToString());
                    this._tinhLuongDTO.BHTN = this._convertMoney.loaidau(this.DGVChiTietLuong.Rows[iLuuTinhLuong].Cells[17].Value.ToString());
                    this._tinhLuongDTO.TamUng = this._convertMoney.loaidau(this.DGVChiTietLuong.Rows[iLuuTinhLuong].Cells[18].Value.ToString());
                    this._tinhLuongDTO.ViPham = this._convertMoney.loaidau(this.DGVChiTietLuong.Rows[iLuuTinhLuong].Cells[19].Value.ToString());
                    this._tinhLuongDTO.TongTienTruVaoLuong = this._convertMoney.loaidau(this.DGVChiTietLuong.Rows[iLuuTinhLuong].Cells[20].Value.ToString());
                    this._tinhLuongDTO.LuongThucLanh = this._convertMoney.loaidau(this.DGVChiTietLuong.Rows[iLuuTinhLuong].Cells[21].Value.ToString());
                    this._tinhLuongBLL.TinhLuongInsert(this._tinhLuongDTO);
                }
            }
            _loadTinhCong.Close();
        }

        private void dateTimeTuNgay_ValueChanged(object sender, EventArgs e)
        {
            xuatThuTuNgay();
        }

        private void dateTimeDenNgay_ValueChanged(object sender, EventArgs e)
        {
            xuatThuDenNgay();
        }

        private void xuatThuTuNgay()
        {
            DateTime thuA2;
            thuA2 = dateTimeTuNgay.Value;
            lbThuA.Text = DateTimeProgress.XuatThu((int)thuA2.DayOfWeek);
            if (lbThuA.Text == "Chủ nhật")
            {
                lbThuA.ForeColor = Color.Red;
            }
            else
            {
                lbThuA.ForeColor = Color.Blue;
            }
        }

        private void xuatThuDenNgay()
        {
            DateTime thuB2;
            thuB2 = dateTimeDenNgay.Value;
            lbThuB.Text = DateTimeProgress.XuatThu((int)thuB2.DayOfWeek);
            if (lbThuB.Text == "Chủ nhật")
            {
                lbThuB.ForeColor = Color.Red;
            }
            else
            {
                lbThuB.ForeColor = Color.Blue;
            }
        }

        private void loadControlTinhCong()
        {
            DGVTinhCong.Columns[7].DefaultCellStyle.Alignment = DataGridViewContentAlignment.MiddleRight;
            DGVTinhCong.Columns[8].DefaultCellStyle.Alignment = DataGridViewContentAlignment.MiddleRight;
            DGVTinhCong.Columns[9].DefaultCellStyle.Alignment = DataGridViewContentAlignment.MiddleRight;
            DGVTinhCong.Columns[10].DefaultCellStyle.Alignment = DataGridViewContentAlignment.MiddleRight;
            DGVTinhCong.Columns[11].DefaultCellStyle.Alignment = DataGridViewContentAlignment.MiddleRight;
            DGVTinhCong.Columns[12].DefaultCellStyle.Alignment = DataGridViewContentAlignment.MiddleRight;
            DGVTinhCong.Columns[13].DefaultCellStyle.Alignment = DataGridViewContentAlignment.MiddleRight;
            DGVTinhCong.Columns[14].DefaultCellStyle.Alignment = DataGridViewContentAlignment.MiddleRight;
            DGVTinhCong.Columns[15].DefaultCellStyle.Alignment = DataGridViewContentAlignment.MiddleRight;
            DGVTinhCong.Columns[16].DefaultCellStyle.Alignment = DataGridViewContentAlignment.MiddleRight;
            DGVTinhCong.Columns[17].DefaultCellStyle.Alignment = DataGridViewContentAlignment.MiddleRight;
            DGVTinhCong.Columns[18].DefaultCellStyle.Alignment = DataGridViewContentAlignment.MiddleRight;
        }

        private void loadControlTinhLuong()
        {
            DGVChiTietLuong.Columns[3].DefaultCellStyle.Alignment = DataGridViewContentAlignment.MiddleRight;
            DGVChiTietLuong.Columns[4].DefaultCellStyle.Alignment = DataGridViewContentAlignment.MiddleRight;
            DGVChiTietLuong.Columns[5].DefaultCellStyle.Alignment = DataGridViewContentAlignment.MiddleRight;
            DGVChiTietLuong.Columns[6].DefaultCellStyle.Alignment = DataGridViewContentAlignment.MiddleRight;
            DGVChiTietLuong.Columns[7].DefaultCellStyle.Alignment = DataGridViewContentAlignment.MiddleRight;
            DGVChiTietLuong.Columns[8].DefaultCellStyle.Alignment = DataGridViewContentAlignment.MiddleRight;
            DGVChiTietLuong.Columns[9].DefaultCellStyle.Alignment = DataGridViewContentAlignment.MiddleRight;
            DGVChiTietLuong.Columns[10].DefaultCellStyle.Alignment = DataGridViewContentAlignment.MiddleRight;
            DGVChiTietLuong.Columns[11].DefaultCellStyle.Alignment = DataGridViewContentAlignment.MiddleRight;
            DGVChiTietLuong.Columns[12].DefaultCellStyle.Alignment = DataGridViewContentAlignment.MiddleRight;
            DGVChiTietLuong.Columns[13].DefaultCellStyle.Alignment = DataGridViewContentAlignment.MiddleRight;
            DGVChiTietLuong.Columns[14].DefaultCellStyle.Alignment = DataGridViewContentAlignment.MiddleRight;
            DGVChiTietLuong.Columns[15].DefaultCellStyle.Alignment = DataGridViewContentAlignment.MiddleRight;
            DGVChiTietLuong.Columns[16].DefaultCellStyle.Alignment = DataGridViewContentAlignment.MiddleRight;
            DGVChiTietLuong.Columns[17].DefaultCellStyle.Alignment = DataGridViewContentAlignment.MiddleRight;
            DGVChiTietLuong.Columns[18].DefaultCellStyle.Alignment = DataGridViewContentAlignment.MiddleRight;
            DGVChiTietLuong.Columns[19].DefaultCellStyle.Alignment = DataGridViewContentAlignment.MiddleRight;
            DGVChiTietLuong.Columns[20].DefaultCellStyle.Alignment = DataGridViewContentAlignment.MiddleRight;
            DGVChiTietLuong.Columns[21].DefaultCellStyle.Alignment = DataGridViewContentAlignment.MiddleRight;
            checkBoxCoTinhLuong.Checked = false;
            txtNgayCongTinh.Enabled = false;
        }

        private void loadTuyChon()
        {
            new DataTable();
            _tuyChonDTO.MaTuyChinh = "TC00001";
            DataTable dtLoadTuyChon;
            dtLoadTuyChon = _tuyChonBLL.showLoadTuyChon("TC00001");
            for (int iLoadTuyChon = 0; iLoadTuyChon < dtLoadTuyChon.Rows.Count; iLoadTuyChon++)
            {
                iLamTronCong = Convert.ToInt32(dtLoadTuyChon.Rows[iLoadTuyChon]["LamTronCong"].ToString());
                iLamTronGio = Convert.ToInt32(dtLoadTuyChon.Rows[iLoadTuyChon]["LamTronGio"].ToString());
                sDinhDangThoiGian = dtLoadTuyChon.Rows[iLoadTuyChon]["DinhDangThoiGian"].ToString();
                dTangCa1HeSo = Convert.ToDouble(dtLoadTuyChon.Rows[iLoadTuyChon]["TC1HeSo"].ToString());
                dTangCa2HeSo = Convert.ToDouble(dtLoadTuyChon.Rows[iLoadTuyChon]["TC2HeSo"].ToString());
                dTangCa3HeSo = Convert.ToDouble(dtLoadTuyChon.Rows[iLoadTuyChon]["TC3HeSo"].ToString());
                dTangCa4HeSo = Convert.ToDouble(dtLoadTuyChon.Rows[iLoadTuyChon]["TC4HeSo"].ToString());
                dTangCaChuNhatHeSo = Convert.ToDouble(dtLoadTuyChon.Rows[iLoadTuyChon]["ChuNhatHeSo"].ToString());
                sLuaChonKhaiBaoLuongBaoHiem = dtLoadTuyChon.Rows[iLoadTuyChon]["LuaChonKhaiBaoLuong"].ToString();
                dSoTienKhaiBao = Convert.ToDouble(dtLoadTuyChon.Rows[iLoadTuyChon]["SoTienKhaiBao"].ToString());
                dHeSoBaoHiemXaHoi = Convert.ToDouble(dtLoadTuyChon.Rows[iLoadTuyChon]["BaoHiemXaHoi"].ToString());
                dHeSoBaoHiemYTe = Convert.ToDouble(dtLoadTuyChon.Rows[iLoadTuyChon]["BaoHiemYTe"].ToString());
                dHeSoBaoHiemThatNghiep = Convert.ToDouble(dtLoadTuyChon.Rows[iLoadTuyChon]["BaoHiemThatNghiep"].ToString());
                iLamTronTuA = Convert.ToInt32(dtLoadTuyChon.Rows[iLoadTuyChon]["LTTuA"].ToString());
                iLamTronDenA = Convert.ToInt32(dtLoadTuyChon.Rows[iLoadTuyChon]["LTDenA"].ToString());
                sLamTronA = dtLoadTuyChon.Rows[iLoadTuyChon]["LTA"].ToString();
                iLamTronTuB = Convert.ToInt32(dtLoadTuyChon.Rows[iLoadTuyChon]["LTTuB"].ToString());
                iLamTronDenB = Convert.ToInt32(dtLoadTuyChon.Rows[iLoadTuyChon]["LTDenB"].ToString());
                sLamTronB = dtLoadTuyChon.Rows[iLoadTuyChon]["LTB"].ToString();
                iLamTronTuC = Convert.ToInt32(dtLoadTuyChon.Rows[iLoadTuyChon]["LTTuC"].ToString());
                iLamTronDenC = Convert.ToInt32(dtLoadTuyChon.Rows[iLoadTuyChon]["LTDenC"].ToString());
                sLamTronC = dtLoadTuyChon.Rows[iLoadTuyChon]["LTC"].ToString();
                iLamTronTuD = Convert.ToInt32(dtLoadTuyChon.Rows[iLoadTuyChon]["LTTuD"].ToString());
                iLamTronDenD = Convert.ToInt32(dtLoadTuyChon.Rows[iLoadTuyChon]["LTDenD"].ToString());
                sLamTronD = dtLoadTuyChon.Rows[iLoadTuyChon]["LTD"].ToString();
            }
        }

        private void load_NhanVienCoChamCong()
        {
            string sql = "select b.* from " +
                $"(select distinct MaChamCong from CheckInOut where NgayCham >= '{DateTime.Parse(dateTimeTuNgay.Text).ToString("yyyy/MM/dd")}' " +
                $"and NgayCham <= '{DateTime.Parse(dateTimeDenNgay.Text).ToString("yyyy/MM/dd")}') a " +
                $"join NHANVIEN b on a.MaChamCong = b.MaChamCong ";

            DataTable dt_nhavien = new DataTable();
            dt_nhavien = SQLHelper.ExecuteDt(sql);
            DGVDanhSachNhanVien.Rows.Clear();
            for (int iNhanVien = 0; iNhanVien < dt_nhavien.Rows.Count; iNhanVien++)
            {
                int addNhanVien = DGVDanhSachNhanVien.Rows.Add();
                DGVDanhSachNhanVien.Rows[addNhanVien].Cells[1].Value = dt_nhavien.Rows[iNhanVien]["MaNhanVien"].ToString();
                DGVDanhSachNhanVien.Rows[addNhanVien].Cells[2].Value = dt_nhavien.Rows[iNhanVien]["TenNhanVien"].ToString();
                DGVDanhSachNhanVien.Rows[addNhanVien].Cells[3].Value = dt_nhavien.Rows[iNhanVien]["MaChamCong"].ToString();
                DGVDanhSachNhanVien.Rows[addNhanVien].Cells[4].Value = dt_nhavien.Rows[iNhanVien]["MaPhongBan"].ToString();
            }
        }
        private void treeViewSoDoQuanLy_AfterSelect(object sender, TreeViewEventArgs e)
        {
            if (treeViewSoDoQuanLy.SelectedNode.Tag.ToString() == "CoChamCong")
            {
                load_NhanVienCoChamCong();
            }
            else
            {
                sMaCongTyTreeView = "";
                sMaKhuVucTreeView = "";
                sMaPhongBanTreeView = "";
                sMaChucVuTreeView = "";
                DGVDanhSachNhanVien.Rows.Clear();
                _tenNode = treeViewSoDoQuanLy.SelectedNode.Text;
                DataTable dtTreeviewPhongBan = new DataTable();
                _phongBanDTO.TenPhongBan = _tenNode;
                dtTreeviewPhongBan = _phongBanBLL.PhongBanGetTreeView(_phongBanDTO);
                for (int iTreeviewPhongBan = 0; iTreeviewPhongBan < dtTreeviewPhongBan.Rows.Count; iTreeviewPhongBan++)
                {
                    sMaPhongBanTreeView = dtTreeviewPhongBan.Rows[iTreeviewPhongBan]["MaPhongBan"].ToString();
                }
                DataTable dtTreeViewCongTy = new DataTable();
                _congTyDTO.TenCongTy = _tenNode;
                dtTreeViewCongTy = _congTyBLL.CongTygetTreeView(_congTyDTO);
                DataTable dtTreeViewKhuVuc = new DataTable();
                _khuVucDTO.TenKhuVuc = _tenNode;
                dtTreeViewKhuVuc = _khuVucBLL.KhuVucgetTreeView(_khuVucDTO);
                for (int iTreeviewKhuVuc = 0; iTreeviewKhuVuc < dtTreeViewKhuVuc.Rows.Count; iTreeviewKhuVuc++)
                {
                    sMaKhuVucTreeView = dtTreeViewKhuVuc.Rows[iTreeviewKhuVuc]["MaKhuVuc"].ToString();
                }
                DataTable dtTreeViewChucVu = new DataTable();
                _chucVuDTO.TenChucVu = _tenNode;
                dtTreeViewChucVu = _chucVuBLL.ChucVugetTreeView(_chucVuDTO);
                for (int iTreeviewChucVu = 0; iTreeviewChucVu < dtTreeViewChucVu.Rows.Count; iTreeviewChucVu++)
                {
                    sMaChucVuTreeView = dtTreeViewChucVu.Rows[iTreeviewChucVu]["MaChucVu"].ToString();
                }
                DataTable dtNhanVien = new DataTable();
                _nhanVienDTO.MaCongTy = sMaCongTyTreeView;
                _nhanVienDTO.MaKhuVuc = sMaKhuVucTreeView;
                _nhanVienDTO.MaPhongBan = sMaPhongBanTreeView;
                _nhanVienDTO.MaChucVu = sMaChucVuTreeView;
                dtNhanVien = _nhanVienBLL.NhanViengetFromTreeview(_nhanVienDTO);
                for (int iNhanVien = 0; iNhanVien < dtNhanVien.Rows.Count; iNhanVien++)
                {
                    int addNhanVien = DGVDanhSachNhanVien.Rows.Add();
                    DGVDanhSachNhanVien.Rows[addNhanVien].Cells[1].Value = dtNhanVien.Rows[iNhanVien]["MaNhanVien"].ToString();
                    DGVDanhSachNhanVien.Rows[addNhanVien].Cells[2].Value = dtNhanVien.Rows[iNhanVien]["TenNhanVien"].ToString();
                    DGVDanhSachNhanVien.Rows[addNhanVien].Cells[3].Value = dtNhanVien.Rows[iNhanVien]["MaChamCong"].ToString();
                    DGVDanhSachNhanVien.Rows[addNhanVien].Cells[4].Value = dtNhanVien.Rows[iNhanVien]["MaPhongBan"].ToString();
                }
            }
        }

        private void navigationPane1_Load(object sender, EventArgs e)
        {
            navigationPane1.TitlePanel.Text = "Sơ Đồ Công Ty";
            buttonItem1.Text = "Sơ Đồ Công Ty";
        }

        private static void setListview(ListView sListView, string sCaption, byte sIcon, ImageList sImageList)
        {
            sListView.Width = 250;
            sListView.LargeImageList = sImageList;
            sListView.SmallImageList = sImageList;
            sListView.Items.Add(new ListViewItem(sCaption, sIcon));
        }

        //private void loadListViewBaoCao()
        //{
        //    setListview(listViewBaoCao, "Chi tiết từng người từng ngày", 0, imageBaoCao);
        //    setListview(listViewBaoCao, "Chi tiết thời gian làm việc", 1, imageBaoCao);
        //    setListview(listViewBaoCao, "Chi tiết giờ và tăng ca kèm kí hiệu", 2, imageBaoCao);
        //    setListview(listViewBaoCao, "Xuất lưới", 3, imageBaoCao);
        //    setListview(listViewBaoCao, "Thống kê tháng (ký hiệu)", 4, imageBaoCao);
        //    setListview(listViewBaoCao, "Thống kê tháng (công)", 5, imageBaoCao);
        //    setListview(listViewBaoCao, "Thống kê tháng (giờ)", 6, imageBaoCao);
        //    setListview(listViewBaoCao, "Thống kê tháng (giờ và tăng ca)", 9, imageBaoCao);
        //    setListview(listViewBaoCao, "Bảng Lương Tổng Hợp", 7, imageBaoCao);
        //    setListview(listViewBaoCao, "Bảng lương từng nhân viên", 8, imageBaoCao);
        //    setListview(listViewBaoCao, "Tổng Hợp Tháng", 10, imageBaoCao);
        //}

        private void listViewBaoCao_Click(object sender, EventArgs e)
        {
            switch (listViewBaoCao.Items[listViewBaoCao.FocusedItem.Index].ImageIndex.ToString())
            {
                case "0":
                    ChiTietTungNguoiTungNgay_Click(sender, e);
                    break;
                case "1":
                    ChiTietThoiGianLamViec_Click(sender, e);
                    break;
                case "2":
                    ThongKeThangCongPB_Click(sender, e);
                    break;
                case "3":
                    XuatLuoi_Click(sender, e);
                    break;
                case "4":
                    ThongKeThangKyHieu_Click(sender, e);
                    break;
                case "5":
                    ThongKeThangCong_Click(sender, e);
                    break;
                case "6":
                    ThongKeThangGio_Click(sender, e);
                    break;
                case "7":
                    TienLuong_Click(sender, e);
                    break;
                case "8":
                    BangLuongTungNhanVien_Click(sender, e);
                    break;
                case "9":
                    ThongKeGioVaTC_Click(sender, e);
                    break;
                case "10":
                    TongHop_Click(sender, e);
                    break;
            }
        }

        private void BangLuongTungNhanVien_Click(object sender, EventArgs e)
        {
            //BangLuongTungNhanVienExport();
        }

        private void TienLuong_Click(object sender, EventArgs e)
        {
            //TienLuongExport();
        }

        private void ThongKeThangGio_Click(object sender, EventArgs e)
        {
            ThongKeThangGio();
        }

        private void ChiTietTungNguoiTungNgay_Click(object sender, EventArgs e)
        {
            ExportExcelChiTietTungNguoiTungNgay();
        }

        private void TongHop_Click(object sender, EventArgs e)
        {
            ExportTongHop();
        }

        private void ThongKeThangCong_Click(object sender, EventArgs e)
        {
            ExportExcelThongKeThangCong();
        }

        private void ThongKeGioVaTC_Click(object sender, EventArgs e)
        {
            ThongKeGioVaTC();
        }

        private void ThongKeThangCongPB_Click(object sender, EventArgs e)
        {
            ThongKeChiTietGioVaTC();
        }

        private void ChiTietThoiGianLamViec_Click(object sender, EventArgs e)
        {
            //frmChonLanXuat _chonLanXuat;
            //_chonLanXuat = new frmChonLanXuat();
            //_chonLanXuat.ShowDialog();
            //iChonLanXuat = _chonLanXuat._iChonLanXuat;
            //if (iChonLanXuat != 0)
            //{
            //    ExportExcelChiTietThoiGianLamViec();
            //}
        }

        private void ThongKeThangKyHieu_Click(object sender, EventArgs e)
        {
            ExportThongKeThang_KyHieu();
        }

        private void ThongKeChiTietGioVaTC()
        {
            Thread.CurrentThread.CurrentCulture = new CultureInfo("en-US");
            Excel.Application xla_ChiTietThoiGianLamViec;
            xla_ChiTietThoiGianLamViec = new Excel.Application();
            xla_ChiTietThoiGianLamViec.Workbooks.Add(Excel.XlSheetType.xlWorksheet);
            _ = xla_ChiTietThoiGianLamViec.ActiveSheet;
            Excel.Worksheet ws_ChiTietThoiGianLamViec;
            ws_ChiTietThoiGianLamViec = xla_ChiTietThoiGianLamViec.Worksheets.get_Item((object)1);
            DateTime dNgayTinh;
            dNgayTinh = Convert.ToDateTime(dateTimeTuNgay.Text);
            DateTime dNgayBatDauTinhCong;
            dNgayBatDauTinhCong = new DateTime(dNgayTinh.Year, dNgayTinh.Month, dNgayTinh.Day, 0, 0, 0);
            bool failed;
            failed = false;
            do
            {
                try
                {
                    Excel.Range excelChiTietThoiGianLamViec_CongTyHeader;
                    excelChiTietThoiGianLamViec_CongTyHeader = (ws_ChiTietThoiGianLamViec).get_Range((object)"A1", (object)"BT1");
                    excelChiTietThoiGianLamViec_CongTyHeader.Cells[1, 1] = sTenCongTyReport;
                    excelChiTietThoiGianLamViec_CongTyHeader.get_Range((object)"A1", (object)"BT1").Merge(true);
                    Excel.Range excelChiTietThoiGianLamViec_DiaChiHeader;
                    excelChiTietThoiGianLamViec_DiaChiHeader = (ws_ChiTietThoiGianLamViec).get_Range((object)"A2", (object)"BT2");
                    excelChiTietThoiGianLamViec_DiaChiHeader.Cells[1, 1] = sDiaChiCongTyReport;
                    excelChiTietThoiGianLamViec_DiaChiHeader.get_Range((object)"A1", (object)"BT1").Merge(true);
                    Excel.Range excelChiTietThoiGianLamViec_DinhDangCongTyHeader;
                    excelChiTietThoiGianLamViec_DinhDangCongTyHeader = (ws_ChiTietThoiGianLamViec).get_Range((object)"A1", (object)"BT2");
                    excelChiTietThoiGianLamViec_DinhDangCongTyHeader.Font.Name = "Times New Roman";
                    excelChiTietThoiGianLamViec_DinhDangCongTyHeader.Font.Size = "11";
                    new DataTable();
                    DataTable dtNgayTinhCongChiTietThoiGianLamViec;
                    dtNgayTinhCongChiTietThoiGianLamViec = _ngayTinhCongBLL.showThongTinNgayTinhCong();
                    for (int iNgayTinhCongChiTietThoiGianLamViec = 0; iNgayTinhCongChiTietThoiGianLamViec < dtNgayTinhCongChiTietThoiGianLamViec.Rows.Count; iNgayTinhCongChiTietThoiGianLamViec++)
                    {
                        sTuNgayChiTietThoiGianLamViec = string.Format("{0:d}", Convert.ToDateTime(dtNgayTinhCongChiTietThoiGianLamViec.Rows[iNgayTinhCongChiTietThoiGianLamViec]["NgayBatDau"].ToString()));
                        sDenNgayChiTietThoiGianLamViec = string.Format("{0:d}", Convert.ToDateTime(dtNgayTinhCongChiTietThoiGianLamViec.Rows[iNgayTinhCongChiTietThoiGianLamViec]["NgayKetThuc"].ToString()));
                    }
                    Excel.Range excelChiTietThoiGianLamViec_TieuDeHeader;
                    excelChiTietThoiGianLamViec_TieuDeHeader = (ws_ChiTietThoiGianLamViec).get_Range((object)"A4", (object)"BU4");
                    excelChiTietThoiGianLamViec_TieuDeHeader.Cells[1, 1] = "BẢNG CHẤM CÔNG CHI TIẾT TỪ NGÀY " + sTuNgayChiTietThoiGianLamViec + " ĐẾN NGÀY " + sDenNgayChiTietThoiGianLamViec + " (MONTHLY REPORT)";
                    excelChiTietThoiGianLamViec_TieuDeHeader.get_Range((object)"A1", (object)"BU1").Merge(true);
                    excelChiTietThoiGianLamViec_TieuDeHeader.Font.Name = "Times New Roman";
                    excelChiTietThoiGianLamViec_TieuDeHeader.Font.Size = "14";
                    excelChiTietThoiGianLamViec_TieuDeHeader.Font.Bold = true;
                    excelChiTietThoiGianLamViec_TieuDeHeader.RowHeight = 18;
                    excelChiTietThoiGianLamViec_TieuDeHeader.HorizontalAlignment = Excel.Constants.xlCenter;
                    Excel.Range excelChiTietThoiGianLamViec_STTHeader;
                    excelChiTietThoiGianLamViec_STTHeader = (ws_ChiTietThoiGianLamViec).get_Range((object)"A6", (object)"A8");
                    excelChiTietThoiGianLamViec_STTHeader.Cells[1, 1] = "STT";
                    excelChiTietThoiGianLamViec_STTHeader.get_Range((object)"A1", (object)"A3").MergeCells = true;
                    excelChiTietThoiGianLamViec_STTHeader.VerticalAlignment = HorizontalAlignment.Center;
                    excelChiTietThoiGianLamViec_STTHeader.ColumnWidth = 4;
                    Excel.Range excelChiTietThoiGianLamViec_MaNhanVienHeader;
                    excelChiTietThoiGianLamViec_MaNhanVienHeader = (ws_ChiTietThoiGianLamViec).get_Range((object)"B6", (object)"B8");
                    excelChiTietThoiGianLamViec_MaNhanVienHeader.Cells[1, 1] = "MÃ NHÂN VIÊN";
                    excelChiTietThoiGianLamViec_MaNhanVienHeader.get_Range((object)"A1", (object)"A3").MergeCells = true;
                    excelChiTietThoiGianLamViec_MaNhanVienHeader.VerticalAlignment = HorizontalAlignment.Center;
                    excelChiTietThoiGianLamViec_MaNhanVienHeader.ColumnWidth = 14;
                    Excel.Range excelChiTietThoiGianLamViec_TenNhanVienHeader;
                    excelChiTietThoiGianLamViec_TenNhanVienHeader = (ws_ChiTietThoiGianLamViec).get_Range((object)"C6", (object)"C8");
                    excelChiTietThoiGianLamViec_TenNhanVienHeader.Cells[1, 1] = "TÊN NHÂN VIÊN";
                    excelChiTietThoiGianLamViec_TenNhanVienHeader.get_Range((object)"A1", (object)"A3").MergeCells = true;
                    excelChiTietThoiGianLamViec_TenNhanVienHeader.VerticalAlignment = HorizontalAlignment.Center;
                    excelChiTietThoiGianLamViec_TenNhanVienHeader.ColumnWidth = 14;
                    Excel.Range excelChiTietThoiGianLamViec_PhongBanHeader;
                    excelChiTietThoiGianLamViec_PhongBanHeader = (ws_ChiTietThoiGianLamViec).get_Range((object)"D6", (object)"D8");
                    excelChiTietThoiGianLamViec_PhongBanHeader.Cells[1, 1] = "PHÒNG BAN";
                    excelChiTietThoiGianLamViec_PhongBanHeader.get_Range((object)"A1", (object)"A3").MergeCells = true;
                    excelChiTietThoiGianLamViec_PhongBanHeader.VerticalAlignment = HorizontalAlignment.Center;
                    excelChiTietThoiGianLamViec_PhongBanHeader.ColumnWidth = 11;
                    Excel.Range excelChiTietThoiGianLamViec_NgayTrongThangHeader;
                    excelChiTietThoiGianLamViec_NgayTrongThangHeader = (ws_ChiTietThoiGianLamViec).get_Range((object)"E6", (object)"BN6");
                    excelChiTietThoiGianLamViec_NgayTrongThangHeader.Cells[1, 1] = "NGÀY TRONG THÁNG (DAYS IN MONTH)";
                    excelChiTietThoiGianLamViec_NgayTrongThangHeader.get_Range((object)"A1", (object)"BJ1").Merge(true);
                    int ColunmNgayChiTietThoiGianLamViec;
                    ColunmNgayChiTietThoiGianLamViec = 1;
                    int iTangHangO;
                    iTangHangO = 8;
                    int iTangCotO;
                    iTangCotO = 5;
                    for (int iChiTietThoiGianLamViec2 = 0; iChiTietThoiGianLamViec2 < 31; iChiTietThoiGianLamViec2++)
                    {
                        int iNgayChamChiTietThoiGianLamViec;
                        iNgayChamChiTietThoiGianLamViec = Convert.ToInt32(Convert.ToDateTime(dateTimeTuNgay.Value.AddDays(iChiTietThoiGianLamViec2).ToString()).Day);
                        Excel.Range excelChiTietThoiGianLamViec_Ngay;
                        excelChiTietThoiGianLamViec_Ngay = (ws_ChiTietThoiGianLamViec).get_Range((object)"E7", (object)"BN8");
                        excelChiTietThoiGianLamViec_Ngay.Cells[1, ColunmNgayChiTietThoiGianLamViec + iChiTietThoiGianLamViec2] = iNgayChamChiTietThoiGianLamViec;
                        if (iChiTietThoiGianLamViec2 == 0)
                        {
                            excelChiTietThoiGianLamViec_Ngay.get_Range((object)"A1", (object)"B1").Merge(true);
                        }
                        if (iChiTietThoiGianLamViec2 == 1)
                        {
                            excelChiTietThoiGianLamViec_Ngay.get_Range((object)"C1", (object)"D1").Merge(true);
                        }
                        if (iChiTietThoiGianLamViec2 == 2)
                        {
                            excelChiTietThoiGianLamViec_Ngay.get_Range((object)"E1", (object)"F1").Merge(true);
                        }
                        if (iChiTietThoiGianLamViec2 == 3)
                        {
                            excelChiTietThoiGianLamViec_Ngay.get_Range((object)"G1", (object)"H1").Merge(true);
                        }
                        if (iChiTietThoiGianLamViec2 == 4)
                        {
                            excelChiTietThoiGianLamViec_Ngay.get_Range((object)"I1", (object)"J1").Merge(true);
                        }
                        if (iChiTietThoiGianLamViec2 == 5)
                        {
                            excelChiTietThoiGianLamViec_Ngay.get_Range((object)"K1", (object)"L1").Merge(true);
                        }
                        if (iChiTietThoiGianLamViec2 == 6)
                        {
                            excelChiTietThoiGianLamViec_Ngay.get_Range((object)"K1", (object)"L1").Merge(true);
                        }
                        if (iChiTietThoiGianLamViec2 == 7)
                        {
                            excelChiTietThoiGianLamViec_Ngay.get_Range((object)"M1", (object)"N1").Merge(true);
                        }
                        if (iChiTietThoiGianLamViec2 == 8)
                        {
                            excelChiTietThoiGianLamViec_Ngay.get_Range((object)"O1", (object)"P1").Merge(true);
                        }
                        if (iChiTietThoiGianLamViec2 == 9)
                        {
                            excelChiTietThoiGianLamViec_Ngay.get_Range((object)"Q1", (object)"R1").Merge(true);
                        }
                        if (iChiTietThoiGianLamViec2 == 10)
                        {
                            excelChiTietThoiGianLamViec_Ngay.get_Range((object)"S1", (object)"T1").Merge(true);
                        }
                        if (iChiTietThoiGianLamViec2 == 11)
                        {
                            excelChiTietThoiGianLamViec_Ngay.get_Range((object)"U1", (object)"V1").Merge(true);
                        }
                        if (iChiTietThoiGianLamViec2 == 12)
                        {
                            excelChiTietThoiGianLamViec_Ngay.get_Range((object)"W1", (object)"X1").Merge(true);
                        }
                        if (iChiTietThoiGianLamViec2 == 13)
                        {
                            excelChiTietThoiGianLamViec_Ngay.get_Range((object)"Y1", (object)"Z1").Merge(true);
                        }
                        if (iChiTietThoiGianLamViec2 == 14)
                        {
                            excelChiTietThoiGianLamViec_Ngay.get_Range((object)"AA1", (object)"AB1").Merge(true);
                        }
                        if (iChiTietThoiGianLamViec2 == 15)
                        {
                            excelChiTietThoiGianLamViec_Ngay.get_Range((object)"AC1", (object)"AD1").Merge(true);
                        }
                        if (iChiTietThoiGianLamViec2 == 16)
                        {
                            excelChiTietThoiGianLamViec_Ngay.get_Range((object)"AE1", (object)"AF1").Merge(true);
                        }
                        if (iChiTietThoiGianLamViec2 == 17)
                        {
                            excelChiTietThoiGianLamViec_Ngay.get_Range((object)"AG1", (object)"AH1").Merge(true);
                        }
                        if (iChiTietThoiGianLamViec2 == 18)
                        {
                            excelChiTietThoiGianLamViec_Ngay.get_Range((object)"AI1", (object)"AJ1").Merge(true);
                        }
                        if (iChiTietThoiGianLamViec2 == 19)
                        {
                            excelChiTietThoiGianLamViec_Ngay.get_Range((object)"AK1", (object)"AL1").Merge(true);
                        }
                        if (iChiTietThoiGianLamViec2 == 20)
                        {
                            excelChiTietThoiGianLamViec_Ngay.get_Range((object)"AM1", (object)"AN1").Merge(true);
                        }
                        if (iChiTietThoiGianLamViec2 == 21)
                        {
                            excelChiTietThoiGianLamViec_Ngay.get_Range((object)"AO1", (object)"AP1").Merge(true);
                        }
                        if (iChiTietThoiGianLamViec2 == 22)
                        {
                            excelChiTietThoiGianLamViec_Ngay.get_Range((object)"AQ1", (object)"AR1").Merge(true);
                        }
                        if (iChiTietThoiGianLamViec2 == 23)
                        {
                            excelChiTietThoiGianLamViec_Ngay.get_Range((object)"AS1", (object)"AT1").Merge(true);
                        }
                        if (iChiTietThoiGianLamViec2 == 24)
                        {
                            excelChiTietThoiGianLamViec_Ngay.get_Range((object)"AU1", (object)"AV1").Merge(true);
                        }
                        if (iChiTietThoiGianLamViec2 == 25)
                        {
                            excelChiTietThoiGianLamViec_Ngay.get_Range((object)"AW1", (object)"AX1").Merge(true);
                        }
                        if (iChiTietThoiGianLamViec2 == 26)
                        {
                            excelChiTietThoiGianLamViec_Ngay.get_Range((object)"AY1", (object)"AZ1").Merge(true);
                        }
                        if (iChiTietThoiGianLamViec2 == 27)
                        {
                            excelChiTietThoiGianLamViec_Ngay.get_Range((object)"BA1", (object)"BB1").Merge(true);
                        }
                        if (iChiTietThoiGianLamViec2 == 28)
                        {
                            excelChiTietThoiGianLamViec_Ngay.get_Range((object)"BC1", (object)"BD1").Merge(true);
                        }
                        if (iChiTietThoiGianLamViec2 == 29)
                        {
                            excelChiTietThoiGianLamViec_Ngay.get_Range((object)"BE1", (object)"BF1").Merge(true);
                        }
                        if (iChiTietThoiGianLamViec2 == 30)
                        {
                            excelChiTietThoiGianLamViec_Ngay.get_Range((object)"BG1", (object)"BH1").Merge(true);
                        }
                        excelChiTietThoiGianLamViec_Ngay.get_Range((object)"BI1", (object)"BJ1").Merge(true);
                        excelChiTietThoiGianLamViec_Ngay.Cells[2, ColunmNgayChiTietThoiGianLamViec + iChiTietThoiGianLamViec2] = "N";
                        excelChiTietThoiGianLamViec_Ngay.Cells[2, ColunmNgayChiTietThoiGianLamViec + iChiTietThoiGianLamViec2 + 1] = "O";
                        (ws_ChiTietThoiGianLamViec).get_Range(ws_ChiTietThoiGianLamViec.Cells[iTangHangO, iTangCotO], ws_ChiTietThoiGianLamViec.Cells[iTangHangO, iTangCotO]).Interior.Color = ColorTranslator.ToOle(Color.Red);
                        (ws_ChiTietThoiGianLamViec).get_Range(ws_ChiTietThoiGianLamViec.Cells[iTangHangO, iTangCotO + 1], ws_ChiTietThoiGianLamViec.Cells[iTangHangO, iTangCotO + 1]).Interior.Color = ColorTranslator.ToOle(Color.Yellow);
                        ColunmNgayChiTietThoiGianLamViec++;
                        iTangCotO = iTangCotO + 1 + 1;
                        excelChiTietThoiGianLamViec_Ngay.ColumnWidth = 4;
                    }
                    Excel.Range excelChiTietThoiGianLamViec_TongGioCongHeader;
                    excelChiTietThoiGianLamViec_TongGioCongHeader = (ws_ChiTietThoiGianLamViec).get_Range((object)"BO6", (object)"BO8");
                    excelChiTietThoiGianLamViec_TongGioCongHeader.Cells[1, 1] = "Ngày công \n (Work Day)";
                    excelChiTietThoiGianLamViec_TongGioCongHeader.get_Range((object)"A1", (object)"A3").MergeCells = true;
                    excelChiTietThoiGianLamViec_TongGioCongHeader.ColumnWidth = 10;
                    excelChiTietThoiGianLamViec_TongGioCongHeader.VerticalAlignment = HorizontalAlignment.Center;
                    excelChiTietThoiGianLamViec_TongGioCongHeader.WrapText = true;
                    Excel.Range excelChiTietThoiGianLamViec_TongNgayHeader;
                    excelChiTietThoiGianLamViec_TongNgayHeader = (ws_ChiTietThoiGianLamViec).get_Range((object)"BP6", (object)"BP8");
                    excelChiTietThoiGianLamViec_TongNgayHeader.Cells[1, 1] = "Phép năm \n (Annual Leave) ";
                    excelChiTietThoiGianLamViec_TongNgayHeader.get_Range((object)"A1", (object)"A3").MergeCells = true;
                    excelChiTietThoiGianLamViec_TongNgayHeader.ColumnWidth = 10;
                    excelChiTietThoiGianLamViec_TongNgayHeader.VerticalAlignment = HorizontalAlignment.Center;
                    excelChiTietThoiGianLamViec_TongNgayHeader.WrapText = true;
                    Excel.Range excelChiTietThoiGianLamViec_TongGioTangCaHeader;
                    excelChiTietThoiGianLamViec_TongGioTangCaHeader = (ws_ChiTietThoiGianLamViec).get_Range((object)"BQ6", (object)"BQ8");
                    excelChiTietThoiGianLamViec_TongGioTangCaHeader.Cells[1, 1] = "Ngày lễ \n (Vacation holidays)";
                    excelChiTietThoiGianLamViec_TongGioTangCaHeader.get_Range((object)"A1", (object)"A3").MergeCells = true;
                    excelChiTietThoiGianLamViec_TongGioTangCaHeader.ColumnWidth = 10;
                    excelChiTietThoiGianLamViec_TongGioTangCaHeader.VerticalAlignment = HorizontalAlignment.Center;
                    excelChiTietThoiGianLamViec_TongGioTangCaHeader.WrapText = true;
                    Excel.Range excelChiTietThoiGianLamViec_TongPhutTreHeader;
                    excelChiTietThoiGianLamViec_TongPhutTreHeader = (ws_ChiTietThoiGianLamViec).get_Range((object)"BR6", (object)"BR8");
                    excelChiTietThoiGianLamViec_TongPhutTreHeader.Cells[1, 1] = "T.Ca x1.5 \n (OV level 1)";
                    excelChiTietThoiGianLamViec_TongPhutTreHeader.get_Range((object)"A1", (object)"A3").MergeCells = true;
                    excelChiTietThoiGianLamViec_TongPhutTreHeader.ColumnWidth = 10;
                    excelChiTietThoiGianLamViec_TongPhutTreHeader.VerticalAlignment = HorizontalAlignment.Center;
                    excelChiTietThoiGianLamViec_TongPhutTreHeader.WrapText = true;
                    Excel.Range excelChiTietThoiGianLamViec_TongPhutSomHeader;
                    excelChiTietThoiGianLamViec_TongPhutSomHeader = (ws_ChiTietThoiGianLamViec).get_Range((object)"BS6", (object)"BS8");
                    excelChiTietThoiGianLamViec_TongPhutSomHeader.Cells[1, 1] = "T.Ca x2 (OV level 2)";
                    excelChiTietThoiGianLamViec_TongPhutSomHeader.get_Range((object)"A1", (object)"A3").MergeCells = true;
                    excelChiTietThoiGianLamViec_TongPhutSomHeader.ColumnWidth = 10;
                    excelChiTietThoiGianLamViec_TongPhutSomHeader.VerticalAlignment = HorizontalAlignment.Center;
                    excelChiTietThoiGianLamViec_TongPhutSomHeader.WrapText = true;
                    Excel.Range excelChiTietThoiGianLamViec_TongPhutSomHeader2;
                    excelChiTietThoiGianLamViec_TongPhutSomHeader2 = (ws_ChiTietThoiGianLamViec).get_Range((object)"BT6", (object)"BT8");
                    excelChiTietThoiGianLamViec_TongPhutSomHeader2.Cells[1, 1] = "Ký Nhận \n (Confirm)";
                    excelChiTietThoiGianLamViec_TongPhutSomHeader2.get_Range((object)"A1", (object)"A3").MergeCells = true;
                    excelChiTietThoiGianLamViec_TongPhutSomHeader2.ColumnWidth = 10;
                    excelChiTietThoiGianLamViec_TongPhutSomHeader2.VerticalAlignment = HorizontalAlignment.Center;
                    excelChiTietThoiGianLamViec_TongPhutSomHeader2.WrapText = true;
                    Excel.Range excelChiTietThoiGianLamViec_DinhDangHeader;
                    excelChiTietThoiGianLamViec_DinhDangHeader = (ws_ChiTietThoiGianLamViec).get_Range((object)"A6", (object)"BT8");
                    excelChiTietThoiGianLamViec_DinhDangHeader.Font.Name = "Times New Roman";
                    excelChiTietThoiGianLamViec_DinhDangHeader.Font.Size = "10";
                    excelChiTietThoiGianLamViec_DinhDangHeader.Font.Bold = true;
                    excelChiTietThoiGianLamViec_DinhDangHeader.HorizontalAlignment = Excel.Constants.xlCenter;
                    excelChiTietThoiGianLamViec_DinhDangHeader.Borders.LineStyle = Excel.Constants.xlBoth;
                    (ws_ChiTietThoiGianLamViec).get_Range((object)"A6", (object)"BT7").Interior.Color = ColorTranslator.ToOle(Color.LightGreen);
                    xla_ChiTietThoiGianLamViec.Visible = true;
                    int iTangHang;
                    iTangHang = 9;
                    int iDemNhanVienChiTietThoiGianLamViec;
                    iDemNhanVienChiTietThoiGianLamViec = 0;
                    int iDemSTTChiTietThoiGianLamViec;
                    iDemSTTChiTietThoiGianLamViec = 0;
                    int iTongDongChiTietThoiGianLamViec;
                    iTongDongChiTietThoiGianLamViec = 9;
                    new DataTable();
                    _tinhCongDTO.Ngay = dNgayBatDauTinhCong;
                    int iMaChamCongChiTietThoiGianLamViec;
                    iMaChamCongChiTietThoiGianLamViec = 0;
                    DataTable dtNhanVienChiTietThoiGianLamViec;
                    dtNhanVienChiTietThoiGianLamViec = _tinhCongBLL.TinhCongGetNgay(_tinhCongDTO);
                    for (int iNhanVienChiTietThoiGianLamViec = 0; iNhanVienChiTietThoiGianLamViec < dtNhanVienChiTietThoiGianLamViec.Rows.Count; iNhanVienChiTietThoiGianLamViec++)
                    {
                        if (Convert.ToInt32(dtNhanVienChiTietThoiGianLamViec.Rows[iNhanVienChiTietThoiGianLamViec]["MaChamCong"].ToString()) == iMaChamCongChiTietThoiGianLamViec)
                        {
                            continue;
                        }
                        iDemSTTChiTietThoiGianLamViec++;
                        iMaChamCongChiTietThoiGianLamViec = Convert.ToInt32(dtNhanVienChiTietThoiGianLamViec.Rows[iNhanVienChiTietThoiGianLamViec]["MaChamCong"].ToString());
                        string sMaNhanVienChiTietThoiGianLamViec;
                        sMaNhanVienChiTietThoiGianLamViec = dtNhanVienChiTietThoiGianLamViec.Rows[iNhanVienChiTietThoiGianLamViec]["MaNhanVien"].ToString();
                        string sTenNhanVienChiTietThoiGianLamViec;
                        sTenNhanVienChiTietThoiGianLamViec = dtNhanVienChiTietThoiGianLamViec.Rows[iNhanVienChiTietThoiGianLamViec]["TenNhanVien"].ToString();
                        Excel.Range excelChiTietThoiGianLamViec_STTDuLieu;
                        excelChiTietThoiGianLamViec_STTDuLieu = (ws_ChiTietThoiGianLamViec).get_Range((object)("A" + (iTongDongChiTietThoiGianLamViec + iDemNhanVienChiTietThoiGianLamViec)), (object)("A" + (iTongDongChiTietThoiGianLamViec + iDemNhanVienChiTietThoiGianLamViec)));
                        excelChiTietThoiGianLamViec_STTDuLieu.Cells[1, 1] = iDemSTTChiTietThoiGianLamViec;
                        excelChiTietThoiGianLamViec_STTDuLieu.Select();
                        Excel.Range excelChiTietThoiGianLamViec_MaNhanVienDuLieu;
                        excelChiTietThoiGianLamViec_MaNhanVienDuLieu = (ws_ChiTietThoiGianLamViec).get_Range((object)("B" + (iTongDongChiTietThoiGianLamViec + iDemNhanVienChiTietThoiGianLamViec)), (object)("B" + (iTongDongChiTietThoiGianLamViec + iDemNhanVienChiTietThoiGianLamViec)));
                        excelChiTietThoiGianLamViec_MaNhanVienDuLieu.get_Range((object)"A1", (object)"A2").NumberFormat = "@";
                        excelChiTietThoiGianLamViec_MaNhanVienDuLieu.Cells[1, 1] = sMaNhanVienChiTietThoiGianLamViec;
                        (ws_ChiTietThoiGianLamViec).get_Range((object)("C" + (iTongDongChiTietThoiGianLamViec + iDemNhanVienChiTietThoiGianLamViec)), (object)("C" + (iTongDongChiTietThoiGianLamViec + iDemNhanVienChiTietThoiGianLamViec))).Cells[1, 1] = sTenNhanVienChiTietThoiGianLamViec;
                        string sTenPhongBan;
                        sTenPhongBan = "";
                        new DataTable();
                        _phongBanDTO.MaPhongBan = dtNhanVienChiTietThoiGianLamViec.Rows[iNhanVienChiTietThoiGianLamViec]["PhongBan"].ToString();
                        DataTable dtPhongBan;
                        dtPhongBan = _phongBanBLL.getTenPhongBanByMaPhongBan(_phongBanDTO);
                        for (int iPhongBan = 0; iPhongBan < dtPhongBan.Rows.Count; iPhongBan++)
                        {
                            sTenPhongBan = dtPhongBan.Rows[iPhongBan]["TenPhongBan"].ToString();
                        }
                        Excel.Range excelChiTietThoiGianLamViec_PhongBanDuLieu;
                        excelChiTietThoiGianLamViec_PhongBanDuLieu = (ws_ChiTietThoiGianLamViec).get_Range((object)("D" + (iTongDongChiTietThoiGianLamViec + iDemNhanVienChiTietThoiGianLamViec)), (object)("D" + (iTongDongChiTietThoiGianLamViec + iDemNhanVienChiTietThoiGianLamViec)));
                        if (sTenPhongBan == "")
                        {
                            excelChiTietThoiGianLamViec_PhongBanDuLieu.Cells[1, 1] = "------";
                        }
                        else
                        {
                            excelChiTietThoiGianLamViec_PhongBanDuLieu.Cells[1, 1] = sTenPhongBan;
                        }
                        int iDemNgayChiTietThoiGianLamViec;
                        iDemNgayChiTietThoiGianLamViec = 0;
                        int iCotGioVao;
                        iCotGioVao = 1;
                        int iCotGioRa;
                        iCotGioRa = 2;
                        int iTangCot;
                        iTangCot = 5;
                        for (int iGioChamChiTietThoiGianLamViec = 0; iGioChamChiTietThoiGianLamViec < 31; iGioChamChiTietThoiGianLamViec++)
                        {
                            DateTime dNgayChiTietThoiGianLamViec;
                            dNgayChiTietThoiGianLamViec = Convert.ToDateTime(dNgayBatDauTinhCong.AddDays(iDemNgayChiTietThoiGianLamViec).ToString());
                            new DataTable();
                            _tinhCongDTO.MaChamCong = iMaChamCongChiTietThoiGianLamViec;
                            _tinhCongDTO.Ngay = dNgayChiTietThoiGianLamViec;
                            DataTable dtDuLieuGioChiTietThoiGianLamViec;
                            dtDuLieuGioChiTietThoiGianLamViec = _tinhCongBLL.TinhCongGetMaChamCongAndNgay(_tinhCongDTO);
                            int iDuLieuGioChiTietThoiGianLamViec;
                            iDuLieuGioChiTietThoiGianLamViec = 0;
                            if (iDuLieuGioChiTietThoiGianLamViec < dtDuLieuGioChiTietThoiGianLamViec.Rows.Count)
                            {
                                string sThu;
                                sThu = dtDuLieuGioChiTietThoiGianLamViec.Rows[iDuLieuGioChiTietThoiGianLamViec]["Thu"].ToString();
                                string sGioVaoChiTietThoiGianLamViec;
                                sGioVaoChiTietThoiGianLamViec = dtDuLieuGioChiTietThoiGianLamViec.Rows[iDuLieuGioChiTietThoiGianLamViec]["GioVao"].ToString();
                                string sGioRaChiTietThoiGianLamViec;
                                sGioRaChiTietThoiGianLamViec = dtDuLieuGioChiTietThoiGianLamViec.Rows[iDuLieuGioChiTietThoiGianLamViec]["GioRa"].ToString();
                                double dGioTungNgayChiTietThoiGianLamViec;
                                dGioTungNgayChiTietThoiGianLamViec = Convert.ToDouble(dtDuLieuGioChiTietThoiGianLamViec.Rows[iDuLieuGioChiTietThoiGianLamViec]["Gio"].ToString());
                                double dTongGioTangCaNgayChiTietThoiGianLamViec;
                                dTongGioTangCaNgayChiTietThoiGianLamViec = Convert.ToDouble(dtDuLieuGioChiTietThoiGianLamViec.Rows[iDuLieuGioChiTietThoiGianLamViec]["TC1"]) + Convert.ToDouble(dtDuLieuGioChiTietThoiGianLamViec.Rows[iDuLieuGioChiTietThoiGianLamViec]["TC2"]);
                                string sKyHieu;
                                sKyHieu = dtDuLieuGioChiTietThoiGianLamViec.Rows[iDuLieuGioChiTietThoiGianLamViec]["KyHieu"].ToString();
                                if (sGioVaoChiTietThoiGianLamViec != "")
                                {
                                    DateTime dGioVao;
                                    dGioVao = Convert.ToDateTime(sGioVaoChiTietThoiGianLamViec);
                                    _ = dGioVao.Hour + ":" + dGioVao.Minute;
                                }
                                if (sGioRaChiTietThoiGianLamViec != "")
                                {
                                    DateTime dGioRa;
                                    dGioRa = Convert.ToDateTime(sGioRaChiTietThoiGianLamViec);
                                    _ = dGioRa.Hour + ":" + dGioRa.Minute;
                                }
                                Excel.Range excelChiTietThoiGianLamViec_GioVaoDuLieu;
                                excelChiTietThoiGianLamViec_GioVaoDuLieu = (ws_ChiTietThoiGianLamViec).get_Range((object)("E" + (iTongDongChiTietThoiGianLamViec + iDemNhanVienChiTietThoiGianLamViec)), (object)("BN" + (iTongDongChiTietThoiGianLamViec + iDemNhanVienChiTietThoiGianLamViec)));
                                excelChiTietThoiGianLamViec_GioVaoDuLieu.Cells[1, iCotGioVao] = dGioTungNgayChiTietThoiGianLamViec;
                                Excel.Range excelChiTietThoiGianLamViec_GioRaDuLieu;
                                excelChiTietThoiGianLamViec_GioRaDuLieu = (ws_ChiTietThoiGianLamViec).get_Range((object)("E" + (iTongDongChiTietThoiGianLamViec + iDemNhanVienChiTietThoiGianLamViec)), (object)("BN" + (iTongDongChiTietThoiGianLamViec + iDemNhanVienChiTietThoiGianLamViec)));
                                excelChiTietThoiGianLamViec_GioRaDuLieu.Cells[1, iCotGioRa] = dTongGioTangCaNgayChiTietThoiGianLamViec;
                                if (dTongGioTangCaNgayChiTietThoiGianLamViec > 0.0)
                                {
                                    excelChiTietThoiGianLamViec_GioRaDuLieu.Cells[1, iCotGioRa] = dTongGioTangCaNgayChiTietThoiGianLamViec;
                                }
                                else
                                {
                                    excelChiTietThoiGianLamViec_GioRaDuLieu.Cells[1, iCotGioRa] = "";
                                }
                                if (sKyHieu != "X" && sKyHieu != "V")
                                {
                                    excelChiTietThoiGianLamViec_GioVaoDuLieu.Cells[1, iCotGioVao] = sKyHieu;
                                    excelChiTietThoiGianLamViec_GioRaDuLieu.Cells[1, iCotGioRa] = "";
                                }
                                else
                                {
                                    if (sKyHieu == "V" && dTongGioTangCaNgayChiTietThoiGianLamViec > 0.0)
                                    {
                                        excelChiTietThoiGianLamViec_GioVaoDuLieu.Cells[1, iCotGioVao] = "";
                                        excelChiTietThoiGianLamViec_GioRaDuLieu.Cells[1, iCotGioRa] = dTongGioTangCaNgayChiTietThoiGianLamViec;
                                    }
                                    if (sKyHieu == "V" && dTongGioTangCaNgayChiTietThoiGianLamViec == 0.0)
                                    {
                                        if (sThu == "CN")
                                        {
                                            excelChiTietThoiGianLamViec_GioVaoDuLieu.Cells[1, iCotGioVao] = "";
                                            excelChiTietThoiGianLamViec_GioRaDuLieu.Cells[1, iCotGioRa] = "";
                                        }
                                        else
                                        {
                                            excelChiTietThoiGianLamViec_GioVaoDuLieu.Cells[1, iCotGioVao] = "KP";
                                            excelChiTietThoiGianLamViec_GioRaDuLieu.Cells[1, iCotGioRa] = "";
                                        }
                                    }
                                }
                                if (sThu == "CN")
                                {
                                    Excel.Range fuckVisual4;
                                    fuckVisual4 = (ws_ChiTietThoiGianLamViec).get_Range(ws_ChiTietThoiGianLamViec.Cells[iTangHang, iTangCot], ws_ChiTietThoiGianLamViec.Cells[iTangHang, iTangCot]);
                                    Excel.Range fuckVisual5;
                                    fuckVisual5 = (ws_ChiTietThoiGianLamViec).get_Range(ws_ChiTietThoiGianLamViec.Cells[iTangHang, iTangCot + 1], ws_ChiTietThoiGianLamViec.Cells[iTangHang, iTangCot + 1]);
                                    fuckVisual4.Interior.Color = ColorTranslator.ToOle(Color.Aqua);
                                    fuckVisual5.Interior.Color = ColorTranslator.ToOle(Color.Aqua);
                                }
                            }
                            iCotGioVao = iCotGioVao + 1 + 1;
                            iCotGioRa = iCotGioRa + 1 + 1;
                            iDemNgayChiTietThoiGianLamViec++;
                            iTangCot = iTangCot + 1 + 1;
                        }
                        int iDemPhepNamThongKeThangKyHieu;
                        iDemPhepNamThongKeThangKyHieu = 0;
                        int iDemLe;
                        iDemLe = 0;
                        int iDemCN;
                        iDemCN = 0;
                        double dTongGio;
                        dTongGio = 0.0;
                        double dTongNgayCongThongKeThangKyHieu;
                        dTongNgayCongThongKeThangKyHieu = 0.0;
                        double dTongGioTC1ThongKeThangKyHieu;
                        dTongGioTC1ThongKeThangKyHieu = 0.0;
                        double dTongGioTC2ThongKeThangKyHieu;
                        dTongGioTC2ThongKeThangKyHieu = 0.0;
                        new DataTable();
                        _tinhCongDTO.MaChamCong = iMaChamCongChiTietThoiGianLamViec;
                        DataTable dtChiTietThoiGianLamViec;
                        dtChiTietThoiGianLamViec = _tinhCongBLL.TinhCongGetByMaChamCong(_tinhCongDTO);
                        for (int iChiTietThoiGianLamViec = 0; iChiTietThoiGianLamViec < dtChiTietThoiGianLamViec.Rows.Count; iChiTietThoiGianLamViec++)
                        {
                            if (dtChiTietThoiGianLamViec.Rows[iChiTietThoiGianLamViec]["Gio"].ToString() != "")
                            {
                                dTongGio += Convert.ToDouble(dtChiTietThoiGianLamViec.Rows[iChiTietThoiGianLamViec]["Gio"].ToString());
                            }
                            if (dtChiTietThoiGianLamViec.Rows[iChiTietThoiGianLamViec]["Cong"].ToString() != "")
                            {
                                dTongNgayCongThongKeThangKyHieu += Convert.ToDouble(dtChiTietThoiGianLamViec.Rows[iChiTietThoiGianLamViec]["Cong"].ToString());
                            }
                            if (dtChiTietThoiGianLamViec.Rows[iChiTietThoiGianLamViec]["TC1"].ToString() != "")
                            {
                                dTongGioTC1ThongKeThangKyHieu += Convert.ToDouble(dtChiTietThoiGianLamViec.Rows[iChiTietThoiGianLamViec]["TC1"].ToString());
                            }
                            if (dtChiTietThoiGianLamViec.Rows[iChiTietThoiGianLamViec]["TC2"].ToString() != "")
                            {
                                dTongGioTC2ThongKeThangKyHieu += Convert.ToDouble(dtChiTietThoiGianLamViec.Rows[iChiTietThoiGianLamViec]["TC2"].ToString());
                            }
                            string sKyHieuDuLieuThongKeThang;
                            sKyHieuDuLieuThongKeThang = dtChiTietThoiGianLamViec.Rows[iChiTietThoiGianLamViec]["KyHieu"].ToString();
                            if (sKyHieuDuLieuThongKeThang == sKHPhepNam)
                            {
                                iDemPhepNamThongKeThangKyHieu++;
                            }
                            if (sKyHieuDuLieuThongKeThang == "L")
                            {
                                iDemLe++;
                            }
                            if (dtChiTietThoiGianLamViec.Rows[iChiTietThoiGianLamViec]["KyHieuPhu"].ToString() == "CN")
                            {
                                iDemCN++;
                            }
                        }
                        (ws_ChiTietThoiGianLamViec).get_Range((object)("BO" + (iTongDongChiTietThoiGianLamViec + iDemNhanVienChiTietThoiGianLamViec)), (object)("BO" + (iTongDongChiTietThoiGianLamViec + iDemNhanVienChiTietThoiGianLamViec) + 1)).Cells[1, 1] = dTongNgayCongThongKeThangKyHieu;
                        (ws_ChiTietThoiGianLamViec).get_Range((object)("BP" + (iTongDongChiTietThoiGianLamViec + iDemNhanVienChiTietThoiGianLamViec)), (object)("BP" + (iTongDongChiTietThoiGianLamViec + iDemNhanVienChiTietThoiGianLamViec) + 1)).Cells[1, 1] = iDemPhepNamThongKeThangKyHieu;
                        (ws_ChiTietThoiGianLamViec).get_Range((object)("BQ" + (iTongDongChiTietThoiGianLamViec + iDemNhanVienChiTietThoiGianLamViec)), (object)("BQ" + (iTongDongChiTietThoiGianLamViec + iDemNhanVienChiTietThoiGianLamViec) + 1)).Cells[1, 1] = iDemLe;
                        (ws_ChiTietThoiGianLamViec).get_Range((object)("BR" + (iTongDongChiTietThoiGianLamViec + iDemNhanVienChiTietThoiGianLamViec)), (object)("BR" + (iTongDongChiTietThoiGianLamViec + iDemNhanVienChiTietThoiGianLamViec) + 1)).Cells[1, 1] = dTongGioTC1ThongKeThangKyHieu;
                        (ws_ChiTietThoiGianLamViec).get_Range((object)("BS" + (iTongDongChiTietThoiGianLamViec + iDemNhanVienChiTietThoiGianLamViec)), (object)("BS" + (iTongDongChiTietThoiGianLamViec + iDemNhanVienChiTietThoiGianLamViec) + 1)).Cells[1, 1] = dTongGioTC2ThongKeThangKyHieu;
                        (ws_ChiTietThoiGianLamViec).get_Range((object)("BT" + (iTongDongChiTietThoiGianLamViec + iDemNhanVienChiTietThoiGianLamViec)), (object)("BT" + (iTongDongChiTietThoiGianLamViec + iDemNhanVienChiTietThoiGianLamViec) + 1)).Cells[1, 1] = "";
                        iDemNhanVienChiTietThoiGianLamViec++;
                        iTangHang++;
                    }
                    Excel.Range excelChiTietThoiGianLamViec_DinhDangDuLieu;
                    excelChiTietThoiGianLamViec_DinhDangDuLieu = (ws_ChiTietThoiGianLamViec).get_Range((object)"A9", (object)("BT" + (iTongDongChiTietThoiGianLamViec + iDemNhanVienChiTietThoiGianLamViec - 1)));
                    excelChiTietThoiGianLamViec_DinhDangDuLieu.Font.Name = "Times New Roman";
                    excelChiTietThoiGianLamViec_DinhDangDuLieu.Font.Size = "8";
                    excelChiTietThoiGianLamViec_DinhDangDuLieu.HorizontalAlignment = Excel.Constants.xlCenter;
                    excelChiTietThoiGianLamViec_DinhDangDuLieu.Borders.LineStyle = Excel.Constants.xlBoth;
                    Excel.Range excelThongKeThangKyHieu_PhongBan11111;
                    excelThongKeThangKyHieu_PhongBan11111 = (ws_ChiTietThoiGianLamViec).get_Range((object)("E" + (iTongDongChiTietThoiGianLamViec + iDemNhanVienChiTietThoiGianLamViec + 2)), (object)("E" + (iTongDongChiTietThoiGianLamViec + iDemNhanVienChiTietThoiGianLamViec) + 2));
                    excelThongKeThangKyHieu_PhongBan11111.Cells[1, 1] = "Ghi Chú: N: Tổng giờ làm được trong ca";
                    excelThongKeThangKyHieu_PhongBan11111.Font.Name = "Times New Roman";
                    excelThongKeThangKyHieu_PhongBan11111.Font.Size = "10";
                    excelThongKeThangKyHieu_PhongBan11111.Font.Bold = true;
                    Excel.Range excelThongKeThangKyHieu_PhongBan11112;
                    excelThongKeThangKyHieu_PhongBan11112 = (ws_ChiTietThoiGianLamViec).get_Range((object)("E" + (iTongDongChiTietThoiGianLamViec + iDemNhanVienChiTietThoiGianLamViec + 3)), (object)("E" + (iTongDongChiTietThoiGianLamViec + iDemNhanVienChiTietThoiGianLamViec) + 3));
                    excelThongKeThangKyHieu_PhongBan11112.Cells[1, 1] = "O:Tổng giờ tăng ca làm được";
                    excelThongKeThangKyHieu_PhongBan11112.Font.Name = "Times New Roman";
                    excelThongKeThangKyHieu_PhongBan11112.Font.Size = "10";
                    excelThongKeThangKyHieu_PhongBan11112.Font.Bold = true;
                    Excel.Range excelThongKeThangKyHieu_PhongBan11113;
                    excelThongKeThangKyHieu_PhongBan11113 = (ws_ChiTietThoiGianLamViec).get_Range((object)("E" + (iTongDongChiTietThoiGianLamViec + iDemNhanVienChiTietThoiGianLamViec + 4)), (object)("E" + (iTongDongChiTietThoiGianLamViec + iDemNhanVienChiTietThoiGianLamViec) + 4));
                    excelThongKeThangKyHieu_PhongBan11113.Cells[1, 1] = "KP:Nghỉ ko phép";
                    excelThongKeThangKyHieu_PhongBan11113.Font.Name = "Times New Roman";
                    excelThongKeThangKyHieu_PhongBan11113.Font.Size = "10";
                    excelThongKeThangKyHieu_PhongBan11113.Font.Bold = true;
                    Excel.Range excelThongKeThangKyHieu_PhongBan11114;
                    excelThongKeThangKyHieu_PhongBan11114 = (ws_ChiTietThoiGianLamViec).get_Range((object)("E" + (iTongDongChiTietThoiGianLamViec + iDemNhanVienChiTietThoiGianLamViec + 5)), (object)("E" + (iTongDongChiTietThoiGianLamViec + iDemNhanVienChiTietThoiGianLamViec) + 5));
                    excelThongKeThangKyHieu_PhongBan11114.Cells[1, 1] = "Các loại phép được khai báo từ phần mềm: P,PB,R,PN,OM,TS,CO";
                    excelThongKeThangKyHieu_PhongBan11114.Font.Name = "Times New Roman";
                    excelThongKeThangKyHieu_PhongBan11114.Font.Size = "10";
                    excelThongKeThangKyHieu_PhongBan11114.Font.Bold = true;
                }
                catch (COMException)
                {
                    failed = true;
                }
                Thread.Sleep(10);
            }
            while (failed);
        }

        private void ThongKeGioVaTC()
        {
            DateTime dNgayTinh;
            dNgayTinh = Convert.ToDateTime(dateTimeTuNgay.Text);
            DateTime dNgayBatDauTinhCong;
            dNgayBatDauTinhCong = new DateTime(dNgayTinh.Year, dNgayTinh.Month, dNgayTinh.Day, 0, 0, 0);
            _ = Thread.CurrentThread.CurrentCulture;
            Thread.CurrentThread.CurrentCulture = new CultureInfo("en-US");
            Excel.Application xla_ThongKeThang_KyHieu;
            xla_ThongKeThang_KyHieu = new Excel.Application();
            xla_ThongKeThang_KyHieu.Workbooks.Add(Excel.XlSheetType.xlWorksheet);
            _ = xla_ThongKeThang_KyHieu.ActiveSheet;
            Excel.Worksheet ws_ThongKeThang_KyHieu;
            ws_ThongKeThang_KyHieu = xla_ThongKeThang_KyHieu.Worksheets.get_Item((object)1);
            bool failed;
            failed = false;
            do
            {
                try
                {
                    Excel.Range excelThongKeThangKyHieu_TenCongTy;
                    excelThongKeThangKyHieu_TenCongTy = (ws_ThongKeThang_KyHieu).get_Range((object)"A1", (object)"AT1");
                    excelThongKeThangKyHieu_TenCongTy.Select();
                    excelThongKeThangKyHieu_TenCongTy.Cells[1, 1] = "Công ty: " + sTenCongTyReport;
                    excelThongKeThangKyHieu_TenCongTy.get_Range((object)"A1", (object)"AT1").Merge(true);
                    Excel.Range excelThongKeThangKyHieu_DiaChiCongTy;
                    excelThongKeThangKyHieu_DiaChiCongTy = (ws_ThongKeThang_KyHieu).get_Range((object)"A2", (object)"AT2");
                    excelThongKeThangKyHieu_DiaChiCongTy.Cells[1, 1] = "Địa chỉ: " + sDiaChiCongTyReport;
                    excelThongKeThangKyHieu_DiaChiCongTy.get_Range((object)"A1", (object)"AT1").Merge(true);
                    Excel.Range excelThongKeThangKyHieu_TieuDe;
                    excelThongKeThangKyHieu_TieuDe = (ws_ThongKeThang_KyHieu).get_Range((object)"A4", (object)"AT4");
                    excelThongKeThangKyHieu_TieuDe.Cells[1, 1] = "BẢNG THỐNG KÊ CHẤM CÔNG CHI TIẾT TỪ NGÀY " + dateTimeTuNgay.Text + " ĐẾN NGÀY  " + dateTimeDenNgay.Text;
                    excelThongKeThangKyHieu_TieuDe.get_Range((object)"A1", (object)"AT1").Merge(true);
                    excelThongKeThangKyHieu_TieuDe.Font.Name = "Times New Roman";
                    excelThongKeThangKyHieu_TieuDe.Font.Size = "16";
                    excelThongKeThangKyHieu_TieuDe.Font.Bold = true;
                    excelThongKeThangKyHieu_TieuDe.RowHeight = "24";
                    excelThongKeThangKyHieu_TieuDe.HorizontalAlignment = Excel.Constants.xlCenter;
                    Excel.Range excelThongKeThangKyHieu_STT;
                    excelThongKeThangKyHieu_STT = (ws_ThongKeThang_KyHieu).get_Range((object)"A5", (object)"A6");
                    excelThongKeThangKyHieu_STT.Cells[1, 1] = "STT";
                    excelThongKeThangKyHieu_STT.get_Range((object)"A1", (object)"A2").MergeCells = true;
                    excelThongKeThangKyHieu_STT.ColumnWidth = 4;
                    Excel.Range excelThongKeThangKyHieu_PhongBan;
                    excelThongKeThangKyHieu_PhongBan = (ws_ThongKeThang_KyHieu).get_Range((object)"B5", (object)"B6");
                    excelThongKeThangKyHieu_PhongBan.Cells[1, 1] = "MÃ NHÂN VIÊN";
                    excelThongKeThangKyHieu_PhongBan.get_Range((object)"A1", (object)"A2").MergeCells = true;
                    excelThongKeThangKyHieu_PhongBan.ColumnWidth = 13;
                    Excel.Range excelThongKeThangKyHieu_MaSoNhanVien;
                    excelThongKeThangKyHieu_MaSoNhanVien = (ws_ThongKeThang_KyHieu).get_Range((object)"C5", (object)"C6");
                    excelThongKeThangKyHieu_MaSoNhanVien.Cells[1, 1] = "TÊN NHÂN VIÊN";
                    excelThongKeThangKyHieu_MaSoNhanVien.get_Range((object)"A1", (object)"A2").MergeCells = true;
                    excelThongKeThangKyHieu_MaSoNhanVien.ColumnWidth = 13;
                    Excel.Range excelThongKeThangKyHieu_TenNhanVien;
                    excelThongKeThangKyHieu_TenNhanVien = (ws_ThongKeThang_KyHieu).get_Range((object)"D5", (object)"D6");
                    excelThongKeThangKyHieu_TenNhanVien.Cells[1, 1] = "PHÒNG BAN";
                    excelThongKeThangKyHieu_TenNhanVien.get_Range((object)"A1", (object)"A2").MergeCells = true;
                    excelThongKeThangKyHieu_TenNhanVien.ColumnWidth = 11;
                    int ColunmNgay;
                    ColunmNgay = 6;
                    for (int iThongKe_KyHieu = 0; iThongKe_KyHieu < 31; iThongKe_KyHieu++)
                    {
                        DateTime dtNgayChamThongKeKyHieu;
                        dtNgayChamThongKeKyHieu = dateTimeTuNgay.Value;
                        int iNgayChamThongKeKyHieu;
                        iNgayChamThongKeKyHieu = Convert.ToInt32(Convert.ToDateTime(dtNgayChamThongKeKyHieu.AddDays(iThongKe_KyHieu).ToString()).Day);
                        Excel.Range excelThongKeThangKyHieu_Ngay;
                        excelThongKeThangKyHieu_Ngay = (ws_ThongKeThang_KyHieu).get_Range((object)"F5", (object)"AJ6");
                        xla_ThongKeThang_KyHieu.Cells[5, ColunmNgay] = iNgayChamThongKeKyHieu;
                        xla_ThongKeThang_KyHieu.Cells[6, ColunmNgay] = DateTimeProgress.XuatThuReport((int)dtNgayChamThongKeKyHieu.AddDays(iThongKe_KyHieu).DayOfWeek);
                        ColunmNgay++;
                        excelThongKeThangKyHieu_Ngay.ColumnWidth = 5;
                    }
                    Excel.Range excelThongKeThangKyHieu_NgayCong;
                    excelThongKeThangKyHieu_NgayCong = (ws_ThongKeThang_KyHieu).get_Range((object)"AK5", (object)"AK6");
                    excelThongKeThangKyHieu_NgayCong.Cells[1, 1] = "GIỜ CÔNG";
                    excelThongKeThangKyHieu_NgayCong.get_Range((object)"A1", (object)"A2").MergeCells = true;
                    Excel.Range excelThongKeThangKyHieu_TangCa;
                    excelThongKeThangKyHieu_TangCa = (ws_ThongKeThang_KyHieu).get_Range((object)"AL5", (object)"AO5");
                    excelThongKeThangKyHieu_TangCa.Cells[1, 1] = "TĂNG CA";
                    excelThongKeThangKyHieu_TangCa.get_Range((object)"A1", (object)"D1").Merge(true);
                    int ColumTangCa;
                    ColumTangCa = 38;
                    for (int iThongKeKyHieu_TangCa = 1; iThongKeKyHieu_TangCa < 5; iThongKeKyHieu_TangCa++)
                    {
                        Excel.Range excelThongKeThangKyHieu_ChiTietTangCa;
                        excelThongKeThangKyHieu_ChiTietTangCa = (ws_ThongKeThang_KyHieu).get_Range((object)"AL6", (object)"AO6");
                        xla_ThongKeThang_KyHieu.Cells[6, ColumTangCa] = "TC " + iThongKeKyHieu_TangCa;
                        ColumTangCa++;
                        excelThongKeThangKyHieu_ChiTietTangCa.ColumnWidth = 5;
                    }
                    Excel.Range excelThongKeThangKyHieu_Vang;
                    excelThongKeThangKyHieu_Vang = (ws_ThongKeThang_KyHieu).get_Range((object)"AP5", (object)"AP6");
                    excelThongKeThangKyHieu_Vang.Cells[1, 1] = "V";
                    excelThongKeThangKyHieu_Vang.get_Range((object)"A1", (object)"A2").MergeCells = true;
                    excelThongKeThangKyHieu_Vang.ColumnWidth = 5;
                    Excel.Range excelThongKeThangKyHieu_PhepNam;
                    excelThongKeThangKyHieu_PhepNam = (ws_ThongKeThang_KyHieu).get_Range((object)"AQ5", (object)"AQ6");
                    excelThongKeThangKyHieu_PhepNam.Cells[1, 1] = "PN";
                    excelThongKeThangKyHieu_PhepNam.get_Range((object)"A1", (object)"A2").MergeCells = true;
                    excelThongKeThangKyHieu_PhepNam.ColumnWidth = 5;
                    Excel.Range excelThongKeThangKyHieu_CheDo;
                    excelThongKeThangKyHieu_CheDo = (ws_ThongKeThang_KyHieu).get_Range((object)"AR5", (object)"AR6");
                    excelThongKeThangKyHieu_CheDo.Cells[1, 1] = "CĐ";
                    excelThongKeThangKyHieu_CheDo.get_Range((object)"A1", (object)"A2").MergeCells = true;
                    excelThongKeThangKyHieu_CheDo.ColumnWidth = 5;
                    Excel.Range excelThongKeThangKyHieu_Tre;
                    excelThongKeThangKyHieu_Tre = (ws_ThongKeThang_KyHieu).get_Range((object)"AS5", (object)"AS6");
                    excelThongKeThangKyHieu_Tre.Cells[1, 1] = "Trễ";
                    excelThongKeThangKyHieu_Tre.get_Range((object)"A1", (object)"A2").MergeCells = true;
                    excelThongKeThangKyHieu_Tre.ColumnWidth = 5;
                    Excel.Range excelThongKeThangKyHieu_Som;
                    excelThongKeThangKyHieu_Som = (ws_ThongKeThang_KyHieu).get_Range((object)"AT5", (object)"AT6");
                    excelThongKeThangKyHieu_Som.Cells[1, 1] = "Sớm";
                    excelThongKeThangKyHieu_Som.get_Range((object)"A1", (object)"A2").MergeCells = true;
                    excelThongKeThangKyHieu_Som.ColumnWidth = 5;
                    Excel.Range excelThongKeThangKyHieu_Total;
                    excelThongKeThangKyHieu_Total = (ws_ThongKeThang_KyHieu).get_Range((object)"A5", (object)"AT6");
                    excelThongKeThangKyHieu_Total.Font.Name = "Times New Roman";
                    excelThongKeThangKyHieu_Total.Font.Size = "10";
                    excelThongKeThangKyHieu_Total.Font.Bold = true;
                    excelThongKeThangKyHieu_Total.HorizontalAlignment = Excel.Constants.xlCenter;
                    excelThongKeThangKyHieu_Total.Interior.ColorIndex = 33;
                    xla_ThongKeThang_KyHieu.Visible = true;
                    int iDemDongThongKeThangKyHieu;
                    iDemDongThongKeThangKyHieu = 7;
                    int iDemTangCa;
                    iDemTangCa = 8;
                    new DataTable();
                    DataTable dtNgayTinhCongThongKeThangKyHieu;
                    dtNgayTinhCongThongKeThangKyHieu = _ngayTinhCongBLL.showThongTinNgayTinhCong();
                    for (int iNgayTinhCongThongKeThangKyHieu = 0; iNgayTinhCongThongKeThangKyHieu < dtNgayTinhCongThongKeThangKyHieu.Rows.Count; iNgayTinhCongThongKeThangKyHieu++)
                    {
                        int iSTTThongKeThangKyHieu;
                        iSTTThongKeThangKyHieu = 1;
                        int iMaChamCongThongKeThangKyHieu;
                        iMaChamCongThongKeThangKyHieu = 0;
                        DateTime dNgayBatDauTinhCongThongKeThangKyHieu;
                        dNgayBatDauTinhCongThongKeThangKyHieu = Convert.ToDateTime(dtNgayTinhCongThongKeThangKyHieu.Rows[iNgayTinhCongThongKeThangKyHieu]["NgayBatDau"].ToString());
                        int iTongNgayTinhCongThongKeThangKyHieu;
                        iTongNgayTinhCongThongKeThangKyHieu = Convert.ToInt32((Convert.ToDateTime(dtNgayTinhCongThongKeThangKyHieu.Rows[iNgayTinhCongThongKeThangKyHieu]["NgayKetThuc"].ToString()) - dNgayBatDauTinhCongThongKeThangKyHieu).TotalDays);
                        new DataTable();
                        _tinhCongDTO.Ngay = dNgayBatDauTinhCong;
                        DataTable dtTinhCongThongKeThangKyHieu;
                        dtTinhCongThongKeThangKyHieu = _tinhCongBLL.TinhCongGetNgay(_tinhCongDTO);
                        for (int iTinhCongThongKeThangKyHieu = 0; iTinhCongThongKeThangKyHieu < dtTinhCongThongKeThangKyHieu.Rows.Count; iTinhCongThongKeThangKyHieu++)
                        {
                            int iDemCotThongKeThangKyHieu;
                            iDemCotThongKeThangKyHieu = 1;
                            if (Convert.ToInt32(dtTinhCongThongKeThangKyHieu.Rows[iTinhCongThongKeThangKyHieu]["MaChamCong"].ToString()) == iMaChamCongThongKeThangKyHieu)
                            {
                                continue;
                            }
                            iMaChamCongThongKeThangKyHieu = Convert.ToInt32(dtTinhCongThongKeThangKyHieu.Rows[iTinhCongThongKeThangKyHieu]["MaChamCong"].ToString());
                            Excel.Range excelThongKeThangKyHieu_STTDuLieu;
                            excelThongKeThangKyHieu_STTDuLieu = (ws_ThongKeThang_KyHieu).get_Range((object)("A" + iDemDongThongKeThangKyHieu), (object)("A" + iDemDongThongKeThangKyHieu));
                            excelThongKeThangKyHieu_STTDuLieu.Cells[1, 1] = iSTTThongKeThangKyHieu.ToString();
                            excelThongKeThangKyHieu_STTDuLieu.get_Range((object)"A1", (object)"A2").MergeCells = true;
                            excelThongKeThangKyHieu_STTDuLieu.Select();
                            string sTenPhongBan;
                            sTenPhongBan = "";
                            new DataTable();
                            _phongBanDTO.MaPhongBan = dtTinhCongThongKeThangKyHieu.Rows[iTinhCongThongKeThangKyHieu]["PhongBan"].ToString();
                            DataTable dtPhongBan;
                            dtPhongBan = _phongBanBLL.getTenPhongBanByMaPhongBan(_phongBanDTO);
                            for (int iPhongBan = 0; iPhongBan < dtPhongBan.Rows.Count; iPhongBan++)
                            {
                                sTenPhongBan = dtPhongBan.Rows[iPhongBan]["TenPhongBan"].ToString();
                            }
                            Excel.Range excelThongKeThangKyHieu_PhongBanDuLieu;
                            excelThongKeThangKyHieu_PhongBanDuLieu = (ws_ThongKeThang_KyHieu).get_Range((object)("D" + iDemDongThongKeThangKyHieu), (object)("D" + iDemDongThongKeThangKyHieu));
                            excelThongKeThangKyHieu_PhongBanDuLieu.get_Range((object)"A1", (object)"A2").MergeCells = true;
                            if (sTenPhongBan == "")
                            {
                                excelThongKeThangKyHieu_PhongBanDuLieu.Cells[1, 1] = "------";
                            }
                            else
                            {
                                excelThongKeThangKyHieu_PhongBanDuLieu.Cells[1, 1] = sTenPhongBan;
                            }
                            Excel.Range excelThongKeThangKyHieu_PhongBan2DuLieu;
                            excelThongKeThangKyHieu_PhongBan2DuLieu = (ws_ThongKeThang_KyHieu).get_Range((object)("D" + iDemTangCa), (object)("D" + iDemTangCa));
                            if (sTenPhongBan == "")
                            {
                                excelThongKeThangKyHieu_PhongBan2DuLieu.Cells[1, 1] = "------";
                            }
                            else
                            {
                                excelThongKeThangKyHieu_PhongBan2DuLieu.Cells[1, 1] = sTenPhongBan;
                            }
                            Excel.Range excelThongKeThangKyHieu_MaNhanVienDuLieu;
                            excelThongKeThangKyHieu_MaNhanVienDuLieu = (ws_ThongKeThang_KyHieu).get_Range((object)("B" + iDemDongThongKeThangKyHieu), (object)("B" + iDemDongThongKeThangKyHieu));
                            excelThongKeThangKyHieu_MaNhanVienDuLieu.get_Range((object)"A1", (object)"A1").NumberFormat = "@";
                            excelThongKeThangKyHieu_MaNhanVienDuLieu.get_Range((object)"A1", (object)"A2").MergeCells = true;
                            excelThongKeThangKyHieu_MaNhanVienDuLieu.Cells[1, 1] = dtTinhCongThongKeThangKyHieu.Rows[iTinhCongThongKeThangKyHieu]["MaNhanVien"].ToString();
                            Excel.Range excelThongKeThangKyHieu_TenNhanVienDuLieu;
                            excelThongKeThangKyHieu_TenNhanVienDuLieu = (ws_ThongKeThang_KyHieu).get_Range((object)("C" + iDemDongThongKeThangKyHieu), (object)("C" + iDemDongThongKeThangKyHieu));
                            excelThongKeThangKyHieu_TenNhanVienDuLieu.Cells[1, 1] = dtTinhCongThongKeThangKyHieu.Rows[iTinhCongThongKeThangKyHieu]["TenNhanVien"].ToString();
                            excelThongKeThangKyHieu_TenNhanVienDuLieu.get_Range((object)"A1", (object)"A2").MergeCells = true;
                            (ws_ThongKeThang_KyHieu).get_Range((object)("E" + iDemDongThongKeThangKyHieu), (object)("E" + iDemDongThongKeThangKyHieu))[1, 1] = "HC";
                            (ws_ThongKeThang_KyHieu).get_Range((object)("E" + iDemTangCa), (object)("E" + iDemTangCa))[1, 1] = "TC";
                            string sGio;
                            sGio = "";
                            double dTangCa;
                            dTangCa = 0.0;
                            double dTangCa2;
                            dTangCa2 = 0.0;
                            for (int iThongKeThangKyHieu_NgayDuLieu = 0; iThongKeThangKyHieu_NgayDuLieu <= iTongNgayTinhCongThongKeThangKyHieu; iThongKeThangKyHieu_NgayDuLieu++)
                            {
                                DateTime dNgayChamThongKeKyHieu;
                                dNgayChamThongKeKyHieu = Convert.ToDateTime(dNgayBatDauTinhCong.AddDays(iThongKeThangKyHieu_NgayDuLieu).ToString());
                                new DataTable();
                                _tinhCongDTO.MaChamCong = iMaChamCongThongKeThangKyHieu;
                                _tinhCongDTO.Ngay = dNgayChamThongKeKyHieu;
                                DataTable dtDuLieuNgayThongKeThangKyHieu;
                                dtDuLieuNgayThongKeThangKyHieu = _tinhCongBLL.TinhCongGetMaChamCongAndNgayGioVaTC(_tinhCongDTO);
                                for (int iDuLieuNgayThongKeThangKyHieu = 0; iDuLieuNgayThongKeThangKyHieu < dtDuLieuNgayThongKeThangKyHieu.Rows.Count; iDuLieuNgayThongKeThangKyHieu++)
                                {
                                    dTangCa = Convert.ToDouble(dtDuLieuNgayThongKeThangKyHieu.Rows[iDuLieuNgayThongKeThangKyHieu]["TC1"].ToString());
                                    dTangCa2 = Convert.ToDouble(dtDuLieuNgayThongKeThangKyHieu.Rows[iDuLieuNgayThongKeThangKyHieu]["TC2"].ToString());
                                    sGio = dtDuLieuNgayThongKeThangKyHieu.Rows[iDuLieuNgayThongKeThangKyHieu]["Gio"].ToString();
                                }
                                (ws_ThongKeThang_KyHieu).get_Range((object)("F" + iDemDongThongKeThangKyHieu), (object)("AJ" + iDemDongThongKeThangKyHieu)).Cells[1, iDemCotThongKeThangKyHieu] = sGio;
                                (ws_ThongKeThang_KyHieu).get_Range((object)("F" + iDemTangCa), (object)("AJ" + iDemTangCa)).Cells[1, iDemCotThongKeThangKyHieu] = dTangCa + dTangCa2;
                                iDemCotThongKeThangKyHieu++;
                            }
                            double dTongGio;
                            dTongGio = 0.0;
                            double dTongNgayCongThongKeThangKyHieu;
                            dTongNgayCongThongKeThangKyHieu = 0.0;
                            double dTongGioTC1ThongKeThangKyHieu;
                            dTongGioTC1ThongKeThangKyHieu = 0.0;
                            double dTongGioTC2ThongKeThangKyHieu;
                            dTongGioTC2ThongKeThangKyHieu = 0.0;
                            double dTongGioTC3ThongKeThangKyHieu;
                            dTongGioTC3ThongKeThangKyHieu = 0.0;
                            double dTongGioTC4ThongKeThangKyHieu;
                            dTongGioTC4ThongKeThangKyHieu = 0.0;
                            double dTongTreThongKeThangKyHieu;
                            dTongTreThongKeThangKyHieu = 0.0;
                            double dTongVeSomThongKeThangKyHieu;
                            dTongVeSomThongKeThangKyHieu = 0.0;
                            int iDemPhepNamThongKeThangKyHieu;
                            iDemPhepNamThongKeThangKyHieu = 0;
                            int iDemVangThongKeThangKyHieu;
                            iDemVangThongKeThangKyHieu = 0;
                            new DataTable();
                            _tinhCongDTO.MaChamCong = iMaChamCongThongKeThangKyHieu;
                            DataTable dtDuLieuTongThongKeThangKyHieu;
                            dtDuLieuTongThongKeThangKyHieu = _tinhCongBLL.TinhCongGetByMaChamCong(_tinhCongDTO);
                            for (int iDuLieuTongThongKeThangKyHieu = 0; iDuLieuTongThongKeThangKyHieu < dtDuLieuTongThongKeThangKyHieu.Rows.Count; iDuLieuTongThongKeThangKyHieu++)
                            {
                                dTongGio += Convert.ToDouble(dtDuLieuTongThongKeThangKyHieu.Rows[iDuLieuTongThongKeThangKyHieu]["Gio"].ToString());
                                dTongNgayCongThongKeThangKyHieu += Convert.ToDouble(dtDuLieuTongThongKeThangKyHieu.Rows[iDuLieuTongThongKeThangKyHieu]["Cong"].ToString());
                                dTongGioTC1ThongKeThangKyHieu += Convert.ToDouble(dtDuLieuTongThongKeThangKyHieu.Rows[iDuLieuTongThongKeThangKyHieu]["TC1"].ToString());
                                dTongGioTC2ThongKeThangKyHieu += Convert.ToDouble(dtDuLieuTongThongKeThangKyHieu.Rows[iDuLieuTongThongKeThangKyHieu]["TC2"].ToString());
                                dTongGioTC3ThongKeThangKyHieu += Convert.ToDouble(dtDuLieuTongThongKeThangKyHieu.Rows[iDuLieuTongThongKeThangKyHieu]["TC3"].ToString());
                                dTongGioTC4ThongKeThangKyHieu += Convert.ToDouble(dtDuLieuTongThongKeThangKyHieu.Rows[iDuLieuTongThongKeThangKyHieu]["TC4"].ToString());
                                dTongTreThongKeThangKyHieu += Convert.ToDouble(dtDuLieuTongThongKeThangKyHieu.Rows[iDuLieuTongThongKeThangKyHieu]["Tre"].ToString());
                                dTongVeSomThongKeThangKyHieu += Convert.ToDouble(dtDuLieuTongThongKeThangKyHieu.Rows[iDuLieuTongThongKeThangKyHieu]["VeSom"].ToString());
                                string sKyHieuDuLieuThongKeThang;
                                sKyHieuDuLieuThongKeThang = dtDuLieuTongThongKeThangKyHieu.Rows[iDuLieuTongThongKeThangKyHieu]["KyHieu"].ToString();
                                string sThuTotal;
                                sThuTotal = dtDuLieuTongThongKeThangKyHieu.Rows[iDuLieuTongThongKeThangKyHieu]["Thu"].ToString();
                                if (sKyHieuDuLieuThongKeThang == sKHPhepNam)
                                {
                                    iDemPhepNamThongKeThangKyHieu++;
                                }
                                if (sKyHieuDuLieuThongKeThang == sKHVang && sThuTotal != "CN")
                                {
                                    iDemVangThongKeThangKyHieu++;
                                }
                            }
                            Excel.Range excelThongKeThangKyHieu_TongNgayCongDuLieu;
                            excelThongKeThangKyHieu_TongNgayCongDuLieu = (ws_ThongKeThang_KyHieu).get_Range((object)("AK" + iDemDongThongKeThangKyHieu), (object)("AK" + iDemDongThongKeThangKyHieu));
                            excelThongKeThangKyHieu_TongNgayCongDuLieu.Cells[1, 1] = dTongGio.ToString();
                            excelThongKeThangKyHieu_TongNgayCongDuLieu.get_Range((object)"A1", (object)"A2").MergeCells = true;
                            Excel.Range excelThongKeThangKyHieu_TC1DuLieu;
                            excelThongKeThangKyHieu_TC1DuLieu = (ws_ThongKeThang_KyHieu).get_Range((object)("AL" + iDemDongThongKeThangKyHieu), (object)("AL" + iDemDongThongKeThangKyHieu));
                            excelThongKeThangKyHieu_TC1DuLieu.Cells[1, 1] = dTongGioTC1ThongKeThangKyHieu.ToString();
                            excelThongKeThangKyHieu_TC1DuLieu.get_Range((object)"A1", (object)"A2").MergeCells = true;
                            Excel.Range excelThongKeThangKyHieu_TC2DuLieu;
                            excelThongKeThangKyHieu_TC2DuLieu = (ws_ThongKeThang_KyHieu).get_Range((object)("AM" + iDemDongThongKeThangKyHieu), (object)("AM" + iDemDongThongKeThangKyHieu));
                            excelThongKeThangKyHieu_TC2DuLieu.Cells[1, 1] = dTongGioTC2ThongKeThangKyHieu.ToString();
                            excelThongKeThangKyHieu_TC2DuLieu.get_Range((object)"A1", (object)"A2").MergeCells = true;
                            Excel.Range excelThongKeThangKyHieu_TC3DuLieu;
                            excelThongKeThangKyHieu_TC3DuLieu = (ws_ThongKeThang_KyHieu).get_Range((object)("AN" + iDemDongThongKeThangKyHieu), (object)("AN" + iDemDongThongKeThangKyHieu));
                            excelThongKeThangKyHieu_TC3DuLieu.Cells[1, 1] = dTongGioTC3ThongKeThangKyHieu.ToString();
                            excelThongKeThangKyHieu_TC3DuLieu.get_Range((object)"A1", (object)"A2").MergeCells = true;
                            Excel.Range excelThongKeThangKyHieu_TC4DuLieu;
                            excelThongKeThangKyHieu_TC4DuLieu = (ws_ThongKeThang_KyHieu).get_Range((object)("AO" + iDemDongThongKeThangKyHieu), (object)("AO" + iDemDongThongKeThangKyHieu));
                            excelThongKeThangKyHieu_TC4DuLieu.Cells[1, 1] = dTongGioTC4ThongKeThangKyHieu.ToString();
                            excelThongKeThangKyHieu_TC4DuLieu.get_Range((object)"A1", (object)"A2").MergeCells = true;
                            Excel.Range excelThongKeThangKyHieu_VangDuLieu;
                            excelThongKeThangKyHieu_VangDuLieu = (ws_ThongKeThang_KyHieu).get_Range((object)("AP" + iDemDongThongKeThangKyHieu), (object)("AP" + iDemDongThongKeThangKyHieu));
                            excelThongKeThangKyHieu_VangDuLieu.Cells[1, 1] = iDemVangThongKeThangKyHieu.ToString();
                            excelThongKeThangKyHieu_VangDuLieu.get_Range((object)"A1", (object)"A2").MergeCells = true;
                            Excel.Range excelThongKeThangKyHieu_PhepNamDuLieu;
                            excelThongKeThangKyHieu_PhepNamDuLieu = (ws_ThongKeThang_KyHieu).get_Range((object)("AQ" + iDemDongThongKeThangKyHieu), (object)("AQ" + iDemDongThongKeThangKyHieu));
                            excelThongKeThangKyHieu_PhepNamDuLieu.Cells[1, 1] = iDemPhepNamThongKeThangKyHieu.ToString();
                            excelThongKeThangKyHieu_PhepNamDuLieu.get_Range((object)"A1", (object)"A2").MergeCells = true;
                            Excel.Range excelThongKeThangKyHieu_TreDuLieu;
                            excelThongKeThangKyHieu_TreDuLieu = (ws_ThongKeThang_KyHieu).get_Range((object)("AS" + iDemDongThongKeThangKyHieu), (object)("AS" + iDemDongThongKeThangKyHieu));
                            excelThongKeThangKyHieu_TreDuLieu.Cells[1, 1] = dTongTreThongKeThangKyHieu.ToString();
                            excelThongKeThangKyHieu_TreDuLieu.get_Range((object)"A1", (object)"A2").MergeCells = true;
                            (ws_ThongKeThang_KyHieu).get_Range((object)("AR" + iDemDongThongKeThangKyHieu), (object)("AR" + iDemDongThongKeThangKyHieu)).get_Range((object)"A1", (object)"A2").MergeCells = true;
                            Excel.Range excelThongKeThangKyHieu_VeSomDuLieu;
                            excelThongKeThangKyHieu_VeSomDuLieu = (ws_ThongKeThang_KyHieu).get_Range((object)("AT" + iDemDongThongKeThangKyHieu), (object)("AT" + iDemDongThongKeThangKyHieu));
                            excelThongKeThangKyHieu_VeSomDuLieu.Cells[1, 1] = dTongVeSomThongKeThangKyHieu.ToString();
                            excelThongKeThangKyHieu_VeSomDuLieu.get_Range((object)"A1", (object)"A2").MergeCells = true;
                            iDemTangCa = iDemTangCa + 1 + 1;
                            iDemDongThongKeThangKyHieu = iDemDongThongKeThangKyHieu + 1 + 1;
                            iSTTThongKeThangKyHieu++;
                        }
                    }
                    Excel.Range excelThongKeThangKyHieu_DinhDangDuLieu;
                    excelThongKeThangKyHieu_DinhDangDuLieu = (ws_ThongKeThang_KyHieu).get_Range((object)"A7", (object)("AT" + (iDemDongThongKeThangKyHieu - 1)));
                    excelThongKeThangKyHieu_DinhDangDuLieu.Font.Name = "Times New Roman";
                    excelThongKeThangKyHieu_DinhDangDuLieu.Font.Size = "8";
                    excelThongKeThangKyHieu_DinhDangDuLieu.HorizontalAlignment = Excel.Constants.xlCenter;
                    (ws_ThongKeThang_KyHieu).get_Range((object)"A4", (object)("AT" + (iDemDongThongKeThangKyHieu - 1))).Borders.LineStyle = Excel.Constants.xlBoth;
                }
                catch (COMException)
                {
                    failed = true;
                }
                Thread.Sleep(10);
            }
            while (failed);
        }

        private void ExportThongKeThang_KyHieu()
        {
            _ = Thread.CurrentThread.CurrentCulture;
            Thread.CurrentThread.CurrentCulture = new CultureInfo("en-US");
            Excel.Application xla_ThongKeThang_KyHieu;
            xla_ThongKeThang_KyHieu = new Excel.Application();
            xla_ThongKeThang_KyHieu.Workbooks.Add(Excel.XlSheetType.xlWorksheet);
            _ = xla_ThongKeThang_KyHieu.ActiveSheet;
            Excel.Worksheet ws_ThongKeThang_KyHieu;
            ws_ThongKeThang_KyHieu = xla_ThongKeThang_KyHieu.Worksheets.get_Item((object)1);
            DateTime dNgayTinh;
            dNgayTinh = Convert.ToDateTime(dateTimeTuNgay.Text);
            DateTime dNgayBatDauTinhCong;
            dNgayBatDauTinhCong = new DateTime(dNgayTinh.Year, dNgayTinh.Month, dNgayTinh.Day, 0, 0, 0);
            bool failed;
            do
            {
                try
                {
                    Excel.Range excelThongKeThangKyHieu_TenCongTy;
                    excelThongKeThangKyHieu_TenCongTy = (ws_ThongKeThang_KyHieu).get_Range((object)"A1", (object)"AT1");
                    excelThongKeThangKyHieu_TenCongTy.Select();
                    excelThongKeThangKyHieu_TenCongTy.Cells[1, 1] = "Công ty: " + sTenCongTyReport;
                    excelThongKeThangKyHieu_TenCongTy.get_Range((object)"A1", (object)"AT1").Merge(true);
                    Excel.Range excelThongKeThangKyHieu_DiaChiCongTy;
                    excelThongKeThangKyHieu_DiaChiCongTy = (ws_ThongKeThang_KyHieu).get_Range((object)"A2", (object)"AT2");
                    excelThongKeThangKyHieu_DiaChiCongTy.Cells[1, 1] = "Địa chỉ: " + sDiaChiCongTyReport;
                    excelThongKeThangKyHieu_DiaChiCongTy.get_Range((object)"A1", (object)"AT1").Merge(true);
                    Excel.Range excelThongKeThangKyHieu_TieuDe;
                    excelThongKeThangKyHieu_TieuDe = (ws_ThongKeThang_KyHieu).get_Range((object)"A4", (object)"AT4");
                    excelThongKeThangKyHieu_TieuDe.Cells[1, 1] = "BẢNG THỐNG KÊ CHẤM CÔNG (KÝ HIỆU)";
                    excelThongKeThangKyHieu_TieuDe.get_Range((object)"A1", (object)"AT1").Merge(true);
                    excelThongKeThangKyHieu_TieuDe.Font.Name = "Times New Roman";
                    excelThongKeThangKyHieu_TieuDe.Font.Size = "16";
                    excelThongKeThangKyHieu_TieuDe.Font.Bold = true;
                    excelThongKeThangKyHieu_TieuDe.RowHeight = "24";
                    excelThongKeThangKyHieu_TieuDe.HorizontalAlignment = Excel.Constants.xlCenter;
                    Excel.Range excelThongKeThangKyHieu_STT;
                    excelThongKeThangKyHieu_STT = (ws_ThongKeThang_KyHieu).get_Range((object)"A5", (object)"A6");
                    excelThongKeThangKyHieu_STT.Cells[1, 1] = "STT";
                    excelThongKeThangKyHieu_STT.get_Range((object)"A1", (object)"A2").MergeCells = true;
                    excelThongKeThangKyHieu_STT.ColumnWidth = 5;
                    Excel.Range excelThongKeThangKyHieu_PhongBan;
                    excelThongKeThangKyHieu_PhongBan = (ws_ThongKeThang_KyHieu).get_Range((object)"B5", (object)"B6");
                    excelThongKeThangKyHieu_PhongBan.Cells[1, 1] = "PHÒNG BAN";
                    excelThongKeThangKyHieu_PhongBan.get_Range((object)"A1", (object)"A2").MergeCells = true;
                    excelThongKeThangKyHieu_PhongBan.ColumnWidth = 13;
                    Excel.Range excelThongKeThangKyHieu_MaSoNhanVien;
                    excelThongKeThangKyHieu_MaSoNhanVien = (ws_ThongKeThang_KyHieu).get_Range((object)"C5", (object)"C6");
                    excelThongKeThangKyHieu_MaSoNhanVien.Cells[1, 1] = "MSNV";
                    excelThongKeThangKyHieu_MaSoNhanVien.get_Range((object)"A1", (object)"A2").MergeCells = true;
                    excelThongKeThangKyHieu_MaSoNhanVien.ColumnWidth = 6;
                    Excel.Range excelThongKeThangKyHieu_TenNhanVien;
                    excelThongKeThangKyHieu_TenNhanVien = (ws_ThongKeThang_KyHieu).get_Range((object)"D5", (object)"D6");
                    excelThongKeThangKyHieu_TenNhanVien.Cells[1, 1] = "TÊN NHÂN VIÊN";
                    excelThongKeThangKyHieu_TenNhanVien.get_Range((object)"A1", (object)"A2").MergeCells = true;
                    excelThongKeThangKyHieu_TenNhanVien.ColumnWidth = 14;
                    Excel.Range excelThongKeThangKyHieu_NgayVaoLamViec;
                    excelThongKeThangKyHieu_NgayVaoLamViec = (ws_ThongKeThang_KyHieu).get_Range((object)"E5", (object)"E6");
                    excelThongKeThangKyHieu_NgayVaoLamViec.Cells[1, 1] = "NGÀY VÀO LÀM";
                    excelThongKeThangKyHieu_NgayVaoLamViec.get_Range((object)"A1", (object)"A2").MergeCells = true;
                    excelThongKeThangKyHieu_NgayVaoLamViec.ColumnWidth = 14;
                    int ColunmNgay;
                    ColunmNgay = 6;
                    for (int iThongKe_KyHieu = 0; iThongKe_KyHieu < 31; iThongKe_KyHieu++)
                    {
                        DateTime dtNgayChamThongKeKyHieu;
                        dtNgayChamThongKeKyHieu = dateTimeTuNgay.Value;
                        int iNgayChamThongKeKyHieu;
                        iNgayChamThongKeKyHieu = Convert.ToInt32(Convert.ToDateTime(dtNgayChamThongKeKyHieu.AddDays(iThongKe_KyHieu).ToString()).Day);
                        Excel.Range excelThongKeThangKyHieu_Ngay;
                        excelThongKeThangKyHieu_Ngay = (ws_ThongKeThang_KyHieu).get_Range((object)"F5", (object)"AJ6");
                        xla_ThongKeThang_KyHieu.Cells[5, ColunmNgay] = iNgayChamThongKeKyHieu;
                        xla_ThongKeThang_KyHieu.Cells[6, ColunmNgay] = DateTimeProgress.XuatThuReport((int)dtNgayChamThongKeKyHieu.AddDays(iThongKe_KyHieu).DayOfWeek);
                        ColunmNgay++;
                        excelThongKeThangKyHieu_Ngay.ColumnWidth = 5;
                    }
                    Excel.Range excelThongKeThangKyHieu_NgayCong;
                    excelThongKeThangKyHieu_NgayCong = (ws_ThongKeThang_KyHieu).get_Range((object)"AK5", (object)"AK6");
                    excelThongKeThangKyHieu_NgayCong.Cells[1, 1] = "Ngày công";
                    excelThongKeThangKyHieu_NgayCong.get_Range((object)"A1", (object)"A2").MergeCells = true;
                    Excel.Range excelThongKeThangKyHieu_TangCa;
                    excelThongKeThangKyHieu_TangCa = (ws_ThongKeThang_KyHieu).get_Range((object)"AL5", (object)"AO5");
                    excelThongKeThangKyHieu_TangCa.Cells[1, 1] = "Tăng ca";
                    excelThongKeThangKyHieu_TangCa.get_Range((object)"A1", (object)"D1").Merge(true);
                    int ColumTangCa;
                    ColumTangCa = 38;
                    for (int iThongKeKyHieu_TangCa = 1; iThongKeKyHieu_TangCa < 5; iThongKeKyHieu_TangCa++)
                    {
                        Excel.Range excelThongKeThangKyHieu_ChiTietTangCa;
                        excelThongKeThangKyHieu_ChiTietTangCa = (ws_ThongKeThang_KyHieu).get_Range((object)"AL6", (object)"AO6");
                        xla_ThongKeThang_KyHieu.Cells[6, ColumTangCa] = "TC " + iThongKeKyHieu_TangCa;
                        ColumTangCa++;
                        excelThongKeThangKyHieu_ChiTietTangCa.ColumnWidth = 5;
                    }
                    Excel.Range excelThongKeThangKyHieu_Vang;
                    excelThongKeThangKyHieu_Vang = (ws_ThongKeThang_KyHieu).get_Range((object)"AP5", (object)"AP6");
                    excelThongKeThangKyHieu_Vang.Cells[1, 1] = "V";
                    excelThongKeThangKyHieu_Vang.get_Range((object)"A1", (object)"A2").MergeCells = true;
                    excelThongKeThangKyHieu_Vang.ColumnWidth = 5;
                    Excel.Range excelThongKeThangKyHieu_PhepNam;
                    excelThongKeThangKyHieu_PhepNam = (ws_ThongKeThang_KyHieu).get_Range((object)"AQ5", (object)"AQ6");
                    excelThongKeThangKyHieu_PhepNam.Cells[1, 1] = "PN";
                    excelThongKeThangKyHieu_PhepNam.get_Range((object)"A1", (object)"A2").MergeCells = true;
                    excelThongKeThangKyHieu_PhepNam.ColumnWidth = 5;
                    Excel.Range excelThongKeThangKyHieu_CheDo;
                    excelThongKeThangKyHieu_CheDo = (ws_ThongKeThang_KyHieu).get_Range((object)"AR5", (object)"AR6");
                    excelThongKeThangKyHieu_CheDo.Cells[1, 1] = "CĐ";
                    excelThongKeThangKyHieu_CheDo.get_Range((object)"A1", (object)"A2").MergeCells = true;
                    excelThongKeThangKyHieu_CheDo.ColumnWidth = 5;
                    Excel.Range excelThongKeThangKyHieu_Tre;
                    excelThongKeThangKyHieu_Tre = (ws_ThongKeThang_KyHieu).get_Range((object)"AS5", (object)"AS6");
                    excelThongKeThangKyHieu_Tre.Cells[1, 1] = "Trễ";
                    excelThongKeThangKyHieu_Tre.get_Range((object)"A1", (object)"A2").MergeCells = true;
                    excelThongKeThangKyHieu_Tre.ColumnWidth = 5;
                    Excel.Range excelThongKeThangKyHieu_Som;
                    excelThongKeThangKyHieu_Som = (ws_ThongKeThang_KyHieu).get_Range((object)"AT5", (object)"AT6");
                    excelThongKeThangKyHieu_Som.Cells[1, 1] = "Sớm";
                    excelThongKeThangKyHieu_Som.get_Range((object)"A1", (object)"A2").MergeCells = true;
                    excelThongKeThangKyHieu_Som.ColumnWidth = 5;
                    Excel.Range excelThongKeThangKyHieu_Total;
                    excelThongKeThangKyHieu_Total = (ws_ThongKeThang_KyHieu).get_Range((object)"A5", (object)"AT6");
                    excelThongKeThangKyHieu_Total.Font.Name = "Times New Roman";
                    excelThongKeThangKyHieu_Total.Font.Size = "10";
                    excelThongKeThangKyHieu_Total.Font.Bold = true;
                    excelThongKeThangKyHieu_Total.HorizontalAlignment = Excel.Constants.xlCenter;
                    xla_ThongKeThang_KyHieu.Visible = true;
                    int iDemDongThongKeThangKyHieu;
                    iDemDongThongKeThangKyHieu = 7;
                    new DataTable();
                    DataTable dtNgayTinhCongThongKeThangKyHieu;
                    dtNgayTinhCongThongKeThangKyHieu = _ngayTinhCongBLL.showThongTinNgayTinhCong();
                    for (int iNgayTinhCongThongKeThangKyHieu = 0; iNgayTinhCongThongKeThangKyHieu < dtNgayTinhCongThongKeThangKyHieu.Rows.Count; iNgayTinhCongThongKeThangKyHieu++)
                    {
                        int iSTTThongKeThangKyHieu;
                        iSTTThongKeThangKyHieu = 1;
                        int iMaChamCongThongKeThangKyHieu;
                        iMaChamCongThongKeThangKyHieu = 0;
                        DateTime dNgayBatDauTinhCongThongKeThangKyHieu;
                        dNgayBatDauTinhCongThongKeThangKyHieu = Convert.ToDateTime(dtNgayTinhCongThongKeThangKyHieu.Rows[iNgayTinhCongThongKeThangKyHieu]["NgayBatDau"].ToString());
                        int iTongNgayTinhCongThongKeThangKyHieu;
                        iTongNgayTinhCongThongKeThangKyHieu = Convert.ToInt32((Convert.ToDateTime(dtNgayTinhCongThongKeThangKyHieu.Rows[iNgayTinhCongThongKeThangKyHieu]["NgayKetThuc"].ToString()) - dNgayBatDauTinhCongThongKeThangKyHieu).TotalDays);
                        new DataTable();
                        _tinhCongDTO.Ngay = dNgayBatDauTinhCong;
                        DataTable dtTinhCongThongKeThangKyHieu;
                        dtTinhCongThongKeThangKyHieu = _tinhCongBLL.TinhCongGetNgay(_tinhCongDTO);
                        for (int iTinhCongThongKeThangKyHieu = 0; iTinhCongThongKeThangKyHieu < dtTinhCongThongKeThangKyHieu.Rows.Count; iTinhCongThongKeThangKyHieu++)
                        {
                            int iDemCotThongKeThangKyHieu;
                            iDemCotThongKeThangKyHieu = 1;
                            if (Convert.ToInt32(dtTinhCongThongKeThangKyHieu.Rows[iTinhCongThongKeThangKyHieu]["MaChamCong"].ToString()) == iMaChamCongThongKeThangKyHieu)
                            {
                                continue;
                            }
                            iMaChamCongThongKeThangKyHieu = Convert.ToInt32(dtTinhCongThongKeThangKyHieu.Rows[iTinhCongThongKeThangKyHieu]["MaChamCong"].ToString());
                            Excel.Range excelThongKeThangKyHieu_STTDuLieu;
                            excelThongKeThangKyHieu_STTDuLieu = (ws_ThongKeThang_KyHieu).get_Range((object)("A" + iDemDongThongKeThangKyHieu), (object)("A" + iDemDongThongKeThangKyHieu));
                            excelThongKeThangKyHieu_STTDuLieu.Cells[1, 1] = iSTTThongKeThangKyHieu.ToString();
                            excelThongKeThangKyHieu_STTDuLieu.Select();
                            string sTenPhongBan;
                            sTenPhongBan = "";
                            new DataTable();
                            _phongBanDTO.MaPhongBan = dtTinhCongThongKeThangKyHieu.Rows[iTinhCongThongKeThangKyHieu]["PhongBan"].ToString();
                            DataTable dtPhongBan;
                            dtPhongBan = _phongBanBLL.getTenPhongBanByMaPhongBan(_phongBanDTO);
                            for (int iPhongBan = 0; iPhongBan < dtPhongBan.Rows.Count; iPhongBan++)
                            {
                                sTenPhongBan = dtPhongBan.Rows[iPhongBan]["TenPhongBan"].ToString();
                            }
                            Excel.Range excelThongKeThangKyHieu_PhongBanDuLieu;
                            excelThongKeThangKyHieu_PhongBanDuLieu = (ws_ThongKeThang_KyHieu).get_Range((object)("B" + iDemDongThongKeThangKyHieu), (object)("B" + iDemDongThongKeThangKyHieu));
                            if (sTenPhongBan == "")
                            {
                                excelThongKeThangKyHieu_PhongBanDuLieu.Cells[1, 1] = "------";
                            }
                            else
                            {
                                excelThongKeThangKyHieu_PhongBanDuLieu.Cells[1, 1] = sTenPhongBan;
                            }
                            Excel.Range excelThongKeThangKyHieu_MaNhanVienDuLieu;
                            excelThongKeThangKyHieu_MaNhanVienDuLieu = (ws_ThongKeThang_KyHieu).get_Range((object)("C" + iDemDongThongKeThangKyHieu), (object)("C" + iDemDongThongKeThangKyHieu));
                            excelThongKeThangKyHieu_MaNhanVienDuLieu.get_Range((object)"A1", (object)"A1").NumberFormat = "@";
                            excelThongKeThangKyHieu_MaNhanVienDuLieu.Cells[1, 1] = dtTinhCongThongKeThangKyHieu.Rows[iTinhCongThongKeThangKyHieu]["MaNhanVien"].ToString();
                            (ws_ThongKeThang_KyHieu).get_Range((object)("D" + iDemDongThongKeThangKyHieu), (object)("D" + iDemDongThongKeThangKyHieu)).Cells[1, 1] = dtTinhCongThongKeThangKyHieu.Rows[iTinhCongThongKeThangKyHieu]["TenNhanVien"].ToString();
                            for (int iThongKeThangKyHieu_NgayDuLieu = 0; iThongKeThangKyHieu_NgayDuLieu <= iTongNgayTinhCongThongKeThangKyHieu; iThongKeThangKyHieu_NgayDuLieu++)
                            {
                                string sDuLieuThongKeThangKyHieu;
                                sDuLieuThongKeThangKyHieu = "";
                                DateTime dNgayChamThongKeKyHieu;
                                dNgayChamThongKeKyHieu = Convert.ToDateTime(dNgayBatDauTinhCongThongKeThangKyHieu.AddDays(iThongKeThangKyHieu_NgayDuLieu).ToString());
                                new DataTable();
                                _tinhCongDTO.MaChamCong = iMaChamCongThongKeThangKyHieu;
                                _tinhCongDTO.Ngay = dNgayChamThongKeKyHieu;
                                DataTable dtDuLieuNgayThongKeThangKyHieu;
                                dtDuLieuNgayThongKeThangKyHieu = _tinhCongBLL.TinhCongGetMaChamCongAndNgay(_tinhCongDTO);
                                for (int iDuLieuNgayThongKeThangKyHieu = 0; iDuLieuNgayThongKeThangKyHieu < dtDuLieuNgayThongKeThangKyHieu.Rows.Count; iDuLieuNgayThongKeThangKyHieu++)
                                {
                                    string sThu;
                                    sThu = dtDuLieuNgayThongKeThangKyHieu.Rows[iDuLieuNgayThongKeThangKyHieu]["Thu"].ToString();
                                    double dCong;
                                    dCong = Convert.ToDouble(dtDuLieuNgayThongKeThangKyHieu.Rows[iDuLieuNgayThongKeThangKyHieu]["Cong"].ToString());
                                    sDuLieuThongKeThangKyHieu = ((!(sThu == "CN")) ? (sDuLieuThongKeThangKyHieu + dtDuLieuNgayThongKeThangKyHieu.Rows[iDuLieuNgayThongKeThangKyHieu]["KyHieu"].ToString()) : ((!(dCong > 0.0)) ? "" : (sDuLieuThongKeThangKyHieu + dtDuLieuNgayThongKeThangKyHieu.Rows[iDuLieuNgayThongKeThangKyHieu]["KyHieu"].ToString())));
                                }
                                (ws_ThongKeThang_KyHieu).get_Range((object)("F" + iDemDongThongKeThangKyHieu), (object)("AJ" + iDemDongThongKeThangKyHieu)).Cells[1, iDemCotThongKeThangKyHieu] = sDuLieuThongKeThangKyHieu;
                                iDemCotThongKeThangKyHieu++;
                            }
                            double dTongNgayCongThongKeThangKyHieu;
                            dTongNgayCongThongKeThangKyHieu = 0.0;
                            double dTongGioTC1ThongKeThangKyHieu;
                            dTongGioTC1ThongKeThangKyHieu = 0.0;
                            double dTongGioTC2ThongKeThangKyHieu;
                            dTongGioTC2ThongKeThangKyHieu = 0.0;
                            double dTongGioTC3ThongKeThangKyHieu;
                            dTongGioTC3ThongKeThangKyHieu = 0.0;
                            double dTongGioTC4ThongKeThangKyHieu;
                            dTongGioTC4ThongKeThangKyHieu = 0.0;
                            double dTongTreThongKeThangKyHieu;
                            dTongTreThongKeThangKyHieu = 0.0;
                            double dTongVeSomThongKeThangKyHieu;
                            dTongVeSomThongKeThangKyHieu = 0.0;
                            int iDemPhepNamThongKeThangKyHieu;
                            iDemPhepNamThongKeThangKyHieu = 0;
                            int iDemVangThongKeThangKyHieu;
                            iDemVangThongKeThangKyHieu = 0;
                            new DataTable();
                            _tinhCongDTO.MaChamCong = iMaChamCongThongKeThangKyHieu;
                            DataTable dtDuLieuTongThongKeThangKyHieu;
                            dtDuLieuTongThongKeThangKyHieu = _tinhCongBLL.TinhCongGetByMaChamCong(_tinhCongDTO);
                            for (int iDuLieuTongThongKeThangKyHieu = 0; iDuLieuTongThongKeThangKyHieu < dtDuLieuTongThongKeThangKyHieu.Rows.Count; iDuLieuTongThongKeThangKyHieu++)
                            {
                                dTongNgayCongThongKeThangKyHieu += Convert.ToDouble(dtDuLieuTongThongKeThangKyHieu.Rows[iDuLieuTongThongKeThangKyHieu]["Cong"].ToString());
                                dTongGioTC1ThongKeThangKyHieu += Convert.ToDouble(dtDuLieuTongThongKeThangKyHieu.Rows[iDuLieuTongThongKeThangKyHieu]["TC1"].ToString());
                                dTongGioTC2ThongKeThangKyHieu += Convert.ToDouble(dtDuLieuTongThongKeThangKyHieu.Rows[iDuLieuTongThongKeThangKyHieu]["TC2"].ToString());
                                dTongGioTC3ThongKeThangKyHieu += Convert.ToDouble(dtDuLieuTongThongKeThangKyHieu.Rows[iDuLieuTongThongKeThangKyHieu]["TC3"].ToString());
                                dTongGioTC4ThongKeThangKyHieu += Convert.ToDouble(dtDuLieuTongThongKeThangKyHieu.Rows[iDuLieuTongThongKeThangKyHieu]["TC4"].ToString());
                                dTongTreThongKeThangKyHieu += Convert.ToDouble(dtDuLieuTongThongKeThangKyHieu.Rows[iDuLieuTongThongKeThangKyHieu]["Tre"].ToString());
                                dTongVeSomThongKeThangKyHieu += Convert.ToDouble(dtDuLieuTongThongKeThangKyHieu.Rows[iDuLieuTongThongKeThangKyHieu]["VeSom"].ToString());
                                string sKyHieuDuLieuThongKeThang;
                                sKyHieuDuLieuThongKeThang = dtDuLieuTongThongKeThangKyHieu.Rows[iDuLieuTongThongKeThangKyHieu]["KyHieu"].ToString();
                                string sThuTotal;
                                sThuTotal = dtDuLieuTongThongKeThangKyHieu.Rows[iDuLieuTongThongKeThangKyHieu]["Thu"].ToString();
                                if (sKyHieuDuLieuThongKeThang == sKHPhepNam)
                                {
                                    iDemPhepNamThongKeThangKyHieu++;
                                }
                                if (sKyHieuDuLieuThongKeThang == sKHVang && sThuTotal != "CN")
                                {
                                    iDemVangThongKeThangKyHieu++;
                                }
                            }
                            (ws_ThongKeThang_KyHieu).get_Range((object)("AK" + iDemDongThongKeThangKyHieu), (object)("AK" + iDemDongThongKeThangKyHieu)).Cells[1, 1] = dTongNgayCongThongKeThangKyHieu.ToString();
                            (ws_ThongKeThang_KyHieu).get_Range((object)("AL" + iDemDongThongKeThangKyHieu), (object)("AL" + iDemDongThongKeThangKyHieu)).Cells[1, 1] = dTongGioTC1ThongKeThangKyHieu.ToString();
                            (ws_ThongKeThang_KyHieu).get_Range((object)("AM" + iDemDongThongKeThangKyHieu), (object)("AM" + iDemDongThongKeThangKyHieu)).Cells[1, 1] = dTongGioTC2ThongKeThangKyHieu.ToString();
                            (ws_ThongKeThang_KyHieu).get_Range((object)("AN" + iDemDongThongKeThangKyHieu), (object)("AN" + iDemDongThongKeThangKyHieu)).Cells[1, 1] = dTongGioTC3ThongKeThangKyHieu.ToString();
                            (ws_ThongKeThang_KyHieu).get_Range((object)("AO" + iDemDongThongKeThangKyHieu), (object)("AO" + iDemDongThongKeThangKyHieu)).Cells[1, 1] = dTongGioTC4ThongKeThangKyHieu.ToString();
                            (ws_ThongKeThang_KyHieu).get_Range((object)("AP" + iDemDongThongKeThangKyHieu), (object)("AP" + iDemDongThongKeThangKyHieu)).Cells[1, 1] = iDemVangThongKeThangKyHieu.ToString();
                            (ws_ThongKeThang_KyHieu).get_Range((object)("AQ" + iDemDongThongKeThangKyHieu), (object)("AQ" + iDemDongThongKeThangKyHieu)).Cells[1, 1] = iDemPhepNamThongKeThangKyHieu.ToString();
                            (ws_ThongKeThang_KyHieu).get_Range((object)("AS" + iDemDongThongKeThangKyHieu), (object)("AS" + iDemDongThongKeThangKyHieu)).Cells[1, 1] = dTongTreThongKeThangKyHieu.ToString();
                            (ws_ThongKeThang_KyHieu).get_Range((object)("AT" + iDemDongThongKeThangKyHieu), (object)("AT" + iDemDongThongKeThangKyHieu)).Cells[1, 1] = dTongVeSomThongKeThangKyHieu.ToString();
                            iDemDongThongKeThangKyHieu++;
                            iSTTThongKeThangKyHieu++;
                        }
                    }
                    Excel.Range excelThongKeThangKyHieu_DinhDangDuLieu;
                    excelThongKeThangKyHieu_DinhDangDuLieu = (ws_ThongKeThang_KyHieu).get_Range((object)"A7", (object)("AT" + (iDemDongThongKeThangKyHieu - 1)));
                    excelThongKeThangKyHieu_DinhDangDuLieu.Font.Name = "Times New Roman";
                    excelThongKeThangKyHieu_DinhDangDuLieu.Font.Size = "8";
                    excelThongKeThangKyHieu_DinhDangDuLieu.HorizontalAlignment = Excel.Constants.xlCenter;
                    (ws_ThongKeThang_KyHieu).get_Range((object)"A4", (object)("AT" + (iDemDongThongKeThangKyHieu - 1))).Borders.LineStyle = Excel.Constants.xlBoth;
                    failed = false;
                }
                catch (COMException)
                {
                    failed = true;
                }
                Thread.Sleep(10);
            }
            while (failed);
        }

        private void ExportExcelChiTietTungNguoiTungNgay()
        {
            DateTime dNgayTinh;
            dNgayTinh = Convert.ToDateTime(dateTimeTuNgay.Text);
            DateTime dNgayBatDauTinhCong;
            dNgayBatDauTinhCong = new DateTime(dNgayTinh.Year, dNgayTinh.Month, dNgayTinh.Day, 0, 0, 0);
            _ = Thread.CurrentThread.CurrentCulture;
            Thread.CurrentThread.CurrentCulture = new CultureInfo("en-US");
            int iTongNgayChamChiTietTungNguoiTungNgay;
            iTongNgayChamChiTietTungNguoiTungNgay = Convert.ToInt32(Convert.ToInt32((dateTimeDenNgay.Value - dateTimeTuNgay.Value).TotalDays).ToString()) + 1;
            int iTongDong;
            iTongDong = iTongNgayChamChiTietTungNguoiTungNgay + 9;
            Excel.Application xla_ChiTietTungNguoiTungNgay;
            xla_ChiTietTungNguoiTungNgay = new Excel.Application();
            xla_ChiTietTungNguoiTungNgay.Workbooks.Add(Excel.XlSheetType.xlWorksheet);
            _ = xla_ChiTietTungNguoiTungNgay.ActiveSheet;
            Excel.Worksheet ws_ChiTietTungNguoiTungNgay;
            ws_ChiTietTungNguoiTungNgay = xla_ChiTietTungNguoiTungNgay.Worksheets.get_Item((object)1);
            xla_ChiTietTungNguoiTungNgay.Visible = true;
            int demNhanVien;
            demNhanVien = 0;
            new DataTable();
            DataTable dtNgayTinhCongChiTietTungNguoiTungNgay;
            dtNgayTinhCongChiTietTungNguoiTungNgay = _ngayTinhCongBLL.showThongTinNgayTinhCong();
            for (int iNgayTinhCongChiTietTungNguoiTungNgay = 0; iNgayTinhCongChiTietTungNguoiTungNgay < dtNgayTinhCongChiTietTungNguoiTungNgay.Rows.Count; iNgayTinhCongChiTietTungNguoiTungNgay++)
            {
                Convert.ToDateTime(dtNgayTinhCongChiTietTungNguoiTungNgay.Rows[iNgayTinhCongChiTietTungNguoiTungNgay]["NgayBatDau"].ToString());
                new DataTable();
                _tinhCongDTO.Ngay = dNgayBatDauTinhCong;
                DataTable dtNhanVienChiTietTungNguoiTung;
                dtNhanVienChiTietTungNguoiTung = _tinhCongBLL.TinhCongGetNgay(_tinhCongDTO);
                int iMaChamCongChiTietTungNguoiTungNgay;
                iMaChamCongChiTietTungNguoiTungNgay = 0;
                for (int iNhanVienChiTietTungNguoiTungNgay = 0; iNhanVienChiTietTungNguoiTungNgay < dtNhanVienChiTietTungNguoiTung.Rows.Count; iNhanVienChiTietTungNguoiTungNgay++)
                {
                    string sTenPhongBanChiTietTungNguoiTungNgay;
                    sTenPhongBanChiTietTungNguoiTungNgay = "--------";
                    if (Convert.ToInt32(dtNhanVienChiTietTungNguoiTung.Rows[iNhanVienChiTietTungNguoiTungNgay]["MaChamCong"].ToString()) == iMaChamCongChiTietTungNguoiTungNgay)
                    {
                        continue;
                    }
                    iMaChamCongChiTietTungNguoiTungNgay = Convert.ToInt32(dtNhanVienChiTietTungNguoiTung.Rows[iNhanVienChiTietTungNguoiTungNgay]["MaChamCong"].ToString());
                    string sMaPhongBanChiTietTungNguoiTungNgay;
                    sMaPhongBanChiTietTungNguoiTungNgay = dtNhanVienChiTietTungNguoiTung.Rows[iNhanVienChiTietTungNguoiTungNgay]["PhongBan"].ToString();
                    new DataTable();
                    _phongBanDTO.MaPhongBan = sMaPhongBanChiTietTungNguoiTungNgay;
                    DataTable dtPhongBanChiTietTungNguoiTungNgay;
                    dtPhongBanChiTietTungNguoiTungNgay = _phongBanBLL.getTenPhongBanByMaPhongBan(_phongBanDTO);
                    for (int iPhongBanChiTietTungNguoiTungNgay = 0; iPhongBanChiTietTungNguoiTungNgay < dtPhongBanChiTietTungNguoiTungNgay.Rows.Count; iPhongBanChiTietTungNguoiTungNgay++)
                    {
                        sTenPhongBanChiTietTungNguoiTungNgay = dtPhongBanChiTietTungNguoiTungNgay.Rows[iPhongBanChiTietTungNguoiTungNgay]["TenPhongBan"].ToString();
                    }
                    Excel.Range excelChiTietTungNguoiTungNgay_TieuDe;
                    excelChiTietTungNguoiTungNgay_TieuDe = (ws_ChiTietTungNguoiTungNgay).get_Range((object)("A" + (iTongDong * demNhanVien + 1)), (object)("P" + (iTongDong * demNhanVien + 1)));
                    excelChiTietTungNguoiTungNgay_TieuDe.Select();
                    excelChiTietTungNguoiTungNgay_TieuDe.Cells[1, 1] = "BẢNG CHI TIẾT CHẤM CÔNG";
                    excelChiTietTungNguoiTungNgay_TieuDe.get_Range((object)"A1", (object)"P1").Merge(true);
                    excelChiTietTungNguoiTungNgay_TieuDe.Font.Name = "Times New Roman";
                    excelChiTietTungNguoiTungNgay_TieuDe.Font.Size = "18";
                    excelChiTietTungNguoiTungNgay_TieuDe.Font.Bold = true;
                    excelChiTietTungNguoiTungNgay_TieuDe.RowHeight = "23";
                    excelChiTietTungNguoiTungNgay_TieuDe.HorizontalAlignment = Excel.Constants.xlCenter;
                    Excel.Range excelChiTietTungNguoiTungNgay_Header;
                    excelChiTietTungNguoiTungNgay_Header = (ws_ChiTietTungNguoiTungNgay).get_Range((object)("A" + (iTongDong * demNhanVien + 2)), (object)("P" + (iTongDong * demNhanVien + 2)));
                    excelChiTietTungNguoiTungNgay_Header.Select();
                    excelChiTietTungNguoiTungNgay_Header.Cells[1, 1] = string.Concat("Mã nhân viên: ", dtNhanVienChiTietTungNguoiTung.Rows[iNhanVienChiTietTungNguoiTungNgay]["MaNhanVien"].ToString(), "         Tên nhân viên: ", dtNhanVienChiTietTungNguoiTung.Rows[iNhanVienChiTietTungNguoiTungNgay]["TenNhanVien"], "         Phòng ban: ", sTenPhongBanChiTietTungNguoiTungNgay);
                    excelChiTietTungNguoiTungNgay_Header.Font.Size = "14";
                    excelChiTietTungNguoiTungNgay_Header.Font.Bold = true;
                    excelChiTietTungNguoiTungNgay_Header.RowHeight = "18";
                    excelChiTietTungNguoiTungNgay_Header.Font.Name = "Times New Roman";
                    excelChiTietTungNguoiTungNgay_Header.Interior.ColorIndex = 6;
                    excelChiTietTungNguoiTungNgay_Header.get_Range((object)"A1", (object)"P1").Merge(true);
                    Excel.Range excelChiTietTungNguoiTungNgay_TongGioHeader;
                    excelChiTietTungNguoiTungNgay_TongGioHeader = (ws_ChiTietTungNguoiTungNgay).get_Range((object)("A" + (iTongDong * demNhanVien + 3)), (object)("B" + (iTongDong * demNhanVien + 3)));
                    excelChiTietTungNguoiTungNgay_TongGioHeader.Cells[1, 1] = "Tổng giờ";
                    excelChiTietTungNguoiTungNgay_TongGioHeader.get_Range((object)"A1", (object)"B1").Merge(true);
                    Excel.Range excelChiTietTungNguoiTungNgay_SoLanTreHeader;
                    excelChiTietTungNguoiTungNgay_SoLanTreHeader = (ws_ChiTietTungNguoiTungNgay).get_Range((object)("F" + (iTongDong * demNhanVien + 3)), (object)("G" + (iTongDong * demNhanVien + 3)));
                    excelChiTietTungNguoiTungNgay_SoLanTreHeader.Cells[1, 1] = "Số lần trễ";
                    excelChiTietTungNguoiTungNgay_SoLanTreHeader.get_Range((object)"A1", (object)"B1").Merge(true);
                    Excel.Range excelChiTietTungNguoiTungNgay_SoPhutTreHeader;
                    excelChiTietTungNguoiTungNgay_SoPhutTreHeader = (ws_ChiTietTungNguoiTungNgay).get_Range((object)("J" + (iTongDong * demNhanVien + 3)), (object)("K" + (iTongDong * demNhanVien + 3)));
                    excelChiTietTungNguoiTungNgay_SoPhutTreHeader.Cells[1, 1] = "Số phút trễ";
                    excelChiTietTungNguoiTungNgay_SoPhutTreHeader.get_Range((object)"A1", (object)"B1").Merge(true);
                    Excel.Range excelChiTietTungNguoiTungNgay_TangCaNgayLeHeader;
                    excelChiTietTungNguoiTungNgay_TangCaNgayLeHeader = (ws_ChiTietTungNguoiTungNgay).get_Range((object)("N" + (iTongDong * demNhanVien + 3)), (object)("O" + (iTongDong * demNhanVien + 3)));
                    excelChiTietTungNguoiTungNgay_TangCaNgayLeHeader.Cells[1, 1] = "Tăng ca ngày lễ";
                    excelChiTietTungNguoiTungNgay_TangCaNgayLeHeader.get_Range((object)"A1", (object)"B1").Merge(true);
                    Excel.Range excelChiTietTungNguoiTungNgay_TongCongHeader;
                    excelChiTietTungNguoiTungNgay_TongCongHeader = (ws_ChiTietTungNguoiTungNgay).get_Range((object)("A" + (iTongDong * demNhanVien + 4)), (object)("B" + (iTongDong * demNhanVien + 4)));
                    excelChiTietTungNguoiTungNgay_TongCongHeader.Cells[1, 1] = "Tổng công";
                    excelChiTietTungNguoiTungNgay_TongCongHeader.get_Range((object)"A1", (object)"B1").Merge(true);
                    Excel.Range excelChiTietTungNguoiTungNgay_SoLanSomHeader;
                    excelChiTietTungNguoiTungNgay_SoLanSomHeader = (ws_ChiTietTungNguoiTungNgay).get_Range((object)("F" + (iTongDong * demNhanVien + 4)), (object)("G" + (iTongDong * demNhanVien + 4)));
                    excelChiTietTungNguoiTungNgay_SoLanSomHeader.Cells[1, 1] = "Số lần sớm";
                    excelChiTietTungNguoiTungNgay_SoLanSomHeader.get_Range((object)"A1", (object)"B1").Merge(true);
                    Excel.Range excelChiTietTungNguoiTungNgay_SoPhutSomHeader;
                    excelChiTietTungNguoiTungNgay_SoPhutSomHeader = (ws_ChiTietTungNguoiTungNgay).get_Range((object)("J" + (iTongDong * demNhanVien + 4)), (object)("K" + (iTongDong * demNhanVien + 4)));
                    excelChiTietTungNguoiTungNgay_SoPhutSomHeader.Cells[1, 1] = "Số phút sớm";
                    excelChiTietTungNguoiTungNgay_SoPhutSomHeader.get_Range((object)"A1", (object)"B1").Merge(true);
                    Excel.Range excelChiTietTungNguoiTungNgay_TangCaHeader;
                    excelChiTietTungNguoiTungNgay_TangCaHeader = (ws_ChiTietTungNguoiTungNgay).get_Range((object)("A" + (iTongDong * demNhanVien + 5)), (object)("B" + (iTongDong * demNhanVien + 5)));
                    excelChiTietTungNguoiTungNgay_TangCaHeader.Cells[1, 1] = "Tăng ca";
                    excelChiTietTungNguoiTungNgay_TangCaHeader.get_Range((object)"A1", (object)"B1").Merge(true);
                    Excel.Range excelChiTietTungNguoiTungNgay_VangKhongPhepHeader;
                    excelChiTietTungNguoiTungNgay_VangKhongPhepHeader = (ws_ChiTietTungNguoiTungNgay).get_Range((object)("F" + (iTongDong * demNhanVien + 5)), (object)("G" + (iTongDong * demNhanVien + 5)));
                    excelChiTietTungNguoiTungNgay_VangKhongPhepHeader.Cells[1, 1] = "Vắng KP";
                    excelChiTietTungNguoiTungNgay_VangKhongPhepHeader.get_Range((object)"A1", (object)"B1").Merge(true);
                    Excel.Range excelChiTietTungNguoiTungNgay_VangCoPhepHeader;
                    excelChiTietTungNguoiTungNgay_VangCoPhepHeader = (ws_ChiTietTungNguoiTungNgay).get_Range((object)("J" + (iTongDong * demNhanVien + 5)), (object)("K" + (iTongDong * demNhanVien + 5)));
                    excelChiTietTungNguoiTungNgay_VangCoPhepHeader.Cells[1, 1] = "Vắng CP";
                    excelChiTietTungNguoiTungNgay_VangCoPhepHeader.get_Range((object)"A1", (object)"B1").Merge(true);
                    (ws_ChiTietTungNguoiTungNgay).get_Range((object)("E" + (iTongDong * demNhanVien + 3)), (object)("E" + (iTongDong * demNhanVien + 5))).get_Range((object)"A1", (object)"A3").MergeCells = true;
                    (ws_ChiTietTungNguoiTungNgay).get_Range((object)("I" + (iTongDong * demNhanVien + 3)), (object)("I" + (iTongDong * demNhanVien + 5))).get_Range((object)"A1", (object)"A3").MergeCells = true;
                    (ws_ChiTietTungNguoiTungNgay).get_Range((object)("M" + (iTongDong * demNhanVien + 3)), (object)("M" + (iTongDong * demNhanVien + 5))).get_Range((object)"A1", (object)"A3").MergeCells = true;
                    double dTongGioChiTietTungNguoiTungNgay;
                    dTongGioChiTietTungNguoiTungNgay = 0.0;
                    double dTongCongChiTietTungNguoiTungNgay;
                    dTongCongChiTietTungNguoiTungNgay = 0.0;
                    int iSoLanTreChiTietTungNguoiTungNgay;
                    iSoLanTreChiTietTungNguoiTungNgay = 0;
                    int iSoLanVeSomChiTietTungNguoiTungNgay;
                    iSoLanVeSomChiTietTungNguoiTungNgay = 0;
                    int iSoPhutTreChiTietTungNguoiTungNgay;
                    iSoPhutTreChiTietTungNguoiTungNgay = 0;
                    int iSoPhutVeSomChiTietTungNguoiTungNgay;
                    iSoPhutVeSomChiTietTungNguoiTungNgay = 0;
                    double dTongTangCaNgayThuong;
                    dTongTangCaNgayThuong = 0.0;
                    double dTongTangCaNgayChuNhat;
                    dTongTangCaNgayChuNhat = 0.0;
                    int iDemNVProCess;
                    iDemNVProCess = 0;
                    new DataTable();
                    _tinhCongDTO.MaChamCong = iMaChamCongChiTietTungNguoiTungNgay;
                    DataTable dtDuLieuHeader;
                    dtDuLieuHeader = _tinhCongBLL.TinhCongGetByMaChamCong(_tinhCongDTO);
                    for (int iDuLieuHeader = 0; iDuLieuHeader < dtDuLieuHeader.Rows.Count; iDuLieuHeader++)
                    {
                        dTongGioChiTietTungNguoiTungNgay += Convert.ToDouble(dtDuLieuHeader.Rows[iDuLieuHeader]["Gio"].ToString());
                        dTongCongChiTietTungNguoiTungNgay += Convert.ToDouble(dtDuLieuHeader.Rows[iDuLieuHeader]["Cong"].ToString());
                        iSoPhutTreChiTietTungNguoiTungNgay += Convert.ToInt32(dtDuLieuHeader.Rows[iDuLieuHeader]["Tre"].ToString());
                        iSoPhutVeSomChiTietTungNguoiTungNgay += Convert.ToInt32(dtDuLieuHeader.Rows[iDuLieuHeader]["VeSom"].ToString());
                        if (Convert.ToInt32(dtDuLieuHeader.Rows[iDuLieuHeader]["Tre"].ToString()) != 0)
                        {
                            iSoLanTreChiTietTungNguoiTungNgay++;
                        }
                        if (Convert.ToInt32(dtDuLieuHeader.Rows[iDuLieuHeader]["VeSom"].ToString()) != 0)
                        {
                            iSoLanVeSomChiTietTungNguoiTungNgay++;
                        }
                    }
                    Excel.Range excelChiTietTungNguoiTungNgay_TongGioDuLieuHeader;
                    excelChiTietTungNguoiTungNgay_TongGioDuLieuHeader = (ws_ChiTietTungNguoiTungNgay).get_Range((object)("C" + (iTongDong * demNhanVien + 3)), (object)("D" + (iTongDong * demNhanVien + 3)));
                    excelChiTietTungNguoiTungNgay_TongGioDuLieuHeader.Cells[1, 1] = dTongGioChiTietTungNguoiTungNgay;
                    excelChiTietTungNguoiTungNgay_TongGioDuLieuHeader.get_Range((object)"A1", (object)"B1").Merge(true);
                    Excel.Range excelChiTietTungNguoiTungNgay_TongCongDuLieuHeader;
                    excelChiTietTungNguoiTungNgay_TongCongDuLieuHeader = (ws_ChiTietTungNguoiTungNgay).get_Range((object)("C" + (iTongDong * demNhanVien + 4)), (object)("D" + (iTongDong * demNhanVien + 4)));
                    excelChiTietTungNguoiTungNgay_TongCongDuLieuHeader.Cells[1, 1] = dTongCongChiTietTungNguoiTungNgay;
                    excelChiTietTungNguoiTungNgay_TongCongDuLieuHeader.get_Range((object)"A1", (object)"B1").Merge(true);
                    new DataTable();
                    _tinhCongDTO.MaChamCong = iMaChamCongChiTietTungNguoiTungNgay;
                    _tinhCongDTO.KyHieuPhu = "NT";
                    DataTable dtGioCongNgayThuong;
                    dtGioCongNgayThuong = _tinhCongBLL.TinhCongGetByMaChamCongAndKyHieuPhu(_tinhCongDTO);
                    for (int iGioCongNgayThuong = 0; iGioCongNgayThuong < dtGioCongNgayThuong.Rows.Count; iGioCongNgayThuong++)
                    {
                        dTongTangCaNgayThuong += Convert.ToDouble(dtGioCongNgayThuong.Rows[iGioCongNgayThuong]["TC1"].ToString()) + Convert.ToDouble(dtGioCongNgayThuong.Rows[iGioCongNgayThuong]["TC2"].ToString()) + Convert.ToDouble(dtGioCongNgayThuong.Rows[iGioCongNgayThuong]["TC3"].ToString()) + Convert.ToDouble(dtGioCongNgayThuong.Rows[iGioCongNgayThuong]["TC4"].ToString());
                    }
                    (ws_ChiTietTungNguoiTungNgay).get_Range((object)("C" + (iTongDong * demNhanVien + 5)), (object)("C" + (iTongDong * demNhanVien + 5))).Cells[1, 1] = dTongTangCaNgayThuong;
                    new DataTable();
                    _tinhCongDTO.MaChamCong = iMaChamCongChiTietTungNguoiTungNgay;
                    _tinhCongDTO.KyHieuPhu = "CN";
                    DataTable dtGioCongNgayChuNhat;
                    dtGioCongNgayChuNhat = _tinhCongBLL.TinhCongGetByMaChamCongAndKyHieuPhu(_tinhCongDTO);
                    for (int iGioCongNgayChuNhat = 0; iGioCongNgayChuNhat < dtGioCongNgayChuNhat.Rows.Count; iGioCongNgayChuNhat++)
                    {
                        dTongTangCaNgayChuNhat += Convert.ToDouble(dtGioCongNgayChuNhat.Rows[iGioCongNgayChuNhat]["TC1"].ToString()) + Convert.ToDouble(dtGioCongNgayChuNhat.Rows[iGioCongNgayChuNhat]["TC2"].ToString()) + Convert.ToDouble(dtGioCongNgayChuNhat.Rows[iGioCongNgayChuNhat]["TC3"].ToString()) + Convert.ToDouble(dtGioCongNgayChuNhat.Rows[iGioCongNgayChuNhat]["TC4"].ToString());
                    }
                    (ws_ChiTietTungNguoiTungNgay).get_Range((object)("D" + (iTongDong * demNhanVien + 5)), (object)("D" + (iTongDong * demNhanVien + 5))).Cells[1, 1] = dTongTangCaNgayChuNhat;
                    int iDemVangKhongPhepChiTietTungNguoiTungNgay;
                    iDemVangKhongPhepChiTietTungNguoiTungNgay = 0;
                    double iDemVangCoPhepChiTietTungNguoiTungNgay;
                    iDemVangCoPhepChiTietTungNguoiTungNgay = 0.0;
                    new DataTable();
                    _tinhCongDTO.MaChamCong = iMaChamCongChiTietTungNguoiTungNgay;
                    DataTable dtVangChiTietTungNguoiTungNgay;
                    dtVangChiTietTungNguoiTungNgay = _tinhCongBLL.TinhCongGetByMaChamCong(_tinhCongDTO);
                    for (int iVangChiTietTungNguoiTungNgay = 0; iVangChiTietTungNguoiTungNgay < dtVangChiTietTungNguoiTungNgay.Rows.Count; iVangChiTietTungNguoiTungNgay++)
                    {
                        string sThu2;
                        sThu2 = dtVangChiTietTungNguoiTungNgay.Rows[iVangChiTietTungNguoiTungNgay]["Thu"].ToString();
                        if (dtVangChiTietTungNguoiTungNgay.Rows[iVangChiTietTungNguoiTungNgay]["KyHieu"].ToString() == sKHVang && sThu2 != "CN")
                        {
                            iDemVangKhongPhepChiTietTungNguoiTungNgay++;
                        }
                        if (dtVangChiTietTungNguoiTungNgay.Rows[iVangChiTietTungNguoiTungNgay]["KyHieu"].ToString() == "CP")
                        {
                            iDemVangCoPhepChiTietTungNguoiTungNgay += Convert.ToDouble(dtVangChiTietTungNguoiTungNgay.Rows[iVangChiTietTungNguoiTungNgay]["Cong"].ToString());
                        }
                    }
                    (ws_ChiTietTungNguoiTungNgay).get_Range((object)("H" + (iTongDong * demNhanVien + 5)), (object)("H" + (iTongDong * demNhanVien + 5))).Cells[1, 1] = iDemVangKhongPhepChiTietTungNguoiTungNgay;
                    (ws_ChiTietTungNguoiTungNgay).get_Range((object)("L" + (iTongDong * demNhanVien + 5)), (object)("L" + (iTongDong * demNhanVien + 5))).Cells[1, 1] = iDemVangCoPhepChiTietTungNguoiTungNgay;
                    (ws_ChiTietTungNguoiTungNgay).get_Range((object)("H" + (iTongDong * demNhanVien + 3)), (object)("H" + (iTongDong * demNhanVien + 3))).Cells[1, 1] = iSoLanTreChiTietTungNguoiTungNgay;
                    (ws_ChiTietTungNguoiTungNgay).get_Range((object)("H" + (iTongDong * demNhanVien + 4)), (object)("H" + (iTongDong * demNhanVien + 4))).Cells[1, 1] = iSoLanVeSomChiTietTungNguoiTungNgay;
                    (ws_ChiTietTungNguoiTungNgay).get_Range((object)("L" + (iTongDong * demNhanVien + 3)), (object)("L" + (iTongDong * demNhanVien + 3))).Cells[1, 1] = iSoPhutTreChiTietTungNguoiTungNgay;
                    (ws_ChiTietTungNguoiTungNgay).get_Range((object)("L" + (iTongDong * demNhanVien + 4)), (object)("L" + (iTongDong * demNhanVien + 4))).Cells[1, 1] = iSoPhutVeSomChiTietTungNguoiTungNgay;
                    Excel.Range excelChiTietTungNguoiTungNgay_ChiTietHeader;
                    excelChiTietTungNguoiTungNgay_ChiTietHeader = (ws_ChiTietTungNguoiTungNgay).get_Range((object)("A" + (iTongDong * demNhanVien + 6)), (object)("P" + (iTongDong * demNhanVien + 6)));
                    excelChiTietTungNguoiTungNgay_ChiTietHeader.Cells[1, 1] = "Chi tiết";
                    excelChiTietTungNguoiTungNgay_ChiTietHeader.get_Range((object)"A1", (object)"P1").Merge(true);
                    Excel.Range excelChiTietTungNguoiTungNgay_NgayHeader;
                    excelChiTietTungNguoiTungNgay_NgayHeader = (ws_ChiTietTungNguoiTungNgay).get_Range((object)("A" + (iTongDong * demNhanVien + 7)), (object)("A" + (iTongDong * demNhanVien + 8)));
                    excelChiTietTungNguoiTungNgay_NgayHeader.Cells[1, 1] = "Ngày";
                    excelChiTietTungNguoiTungNgay_NgayHeader.get_Range((object)"A1", (object)"A2").MergeCells = true;
                    excelChiTietTungNguoiTungNgay_NgayHeader.ColumnWidth = 10;
                    Excel.Range excelChiTietTungNguoiTungNgay_ThuHeader;
                    excelChiTietTungNguoiTungNgay_ThuHeader = (ws_ChiTietTungNguoiTungNgay).get_Range((object)("B" + (iTongDong * demNhanVien + 7)), (object)("B" + (iTongDong * demNhanVien + 8)));
                    excelChiTietTungNguoiTungNgay_ThuHeader.Cells[1, 1] = "Thứ";
                    excelChiTietTungNguoiTungNgay_ThuHeader.get_Range((object)"A1", (object)"A2").MergeCells = true;
                    Excel.Range excelChiTietTungNguoiTungNgay_TreHeader;
                    excelChiTietTungNguoiTungNgay_TreHeader = (ws_ChiTietTungNguoiTungNgay).get_Range((object)("I" + (iTongDong * demNhanVien + 7)), (object)("I" + (iTongDong * demNhanVien + 8)));
                    excelChiTietTungNguoiTungNgay_TreHeader.Cells[1, 1] = "Trễ";
                    excelChiTietTungNguoiTungNgay_TreHeader.get_Range((object)"A1", (object)"A2").MergeCells = true;
                    Excel.Range excelChiTietTungNguoiTungNgay_SomHeader;
                    excelChiTietTungNguoiTungNgay_SomHeader = (ws_ChiTietTungNguoiTungNgay).get_Range((object)("J" + (iTongDong * demNhanVien + 7)), (object)("J" + (iTongDong * demNhanVien + 8)));
                    excelChiTietTungNguoiTungNgay_SomHeader.Cells[1, 1] = "Sớm";
                    excelChiTietTungNguoiTungNgay_SomHeader.get_Range((object)"A1", (object)"A2").MergeCells = true;
                    Excel.Range excelChiTietTungNguoiTungNgay_VeTreHeader;
                    excelChiTietTungNguoiTungNgay_VeTreHeader = (ws_ChiTietTungNguoiTungNgay).get_Range((object)("K" + (iTongDong * demNhanVien + 7)), (object)("K" + (iTongDong * demNhanVien + 8)));
                    excelChiTietTungNguoiTungNgay_VeTreHeader.Cells[1, 1] = "Về trễ";
                    excelChiTietTungNguoiTungNgay_VeTreHeader.get_Range((object)"A1", (object)"A2").MergeCells = true;
                    Excel.Range excelChiTietTungNguoiTungNgay_GioHeader;
                    excelChiTietTungNguoiTungNgay_GioHeader = (ws_ChiTietTungNguoiTungNgay).get_Range((object)("L" + (iTongDong * demNhanVien + 7)), (object)("L" + (iTongDong * demNhanVien + 8)));
                    excelChiTietTungNguoiTungNgay_GioHeader.Cells[1, 1] = "Giờ";
                    excelChiTietTungNguoiTungNgay_GioHeader.get_Range((object)"A1", (object)"A2").MergeCells = true;
                    Excel.Range excelChiTietTungNguoiTungNgay_CongHeader;
                    excelChiTietTungNguoiTungNgay_CongHeader = (ws_ChiTietTungNguoiTungNgay).get_Range((object)("M" + (iTongDong * demNhanVien + 7)), (object)("M" + (iTongDong * demNhanVien + 8)));
                    excelChiTietTungNguoiTungNgay_CongHeader.Cells[1, 1] = "Công";
                    excelChiTietTungNguoiTungNgay_CongHeader.get_Range((object)"A1", (object)"A2").MergeCells = true;
                    Excel.Range excelChiTietTungNguoiTungNgay_TangCa1Header;
                    excelChiTietTungNguoiTungNgay_TangCa1Header = (ws_ChiTietTungNguoiTungNgay).get_Range((object)("N" + (iTongDong * demNhanVien + 7)), (object)("N" + (iTongDong * demNhanVien + 8)));
                    excelChiTietTungNguoiTungNgay_TangCa1Header.Cells[1, 1] = "T.Ca1";
                    excelChiTietTungNguoiTungNgay_TangCa1Header.get_Range((object)"A1", (object)"A2").MergeCells = true;
                    Excel.Range excelChiTietTungNguoiTungNgay_TangCa2Header;
                    excelChiTietTungNguoiTungNgay_TangCa2Header = (ws_ChiTietTungNguoiTungNgay).get_Range((object)("O" + (iTongDong * demNhanVien + 7)), (object)("O" + (iTongDong * demNhanVien + 8)));
                    excelChiTietTungNguoiTungNgay_TangCa2Header.Cells[1, 1] = "T.Ca2";
                    excelChiTietTungNguoiTungNgay_TangCa2Header.get_Range((object)"A1", (object)"A2").MergeCells = true;
                    Excel.Range excelChiTietTungNguoiTungNgay_KyHieuHeader;
                    excelChiTietTungNguoiTungNgay_KyHieuHeader = (ws_ChiTietTungNguoiTungNgay).get_Range((object)("P" + (iTongDong * demNhanVien + 7)), (object)("P" + (iTongDong * demNhanVien + 8)));
                    excelChiTietTungNguoiTungNgay_KyHieuHeader.Cells[1, 1] = "Ký hiệu";
                    excelChiTietTungNguoiTungNgay_KyHieuHeader.get_Range((object)"A1", (object)"A2").MergeCells = true;
                    Excel.Range excelChiTietTungNguoiTungNgay_1Header;
                    excelChiTietTungNguoiTungNgay_1Header = (ws_ChiTietTungNguoiTungNgay).get_Range((object)("C" + (iTongDong * demNhanVien + 7)), (object)("D" + (iTongDong * demNhanVien + 7)));
                    excelChiTietTungNguoiTungNgay_1Header.Cells[1, 1] = "1";
                    excelChiTietTungNguoiTungNgay_1Header.get_Range((object)"A1", (object)"B1").Merge(true);
                    Excel.Range excelChiTietTungNguoiTungNgay_2Header;
                    excelChiTietTungNguoiTungNgay_2Header = (ws_ChiTietTungNguoiTungNgay).get_Range((object)("E" + (iTongDong * demNhanVien + 7)), (object)("F" + (iTongDong * demNhanVien + 7)));
                    excelChiTietTungNguoiTungNgay_2Header.Cells[1, 1] = "2";
                    excelChiTietTungNguoiTungNgay_2Header.get_Range((object)"A1", (object)"B1").Merge(true);
                    Excel.Range excelChiTietTungNguoiTungNgay_3Header;
                    excelChiTietTungNguoiTungNgay_3Header = (ws_ChiTietTungNguoiTungNgay).get_Range((object)("G" + (iTongDong * demNhanVien + 7)), (object)("H" + (iTongDong * demNhanVien + 7)));
                    excelChiTietTungNguoiTungNgay_3Header.Cells[1, 1] = "3";
                    excelChiTietTungNguoiTungNgay_3Header.get_Range((object)"A1", (object)"B1").Merge(true);
                    (ws_ChiTietTungNguoiTungNgay).get_Range((object)("C" + (iTongDong * demNhanVien + 8)), (object)("C" + (iTongDong * demNhanVien + 8))).Cells[1, 1] = "Vào";
                    (ws_ChiTietTungNguoiTungNgay).get_Range((object)("D" + (iTongDong * demNhanVien + 8)), (object)("D" + (iTongDong * demNhanVien + 8))).Cells[1, 1] = "Ra";
                    (ws_ChiTietTungNguoiTungNgay).get_Range((object)("E" + (iTongDong * demNhanVien + 8)), (object)("E" + (iTongDong * demNhanVien + 8))).Cells[1, 1] = "Vào";
                    (ws_ChiTietTungNguoiTungNgay).get_Range((object)("F" + (iTongDong * demNhanVien + 8)), (object)("F" + (iTongDong * demNhanVien + 8))).Cells[1, 1] = "Ra";
                    (ws_ChiTietTungNguoiTungNgay).get_Range((object)("G" + (iTongDong * demNhanVien + 8)), (object)("G" + (iTongDong * demNhanVien + 8))).Cells[1, 1] = "Vào";
                    (ws_ChiTietTungNguoiTungNgay).get_Range((object)("H" + (iTongDong * demNhanVien + 8)), (object)("H" + (iTongDong * demNhanVien + 8))).Cells[1, 1] = "Ra";
                    Excel.Range excelChiTietTungNguoiTungNgay_DinhDangHeader;
                    excelChiTietTungNguoiTungNgay_DinhDangHeader = (ws_ChiTietTungNguoiTungNgay).get_Range((object)("A" + (iTongDong * demNhanVien + 3)), (object)("P" + (iTongDong * demNhanVien + 8)));
                    excelChiTietTungNguoiTungNgay_DinhDangHeader.Font.Name = "Times New Roman";
                    excelChiTietTungNguoiTungNgay_DinhDangHeader.Font.Size = "11";
                    excelChiTietTungNguoiTungNgay_DinhDangHeader.Font.Bold = true;
                    int demNgay;
                    demNgay = 9;
                    for (int _tongNgay = 0; _tongNgay < iTongNgayChamChiTietTungNguoiTungNgay; _tongNgay++)
                    {
                        DateTime dNgayChamChiTietTungNguoiTungNgay;
                        dNgayChamChiTietTungNguoiTungNgay = dateTimeTuNgay.Value;
                        DateTime dNgayChamDuLieu;
                        dNgayChamDuLieu = Convert.ToDateTime(dNgayBatDauTinhCong.AddDays(_tongNgay).ToString());
                        Excel.Range excelChiTietTungNguoiTungNgay_NgayDuLieu;
                        excelChiTietTungNguoiTungNgay_NgayDuLieu = (ws_ChiTietTungNguoiTungNgay).get_Range((object)("A" + (iTongDong * demNhanVien + demNgay)), (object)("A" + (iTongDong * demNhanVien + demNgay)));
                        excelChiTietTungNguoiTungNgay_NgayDuLieu.Cells[1, 1] = dNgayChamDuLieu;
                        excelChiTietTungNguoiTungNgay_NgayDuLieu.get_Range((object)"A1", (object)"A1").Merge(true);
                        (ws_ChiTietTungNguoiTungNgay).get_Range((object)("B" + (iTongDong * demNhanVien + demNgay)), (object)("B" + (iTongDong * demNhanVien + demNgay))).Cells[1, 1] = DateTimeProgress.XuatThuTinhCong((int)dNgayChamChiTietTungNguoiTungNgay.AddDays(_tongNgay).DayOfWeek);
                        string sThu;
                        sThu = "";
                        int iDemSoLanChamChiTietTungNguoiTungNgay;
                        iDemSoLanChamChiTietTungNguoiTungNgay = 0;
                        int iTreChiTietTungNguoiTungNgay;
                        iTreChiTietTungNguoiTungNgay = 0;
                        int iVeSomChiTietTungNguoiTungNgay;
                        iVeSomChiTietTungNguoiTungNgay = 0;
                        int iVeTreChiTietTungNguoiTungNgay;
                        iVeTreChiTietTungNguoiTungNgay = 0;
                        double dGioChiTietTungNguoiTungNgay;
                        dGioChiTietTungNguoiTungNgay = 0.0;
                        double dCongChiTietTungNguoiTungNgay;
                        dCongChiTietTungNguoiTungNgay = 0.0;
                        double dTC1ChiTietTungNguoiTungNgay;
                        dTC1ChiTietTungNguoiTungNgay = 0.0;
                        double dTC2ChiTietTungNguoiTungNgay;
                        dTC2ChiTietTungNguoiTungNgay = 0.0;
                        string sGioVao;
                        sGioVao = "";
                        string sGioRa;
                        sGioRa = "";
                        new DataTable();
                        _tinhCongDTO.MaChamCong = iMaChamCongChiTietTungNguoiTungNgay;
                        _tinhCongDTO.Ngay = dNgayChamDuLieu;
                        DataTable dtLoadGioChamCongChiTietTungNguoiTungNgay;
                        dtLoadGioChamCongChiTietTungNguoiTungNgay = _tinhCongBLL.TinhCongGetMaChamCongAndNgayChiTietTungNguoiTungNgay(_tinhCongDTO);
                        for (int iLoadGioChamCongChiTietTungNguoiTungNgay = 0; iLoadGioChamCongChiTietTungNguoiTungNgay < dtLoadGioChamCongChiTietTungNguoiTungNgay.Rows.Count; iLoadGioChamCongChiTietTungNguoiTungNgay++)
                        {
                            sThu = dtLoadGioChamCongChiTietTungNguoiTungNgay.Rows[iLoadGioChamCongChiTietTungNguoiTungNgay]["Thu"].ToString();
                            string sGioVaoChiTietTungNguoiTungNgay;
                            sGioVaoChiTietTungNguoiTungNgay = dtLoadGioChamCongChiTietTungNguoiTungNgay.Rows[iLoadGioChamCongChiTietTungNguoiTungNgay]["GioVao"].ToString();
                            string sGioRaChiTietTungNguoiTungNgay;
                            sGioRaChiTietTungNguoiTungNgay = dtLoadGioChamCongChiTietTungNguoiTungNgay.Rows[iLoadGioChamCongChiTietTungNguoiTungNgay]["GioRa"].ToString();
                            if (sGioVaoChiTietTungNguoiTungNgay != "")
                            {
                                DateTime dGioVao;
                                dGioVao = Convert.ToDateTime(sGioVaoChiTietTungNguoiTungNgay);
                                sGioVao = dGioVao.Hour + ":" + dGioVao.Minute;
                            }
                            if (sGioRaChiTietTungNguoiTungNgay != "")
                            {
                                DateTime dGioRa;
                                dGioRa = Convert.ToDateTime(sGioRaChiTietTungNguoiTungNgay);
                                sGioRa = dGioRa.Hour + ":" + dGioRa.Minute;
                            }
                            iDemSoLanChamChiTietTungNguoiTungNgay++;
                            if (iDemSoLanChamChiTietTungNguoiTungNgay == 1)
                            {
                                (ws_ChiTietTungNguoiTungNgay).get_Range((object)("C" + (iTongDong * demNhanVien + demNgay)), (object)("C" + (iTongDong * demNhanVien + demNgay))).Cells[1, 1] = sGioVao;
                                (ws_ChiTietTungNguoiTungNgay).get_Range((object)("D" + (iTongDong * demNhanVien + demNgay)), (object)("D" + (iTongDong * demNhanVien + demNgay))).Cells[1, 1] = sGioRa;
                            }
                            if (iDemSoLanChamChiTietTungNguoiTungNgay == 2)
                            {
                                (ws_ChiTietTungNguoiTungNgay).get_Range((object)("E" + (iTongDong * demNhanVien + demNgay)), (object)("E" + (iTongDong * demNhanVien + demNgay))).Cells[1, 1] = sGioVao;
                                (ws_ChiTietTungNguoiTungNgay).get_Range((object)("F" + (iTongDong * demNhanVien + demNgay)), (object)("F" + (iTongDong * demNhanVien + demNgay))).Cells[1, 1] = sGioRa;
                            }
                            if (iDemSoLanChamChiTietTungNguoiTungNgay == 3)
                            {
                                (ws_ChiTietTungNguoiTungNgay).get_Range((object)("G" + (iTongDong * demNhanVien + demNgay)), (object)("G" + (iTongDong * demNhanVien + demNgay))).Cells[1, 1] = sGioVao;
                                (ws_ChiTietTungNguoiTungNgay).get_Range((object)("H" + (iTongDong * demNhanVien + demNgay)), (object)("H" + (iTongDong * demNhanVien + demNgay))).Cells[1, 1] = sGioRa;
                            }
                            iTreChiTietTungNguoiTungNgay += Convert.ToInt32(dtLoadGioChamCongChiTietTungNguoiTungNgay.Rows[iLoadGioChamCongChiTietTungNguoiTungNgay]["Tre"].ToString());
                            iVeSomChiTietTungNguoiTungNgay += Convert.ToInt32(dtLoadGioChamCongChiTietTungNguoiTungNgay.Rows[iLoadGioChamCongChiTietTungNguoiTungNgay]["VeSom"].ToString());
                            iVeTreChiTietTungNguoiTungNgay += Convert.ToInt32(dtLoadGioChamCongChiTietTungNguoiTungNgay.Rows[iLoadGioChamCongChiTietTungNguoiTungNgay]["VeTre"].ToString());
                            dGioChiTietTungNguoiTungNgay += Convert.ToDouble(dtLoadGioChamCongChiTietTungNguoiTungNgay.Rows[iLoadGioChamCongChiTietTungNguoiTungNgay]["Gio"].ToString());
                            dCongChiTietTungNguoiTungNgay += Convert.ToDouble(dtLoadGioChamCongChiTietTungNguoiTungNgay.Rows[iLoadGioChamCongChiTietTungNguoiTungNgay]["Cong"].ToString());
                            dTC1ChiTietTungNguoiTungNgay += Convert.ToDouble(dtLoadGioChamCongChiTietTungNguoiTungNgay.Rows[iLoadGioChamCongChiTietTungNguoiTungNgay]["TC1"].ToString());
                            dTC2ChiTietTungNguoiTungNgay += Convert.ToDouble(dtLoadGioChamCongChiTietTungNguoiTungNgay.Rows[iLoadGioChamCongChiTietTungNguoiTungNgay]["TC2"].ToString());
                            (ws_ChiTietTungNguoiTungNgay).get_Range((object)("P" + (iTongDong * demNhanVien + demNgay)), (object)("P" + (iTongDong * demNhanVien + demNgay))).Cells[1, 1] = dtLoadGioChamCongChiTietTungNguoiTungNgay.Rows[iLoadGioChamCongChiTietTungNguoiTungNgay]["KyHieu"].ToString();
                            sGioVao = "";
                            sGioRa = "";
                        }
                        (ws_ChiTietTungNguoiTungNgay).get_Range((object)("I" + (iTongDong * demNhanVien + demNgay)), (object)("I" + (iTongDong * demNhanVien + demNgay))).Cells[1, 1] = iTreChiTietTungNguoiTungNgay;
                        (ws_ChiTietTungNguoiTungNgay).get_Range((object)("J" + (iTongDong * demNhanVien + demNgay)), (object)("J" + (iTongDong * demNhanVien + demNgay))).Cells[1, 1] = iVeSomChiTietTungNguoiTungNgay;
                        (ws_ChiTietTungNguoiTungNgay).get_Range((object)("K" + (iTongDong * demNhanVien + demNgay)), (object)("K" + (iTongDong * demNhanVien + demNgay))).Cells[1, 1] = iVeTreChiTietTungNguoiTungNgay;
                        (ws_ChiTietTungNguoiTungNgay).get_Range((object)("L" + (iTongDong * demNhanVien + demNgay)), (object)("L" + (iTongDong * demNhanVien + demNgay))).Cells[1, 1] = dGioChiTietTungNguoiTungNgay;
                        (ws_ChiTietTungNguoiTungNgay).get_Range((object)("M" + (iTongDong * demNhanVien + demNgay)), (object)("M" + (iTongDong * demNhanVien + demNgay))).Cells[1, 1] = dCongChiTietTungNguoiTungNgay;
                        (ws_ChiTietTungNguoiTungNgay).get_Range((object)("N" + (iTongDong * demNhanVien + demNgay)), (object)("N" + (iTongDong * demNhanVien + demNgay))).Cells[1, 1] = dTC1ChiTietTungNguoiTungNgay;
                        (ws_ChiTietTungNguoiTungNgay).get_Range((object)("O" + (iTongDong * demNhanVien + demNgay)), (object)("O" + (iTongDong * demNhanVien + demNgay))).Cells[1, 1] = dTC2ChiTietTungNguoiTungNgay;
                        Excel.Range excelChiTietTungNguoiTungNgay_DinhDangDuLieu;
                        excelChiTietTungNguoiTungNgay_DinhDangDuLieu = (ws_ChiTietTungNguoiTungNgay).get_Range((object)("A" + (iTongDong * demNhanVien + demNgay)), (object)("P" + (iTongDong * demNhanVien + demNgay)));
                        if (sThu == "CN")
                        {
                            excelChiTietTungNguoiTungNgay_DinhDangDuLieu.Interior.Color = ColorTranslator.ToOle(Color.Aqua);
                        }
                        iDemNVProCess++;
                        demNgay++;
                    }
                    Excel.Range excelChiTietTungNguoiTungNgay_DinhDangDuLieuDuLieu;
                    excelChiTietTungNguoiTungNgay_DinhDangDuLieuDuLieu = (ws_ChiTietTungNguoiTungNgay).get_Range((object)("A" + (iTongDong * demNhanVien + demNgay)), (object)("A" + (iTongDong * demNhanVien + demNgay)));
                    excelChiTietTungNguoiTungNgay_DinhDangDuLieuDuLieu.Font.Name = "Times New Roman";
                    excelChiTietTungNguoiTungNgay_DinhDangDuLieuDuLieu.Font.Size = "10";
                    excelChiTietTungNguoiTungNgay_DinhDangDuLieuDuLieu.HorizontalAlignment = Excel.Constants.xlCenter;
                    Excel.Range excelChiTietTungNguoiTungNgay_DinhDangDuLieuHeader;
                    excelChiTietTungNguoiTungNgay_DinhDangDuLieuHeader = (ws_ChiTietTungNguoiTungNgay).get_Range((object)("A" + (iTongDong * demNhanVien + 6)), (object)("R" + (iTongDong * demNhanVien + demNgay - 1)));
                    excelChiTietTungNguoiTungNgay_DinhDangDuLieuHeader.HorizontalAlignment = Excel.Constants.xlCenter;
                    excelChiTietTungNguoiTungNgay_DinhDangDuLieuHeader.Font.Name = "Times New Roman";
                    excelChiTietTungNguoiTungNgay_DinhDangDuLieuHeader.Font.Size = "11";
                    (ws_ChiTietTungNguoiTungNgay).get_Range((object)("A" + (iTongDong * demNhanVien + 1)), (object)("P" + (iTongDong * demNhanVien + demNgay - 1))).Borders.LineStyle = Excel.Constants.xlBoth;
                    demNhanVien++;
                }
            }
            ws_ChiTietTungNguoiTungNgay.PageSetup.Orientation = Excel.XlPageOrientation.xlLandscape;
            ws_ChiTietTungNguoiTungNgay.PageSetup.PaperSize = Excel.XlPaperSize.xlPaperA4;
            ws_ChiTietTungNguoiTungNgay.PageSetup.LeftMargin = 13.0;
            ws_ChiTietTungNguoiTungNgay.PageSetup.RightMargin = 0.0;
            ws_ChiTietTungNguoiTungNgay.PageSetup.BottomMargin = 0.0;
            ws_ChiTietTungNguoiTungNgay.PageSetup.TopMargin = 0.0;
            ws_ChiTietTungNguoiTungNgay.PageSetup.Zoom = 92;
        }

        private void ExportExcelThongKeThangCong()
        {
            testProcess = iDemNhanVienDuocChon;
            demProcess = -1;
            DateTime dNgayTinh;
            dNgayTinh = Convert.ToDateTime(dateTimeTuNgay.Text);
            DateTime dNgayBatDauTinhCong;
            dNgayBatDauTinhCong = new DateTime(dNgayTinh.Year, dNgayTinh.Month, dNgayTinh.Day, 0, 0, 0);
            _ = Thread.CurrentThread.CurrentCulture;
            Thread.CurrentThread.CurrentCulture = new CultureInfo("en-US");
            Excel.Application xla_ThongKeThangCong;
            xla_ThongKeThangCong = new Excel.Application();
            xla_ThongKeThangCong.Workbooks.Add(Excel.XlSheetType.xlWorksheet);
            _ = xla_ThongKeThangCong.ActiveSheet;
            Excel.Worksheet ws_ThongKeThangCong;
            ws_ThongKeThangCong = xla_ThongKeThangCong.Worksheets.get_Item((object)1);
            bool failed;
            do
            {
                try
                {
                    Excel.Range excelThongKeThangCong_CongTyHeader;
                    excelThongKeThangCong_CongTyHeader = (ws_ThongKeThangCong).get_Range((object)"A1", (object)"AT1");
                    excelThongKeThangCong_CongTyHeader.Cells[1, 1] = sTenCongTyReport;
                    excelThongKeThangCong_CongTyHeader.get_Range((object)"A1", (object)"AT1").Merge(true);
                    Excel.Range excelThongKeThangCong_DiaChiHeader;
                    excelThongKeThangCong_DiaChiHeader = (ws_ThongKeThangCong).get_Range((object)"A2", (object)"AT2");
                    excelThongKeThangCong_DiaChiHeader.Cells[1, 1] = sDiaChiCongTyReport;
                    excelThongKeThangCong_DiaChiHeader.get_Range((object)"A1", (object)"AT1").Merge(true);
                    Excel.Range excelThongKeThangCong_DinhDangCongTy;
                    excelThongKeThangCong_DinhDangCongTy = (ws_ThongKeThangCong).get_Range((object)"A1", (object)"AT2");
                    excelThongKeThangCong_DinhDangCongTy.Font.Name = "Times New Roman";
                    excelThongKeThangCong_DinhDangCongTy.Font.Size = "10";
                    excelThongKeThangCong_DinhDangCongTy.Font.Bold = true;
                    Excel.Range excelThongKeThangCong_TieuDeHeader;
                    excelThongKeThangCong_TieuDeHeader = (ws_ThongKeThangCong).get_Range((object)"A4", (object)"AT4");
                    excelThongKeThangCong_TieuDeHeader.Cells[1, 1] = "BẢNG CHẤM CÔNG";
                    excelThongKeThangCong_TieuDeHeader.get_Range((object)"A1", (object)"AT1").Merge(true);
                    excelThongKeThangCong_TieuDeHeader.Font.Name = "Times New Roman";
                    excelThongKeThangCong_TieuDeHeader.Font.Size = "14";
                    excelThongKeThangCong_TieuDeHeader.Font.Bold = true;
                    excelThongKeThangCong_TieuDeHeader.HorizontalAlignment = Excel.Constants.xlCenter;
                    Excel.Range excelThongKeThangCong_TuNgayDenNgayHeader;
                    excelThongKeThangCong_TuNgayDenNgayHeader = (ws_ThongKeThangCong).get_Range((object)"A5", (object)"AS5");
                    excelThongKeThangCong_TuNgayDenNgayHeader.Cells[1, 1] = "Từ ngày " + dateTimeTuNgay.Text + " đến ngày " + dateTimeDenNgay.Text;
                    excelThongKeThangCong_TuNgayDenNgayHeader.get_Range((object)"A1", (object)"AT1").Merge(true);
                    excelThongKeThangCong_TuNgayDenNgayHeader.Font.Name = "Times New Roman";
                    excelThongKeThangCong_TuNgayDenNgayHeader.Font.Size = "10";
                    excelThongKeThangCong_TuNgayDenNgayHeader.Font.Bold = true;
                    excelThongKeThangCong_TuNgayDenNgayHeader.HorizontalAlignment = Excel.Constants.xlCenter;
                    Excel.Range excelThongKeThangCong_STTHeader;
                    excelThongKeThangCong_STTHeader = (ws_ThongKeThangCong).get_Range((object)"A7", (object)"A9");
                    excelThongKeThangCong_STTHeader.Cells[1, 1] = "STT";
                    excelThongKeThangCong_STTHeader.get_Range((object)"A1", (object)"A3").MergeCells = true;
                    Excel.Range excelThongKeThangCong_MaNhanVienHeader;
                    excelThongKeThangCong_MaNhanVienHeader = (ws_ThongKeThangCong).get_Range((object)"B7", (object)"B9");
                    excelThongKeThangCong_MaNhanVienHeader.Cells[1, 1] = "MÃ NHÂN VIÊN";
                    excelThongKeThangCong_MaNhanVienHeader.get_Range((object)"A1", (object)"A3").MergeCells = true;
                    excelThongKeThangCong_MaNhanVienHeader.ColumnWidth = 15;
                    Excel.Range excelThongKeThangCong_HoTenHeader;
                    excelThongKeThangCong_HoTenHeader = (ws_ThongKeThangCong).get_Range((object)"C7", (object)"C9");
                    excelThongKeThangCong_HoTenHeader.Cells[1, 1] = "HỌ TÊN";
                    excelThongKeThangCong_HoTenHeader.get_Range((object)"A1", (object)"A3").MergeCells = true;
                    excelThongKeThangCong_HoTenHeader.ColumnWidth = 17;
                    Excel.Range excelThongKeThangCong_PhongBanHeader;
                    excelThongKeThangCong_PhongBanHeader = (ws_ThongKeThangCong).get_Range((object)"D7", (object)"D9");
                    excelThongKeThangCong_PhongBanHeader.Cells[1, 1] = "PHÒNG BAN";
                    excelThongKeThangCong_PhongBanHeader.get_Range((object)"A1", (object)"A3").MergeCells = true;
                    excelThongKeThangCong_PhongBanHeader.ColumnWidth = 13;
                    Excel.Range excelThongKeThangCong_ChucVuHeader;
                    excelThongKeThangCong_ChucVuHeader = (ws_ThongKeThangCong).get_Range((object)"E7", (object)"E9");
                    excelThongKeThangCong_ChucVuHeader.Cells[1, 1] = "NGÀY VÀO LÀM";
                    excelThongKeThangCong_ChucVuHeader.get_Range((object)"A1", (object)"A3").MergeCells = true;
                    excelThongKeThangCong_ChucVuHeader.ColumnWidth = 15;
                    Excel.Range excelThongKeThangCong_SoNgayLamViecHeader;
                    excelThongKeThangCong_SoNgayLamViecHeader = (ws_ThongKeThangCong).get_Range((object)"F7", (object)"AJ7");
                    excelThongKeThangCong_SoNgayLamViecHeader.Cells[1, 1] = "SỐ NGÀY LÀM VIỆC TRONG THÁNG";
                    excelThongKeThangCong_SoNgayLamViecHeader.get_Range((object)"A1", (object)"AE1").Merge(true);
                    xla_ThongKeThangCong.Visible = true;
                    int ColunmNgay;
                    ColunmNgay = 6;
                    for (int iThongKeThang_Cong2 = 0; iThongKeThang_Cong2 < 31; iThongKeThang_Cong2++)
                    {
                        DateTime dtNgayChamThongKeThangCong;
                        dtNgayChamThongKeThangCong = dateTimeTuNgay.Value;
                        int iNgayChamThongKeThangCong;
                        iNgayChamThongKeThangCong = Convert.ToInt32(Convert.ToDateTime(dtNgayChamThongKeThangCong.AddDays(iThongKeThang_Cong2).ToString()).Day);
                        Excel.Range excelThongKeThangCong_Ngay;
                        excelThongKeThangCong_Ngay = (ws_ThongKeThangCong).get_Range((object)"F8", (object)"AJ9");
                        xla_ThongKeThangCong.Cells[8, ColunmNgay] = iNgayChamThongKeThangCong;
                        DateTimeProgress.XuatThuReport((int)dtNgayChamThongKeThangCong.AddDays(iThongKeThang_Cong2).DayOfWeek);
                        xla_ThongKeThangCong.Cells[9, ColunmNgay] = DateTimeProgress.XuatThuReport((int)dtNgayChamThongKeThangCong.AddDays(iThongKeThang_Cong2).DayOfWeek);
                        ColunmNgay++;
                        excelThongKeThangCong_Ngay.ColumnWidth = 5;
                    }
                    Excel.Range excelThongKeThangCong_TongNgayCongHeader;
                    excelThongKeThangCong_TongNgayCongHeader = (ws_ThongKeThangCong).get_Range((object)"AK7", (object)"AK9");
                    excelThongKeThangCong_TongNgayCongHeader.Cells[1, 1] = "TỔNG NGÀY CÔNG";
                    excelThongKeThangCong_TongNgayCongHeader.get_Range((object)"A1", (object)"A3").MergeCells = true;
                    excelThongKeThangCong_TongNgayCongHeader.ColumnWidth = 17;
                    Excel.Range excelThongKeThangCong_TangCaHeader;
                    excelThongKeThangCong_TangCaHeader = (ws_ThongKeThangCong).get_Range((object)"AL7", (object)"AM8");
                    excelThongKeThangCong_TangCaHeader.Cells[1, 1] = "TĂNG CA";
                    excelThongKeThangCong_TangCaHeader.get_Range((object)"A1", (object)"B2").MergeCells = true;
                    Excel.Range excelThongKeThangCong_BTTangCaHeader;
                    excelThongKeThangCong_BTTangCaHeader = (ws_ThongKeThangCong).get_Range((object)"AL9", (object)"AL9");
                    excelThongKeThangCong_BTTangCaHeader.Cells[1, 1] = "BT";
                    excelThongKeThangCong_BTTangCaHeader.get_Range((object)"A1", (object)"A1").MergeCells = true;
                    Excel.Range excelThongKeThangCong_CNTangCaHeader;
                    excelThongKeThangCong_CNTangCaHeader = (ws_ThongKeThangCong).get_Range((object)"AM9", (object)"AM9");
                    excelThongKeThangCong_CNTangCaHeader.Cells[1, 1] = "CN";
                    excelThongKeThangCong_CNTangCaHeader.get_Range((object)"A1", (object)"A1").MergeCells = true;
                    Excel.Range excelThongKeThangCong_SoPhutHeader;
                    excelThongKeThangCong_SoPhutHeader = (ws_ThongKeThangCong).get_Range((object)"AN7", (object)"AP8");
                    excelThongKeThangCong_SoPhutHeader.Cells[1, 1] = "SỐ PHÚT";
                    excelThongKeThangCong_SoPhutHeader.get_Range((object)"A1", (object)"C2").MergeCells = true;
                    (ws_ThongKeThangCong).get_Range((object)"AN9", (object)"AN9").Cells[1, 1] = "Trễ";
                    (ws_ThongKeThangCong).get_Range((object)"AO9", (object)"AO9").Cells[1, 1] = "Sớm";
                    (ws_ThongKeThangCong).get_Range((object)"AP9", (object)"AP9").Cells[1, 1] = "TC";
                    Excel.Range excelThongKeThangCong_NghiHeader;
                    excelThongKeThangCong_NghiHeader = (ws_ThongKeThangCong).get_Range((object)"AQ7", (object)"AT8");
                    excelThongKeThangCong_NghiHeader.Cells[1, 1] = "NGHỈ";
                    excelThongKeThangCong_NghiHeader.get_Range((object)"A1", (object)"D2").MergeCells = true;
                    (ws_ThongKeThangCong).get_Range((object)"AQ9", (object)"AQ9").Cells[1, 1] = "Phép";
                    (ws_ThongKeThangCong).get_Range((object)"AR9", (object)"AR9").Cells[1, 1] = "Lễ";
                    Excel.Range excelThongKeThangCong_NghiCoLuongNghiHeader;
                    excelThongKeThangCong_NghiCoLuongNghiHeader = (ws_ThongKeThangCong).get_Range((object)"AS9", (object)"AS9");
                    excelThongKeThangCong_NghiCoLuongNghiHeader.Cells[1, 1] = "N.Có Lương";
                    excelThongKeThangCong_NghiCoLuongNghiHeader.ColumnWidth = 11;
                    Excel.Range excelThongKeThangCong_NghiKhongLuongNghiHeader;
                    excelThongKeThangCong_NghiKhongLuongNghiHeader = (ws_ThongKeThangCong).get_Range((object)"AT9", (object)"AT9");
                    excelThongKeThangCong_NghiKhongLuongNghiHeader.Cells[1, 1] = "N.Không Lương";
                    excelThongKeThangCong_NghiKhongLuongNghiHeader.ColumnWidth = 14;
                    int iTangHang;
                    iTangHang = 9;
                    int iDemDongThongKeThangCong;
                    iDemDongThongKeThangCong = 10;
                    int iDemSTTThongKeThangCong;
                    iDemSTTThongKeThangCong = 1;
                    new DataTable();
                    DataTable dtNgayTinhCongThongKeThangCong;
                    dtNgayTinhCongThongKeThangCong = _ngayTinhCongBLL.showThongTinNgayTinhCong();
                    for (int iNgayTinhCongThongKeThangCong = 0; iNgayTinhCongThongKeThangCong < dtNgayTinhCongThongKeThangCong.Rows.Count; iNgayTinhCongThongKeThangCong++)
                    {
                        Convert.ToDateTime(dtNgayTinhCongThongKeThangCong.Rows[iNgayTinhCongThongKeThangCong]["NgayBatDau"].ToString());
                        new DataTable();
                        _tinhCongDTO.Ngay = dNgayBatDauTinhCong;
                        DataTable dtNhanVienThongKeThangCong;
                        dtNhanVienThongKeThangCong = _tinhCongBLL.TinhCongGetNgay(_tinhCongDTO);
                        int iMaChamCongThongKeThangCong;
                        iMaChamCongThongKeThangCong = 0;
                        for (int iNhanVienThongKeThangCong = 0; iNhanVienThongKeThangCong < dtNhanVienThongKeThangCong.Rows.Count; iNhanVienThongKeThangCong++)
                        {
                            if (Convert.ToInt32(dtNhanVienThongKeThangCong.Rows[iNhanVienThongKeThangCong]["MaChamCong"].ToString()) == iMaChamCongThongKeThangCong)
                            {
                                continue;
                            }
                            iMaChamCongThongKeThangCong = Convert.ToInt32(dtNhanVienThongKeThangCong.Rows[iNhanVienThongKeThangCong]["MaChamCong"].ToString());
                            string sMaNhanVienThongKeThangCong;
                            sMaNhanVienThongKeThangCong = dtNhanVienThongKeThangCong.Rows[iNhanVienThongKeThangCong]["MaNhanVien"].ToString();
                            string sTenNhanVienThongKeThangCong;
                            sTenNhanVienThongKeThangCong = dtNhanVienThongKeThangCong.Rows[iNhanVienThongKeThangCong]["TenNhanVien"].ToString();
                            string sMaPhongBanThongKeThangCong;
                            sMaPhongBanThongKeThangCong = dtNhanVienThongKeThangCong.Rows[iNhanVienThongKeThangCong]["PhongBan"].ToString();
                            Excel.Range excelThongKeThangCongSTTDuLieu;
                            excelThongKeThangCongSTTDuLieu = (ws_ThongKeThangCong).get_Range((object)("A" + iDemDongThongKeThangCong), (object)("A" + iDemDongThongKeThangCong));
                            excelThongKeThangCongSTTDuLieu.Cells[1, 1] = iDemSTTThongKeThangCong;
                            excelThongKeThangCongSTTDuLieu.Select();
                            Excel.Range excelThongKeThangCongMaNhanVienDuLieu;
                            excelThongKeThangCongMaNhanVienDuLieu = (ws_ThongKeThangCong).get_Range((object)("B" + iDemDongThongKeThangCong), (object)("B" + iDemDongThongKeThangCong));
                            excelThongKeThangCongMaNhanVienDuLieu.get_Range((object)"A1", (object)"A1").NumberFormat = "@";
                            excelThongKeThangCongMaNhanVienDuLieu.Cells[1, 1] = sMaNhanVienThongKeThangCong;
                            (ws_ThongKeThangCong).get_Range((object)("C" + iDemDongThongKeThangCong), (object)("C" + iDemDongThongKeThangCong)).Cells[1, 1] = sTenNhanVienThongKeThangCong;
                            int iDemPhongBanThongKeThangCong;
                            iDemPhongBanThongKeThangCong = 0;
                            string sTenPhongBanThongKeThangCong;
                            sTenPhongBanThongKeThangCong = "";
                            new DataTable();
                            _phongBanDTO.MaPhongBan = sMaPhongBanThongKeThangCong;
                            DataTable dtPhongBanThongKeThangCong;
                            dtPhongBanThongKeThangCong = _phongBanBLL.getTenPhongBanByMaPhongBan(_phongBanDTO);
                            for (int iPhongBanThongKeThangCong = 0; iPhongBanThongKeThangCong < dtPhongBanThongKeThangCong.Rows.Count; iPhongBanThongKeThangCong++)
                            {
                                iDemPhongBanThongKeThangCong = 1;
                                sTenPhongBanThongKeThangCong = dtPhongBanThongKeThangCong.Rows[iPhongBanThongKeThangCong]["TenPhongBan"].ToString();
                            }
                            Excel.Range excelThongKeThangCongPhongBanDuLieu;
                            excelThongKeThangCongPhongBanDuLieu = (ws_ThongKeThangCong).get_Range((object)("D" + iDemDongThongKeThangCong), (object)("D" + iDemDongThongKeThangCong));
                            if (iDemPhongBanThongKeThangCong == 1)
                            {
                                excelThongKeThangCongPhongBanDuLieu.Cells[1, 1] = sTenPhongBanThongKeThangCong;
                            }
                            else
                            {
                                excelThongKeThangCongPhongBanDuLieu.Cells[1, 1] = "-------";
                            }
                            new DataTable();
                            _nhanVienDTO.MaChamCong = iMaChamCongThongKeThangCong.ToString();
                            DataTable dtNhanVien;
                            dtNhanVien = _nhanVienBLL.NhanVienGetByMaChamCong(iMaChamCongThongKeThangCong.ToString());
                            for (int iNhanVien = 0; iNhanVien < dtNhanVien.Rows.Count; iNhanVien++)
                            {
                                string sNgayVaoLamViec;
                                sNgayVaoLamViec = dtNhanVien.Rows[iNhanVien]["NgayVaoLamViec"].ToString();
                                Excel.Range excelThongKeThangCongChucVuDuLieu;
                                excelThongKeThangCongChucVuDuLieu = (ws_ThongKeThangCong).get_Range((object)("E" + iDemDongThongKeThangCong), (object)("E" + iDemDongThongKeThangCong));
                                if (sNgayVaoLamViec != "")
                                {
                                    try
                                    {
                                        DateTime dNgayVaoLamViecExportDanhSachNhanVien;
                                        dNgayVaoLamViecExportDanhSachNhanVien = Convert.ToDateTime(sNgayVaoLamViec);
                                        excelThongKeThangCongChucVuDuLieu.get_Range((object)"A1", (object)"A1").NumberFormat = "@";
                                        excelThongKeThangCongChucVuDuLieu.Cells[1, 1] = $"{dNgayVaoLamViecExportDanhSachNhanVien:d}";
                                    }
                                    catch
                                    {
                                        excelThongKeThangCongChucVuDuLieu.Cells[1, 1] = $"{DateTime.Now:d}";
                                    }
                                }
                                else
                                {
                                    excelThongKeThangCongChucVuDuLieu.Cells[1, 1] = "-------";
                                }
                            }
                            int ColunmNgayCong;
                            ColunmNgayCong = 6;
                            int iTangCot;
                            iTangCot = 5;
                            int iColumnThongKeThangCong;
                            iColumnThongKeThangCong = 1;
                            for (int iThongKeThang_Cong = 0; iThongKeThang_Cong < 31; iThongKeThang_Cong++)
                            {
                                string sThu;
                                sThu = "";
                                double dNgayCongThongKeThang;
                                dNgayCongThongKeThang = 0.0;
                                _ = dateTimeTuNgay.Value;
                                DateTime dNgayCongThongKeThangCong;
                                dNgayCongThongKeThangCong = Convert.ToDateTime(dNgayBatDauTinhCong.AddDays(iThongKeThang_Cong).ToString());
                                new DataTable();
                                _tinhCongDTO.MaChamCong = iMaChamCongThongKeThangCong;
                                _tinhCongDTO.Ngay = dNgayCongThongKeThangCong;
                                DataTable dtCongHangNgayThongKeThangCong;
                                dtCongHangNgayThongKeThangCong = _tinhCongBLL.TinhCongGetMaChamCongAndNgayThongKeCong(_tinhCongDTO);
                                for (int iCongHangNgayThongKeThangCong = 0; iCongHangNgayThongKeThangCong < dtCongHangNgayThongKeThangCong.Rows.Count; iCongHangNgayThongKeThangCong++)
                                {
                                    dNgayCongThongKeThang += Convert.ToDouble(dtCongHangNgayThongKeThangCong.Rows[iCongHangNgayThongKeThangCong]["Cong"].ToString());
                                    sThu = dtCongHangNgayThongKeThangCong.Rows[iCongHangNgayThongKeThangCong]["Thu"].ToString();
                                }
                                Excel.Range excelThongKeThangCongCongHangNgayDuLieu;
                                excelThongKeThangCongCongHangNgayDuLieu = (ws_ThongKeThangCong).get_Range((object)("F" + iDemDongThongKeThangCong), (object)("AJ" + iDemDongThongKeThangCong));
                                if (dNgayCongThongKeThang > 0.0)
                                {
                                    excelThongKeThangCongCongHangNgayDuLieu.Cells[1, iColumnThongKeThangCong] = dNgayCongThongKeThang;
                                }
                                else
                                {
                                    excelThongKeThangCongCongHangNgayDuLieu.Cells[1, iColumnThongKeThangCong] = "";
                                }
                                if (sThu == "CN")
                                {
                                    (ws_ThongKeThangCong).get_Range(ws_ThongKeThangCong.Cells[iTangHang + 1, iTangCot + 1], ws_ThongKeThangCong.Cells[iTangHang, iTangCot + 1]).Interior.Color = ColorTranslator.ToOle(Color.PaleGoldenrod);
                                }
                                iTangCot++;
                                ColunmNgayCong++;
                                iColumnThongKeThangCong++;
                            }
                            double dTangCaThongKeThangCongNgayThuong;
                            dTangCaThongKeThangCongNgayThuong = 0.0;
                            new DataTable();
                            _tinhCongDTO.MaChamCong = iMaChamCongThongKeThangCong;
                            _tinhCongDTO.KyHieuPhu = "NT";
                            DataTable dtThongKeThangCongTangCaNgayThuong;
                            dtThongKeThangCongTangCaNgayThuong = _tinhCongBLL.TinhCongGetByMaChamCongAndKyHieuPhu(_tinhCongDTO);
                            for (int iTangCaNgayThuong = 0; iTangCaNgayThuong < dtThongKeThangCongTangCaNgayThuong.Rows.Count; iTangCaNgayThuong++)
                            {
                                dTangCaThongKeThangCongNgayThuong += Convert.ToDouble(dtThongKeThangCongTangCaNgayThuong.Rows[iTangCaNgayThuong]["TC1"].ToString()) + Convert.ToDouble(dtThongKeThangCongTangCaNgayThuong.Rows[iTangCaNgayThuong]["TC2"].ToString()) + Convert.ToDouble(dtThongKeThangCongTangCaNgayThuong.Rows[iTangCaNgayThuong]["TC3"].ToString()) + Convert.ToDouble(dtThongKeThangCongTangCaNgayThuong.Rows[iTangCaNgayThuong]["TC4"].ToString());
                            }
                            (ws_ThongKeThangCong).get_Range((object)("AL" + iDemDongThongKeThangCong), (object)("AL" + iDemDongThongKeThangCong)).Cells[1, 1] = dTangCaThongKeThangCongNgayThuong;
                            double dTangCaThongKeThangCongChuNhat;
                            dTangCaThongKeThangCongChuNhat = 0.0;
                            new DataTable();
                            _tinhCongDTO.MaChamCong = iMaChamCongThongKeThangCong;
                            _tinhCongDTO.KyHieuPhu = "CN";
                            DataTable dtThongKeThangCongTangCaChuNhat;
                            dtThongKeThangCongTangCaChuNhat = _tinhCongBLL.TinhCongGetByMaChamCongAndKyHieuPhu(_tinhCongDTO);
                            for (int iTangCaChuNhat = 0; iTangCaChuNhat < dtThongKeThangCongTangCaChuNhat.Rows.Count; iTangCaChuNhat++)
                            {
                                dTangCaThongKeThangCongChuNhat += Convert.ToDouble(dtThongKeThangCongTangCaChuNhat.Rows[iTangCaChuNhat]["TC1"].ToString()) + Convert.ToDouble(dtThongKeThangCongTangCaChuNhat.Rows[iTangCaChuNhat]["TC2"].ToString()) + Convert.ToDouble(dtThongKeThangCongTangCaChuNhat.Rows[iTangCaChuNhat]["TC3"].ToString()) + Convert.ToDouble(dtThongKeThangCongTangCaChuNhat.Rows[iTangCaChuNhat]["TC4"].ToString());
                            }
                            (ws_ThongKeThangCong).get_Range((object)("AM" + iDemDongThongKeThangCong), (object)("AM" + iDemDongThongKeThangCong)).Cells[1, 1] = dTangCaThongKeThangCongChuNhat;
                            int iTreThongKeThangCong;
                            iTreThongKeThangCong = 0;
                            int iVeSomThongKeThangCong;
                            iVeSomThongKeThangCong = 0;
                            int iDemNghiKhongLuongThongKeThangCong;
                            iDemNghiKhongLuongThongKeThangCong = 0;
                            int iDemNghiCoLuongThongKeThangCong;
                            iDemNghiCoLuongThongKeThangCong = 0;
                            int iDemPhepThongKeThangCong;
                            iDemPhepThongKeThangCong = 0;
                            int iDemNgayLeThongKeThangCong;
                            iDemNgayLeThongKeThangCong = 0;
                            double dTongCongThongKeThangCong;
                            dTongCongThongKeThangCong = 0.0;
                            new DataTable();
                            _tinhCongDTO.MaChamCong = iMaChamCongThongKeThangCong;
                            DataTable dtTreSomThongKeThangCong;
                            dtTreSomThongKeThangCong = _tinhCongBLL.TinhCongGetByMaChamCong(_tinhCongDTO);
                            for (int iTreSomThongKeThangCong = 0; iTreSomThongKeThangCong < dtTreSomThongKeThangCong.Rows.Count; iTreSomThongKeThangCong++)
                            {
                                iTreThongKeThangCong += Convert.ToInt32(dtTreSomThongKeThangCong.Rows[iTreSomThongKeThangCong]["Tre"].ToString());
                                iVeSomThongKeThangCong += Convert.ToInt32(dtTreSomThongKeThangCong.Rows[iTreSomThongKeThangCong]["VeSom"].ToString());
                                dTongCongThongKeThangCong += Convert.ToDouble(dtTreSomThongKeThangCong.Rows[iTreSomThongKeThangCong]["Cong"].ToString());
                                if (dtTreSomThongKeThangCong.Rows[iTreSomThongKeThangCong]["Cong"].ToString() == "0")
                                {
                                    iDemNghiKhongLuongThongKeThangCong++;
                                }
                                if (dtTreSomThongKeThangCong.Rows[iTreSomThongKeThangCong]["Cong"].ToString() != "0" && dtTreSomThongKeThangCong.Rows[iTreSomThongKeThangCong]["KyHieu"].ToString() != "X")
                                {
                                    iDemNghiCoLuongThongKeThangCong++;
                                }
                                if (dtTreSomThongKeThangCong.Rows[iTreSomThongKeThangCong]["Cong"].ToString() != "0" && dtTreSomThongKeThangCong.Rows[iTreSomThongKeThangCong]["KyHieu"].ToString() == sKHLe)
                                {
                                    iDemNgayLeThongKeThangCong++;
                                }
                                if (dtTreSomThongKeThangCong.Rows[iTreSomThongKeThangCong]["Cong"].ToString() != "0" && dtTreSomThongKeThangCong.Rows[iTreSomThongKeThangCong]["KyHieu"].ToString() == sKHPhepNam)
                                {
                                    iDemPhepThongKeThangCong++;
                                }
                            }
                            (ws_ThongKeThangCong).get_Range((object)("AN" + iDemDongThongKeThangCong), (object)("AN" + iDemDongThongKeThangCong)).Cells[1, 1] = iTreThongKeThangCong;
                            (ws_ThongKeThangCong).get_Range((object)("AO" + iDemDongThongKeThangCong), (object)("AO" + iDemDongThongKeThangCong)).Cells[1, 1] = iVeSomThongKeThangCong;
                            (ws_ThongKeThangCong).get_Range((object)("AP" + iDemDongThongKeThangCong), (object)("AP" + iDemDongThongKeThangCong)).Cells[1, 1] = (iTreThongKeThangCong + iVeSomThongKeThangCong).ToString();
                            (ws_ThongKeThangCong).get_Range((object)("AK" + iDemDongThongKeThangCong), (object)("AK" + iDemDongThongKeThangCong)).Cells[1, 1] = dTongCongThongKeThangCong;
                            (ws_ThongKeThangCong).get_Range((object)("AT" + iDemDongThongKeThangCong), (object)("AT" + iDemDongThongKeThangCong)).Cells[1, 1] = iDemNghiKhongLuongThongKeThangCong;
                            (ws_ThongKeThangCong).get_Range((object)("AS" + iDemDongThongKeThangCong), (object)("AS" + iDemDongThongKeThangCong)).Cells[1, 1] = iDemNghiCoLuongThongKeThangCong;
                            iDemDongThongKeThangCong++;
                            iDemSTTThongKeThangCong++;
                            iTangHang++;
                        }
                    }
                    Excel.Range excelThongKeThangCong_DinhDangHeader;
                    excelThongKeThangCong_DinhDangHeader = (ws_ThongKeThangCong).get_Range((object)"A7", (object)"AT9");
                    excelThongKeThangCong_DinhDangHeader.Font.Name = "Times New Roman";
                    excelThongKeThangCong_DinhDangHeader.Font.Size = "10";
                    excelThongKeThangCong_DinhDangHeader.Font.Bold = true;
                    excelThongKeThangCong_DinhDangHeader.Interior.ColorIndex = 33;
                    excelThongKeThangCong_DinhDangHeader.HorizontalAlignment = Excel.Constants.xlCenter;
                    excelThongKeThangCong_DinhDangHeader.Borders.LineStyle = Excel.Constants.xlBoth;
                    Excel.Range excelThongKeThangCong_DinhDangDuLieu;
                    excelThongKeThangCong_DinhDangDuLieu = (ws_ThongKeThangCong).get_Range((object)"A10", (object)("AT" + (iDemDongThongKeThangCong - 1)));
                    excelThongKeThangCong_DinhDangDuLieu.Font.Name = "Times New Roman";
                    excelThongKeThangCong_DinhDangDuLieu.Font.Size = "10";
                    excelThongKeThangCong_DinhDangDuLieu.HorizontalAlignment = Excel.Constants.xlCenter;
                    excelThongKeThangCong_DinhDangDuLieu.Borders.LineStyle = Excel.Constants.xlBoth;
                    failed = false;
                }
                catch (COMException)
                {
                    failed = true;
                }
                Thread.Sleep(10);
            }
            while (failed);
        }

        private void ExportTongHop()
        {
            testProcess = iDemNhanVienDuocChon;
            demProcess = -1;
            DateTime dNgayTinh;
            dNgayTinh = Convert.ToDateTime(dateTimeTuNgay.Text);
            DateTime dNgayBatDauTinhCong;
            dNgayBatDauTinhCong = new DateTime(dNgayTinh.Year, dNgayTinh.Month, dNgayTinh.Day, 0, 0, 0);
            _ = Thread.CurrentThread.CurrentCulture;
            Thread.CurrentThread.CurrentCulture = new CultureInfo("en-US");
            Excel.Application xla_TongHop;
            xla_TongHop = new Excel.Application();
            xla_TongHop.Workbooks.Add(Excel.XlSheetType.xlWorksheet);
            _ = xla_TongHop.ActiveSheet;
            Excel.Worksheet ws_TongHop;
            ws_TongHop = xla_TongHop.Worksheets.get_Item((object)1);
            xla_TongHop.Visible = true;
            bool failed;
            do
            {
                try
                {
                    Excel.Range excelTenCongTy;
                    excelTenCongTy = (ws_TongHop).get_Range((object)"A1", (object)"P1");
                    excelTenCongTy.Select();
                    excelTenCongTy.Cells[1, 1] = "Công ty: " + sTenCongTyReport;
                    excelTenCongTy.get_Range((object)"A1", (object)"P1").Merge(true);
                    Excel.Range excelDiaChiCongTy;
                    excelDiaChiCongTy = (ws_TongHop).get_Range((object)"A2", (object)"P2");
                    excelDiaChiCongTy.Cells[1, 1] = "Địa chỉ: " + sDiaChiCongTyReport;
                    excelDiaChiCongTy.get_Range((object)"A1", (object)"P1").Merge(true);
                    Excel.Range excelTieuDeTongHop;
                    excelTieuDeTongHop = (ws_TongHop).get_Range((object)"A4", (object)"P4");
                    excelTieuDeTongHop.Cells[1, 1] = "BẢNG TỔNG HỢP CHẤM CÔNG";
                    excelTieuDeTongHop.get_Range((object)"A1", (object)"P1").Merge(true);
                    excelTieuDeTongHop.Font.Name = "Times New Roman";
                    excelTieuDeTongHop.Font.Size = "18";
                    excelTieuDeTongHop.Font.Bold = true;
                    excelTieuDeTongHop.RowHeight = "24";
                    excelTieuDeTongHop.HorizontalAlignment = Excel.Constants.xlCenter;
                    Excel.Range excelTuNgayDenNgayTongHop;
                    excelTuNgayDenNgayTongHop = (ws_TongHop).get_Range((object)"A5", (object)"P5");
                    excelTuNgayDenNgayTongHop.Cells[1, 1] = "Từ ngày " + dateTimeTuNgay.Text + " đến ngày " + dateTimeDenNgay.Text;
                    excelTuNgayDenNgayTongHop.get_Range((object)"A1", (object)"P1").Merge(true);
                    excelTuNgayDenNgayTongHop.HorizontalAlignment = Excel.Constants.xlCenter;
                    Excel.Range excelSTTTongHop;
                    excelSTTTongHop = (ws_TongHop).get_Range((object)"A7", (object)"A9");
                    excelSTTTongHop.Cells[1, 1] = "STT";
                    excelSTTTongHop.get_Range((object)"A1", (object)"A3").MergeCells = true;
                    Excel.Range excelMaSoTongHop;
                    excelMaSoTongHop = (ws_TongHop).get_Range((object)"B7", (object)"B9");
                    excelMaSoTongHop.Cells[1, 1] = "Mã số";
                    excelMaSoTongHop.get_Range((object)"A1", (object)"A3").MergeCells = true;
                    Excel.Range excelHoVaTenTongHop;
                    excelHoVaTenTongHop = (ws_TongHop).get_Range((object)"C7", (object)"C9");
                    excelHoVaTenTongHop.Cells[1, 1] = "Họ và tên";
                    excelHoVaTenTongHop.get_Range((object)"A1", (object)"A3").MergeCells = true;
                    Excel.Range excelPhongBanTongHop;
                    excelPhongBanTongHop = (ws_TongHop).get_Range((object)"D7", (object)"D9");
                    excelPhongBanTongHop.Cells[1, 1] = "Phòng ban";
                    excelPhongBanTongHop.get_Range((object)"A1", (object)"A3").MergeCells = true;
                    Excel.Range excelQuyRaCongTongHop;
                    excelQuyRaCongTongHop = (ws_TongHop).get_Range((object)"E7", (object)"L7");
                    excelQuyRaCongTongHop.Cells[1, 1] = "QUY RA CÔNG";
                    excelQuyRaCongTongHop.get_Range((object)"A1", (object)"H1").Merge(true);
                    excelQuyRaCongTongHop.HorizontalAlignment = Excel.Constants.xlCenter;
                    Excel.Range excelGioCongTongHop;
                    excelGioCongTongHop = (ws_TongHop).get_Range((object)"E8", (object)"F8");
                    excelGioCongTongHop.Cells[1, 1] = "Giờ công";
                    excelGioCongTongHop.get_Range((object)"A1", (object)"B1").Merge(true);
                    Excel.Range excelNgayCongTongHop;
                    excelNgayCongTongHop = (ws_TongHop).get_Range((object)"G8", (object)"H8");
                    excelNgayCongTongHop.Cells[1, 1] = "Ngày công";
                    excelNgayCongTongHop.get_Range((object)"A1", (object)"B1").Merge(true);
                    Excel.Range excelTangCaTongHop;
                    excelTangCaTongHop = (ws_TongHop).get_Range((object)"I8", (object)"J8");
                    excelTangCaTongHop.Cells[1, 1] = "Tăng ca";
                    excelTangCaTongHop.get_Range((object)"A1", (object)"B1").Merge(true);
                    Excel.Range excelPhutTongHop;
                    excelPhutTongHop = (ws_TongHop).get_Range((object)"K8", (object)"L8");
                    excelPhutTongHop.Cells[1, 1] = "Số lần";
                    excelPhutTongHop.get_Range((object)"A1", (object)"B1").Merge(true);
                    (ws_TongHop).get_Range((object)"E9", (object)"E9").Cells[1, 1] = "BT";
                    Excel.Range excelCNGioCongTongHop;
                    excelCNGioCongTongHop = (ws_TongHop).get_Range((object)"F9", (object)"F9");
                    excelCNGioCongTongHop.Cells[1, 1] = "CN";
                    excelCNGioCongTongHop.Font.ColorIndex = 3;
                    (ws_TongHop).get_Range((object)"G9", (object)"G9").Cells[1, 1] = "BT";
                    Excel.Range excelCNNgayCongTongHop;
                    excelCNNgayCongTongHop = (ws_TongHop).get_Range((object)"H9", (object)"H9");
                    excelCNNgayCongTongHop.Cells[1, 1] = "CN";
                    excelCNNgayCongTongHop.Font.ColorIndex = 3;
                    (ws_TongHop).get_Range((object)"I9", (object)"I9").Cells[1, 1] = "BT";
                    Excel.Range excelCNTangCaTongHop;
                    excelCNTangCaTongHop = (ws_TongHop).get_Range((object)"J9", (object)"J9");
                    excelCNTangCaTongHop.Cells[1, 1] = "CN";
                    excelCNTangCaTongHop.Font.ColorIndex = 3;
                    (ws_TongHop).get_Range((object)"K9", (object)"K9").Cells[1, 1] = "Trễ";
                    (ws_TongHop).get_Range((object)"L9", (object)"L9").Cells[1, 1] = "Sớm";
                    Excel.Range excelNghiTongHop;
                    excelNghiTongHop = (ws_TongHop).get_Range((object)"M7", (object)"P7");
                    excelNghiTongHop.Cells[1, 1] = "NGHỈ";
                    excelNghiTongHop.get_Range((object)"A1", (object)"D1").Merge(true);
                    excelNghiTongHop.HorizontalAlignment = Excel.Constants.xlCenter;
                    Excel.Range excelPhepTongHop;
                    excelPhepTongHop = (ws_TongHop).get_Range((object)"M8", (object)"M9");
                    excelPhepTongHop.Cells[1, 1] = "PHÉP";
                    excelPhepTongHop.get_Range((object)"A1", (object)"A2").MergeCells = true;
                    excelPhepTongHop.get_Range((object)"A1", (object)"A2").Orientation = 90;
                    Excel.Range excelLeTongHop;
                    excelLeTongHop = (ws_TongHop).get_Range((object)"N8", (object)"N9");
                    excelLeTongHop.Cells[1, 1] = "LỄ";
                    excelLeTongHop.get_Range((object)"A1", (object)"A2").MergeCells = true;
                    excelLeTongHop.get_Range((object)"A1", (object)"A2").Orientation = 90;
                    Excel.Range excelNghiCoLuongTongHop;
                    excelNghiCoLuongTongHop = (ws_TongHop).get_Range((object)"O8", (object)"O9");
                    excelNghiCoLuongTongHop.Cells[1, 1] = "N.CÓ LƯƠNG";
                    excelNghiCoLuongTongHop.get_Range((object)"A1", (object)"A2").MergeCells = true;
                    excelNghiCoLuongTongHop.get_Range((object)"A1", (object)"A2").Orientation = 90;
                    Excel.Range excelNghiKhongLuongTongHop;
                    excelNghiKhongLuongTongHop = (ws_TongHop).get_Range((object)"P8", (object)"P9");
                    excelNghiKhongLuongTongHop.Cells[1, 1] = "N.KHÔNG LƯƠNG";
                    excelNghiKhongLuongTongHop.get_Range((object)"A1", (object)"A2").MergeCells = true;
                    excelNghiKhongLuongTongHop.get_Range((object)"A1", (object)"A2").Orientation = 90;
                    (ws_TongHop).get_Range((object)"A8", (object)"P8").get_Range((object)"A1", (object)"A1").RowHeight = 40;
                    (ws_TongHop).get_Range((object)"A9", (object)"P9").get_Range((object)"A1", (object)"A1").RowHeight = 50;
                    int demNhanVienExportTongHop;
                    demNhanVienExportTongHop = 10;
                    int dem;
                    dem = 1;
                    new DataTable();
                    DataTable dtNgayTinhCongTongHop;
                    dtNgayTinhCongTongHop = _ngayTinhCongBLL.showThongTinNgayTinhCong();
                    for (int iNgayTinhCongTongHop = 0; iNgayTinhCongTongHop < dtNgayTinhCongTongHop.Rows.Count; iNgayTinhCongTongHop++)
                    {
                        Convert.ToDateTime(dtNgayTinhCongTongHop.Rows[iNgayTinhCongTongHop]["NgayBatDau"].ToString());
                        new DataTable();
                        _tinhCongDTO.Ngay = dNgayBatDauTinhCong;
                        DataTable dtTinhCongTongHop;
                        dtTinhCongTongHop = _tinhCongBLL.TinhCongGetNgay(_tinhCongDTO);
                        int iMaChamCongTongHop;
                        iMaChamCongTongHop = 0;
                        for (int iTinhCongTongHop = 0; iTinhCongTongHop < dtTinhCongTongHop.Rows.Count; iTinhCongTongHop++)
                        {
                            if (Convert.ToInt32(dtTinhCongTongHop.Rows[iTinhCongTongHop]["MaChamCong"].ToString()) == iMaChamCongTongHop)
                            {
                                continue;
                            }
                            string sTenPhongBanTongHop;
                            sTenPhongBanTongHop = "";
                            int iDemNgayThuong;
                            iDemNgayThuong = 0;
                            int iDemNgayChuNhat;
                            iDemNgayChuNhat = 0;
                            double dTongGioNgayThuong;
                            dTongGioNgayThuong = 0.0;
                            double dTongGioNgayChuNhat;
                            dTongGioNgayChuNhat = 0.0;
                            double dTongCongNgayThuong;
                            dTongCongNgayThuong = 0.0;
                            double dTongCongNgayChuNhat;
                            dTongCongNgayChuNhat = 0.0;
                            double dTongTangCaNgayThuong;
                            dTongTangCaNgayThuong = 0.0;
                            double dTongTangCaNgayChuNhat;
                            dTongTangCaNgayChuNhat = 0.0;
                            int iDemNgayLeTongHop;
                            iDemNgayLeTongHop = 0;
                            double iDemPhepNamTongHop;
                            iDemPhepNamTongHop = 0.0;
                            int iDemNghiKhongLuongTongHop;
                            iDemNghiKhongLuongTongHop = 0;
                            int iTongDiTreTongHop;
                            iTongDiTreTongHop = 0;
                            int iTongVeSomTongHop;
                            iTongVeSomTongHop = 0;
                            iMaChamCongTongHop = Convert.ToInt32(dtTinhCongTongHop.Rows[iTinhCongTongHop]["MaChamCong"].ToString());
                            string sMaNhanVienTongHop;
                            sMaNhanVienTongHop = dtTinhCongTongHop.Rows[iTinhCongTongHop]["MaNhanVien"].ToString();
                            string sTenNhanVienTongHop;
                            sTenNhanVienTongHop = dtTinhCongTongHop.Rows[iTinhCongTongHop]["TenNhanVien"].ToString();
                            string sMaPhongBanTongHop;
                            sMaPhongBanTongHop = dtTinhCongTongHop.Rows[iTinhCongTongHop]["PhongBan"].ToString();
                            Excel.Range excelSTTDuLieuTongHop;
                            excelSTTDuLieuTongHop = (ws_TongHop).get_Range((object)("A" + demNhanVienExportTongHop), (object)("A" + demNhanVienExportTongHop));
                            excelSTTDuLieuTongHop.Cells[1, 1] = dem;
                            excelSTTDuLieuTongHop.Select();
                            Excel.Range excelMaNhanVienDuLieuTongHop;
                            excelMaNhanVienDuLieuTongHop = (ws_TongHop).get_Range((object)("B" + demNhanVienExportTongHop), (object)("B" + demNhanVienExportTongHop));
                            excelMaNhanVienDuLieuTongHop.get_Range((object)"A1", (object)"A1").NumberFormat = "@";
                            excelMaNhanVienDuLieuTongHop.Cells[1, 1] = sMaNhanVienTongHop;
                            (ws_TongHop).get_Range((object)("C" + demNhanVienExportTongHop), (object)("C" + demNhanVienExportTongHop)).Cells[1, 1] = sTenNhanVienTongHop;
                            new DataTable();
                            _phongBanDTO.MaPhongBan = sMaPhongBanTongHop;
                            DataTable dtPhongBanTongHop;
                            dtPhongBanTongHop = _phongBanBLL.getTenPhongBanByMaPhongBan(_phongBanDTO);
                            for (int iPhongBanTongHop = 0; iPhongBanTongHop < dtPhongBanTongHop.Rows.Count; iPhongBanTongHop++)
                            {
                                sTenPhongBanTongHop = dtPhongBanTongHop.Rows[iPhongBanTongHop]["TenPhongBan"].ToString();
                            }
                            if (sMaPhongBanTongHop == "")
                            {
                                (ws_TongHop).get_Range((object)("D" + demNhanVienExportTongHop), (object)("D" + demNhanVienExportTongHop)).Cells[1, 1] = "------";
                            }
                            else
                            {
                                (ws_TongHop).get_Range((object)("D" + demNhanVienExportTongHop), (object)("D" + demNhanVienExportTongHop)).Cells[1, 1] = sTenPhongBanTongHop;
                            }
                            new DataTable();
                            _tinhCongDTO.MaChamCong = iMaChamCongTongHop;
                            DataTable dtNhanVienTongHop;
                            dtNhanVienTongHop = _tinhCongBLL.TinhCongGetByMaChamCong(_tinhCongDTO);
                            for (int iNhanVienTongHop = 0; iNhanVienTongHop < dtNhanVienTongHop.Rows.Count; iNhanVienTongHop++)
                            {
                                int iDiTre;
                                iDiTre = Convert.ToInt32(dtNhanVienTongHop.Rows[iNhanVienTongHop]["Tre"].ToString());
                                int iVeSom;
                                iVeSom = Convert.ToInt32(dtNhanVienTongHop.Rows[iNhanVienTongHop]["VeSom"].ToString());
                                if (iDiTre > 0)
                                {
                                    iTongDiTreTongHop++;
                                }
                                if (iVeSom > 0)
                                {
                                    iTongVeSomTongHop++;
                                }
                            }
                            new DataTable();
                            _tinhCongDTO.MaChamCong = iMaChamCongTongHop;
                            _tinhCongDTO.KyHieuPhu = "NT";
                            DataTable dtGioCongNgayThuong;
                            dtGioCongNgayThuong = _tinhCongBLL.TinhCongGetByMaChamCongAndKyHieuPhu(_tinhCongDTO);
                            for (int iGioCongNgayThuong = 0; iGioCongNgayThuong < dtGioCongNgayThuong.Rows.Count; iGioCongNgayThuong++)
                            {
                                iDemNgayThuong++;
                                dTongGioNgayThuong += Convert.ToDouble(dtGioCongNgayThuong.Rows[iGioCongNgayThuong]["Gio"].ToString());
                                dTongCongNgayThuong += Convert.ToDouble(dtGioCongNgayThuong.Rows[iGioCongNgayThuong]["Cong"].ToString());
                                dTongTangCaNgayThuong += Convert.ToDouble(dtGioCongNgayThuong.Rows[iGioCongNgayThuong]["TC1"].ToString()) + Convert.ToDouble(dtGioCongNgayThuong.Rows[iGioCongNgayThuong]["TC2"].ToString()) + Convert.ToDouble(dtGioCongNgayThuong.Rows[iGioCongNgayThuong]["TC3"].ToString()) + Convert.ToDouble(dtGioCongNgayThuong.Rows[iGioCongNgayThuong]["TC4"].ToString());
                            }
                            (ws_TongHop).get_Range((object)("E" + demNhanVienExportTongHop), (object)("E" + demNhanVienExportTongHop)).Cells[1, 1] = dTongGioNgayThuong;
                            (ws_TongHop).get_Range((object)("G" + demNhanVienExportTongHop), (object)("G" + demNhanVienExportTongHop)).Cells[1, 1] = dTongCongNgayThuong;
                            (ws_TongHop).get_Range((object)("I" + demNhanVienExportTongHop), (object)("I" + demNhanVienExportTongHop)).Cells[1, 1] = dTongTangCaNgayThuong;
                            new DataTable();
                            _tinhCongDTO.MaChamCong = iMaChamCongTongHop;
                            _tinhCongDTO.KyHieuPhu = "CN";
                            DataTable dtGioCongNgayChuNhat;
                            dtGioCongNgayChuNhat = _tinhCongBLL.TinhCongGetByMaChamCongAndKyHieuPhu(_tinhCongDTO);
                            for (int iGioCongNgayChuNhat = 0; iGioCongNgayChuNhat < dtGioCongNgayChuNhat.Rows.Count; iGioCongNgayChuNhat++)
                            {
                                iDemNgayChuNhat++;
                                dTongGioNgayChuNhat += Convert.ToDouble(dtGioCongNgayChuNhat.Rows[iGioCongNgayChuNhat]["Gio"].ToString());
                                dTongCongNgayChuNhat += Convert.ToDouble(dtGioCongNgayChuNhat.Rows[iGioCongNgayChuNhat]["Cong"].ToString());
                                dTongTangCaNgayChuNhat += Convert.ToDouble(dtGioCongNgayChuNhat.Rows[iGioCongNgayChuNhat]["TC1"].ToString()) + Convert.ToDouble(dtGioCongNgayChuNhat.Rows[iGioCongNgayChuNhat]["TC2"].ToString()) + Convert.ToDouble(dtGioCongNgayChuNhat.Rows[iGioCongNgayChuNhat]["TC3"].ToString()) + Convert.ToDouble(dtGioCongNgayChuNhat.Rows[iGioCongNgayChuNhat]["TC4"].ToString());
                            }
                            (ws_TongHop).get_Range((object)("F" + demNhanVienExportTongHop), (object)("F" + demNhanVienExportTongHop)).Cells[1, 1] = dTongGioNgayChuNhat;
                            (ws_TongHop).get_Range((object)("H" + demNhanVienExportTongHop), (object)("H" + demNhanVienExportTongHop)).Cells[1, 1] = dTongCongNgayChuNhat;
                            (ws_TongHop).get_Range((object)("J" + demNhanVienExportTongHop), (object)("J" + demNhanVienExportTongHop)).Cells[1, 1] = dTongTangCaNgayChuNhat;
                            (ws_TongHop).get_Range((object)("K" + demNhanVienExportTongHop), (object)("K" + demNhanVienExportTongHop)).Cells[1, 1] = iTongDiTreTongHop;
                            (ws_TongHop).get_Range((object)("L" + demNhanVienExportTongHop), (object)("L" + demNhanVienExportTongHop)).Cells[1, 1] = iTongVeSomTongHop;
                            new DataTable();
                            _tinhCongDTO.MaChamCong = iMaChamCongTongHop;
                            _tinhCongDTO.KyHieu = sKHLe;
                            DataTable dtNgayLeTongHop;
                            dtNgayLeTongHop = _tinhCongBLL.TinhCongGetByMaChamCongAndLe(_tinhCongDTO);
                            for (int iNgayLeTongHop = 0; iNgayLeTongHop < dtNgayLeTongHop.Rows.Count; iNgayLeTongHop++)
                            {
                                iDemNgayLeTongHop++;
                            }
                            (ws_TongHop).get_Range((object)("N" + demNhanVienExportTongHop), (object)("N" + demNhanVienExportTongHop)).Cells[1, 1] = iDemNgayLeTongHop;
                            new DataTable();
                            _tinhCongDTO.MaChamCong = iMaChamCongTongHop;
                            _tinhCongDTO.KyHieu = sKHPhepNam;
                            DataTable dtPhepNamTongHop;
                            dtPhepNamTongHop = _tinhCongBLL.TinhCongGetByMaChamCongAndLe(_tinhCongDTO);
                            for (int iPhepNamTongHop = 0; iPhepNamTongHop < dtPhepNamTongHop.Rows.Count; iPhepNamTongHop++)
                            {
                                iDemPhepNamTongHop += Convert.ToDouble(dtPhepNamTongHop.Rows[iPhepNamTongHop]["Cong"].ToString());
                            }
                            (ws_TongHop).get_Range((object)("M" + demNhanVienExportTongHop), (object)("M" + demNhanVienExportTongHop)).Cells[1, 1] = iDemPhepNamTongHop;
                            new DataTable();
                            _tinhCongDTO.MaChamCong = iMaChamCongTongHop;
                            _tinhCongDTO.KyHieu = sKHVang;
                            DataTable dtNghiKhongLuongTongHop;
                            dtNghiKhongLuongTongHop = _tinhCongBLL.TinhCongGetByMaChamCongAndLe(_tinhCongDTO);
                            for (int iNghiKhongLuongTongHop = 0; iNghiKhongLuongTongHop < dtNghiKhongLuongTongHop.Rows.Count; iNghiKhongLuongTongHop++)
                            {
                                if (dtNghiKhongLuongTongHop.Rows[iNghiKhongLuongTongHop]["Thu"].ToString() != "CN")
                                {
                                    iDemNghiKhongLuongTongHop++;
                                }
                            }
                            (ws_TongHop).get_Range((object)("P" + demNhanVienExportTongHop), (object)("P" + demNhanVienExportTongHop)).Cells[1, 1] = iDemNghiKhongLuongTongHop;
                            dem++;
                            demNhanVienExportTongHop++;
                        }
                    }
                    Excel.Range excelTruongBoPhanTongHop;
                    excelTruongBoPhanTongHop = (ws_TongHop).get_Range((object)("B" + (demNhanVienExportTongHop + 2)), (object)("D" + (demNhanVienExportTongHop + 2)));
                    excelTruongBoPhanTongHop.Cells[1, 1] = "Trưởng bộ phận";
                    excelTruongBoPhanTongHop.Font.Name = "Times New Roman";
                    excelTruongBoPhanTongHop.Font.Size = "10";
                    excelTruongBoPhanTongHop.get_Range((object)"A1", (object)"C1").Merge(true);
                    excelTruongBoPhanTongHop.HorizontalAlignment = Excel.Constants.xlCenter;
                    Excel.Range excelNguoiLapBieuTongHop;
                    excelNguoiLapBieuTongHop = (ws_TongHop).get_Range((object)("K" + (demNhanVienExportTongHop + 2)), (object)("N" + (demNhanVienExportTongHop + 2)));
                    excelNguoiLapBieuTongHop.Cells[1, 1] = "Người lập biểu";
                    excelNguoiLapBieuTongHop.Font.Name = "Times New Roman";
                    excelNguoiLapBieuTongHop.Font.Size = "10";
                    excelNguoiLapBieuTongHop.get_Range((object)"A1", (object)"D1").Merge(true);
                    excelNguoiLapBieuTongHop.HorizontalAlignment = Excel.Constants.xlCenter;
                    (ws_TongHop).get_Range((object)"A7", (object)"P9").Interior.ColorIndex = 15;
                    Excel.Range excelVienTongHop;
                    excelVienTongHop = (ws_TongHop).get_Range((object)"A7", (object)("P" + (demNhanVienExportTongHop - 1)));
                    excelVienTongHop.Borders.LineStyle = Excel.Constants.xlBoth;
                    excelVienTongHop.HorizontalAlignment = Excel.Constants.xlCenter;
                    Excel.Range excelChuDamTongHop;
                    excelChuDamTongHop = (ws_TongHop).get_Range((object)"A7", (object)"P9");
                    excelChuDamTongHop.HorizontalAlignment = Excel.Constants.xlCenter;
                    excelChuDamTongHop.Font.Bold = true;
                    excelVienTongHop.Font.Name = "Times New Roman";
                    excelVienTongHop.Font.Size = "10";
                    for (int iAuto = 0; iAuto < 4; iAuto++)
                    {
                        ((Excel.Range)ws_TongHop.Cells[1, 1 + iAuto]).EntireColumn.AutoFit();
                    }
                    failed = false;
                }
                catch (COMException)
                {
                    failed = true;
                }
                Thread.Sleep(10);
            }
            while (failed);
        }

        private void ExportExcelChiTietThoiGianLamViec()
        {
            _ = Thread.CurrentThread.CurrentCulture;
            Thread.CurrentThread.CurrentCulture = new CultureInfo("en-US");
            Excel.Application xla_ChiTietThoiGianLamViec;
            xla_ChiTietThoiGianLamViec = new Excel.Application();
            xla_ChiTietThoiGianLamViec.Workbooks.Add(Excel.XlSheetType.xlWorksheet);
            _ = xla_ChiTietThoiGianLamViec.ActiveSheet;
            Excel.Worksheet ws_ChiTietThoiGianLamViec;
            ws_ChiTietThoiGianLamViec = xla_ChiTietThoiGianLamViec.Worksheets.get_Item((object)1);
            DateTime dNgayTinh;
            dNgayTinh = Convert.ToDateTime(dateTimeTuNgay.Text);
            DateTime dNgayBatDauTinhCong;
            dNgayBatDauTinhCong = new DateTime(dNgayTinh.Year, dNgayTinh.Month, dNgayTinh.Day, 0, 0, 0);
            bool failed;
            do
            {
                try
                {
                    Excel.Range excelChiTietThoiGianLamViec_CongTyHeader;
                    excelChiTietThoiGianLamViec_CongTyHeader = (ws_ChiTietThoiGianLamViec).get_Range((object)"A1", (object)"BT1");
                    excelChiTietThoiGianLamViec_CongTyHeader.Cells[1, 1] = sTenCongTyReport;
                    excelChiTietThoiGianLamViec_CongTyHeader.get_Range((object)"A1", (object)"BS1").Merge(true);
                    Excel.Range excelChiTietThoiGianLamViec_DiaChiHeader;
                    excelChiTietThoiGianLamViec_DiaChiHeader = (ws_ChiTietThoiGianLamViec).get_Range((object)"A2", (object)"BT2");
                    excelChiTietThoiGianLamViec_DiaChiHeader.Cells[1, 1] = sDiaChiCongTyReport;
                    excelChiTietThoiGianLamViec_DiaChiHeader.get_Range((object)"A1", (object)"BS1").Merge(true);
                    Excel.Range excelChiTietThoiGianLamViec_DinhDangCongTyHeader;
                    excelChiTietThoiGianLamViec_DinhDangCongTyHeader = (ws_ChiTietThoiGianLamViec).get_Range((object)"A1", (object)"BT2");
                    excelChiTietThoiGianLamViec_DinhDangCongTyHeader.Font.Name = "Times New Roman";
                    excelChiTietThoiGianLamViec_DinhDangCongTyHeader.Font.Size = "11";
                    DateTime dTuNgayChiTietThoiGianLamViec;
                    dTuNgayChiTietThoiGianLamViec = default(DateTime);
                    new DataTable();
                    DataTable dtNgayTinhCongChiTietThoiGianLamViec;
                    dtNgayTinhCongChiTietThoiGianLamViec = _ngayTinhCongBLL.showThongTinNgayTinhCong();
                    for (int iNgayTinhCongChiTietThoiGianLamViec = 0; iNgayTinhCongChiTietThoiGianLamViec < dtNgayTinhCongChiTietThoiGianLamViec.Rows.Count; iNgayTinhCongChiTietThoiGianLamViec++)
                    {
                        dTuNgayChiTietThoiGianLamViec = Convert.ToDateTime(dtNgayTinhCongChiTietThoiGianLamViec.Rows[iNgayTinhCongChiTietThoiGianLamViec]["NgayBatDau"].ToString());
                        sTuNgayChiTietThoiGianLamViec = $"{dTuNgayChiTietThoiGianLamViec:d}";
                        sDenNgayChiTietThoiGianLamViec = string.Format("{0:d}", Convert.ToDateTime(dtNgayTinhCongChiTietThoiGianLamViec.Rows[iNgayTinhCongChiTietThoiGianLamViec]["NgayKetThuc"].ToString()));
                    }
                    Excel.Range excelChiTietThoiGianLamViec_TieuDeHeader;
                    excelChiTietThoiGianLamViec_TieuDeHeader = (ws_ChiTietThoiGianLamViec).get_Range((object)"A4", (object)"BT4");
                    excelChiTietThoiGianLamViec_TieuDeHeader.Cells[1, 1] = "BẢNG CHẤM CÔNG CHI TIẾT TỪ NGÀY " + sTuNgayChiTietThoiGianLamViec + " ĐẾN NGÀY " + sDenNgayChiTietThoiGianLamViec;
                    excelChiTietThoiGianLamViec_TieuDeHeader.get_Range((object)"A1", (object)"BS1").Merge(true);
                    excelChiTietThoiGianLamViec_TieuDeHeader.Font.Name = "Times New Roman";
                    excelChiTietThoiGianLamViec_TieuDeHeader.Font.Size = "14";
                    excelChiTietThoiGianLamViec_TieuDeHeader.Font.Bold = true;
                    excelChiTietThoiGianLamViec_TieuDeHeader.RowHeight = 18;
                    excelChiTietThoiGianLamViec_TieuDeHeader.HorizontalAlignment = Excel.Constants.xlCenter;
                    Excel.Range excelChiTietThoiGianLamViec_STTHeader;
                    excelChiTietThoiGianLamViec_STTHeader = (ws_ChiTietThoiGianLamViec).get_Range((object)"A6", (object)"A8");
                    excelChiTietThoiGianLamViec_STTHeader.Cells[1, 1] = "STT";
                    excelChiTietThoiGianLamViec_STTHeader.get_Range((object)"A1", (object)"A3").MergeCells = true;
                    excelChiTietThoiGianLamViec_STTHeader.VerticalAlignment = HorizontalAlignment.Center;
                    excelChiTietThoiGianLamViec_STTHeader.ColumnWidth = 4;
                    Excel.Range excelChiTietThoiGianLamViec_MaNhanVienHeader;
                    excelChiTietThoiGianLamViec_MaNhanVienHeader = (ws_ChiTietThoiGianLamViec).get_Range((object)"B6", (object)"B8");
                    excelChiTietThoiGianLamViec_MaNhanVienHeader.Cells[1, 1] = "MÃ NHÂN VIÊN";
                    excelChiTietThoiGianLamViec_MaNhanVienHeader.get_Range((object)"A1", (object)"A3").MergeCells = true;
                    excelChiTietThoiGianLamViec_MaNhanVienHeader.VerticalAlignment = HorizontalAlignment.Center;
                    excelChiTietThoiGianLamViec_MaNhanVienHeader.ColumnWidth = 14;
                    Excel.Range excelChiTietThoiGianLamViec_TenNhanVienHeader;
                    excelChiTietThoiGianLamViec_TenNhanVienHeader = (ws_ChiTietThoiGianLamViec).get_Range((object)"C6", (object)"C8");
                    excelChiTietThoiGianLamViec_TenNhanVienHeader.Cells[1, 1] = "TÊN NHÂN VIÊN";
                    excelChiTietThoiGianLamViec_TenNhanVienHeader.get_Range((object)"A1", (object)"A3").MergeCells = true;
                    excelChiTietThoiGianLamViec_TenNhanVienHeader.VerticalAlignment = HorizontalAlignment.Center;
                    excelChiTietThoiGianLamViec_TenNhanVienHeader.ColumnWidth = 14;
                    Excel.Range excelChiTietThoiGianLamViec_PhongBanHeader;
                    excelChiTietThoiGianLamViec_PhongBanHeader = (ws_ChiTietThoiGianLamViec).get_Range((object)"D6", (object)"D8");
                    excelChiTietThoiGianLamViec_PhongBanHeader.Cells[1, 1] = "PHÒNG BAN";
                    excelChiTietThoiGianLamViec_PhongBanHeader.get_Range((object)"A1", (object)"A3").MergeCells = true;
                    excelChiTietThoiGianLamViec_PhongBanHeader.VerticalAlignment = HorizontalAlignment.Center;
                    excelChiTietThoiGianLamViec_PhongBanHeader.ColumnWidth = 11;
                    Excel.Range excelChiTietThoiGianLamViec_NgayTrongThangHeader;
                    excelChiTietThoiGianLamViec_NgayTrongThangHeader = (ws_ChiTietThoiGianLamViec).get_Range((object)"E6", (object)"BN6");
                    excelChiTietThoiGianLamViec_NgayTrongThangHeader.Cells[1, 1] = "NGÀY TRONG THÁNG";
                    excelChiTietThoiGianLamViec_NgayTrongThangHeader.get_Range((object)"A1", (object)"BJ1").Merge(true);
                    int ColunmNgayChiTietThoiGianLamViec;
                    ColunmNgayChiTietThoiGianLamViec = 1;
                    for (int iChiTietThoiGianLamViec3 = 0; iChiTietThoiGianLamViec3 < 31; iChiTietThoiGianLamViec3++)
                    {
                        DateTime dNgayChamChiTietThoiGianLamViec;
                        dNgayChamChiTietThoiGianLamViec = dateTimeTuNgay.Value;
                        int iNgayChamChiTietThoiGianLamViec;
                        iNgayChamChiTietThoiGianLamViec = Convert.ToInt32(Convert.ToDateTime(dNgayChamChiTietThoiGianLamViec.AddDays(iChiTietThoiGianLamViec3).ToString()).Day);
                        Excel.Range excelChiTietThoiGianLamViec_Ngay;
                        excelChiTietThoiGianLamViec_Ngay = (ws_ChiTietThoiGianLamViec).get_Range((object)"E7", (object)"BN8");
                        excelChiTietThoiGianLamViec_Ngay.Cells[1, ColunmNgayChiTietThoiGianLamViec + iChiTietThoiGianLamViec3] = iNgayChamChiTietThoiGianLamViec;
                        if (iChiTietThoiGianLamViec3 == 0)
                        {
                            excelChiTietThoiGianLamViec_Ngay.get_Range((object)"A1", (object)"B1").Merge(true);
                        }
                        if (iChiTietThoiGianLamViec3 == 1)
                        {
                            excelChiTietThoiGianLamViec_Ngay.get_Range((object)"C1", (object)"D1").Merge(true);
                        }
                        if (iChiTietThoiGianLamViec3 == 2)
                        {
                            excelChiTietThoiGianLamViec_Ngay.get_Range((object)"E1", (object)"F1").Merge(true);
                        }
                        if (iChiTietThoiGianLamViec3 == 3)
                        {
                            excelChiTietThoiGianLamViec_Ngay.get_Range((object)"G1", (object)"H1").Merge(true);
                        }
                        if (iChiTietThoiGianLamViec3 == 4)
                        {
                            excelChiTietThoiGianLamViec_Ngay.get_Range((object)"I1", (object)"J1").Merge(true);
                        }
                        if (iChiTietThoiGianLamViec3 == 5)
                        {
                            excelChiTietThoiGianLamViec_Ngay.get_Range((object)"K1", (object)"L1").Merge(true);
                        }
                        if (iChiTietThoiGianLamViec3 == 6)
                        {
                            excelChiTietThoiGianLamViec_Ngay.get_Range((object)"K1", (object)"L1").Merge(true);
                        }
                        if (iChiTietThoiGianLamViec3 == 7)
                        {
                            excelChiTietThoiGianLamViec_Ngay.get_Range((object)"M1", (object)"N1").Merge(true);
                        }
                        if (iChiTietThoiGianLamViec3 == 8)
                        {
                            excelChiTietThoiGianLamViec_Ngay.get_Range((object)"O1", (object)"P1").Merge(true);
                        }
                        if (iChiTietThoiGianLamViec3 == 9)
                        {
                            excelChiTietThoiGianLamViec_Ngay.get_Range((object)"Q1", (object)"R1").Merge(true);
                        }
                        if (iChiTietThoiGianLamViec3 == 10)
                        {
                            excelChiTietThoiGianLamViec_Ngay.get_Range((object)"S1", (object)"T1").Merge(true);
                        }
                        if (iChiTietThoiGianLamViec3 == 11)
                        {
                            excelChiTietThoiGianLamViec_Ngay.get_Range((object)"U1", (object)"V1").Merge(true);
                        }
                        if (iChiTietThoiGianLamViec3 == 12)
                        {
                            excelChiTietThoiGianLamViec_Ngay.get_Range((object)"W1", (object)"X1").Merge(true);
                        }
                        if (iChiTietThoiGianLamViec3 == 13)
                        {
                            excelChiTietThoiGianLamViec_Ngay.get_Range((object)"Y1", (object)"Z1").Merge(true);
                        }
                        if (iChiTietThoiGianLamViec3 == 14)
                        {
                            excelChiTietThoiGianLamViec_Ngay.get_Range((object)"AA1", (object)"AB1").Merge(true);
                        }
                        if (iChiTietThoiGianLamViec3 == 15)
                        {
                            excelChiTietThoiGianLamViec_Ngay.get_Range((object)"AC1", (object)"AD1").Merge(true);
                        }
                        if (iChiTietThoiGianLamViec3 == 16)
                        {
                            excelChiTietThoiGianLamViec_Ngay.get_Range((object)"AE1", (object)"AF1").Merge(true);
                        }
                        if (iChiTietThoiGianLamViec3 == 17)
                        {
                            excelChiTietThoiGianLamViec_Ngay.get_Range((object)"AG1", (object)"AH1").Merge(true);
                        }
                        if (iChiTietThoiGianLamViec3 == 18)
                        {
                            excelChiTietThoiGianLamViec_Ngay.get_Range((object)"AI1", (object)"AJ1").Merge(true);
                        }
                        if (iChiTietThoiGianLamViec3 == 19)
                        {
                            excelChiTietThoiGianLamViec_Ngay.get_Range((object)"AK1", (object)"AL1").Merge(true);
                        }
                        if (iChiTietThoiGianLamViec3 == 20)
                        {
                            excelChiTietThoiGianLamViec_Ngay.get_Range((object)"AM1", (object)"AN1").Merge(true);
                        }
                        if (iChiTietThoiGianLamViec3 == 21)
                        {
                            excelChiTietThoiGianLamViec_Ngay.get_Range((object)"AO1", (object)"AP1").Merge(true);
                        }
                        if (iChiTietThoiGianLamViec3 == 22)
                        {
                            excelChiTietThoiGianLamViec_Ngay.get_Range((object)"AQ1", (object)"AR1").Merge(true);
                        }
                        if (iChiTietThoiGianLamViec3 == 23)
                        {
                            excelChiTietThoiGianLamViec_Ngay.get_Range((object)"AS1", (object)"AT1").Merge(true);
                        }
                        if (iChiTietThoiGianLamViec3 == 24)
                        {
                            excelChiTietThoiGianLamViec_Ngay.get_Range((object)"AU1", (object)"AV1").Merge(true);
                        }
                        if (iChiTietThoiGianLamViec3 == 25)
                        {
                            excelChiTietThoiGianLamViec_Ngay.get_Range((object)"AW1", (object)"AX1").Merge(true);
                        }
                        if (iChiTietThoiGianLamViec3 == 26)
                        {
                            excelChiTietThoiGianLamViec_Ngay.get_Range((object)"AY1", (object)"AZ1").Merge(true);
                        }
                        if (iChiTietThoiGianLamViec3 == 27)
                        {
                            excelChiTietThoiGianLamViec_Ngay.get_Range((object)"BA1", (object)"BB1").Merge(true);
                        }
                        if (iChiTietThoiGianLamViec3 == 28)
                        {
                            excelChiTietThoiGianLamViec_Ngay.get_Range((object)"BC1", (object)"BD1").Merge(true);
                        }
                        if (iChiTietThoiGianLamViec3 == 29)
                        {
                            excelChiTietThoiGianLamViec_Ngay.get_Range((object)"BE1", (object)"BF1").Merge(true);
                        }
                        if (iChiTietThoiGianLamViec3 == 30)
                        {
                            excelChiTietThoiGianLamViec_Ngay.get_Range((object)"BG1", (object)"BH1").Merge(true);
                        }
                        excelChiTietThoiGianLamViec_Ngay.get_Range((object)"BI1", (object)"BJ1").Merge(true);
                        excelChiTietThoiGianLamViec_Ngay.Cells[2, ColunmNgayChiTietThoiGianLamViec + iChiTietThoiGianLamViec3] = DateTimeProgress.XuatThuReport((int)dNgayChamChiTietThoiGianLamViec.AddDays(iChiTietThoiGianLamViec3).DayOfWeek);
                        if (iChiTietThoiGianLamViec3 == 0)
                        {
                            excelChiTietThoiGianLamViec_Ngay.get_Range((object)"A2", (object)"B2").Merge(true);
                        }
                        if (iChiTietThoiGianLamViec3 == 1)
                        {
                            excelChiTietThoiGianLamViec_Ngay.get_Range((object)"C2", (object)"D2").Merge(true);
                        }
                        if (iChiTietThoiGianLamViec3 == 2)
                        {
                            excelChiTietThoiGianLamViec_Ngay.get_Range((object)"E2", (object)"F2").Merge(true);
                        }
                        if (iChiTietThoiGianLamViec3 == 3)
                        {
                            excelChiTietThoiGianLamViec_Ngay.get_Range((object)"G2", (object)"H2").Merge(true);
                        }
                        if (iChiTietThoiGianLamViec3 == 4)
                        {
                            excelChiTietThoiGianLamViec_Ngay.get_Range((object)"I2", (object)"J2").Merge(true);
                        }
                        if (iChiTietThoiGianLamViec3 == 5)
                        {
                            excelChiTietThoiGianLamViec_Ngay.get_Range((object)"K2", (object)"L2").Merge(true);
                        }
                        if (iChiTietThoiGianLamViec3 == 6)
                        {
                            excelChiTietThoiGianLamViec_Ngay.get_Range((object)"K2", (object)"L2").Merge(true);
                        }
                        if (iChiTietThoiGianLamViec3 == 7)
                        {
                            excelChiTietThoiGianLamViec_Ngay.get_Range((object)"M2", (object)"N2").Merge(true);
                        }
                        if (iChiTietThoiGianLamViec3 == 8)
                        {
                            excelChiTietThoiGianLamViec_Ngay.get_Range((object)"O2", (object)"P2").Merge(true);
                        }
                        if (iChiTietThoiGianLamViec3 == 9)
                        {
                            excelChiTietThoiGianLamViec_Ngay.get_Range((object)"Q2", (object)"R2").Merge(true);
                        }
                        if (iChiTietThoiGianLamViec3 == 10)
                        {
                            excelChiTietThoiGianLamViec_Ngay.get_Range((object)"S2", (object)"T2").Merge(true);
                        }
                        if (iChiTietThoiGianLamViec3 == 11)
                        {
                            excelChiTietThoiGianLamViec_Ngay.get_Range((object)"U2", (object)"V2").Merge(true);
                        }
                        if (iChiTietThoiGianLamViec3 == 12)
                        {
                            excelChiTietThoiGianLamViec_Ngay.get_Range((object)"W2", (object)"X2").Merge(true);
                        }
                        if (iChiTietThoiGianLamViec3 == 13)
                        {
                            excelChiTietThoiGianLamViec_Ngay.get_Range((object)"Y2", (object)"Z2").Merge(true);
                        }
                        if (iChiTietThoiGianLamViec3 == 14)
                        {
                            excelChiTietThoiGianLamViec_Ngay.get_Range((object)"AA2", (object)"AB2").Merge(true);
                        }
                        if (iChiTietThoiGianLamViec3 == 15)
                        {
                            excelChiTietThoiGianLamViec_Ngay.get_Range((object)"AC2", (object)"AD2").Merge(true);
                        }
                        if (iChiTietThoiGianLamViec3 == 16)
                        {
                            excelChiTietThoiGianLamViec_Ngay.get_Range((object)"AE2", (object)"AF2").Merge(true);
                        }
                        if (iChiTietThoiGianLamViec3 == 17)
                        {
                            excelChiTietThoiGianLamViec_Ngay.get_Range((object)"AG2", (object)"AH2").Merge(true);
                        }
                        if (iChiTietThoiGianLamViec3 == 18)
                        {
                            excelChiTietThoiGianLamViec_Ngay.get_Range((object)"AI2", (object)"AJ2").Merge(true);
                        }
                        if (iChiTietThoiGianLamViec3 == 19)
                        {
                            excelChiTietThoiGianLamViec_Ngay.get_Range((object)"AK2", (object)"AL2").Merge(true);
                        }
                        if (iChiTietThoiGianLamViec3 == 20)
                        {
                            excelChiTietThoiGianLamViec_Ngay.get_Range((object)"AM2", (object)"AN2").Merge(true);
                        }
                        if (iChiTietThoiGianLamViec3 == 21)
                        {
                            excelChiTietThoiGianLamViec_Ngay.get_Range((object)"AO2", (object)"AP2").Merge(true);
                        }
                        if (iChiTietThoiGianLamViec3 == 22)
                        {
                            excelChiTietThoiGianLamViec_Ngay.get_Range((object)"AQ2", (object)"AR2").Merge(true);
                        }
                        if (iChiTietThoiGianLamViec3 == 23)
                        {
                            excelChiTietThoiGianLamViec_Ngay.get_Range((object)"AS2", (object)"AT2").Merge(true);
                        }
                        if (iChiTietThoiGianLamViec3 == 24)
                        {
                            excelChiTietThoiGianLamViec_Ngay.get_Range((object)"AU2", (object)"AV2").Merge(true);
                        }
                        if (iChiTietThoiGianLamViec3 == 25)
                        {
                            excelChiTietThoiGianLamViec_Ngay.get_Range((object)"AW2", (object)"AX2").Merge(true);
                        }
                        if (iChiTietThoiGianLamViec3 == 26)
                        {
                            excelChiTietThoiGianLamViec_Ngay.get_Range((object)"AY2", (object)"AZ2").Merge(true);
                        }
                        if (iChiTietThoiGianLamViec3 == 27)
                        {
                            excelChiTietThoiGianLamViec_Ngay.get_Range((object)"BA2", (object)"BB2").Merge(true);
                        }
                        if (iChiTietThoiGianLamViec3 == 28)
                        {
                            excelChiTietThoiGianLamViec_Ngay.get_Range((object)"BC2", (object)"BD2").Merge(true);
                        }
                        if (iChiTietThoiGianLamViec3 == 29)
                        {
                            excelChiTietThoiGianLamViec_Ngay.get_Range((object)"BE2", (object)"BF2").Merge(true);
                        }
                        if (iChiTietThoiGianLamViec3 == 30)
                        {
                            excelChiTietThoiGianLamViec_Ngay.get_Range((object)"BG2", (object)"BH2").Merge(true);
                        }
                        excelChiTietThoiGianLamViec_Ngay.get_Range((object)"BI2", (object)"BJ2").Merge(true);
                        ColunmNgayChiTietThoiGianLamViec++;
                        excelChiTietThoiGianLamViec_Ngay.ColumnWidth = 4;
                    }
                    Excel.Range excelChiTietThoiGianLamViec_TongGioCongHeader;
                    excelChiTietThoiGianLamViec_TongGioCongHeader = (ws_ChiTietThoiGianLamViec).get_Range((object)"BO6", (object)"BO8");
                    excelChiTietThoiGianLamViec_TongGioCongHeader.Cells[1, 1] = "TỔNG GIỜ CÔNG";
                    excelChiTietThoiGianLamViec_TongGioCongHeader.get_Range((object)"A1", (object)"A3").MergeCells = true;
                    excelChiTietThoiGianLamViec_TongGioCongHeader.ColumnWidth = 10;
                    excelChiTietThoiGianLamViec_TongGioCongHeader.VerticalAlignment = HorizontalAlignment.Center;
                    excelChiTietThoiGianLamViec_TongGioCongHeader.WrapText = true;
                    Excel.Range excelChiTietThoiGianLamViec_TongNgayHeader;
                    excelChiTietThoiGianLamViec_TongNgayHeader = (ws_ChiTietThoiGianLamViec).get_Range((object)"BP6", (object)"BP8");
                    excelChiTietThoiGianLamViec_TongNgayHeader.Cells[1, 1] = "TỔNG NGÀY";
                    excelChiTietThoiGianLamViec_TongNgayHeader.get_Range((object)"A1", (object)"A3").MergeCells = true;
                    excelChiTietThoiGianLamViec_TongNgayHeader.ColumnWidth = 10;
                    excelChiTietThoiGianLamViec_TongNgayHeader.VerticalAlignment = HorizontalAlignment.Center;
                    excelChiTietThoiGianLamViec_TongNgayHeader.WrapText = true;
                    Excel.Range excelChiTietThoiGianLamViec_TongGioTangCaHeader;
                    excelChiTietThoiGianLamViec_TongGioTangCaHeader = (ws_ChiTietThoiGianLamViec).get_Range((object)"BQ6", (object)"BQ8");
                    excelChiTietThoiGianLamViec_TongGioTangCaHeader.Cells[1, 1] = "TỔNG GIỜ TĂNG CA";
                    excelChiTietThoiGianLamViec_TongGioTangCaHeader.get_Range((object)"A1", (object)"A3").MergeCells = true;
                    excelChiTietThoiGianLamViec_TongGioTangCaHeader.ColumnWidth = 10;
                    excelChiTietThoiGianLamViec_TongGioTangCaHeader.VerticalAlignment = HorizontalAlignment.Center;
                    excelChiTietThoiGianLamViec_TongGioTangCaHeader.WrapText = true;
                    Excel.Range excelChiTietThoiGianLamViec_TongPhutTreHeader;
                    excelChiTietThoiGianLamViec_TongPhutTreHeader = (ws_ChiTietThoiGianLamViec).get_Range((object)"BR6", (object)"BR8");
                    excelChiTietThoiGianLamViec_TongPhutTreHeader.Cells[1, 1] = "TỔNG PHÚT TRỄ";
                    excelChiTietThoiGianLamViec_TongPhutTreHeader.get_Range((object)"A1", (object)"A3").MergeCells = true;
                    excelChiTietThoiGianLamViec_TongPhutTreHeader.ColumnWidth = 10;
                    excelChiTietThoiGianLamViec_TongPhutTreHeader.VerticalAlignment = HorizontalAlignment.Center;
                    excelChiTietThoiGianLamViec_TongPhutTreHeader.WrapText = true;
                    Excel.Range excelChiTietThoiGianLamViec_TongPhutSomHeader;
                    excelChiTietThoiGianLamViec_TongPhutSomHeader = (ws_ChiTietThoiGianLamViec).get_Range((object)"BS6", (object)"BS8");
                    excelChiTietThoiGianLamViec_TongPhutSomHeader.Cells[1, 1] = "TỔNG PHÚT SỚM";
                    excelChiTietThoiGianLamViec_TongPhutSomHeader.get_Range((object)"A1", (object)"A3").MergeCells = true;
                    excelChiTietThoiGianLamViec_TongPhutSomHeader.ColumnWidth = 10;
                    excelChiTietThoiGianLamViec_TongPhutSomHeader.VerticalAlignment = HorizontalAlignment.Center;
                    excelChiTietThoiGianLamViec_TongPhutSomHeader.WrapText = true;
                    Excel.Range excelChiTietThoiGianLamViec_DinhDangHeader;
                    excelChiTietThoiGianLamViec_DinhDangHeader = (ws_ChiTietThoiGianLamViec).get_Range((object)"A6", (object)"BS8");
                    excelChiTietThoiGianLamViec_DinhDangHeader.Font.Name = "Times New Roman";
                    excelChiTietThoiGianLamViec_DinhDangHeader.Font.Size = "10";
                    excelChiTietThoiGianLamViec_DinhDangHeader.Font.Bold = true;
                    excelChiTietThoiGianLamViec_DinhDangHeader.HorizontalAlignment = Excel.Constants.xlCenter;
                    excelChiTietThoiGianLamViec_DinhDangHeader.Borders.LineStyle = Excel.Constants.xlBoth;
                    excelChiTietThoiGianLamViec_DinhDangHeader.Interior.Color = ColorTranslator.ToOle(Color.Aqua);
                    xla_ChiTietThoiGianLamViec.Visible = true;
                    if (iChonLanXuat == 1)
                    {
                        int iTangHang;
                        iTangHang = 9;
                        int iDemNhanVienChiTietThoiGianLamViec3;
                        iDemNhanVienChiTietThoiGianLamViec3 = 0;
                        int iDemSTTChiTietThoiGianLamViec3;
                        iDemSTTChiTietThoiGianLamViec3 = 0;
                        int iTongDongChiTietThoiGianLamViec3;
                        iTongDongChiTietThoiGianLamViec3 = 9;
                        new DataTable();
                        _tinhCongDTO.Ngay = dNgayBatDauTinhCong;
                        int iMaChamCongChiTietThoiGianLamViec3;
                        iMaChamCongChiTietThoiGianLamViec3 = 0;
                        DataTable dtNhanVienChiTietThoiGianLamViec3;
                        dtNhanVienChiTietThoiGianLamViec3 = _tinhCongBLL.TinhCongGetNgay(_tinhCongDTO);
                        for (int iNhanVienChiTietThoiGianLamViec3 = 0; iNhanVienChiTietThoiGianLamViec3 < dtNhanVienChiTietThoiGianLamViec3.Rows.Count; iNhanVienChiTietThoiGianLamViec3++)
                        {
                            if (Convert.ToInt32(dtNhanVienChiTietThoiGianLamViec3.Rows[iNhanVienChiTietThoiGianLamViec3]["MaChamCong"].ToString()) == iMaChamCongChiTietThoiGianLamViec3)
                            {
                                continue;
                            }
                            iDemSTTChiTietThoiGianLamViec3++;
                            iMaChamCongChiTietThoiGianLamViec3 = Convert.ToInt32(dtNhanVienChiTietThoiGianLamViec3.Rows[iNhanVienChiTietThoiGianLamViec3]["MaChamCong"].ToString());
                            string sMaNhanVienChiTietThoiGianLamViec3;
                            sMaNhanVienChiTietThoiGianLamViec3 = dtNhanVienChiTietThoiGianLamViec3.Rows[iNhanVienChiTietThoiGianLamViec3]["MaNhanVien"].ToString();
                            string sTenNhanVienChiTietThoiGianLamViec3;
                            sTenNhanVienChiTietThoiGianLamViec3 = dtNhanVienChiTietThoiGianLamViec3.Rows[iNhanVienChiTietThoiGianLamViec3]["TenNhanVien"].ToString();
                            Excel.Range excelChiTietThoiGianLamViec_STTDuLieu3;
                            excelChiTietThoiGianLamViec_STTDuLieu3 = (ws_ChiTietThoiGianLamViec).get_Range((object)("A" + (iTongDongChiTietThoiGianLamViec3 + iDemNhanVienChiTietThoiGianLamViec3 * 2)), (object)("A" + (iTongDongChiTietThoiGianLamViec3 + iDemNhanVienChiTietThoiGianLamViec3 * 2)));
                            excelChiTietThoiGianLamViec_STTDuLieu3.Cells[1, 1] = iDemSTTChiTietThoiGianLamViec3;
                            excelChiTietThoiGianLamViec_STTDuLieu3.get_Range((object)"A1", (object)"A2").MergeCells = true;
                            excelChiTietThoiGianLamViec_STTDuLieu3.Select();
                            Excel.Range excelChiTietThoiGianLamViec_MaNhanVienDuLieu3;
                            excelChiTietThoiGianLamViec_MaNhanVienDuLieu3 = (ws_ChiTietThoiGianLamViec).get_Range((object)("B" + (iTongDongChiTietThoiGianLamViec3 + iDemNhanVienChiTietThoiGianLamViec3 * 2)), (object)("B" + (iTongDongChiTietThoiGianLamViec3 + iDemNhanVienChiTietThoiGianLamViec3 * 2)));
                            excelChiTietThoiGianLamViec_MaNhanVienDuLieu3.get_Range((object)"A1", (object)"A2").NumberFormat = "@";
                            excelChiTietThoiGianLamViec_MaNhanVienDuLieu3.get_Range((object)"A1", (object)"A2").MergeCells = true;
                            excelChiTietThoiGianLamViec_MaNhanVienDuLieu3.Cells[1, 1] = sMaNhanVienChiTietThoiGianLamViec3;
                            Excel.Range excelChiTietThoiGianLamViec_TenNhanVienDuLieu3;
                            excelChiTietThoiGianLamViec_TenNhanVienDuLieu3 = (ws_ChiTietThoiGianLamViec).get_Range((object)("C" + (iTongDongChiTietThoiGianLamViec3 + iDemNhanVienChiTietThoiGianLamViec3 * 2)), (object)("C" + (iTongDongChiTietThoiGianLamViec3 + iDemNhanVienChiTietThoiGianLamViec3 * 2)));
                            excelChiTietThoiGianLamViec_TenNhanVienDuLieu3.Cells[1, 1] = sTenNhanVienChiTietThoiGianLamViec3;
                            excelChiTietThoiGianLamViec_TenNhanVienDuLieu3.get_Range((object)"A1", (object)"A2").MergeCells = true;
                            string sTenPhongBan3;
                            sTenPhongBan3 = "";
                            new DataTable();
                            _phongBanDTO.MaPhongBan = dtNhanVienChiTietThoiGianLamViec3.Rows[iNhanVienChiTietThoiGianLamViec3]["PhongBan"].ToString();
                            DataTable dtPhongBan3;
                            dtPhongBan3 = _phongBanBLL.getTenPhongBanByMaPhongBan(_phongBanDTO);
                            for (int iPhongBan3 = 0; iPhongBan3 < dtPhongBan3.Rows.Count; iPhongBan3++)
                            {
                                sTenPhongBan3 = dtPhongBan3.Rows[iPhongBan3]["TenPhongBan"].ToString();
                            }
                            Excel.Range excelChiTietThoiGianLamViec_PhongBanDuLieu3;
                            excelChiTietThoiGianLamViec_PhongBanDuLieu3 = (ws_ChiTietThoiGianLamViec).get_Range((object)("D" + (iTongDongChiTietThoiGianLamViec3 + iDemNhanVienChiTietThoiGianLamViec3 * 2)), (object)("D" + (iTongDongChiTietThoiGianLamViec3 + iDemNhanVienChiTietThoiGianLamViec3 * 2)));
                            excelChiTietThoiGianLamViec_PhongBanDuLieu3.get_Range((object)"A1", (object)"A2").MergeCells = true;
                            if (sTenPhongBan3 == "")
                            {
                                excelChiTietThoiGianLamViec_PhongBanDuLieu3.Cells[1, 1] = "------";
                            }
                            else
                            {
                                excelChiTietThoiGianLamViec_PhongBanDuLieu3.Cells[1, 1] = sTenPhongBan3;
                            }
                            int iDemNgayChiTietThoiGianLamViec3;
                            iDemNgayChiTietThoiGianLamViec3 = 0;
                            int iCotGioVao3;
                            iCotGioVao3 = 1;
                            int iCotGioRa3;
                            iCotGioRa3 = 2;
                            int iTangCot;
                            iTangCot = 5;
                            for (int iGioChamChiTietThoiGianLamViec3 = 0; iGioChamChiTietThoiGianLamViec3 < 31; iGioChamChiTietThoiGianLamViec3++)
                            {
                                string sGioVao2;
                                sGioVao2 = "";
                                string sGioRa2;
                                sGioRa2 = "";
                                DateTime dNgayChiTietThoiGianLamViec3;
                                dNgayChiTietThoiGianLamViec3 = Convert.ToDateTime(dNgayBatDauTinhCong.AddDays(iDemNgayChiTietThoiGianLamViec3).ToString());
                                new DataTable();
                                _tinhCongDTO.MaChamCong = iMaChamCongChiTietThoiGianLamViec3;
                                _tinhCongDTO.Ngay = dNgayChiTietThoiGianLamViec3;
                                DataTable dtDuLieuGioChiTietThoiGianLamViec3;
                                dtDuLieuGioChiTietThoiGianLamViec3 = _tinhCongBLL.TinhCongGetMaChamCongAndNgayChiTietThoiGian(_tinhCongDTO);
                                int iDuLieuGioChiTietThoiGianLamViec3;
                                iDuLieuGioChiTietThoiGianLamViec3 = 0;
                                if (iDuLieuGioChiTietThoiGianLamViec3 < dtDuLieuGioChiTietThoiGianLamViec3.Rows.Count)
                                {
                                    string sThu;
                                    sThu = dtDuLieuGioChiTietThoiGianLamViec3.Rows[iDuLieuGioChiTietThoiGianLamViec3]["Thu"].ToString();
                                    string sGioVaoChiTietThoiGianLamViec3;
                                    sGioVaoChiTietThoiGianLamViec3 = dtDuLieuGioChiTietThoiGianLamViec3.Rows[iDuLieuGioChiTietThoiGianLamViec3]["GioVao"].ToString();
                                    string sGioRaChiTietThoiGianLamViec3;
                                    sGioRaChiTietThoiGianLamViec3 = dtDuLieuGioChiTietThoiGianLamViec3.Rows[iDuLieuGioChiTietThoiGianLamViec3]["GioRa"].ToString();
                                    double dGioTungNgayChiTietThoiGianLamViec3;
                                    dGioTungNgayChiTietThoiGianLamViec3 = Convert.ToDouble(dtDuLieuGioChiTietThoiGianLamViec3.Rows[iDuLieuGioChiTietThoiGianLamViec3]["Gio"].ToString());
                                    double dTongGioTangCaNgayChiTietThoiGianLamViec3;
                                    dTongGioTangCaNgayChiTietThoiGianLamViec3 = Convert.ToDouble(dtDuLieuGioChiTietThoiGianLamViec3.Rows[iDuLieuGioChiTietThoiGianLamViec3]["TC1"]) + Convert.ToDouble(dtDuLieuGioChiTietThoiGianLamViec3.Rows[iDuLieuGioChiTietThoiGianLamViec3]["TC2"]);
                                    if (sGioVaoChiTietThoiGianLamViec3 != "")
                                    {
                                        DateTime dGioVao3;
                                        dGioVao3 = Convert.ToDateTime(sGioVaoChiTietThoiGianLamViec3);
                                        sGioVao2 = dGioVao3.Hour + ":" + dGioVao3.Minute;
                                    }
                                    if (sGioRaChiTietThoiGianLamViec3 != "")
                                    {
                                        DateTime dGioRa3;
                                        dGioRa3 = Convert.ToDateTime(sGioRaChiTietThoiGianLamViec3);
                                        sGioRa2 = dGioRa3.Hour + ":" + dGioRa3.Minute;
                                    }
                                    (ws_ChiTietThoiGianLamViec).get_Range((object)("E" + (iTongDongChiTietThoiGianLamViec3 + iDemNhanVienChiTietThoiGianLamViec3 * 2)), (object)("BN" + (iTongDongChiTietThoiGianLamViec3 + iDemNhanVienChiTietThoiGianLamViec3 * 2))).Cells[1, iCotGioVao3] = sGioVao2;
                                    (ws_ChiTietThoiGianLamViec).get_Range((object)("E" + (iTongDongChiTietThoiGianLamViec3 + iDemNhanVienChiTietThoiGianLamViec3 * 2)), (object)("BN" + (iTongDongChiTietThoiGianLamViec3 + iDemNhanVienChiTietThoiGianLamViec3 * 2))).Cells[1, iCotGioRa3] = sGioRa2;
                                    (ws_ChiTietThoiGianLamViec).get_Range((object)("E" + (iTongDongChiTietThoiGianLamViec3 + iDemNhanVienChiTietThoiGianLamViec3 * 2 + 1)), (object)("BN" + (iTongDongChiTietThoiGianLamViec3 + iDemNhanVienChiTietThoiGianLamViec3 * 2 + 1))).Cells[1, iCotGioVao3] = dGioTungNgayChiTietThoiGianLamViec3;
                                    (ws_ChiTietThoiGianLamViec).get_Range((object)("E" + (iTongDongChiTietThoiGianLamViec3 + iDemNhanVienChiTietThoiGianLamViec3 * 2 + 1)), (object)("BN" + (iTongDongChiTietThoiGianLamViec3 + iDemNhanVienChiTietThoiGianLamViec3 * 2 + 1))).Cells[1, iCotGioRa3] = dTongGioTangCaNgayChiTietThoiGianLamViec3;
                                    if (sThu == "CN")
                                    {
                                        Excel.Range fuckVisual5;
                                        fuckVisual5 = (ws_ChiTietThoiGianLamViec).get_Range(ws_ChiTietThoiGianLamViec.Cells[iTangHang - 1, iTangCot], ws_ChiTietThoiGianLamViec.Cells[iTangHang, iTangCot + 1]);
                                        Excel.Range fuckVisual6;
                                        fuckVisual6 = (ws_ChiTietThoiGianLamViec).get_Range(ws_ChiTietThoiGianLamViec.Cells[iTangHang - 2, iTangCot], ws_ChiTietThoiGianLamViec.Cells[iTangHang, iTangCot + 1]);
                                        Excel.Range fuckVisual3;
                                        fuckVisual3 = (ws_ChiTietThoiGianLamViec).get_Range(ws_ChiTietThoiGianLamViec.Cells[iTangHang + 1, iTangCot], ws_ChiTietThoiGianLamViec.Cells[iTangHang, iTangCot + 1]);
                                        Excel.Range fuckVisual4;
                                        fuckVisual4 = (ws_ChiTietThoiGianLamViec).get_Range(ws_ChiTietThoiGianLamViec.Cells[iTangHang + 1, iTangCot + 1], ws_ChiTietThoiGianLamViec.Cells[iTangHang, iTangCot + 1]);
                                        fuckVisual3.Interior.Color = ColorTranslator.ToOle(Color.PaleGoldenrod);
                                        fuckVisual4.Interior.Color = ColorTranslator.ToOle(Color.PaleGoldenrod);
                                        fuckVisual5.Interior.Color = ColorTranslator.ToOle(Color.PaleGoldenrod);
                                        fuckVisual6.Interior.Color = ColorTranslator.ToOle(Color.PaleGoldenrod);
                                    }
                                }
                                iCotGioVao3 = iCotGioVao3 + 1 + 1;
                                iCotGioRa3 = iCotGioRa3 + 1 + 1;
                                iDemNgayChiTietThoiGianLamViec3++;
                                iTangCot = iTangCot + 1 + 1;
                            }
                            double dTongGioChiTietThoiGianLamViec3;
                            dTongGioChiTietThoiGianLamViec3 = 0.0;
                            double dTongCongChiTietThoiGianLamViec3;
                            dTongCongChiTietThoiGianLamViec3 = 0.0;
                            double dTongTangCaChiTietThoiGianLamViec3;
                            dTongTangCaChiTietThoiGianLamViec3 = 0.0;
                            int iTongPhutTreChiTietThoiGianLamViec3;
                            iTongPhutTreChiTietThoiGianLamViec3 = 0;
                            int iTongPhutSomChiTietThoiGianLamViec3;
                            iTongPhutSomChiTietThoiGianLamViec3 = 0;
                            new DataTable();
                            _tinhCongDTO.MaChamCong = iMaChamCongChiTietThoiGianLamViec3;
                            DataTable dtChiTietThoiGianLamViec3;
                            dtChiTietThoiGianLamViec3 = _tinhCongBLL.TinhCongGetByMaChamCong(_tinhCongDTO);
                            for (int iChiTietThoiGianLamViec4 = 0; iChiTietThoiGianLamViec4 < dtChiTietThoiGianLamViec3.Rows.Count; iChiTietThoiGianLamViec4++)
                            {
                                dTongGioChiTietThoiGianLamViec3 += Convert.ToDouble(dtChiTietThoiGianLamViec3.Rows[iChiTietThoiGianLamViec4]["Gio"].ToString());
                                dTongCongChiTietThoiGianLamViec3 += Convert.ToDouble(dtChiTietThoiGianLamViec3.Rows[iChiTietThoiGianLamViec4]["Cong"].ToString());
                                dTongTangCaChiTietThoiGianLamViec3 += Convert.ToDouble(dtChiTietThoiGianLamViec3.Rows[iChiTietThoiGianLamViec4]["TC1"].ToString()) + Convert.ToDouble(dtChiTietThoiGianLamViec3.Rows[iChiTietThoiGianLamViec4]["TC2"].ToString()) + Convert.ToDouble(dtChiTietThoiGianLamViec3.Rows[iChiTietThoiGianLamViec4]["TC3"].ToString()) + Convert.ToDouble(dtChiTietThoiGianLamViec3.Rows[iChiTietThoiGianLamViec4]["TC4"].ToString());
                                iTongPhutTreChiTietThoiGianLamViec3 += Convert.ToInt32(dtChiTietThoiGianLamViec3.Rows[iChiTietThoiGianLamViec4]["Tre"].ToString());
                                iTongPhutSomChiTietThoiGianLamViec3 += Convert.ToInt32(dtChiTietThoiGianLamViec3.Rows[iChiTietThoiGianLamViec4]["VeSom"].ToString());
                            }
                            Excel.Range excelChiTietThoiGianLamViec_TongGioDuLieu3;
                            excelChiTietThoiGianLamViec_TongGioDuLieu3 = (ws_ChiTietThoiGianLamViec).get_Range((object)("BO" + (iTongDongChiTietThoiGianLamViec3 + iDemNhanVienChiTietThoiGianLamViec3 * 2)), (object)("BO" + (iTongDongChiTietThoiGianLamViec3 + iDemNhanVienChiTietThoiGianLamViec3 * 2) + 1));
                            excelChiTietThoiGianLamViec_TongGioDuLieu3.Cells[1, 1] = dTongGioChiTietThoiGianLamViec3;
                            excelChiTietThoiGianLamViec_TongGioDuLieu3.get_Range((object)"A1", (object)"A2").MergeCells = true;
                            Excel.Range excelChiTietThoiGianLamViec_TongCongDuLieu3;
                            excelChiTietThoiGianLamViec_TongCongDuLieu3 = (ws_ChiTietThoiGianLamViec).get_Range((object)("BP" + (iTongDongChiTietThoiGianLamViec3 + iDemNhanVienChiTietThoiGianLamViec3 * 2)), (object)("BP" + (iTongDongChiTietThoiGianLamViec3 + iDemNhanVienChiTietThoiGianLamViec3 * 2) + 1));
                            excelChiTietThoiGianLamViec_TongCongDuLieu3.Cells[1, 1] = dTongCongChiTietThoiGianLamViec3;
                            excelChiTietThoiGianLamViec_TongCongDuLieu3.get_Range((object)"A1", (object)"A2").MergeCells = true;
                            Excel.Range excelChiTietThoiGianLamViec_TongTangCaDuLieu3;
                            excelChiTietThoiGianLamViec_TongTangCaDuLieu3 = (ws_ChiTietThoiGianLamViec).get_Range((object)("BQ" + (iTongDongChiTietThoiGianLamViec3 + iDemNhanVienChiTietThoiGianLamViec3 * 2)), (object)("BQ" + (iTongDongChiTietThoiGianLamViec3 + iDemNhanVienChiTietThoiGianLamViec3 * 2) + 1));
                            excelChiTietThoiGianLamViec_TongTangCaDuLieu3.Cells[1, 1] = dTongTangCaChiTietThoiGianLamViec3;
                            excelChiTietThoiGianLamViec_TongTangCaDuLieu3.get_Range((object)"A1", (object)"A2").MergeCells = true;
                            Excel.Range excelChiTietThoiGianLamViec_TongPhutTreDuLieu3;
                            excelChiTietThoiGianLamViec_TongPhutTreDuLieu3 = (ws_ChiTietThoiGianLamViec).get_Range((object)("BR" + (iTongDongChiTietThoiGianLamViec3 + iDemNhanVienChiTietThoiGianLamViec3 * 2)), (object)("BR" + (iTongDongChiTietThoiGianLamViec3 + iDemNhanVienChiTietThoiGianLamViec3 * 2) + 1));
                            excelChiTietThoiGianLamViec_TongPhutTreDuLieu3.Cells[1, 1] = iTongPhutTreChiTietThoiGianLamViec3;
                            excelChiTietThoiGianLamViec_TongPhutTreDuLieu3.get_Range((object)"A1", (object)"A2").MergeCells = true;
                            Excel.Range excelChiTietThoiGianLamViec_TongPhutSomDuLieu3;
                            excelChiTietThoiGianLamViec_TongPhutSomDuLieu3 = (ws_ChiTietThoiGianLamViec).get_Range((object)("BS" + (iTongDongChiTietThoiGianLamViec3 + iDemNhanVienChiTietThoiGianLamViec3 * 2)), (object)("BS" + (iTongDongChiTietThoiGianLamViec3 + iDemNhanVienChiTietThoiGianLamViec3 * 2) + 1));
                            excelChiTietThoiGianLamViec_TongPhutSomDuLieu3.Cells[1, 1] = iTongPhutSomChiTietThoiGianLamViec3;
                            excelChiTietThoiGianLamViec_TongPhutSomDuLieu3.get_Range((object)"A1", (object)"A2").MergeCells = true;
                            iDemNhanVienChiTietThoiGianLamViec3++;
                            iTangHang = iTangHang + 1 + 1;
                        }
                        ws_ChiTietThoiGianLamViec.PageSetup.Orientation = Excel.XlPageOrientation.xlLandscape;
                        ws_ChiTietThoiGianLamViec.PageSetup.PaperSize = Excel.XlPaperSize.xlPaperA4;
                        ws_ChiTietThoiGianLamViec.PageSetup.LeftMargin = 13.0;
                        ws_ChiTietThoiGianLamViec.PageSetup.RightMargin = 0.0;
                        ws_ChiTietThoiGianLamViec.PageSetup.BottomMargin = 0.0;
                        ws_ChiTietThoiGianLamViec.PageSetup.TopMargin = 0.0;
                        ws_ChiTietThoiGianLamViec.PageSetup.Zoom = 46;
                        Excel.Range excelChiTietThoiGianLamViec_DinhDangDuLieu3;
                        excelChiTietThoiGianLamViec_DinhDangDuLieu3 = (ws_ChiTietThoiGianLamViec).get_Range((object)"A9", (object)("BS" + (iTongDongChiTietThoiGianLamViec3 + iDemNhanVienChiTietThoiGianLamViec3 * 2 - 1)));
                        excelChiTietThoiGianLamViec_DinhDangDuLieu3.Font.Name = "Times New Roman";
                        excelChiTietThoiGianLamViec_DinhDangDuLieu3.Font.Size = "8";
                        excelChiTietThoiGianLamViec_DinhDangDuLieu3.HorizontalAlignment = Excel.Constants.xlCenter;
                        excelChiTietThoiGianLamViec_DinhDangDuLieu3.Borders.LineStyle = Excel.Constants.xlBoth;
                    }
                    if (iChonLanXuat == 2)
                    {
                        int iDemNhanVienChiTietThoiGianLamViec2;
                        iDemNhanVienChiTietThoiGianLamViec2 = 0;
                        int iDemSTTChiTietThoiGianLamViec2;
                        iDemSTTChiTietThoiGianLamViec2 = 0;
                        int iTongDongChiTietThoiGianLamViec2;
                        iTongDongChiTietThoiGianLamViec2 = 9;
                        new DataTable();
                        _tinhCongDTO.Ngay = dTuNgayChiTietThoiGianLamViec;
                        int iMaChamCongChiTietThoiGianLamViec2;
                        iMaChamCongChiTietThoiGianLamViec2 = 0;
                        DataTable dtNhanVienChiTietThoiGianLamViec2;
                        dtNhanVienChiTietThoiGianLamViec2 = _tinhCongBLL.TinhCongGetNgay(_tinhCongDTO);
                        for (int iNhanVienChiTietThoiGianLamViec2 = 0; iNhanVienChiTietThoiGianLamViec2 < dtNhanVienChiTietThoiGianLamViec2.Rows.Count; iNhanVienChiTietThoiGianLamViec2++)
                        {
                            if (Convert.ToInt32(dtNhanVienChiTietThoiGianLamViec2.Rows[iNhanVienChiTietThoiGianLamViec2]["MaChamCong"].ToString()) == iMaChamCongChiTietThoiGianLamViec2)
                            {
                                continue;
                            }
                            iDemSTTChiTietThoiGianLamViec2++;
                            iMaChamCongChiTietThoiGianLamViec2 = Convert.ToInt32(dtNhanVienChiTietThoiGianLamViec2.Rows[iNhanVienChiTietThoiGianLamViec2]["MaChamCong"].ToString());
                            string sMaNhanVienChiTietThoiGianLamViec2;
                            sMaNhanVienChiTietThoiGianLamViec2 = dtNhanVienChiTietThoiGianLamViec2.Rows[iNhanVienChiTietThoiGianLamViec2]["MaNhanVien"].ToString();
                            string sTenNhanVienChiTietThoiGianLamViec2;
                            sTenNhanVienChiTietThoiGianLamViec2 = dtNhanVienChiTietThoiGianLamViec2.Rows[iNhanVienChiTietThoiGianLamViec2]["TenNhanVien"].ToString();
                            Excel.Range excelChiTietThoiGianLamViec_STTDuLieu2;
                            excelChiTietThoiGianLamViec_STTDuLieu2 = (ws_ChiTietThoiGianLamViec).get_Range((object)("A" + (iTongDongChiTietThoiGianLamViec2 + iDemNhanVienChiTietThoiGianLamViec2 * 3)), (object)("A" + (iTongDongChiTietThoiGianLamViec2 + iDemNhanVienChiTietThoiGianLamViec2 * 3)));
                            excelChiTietThoiGianLamViec_STTDuLieu2.get_Range((object)"A1", (object)"A3").MergeCells = true;
                            excelChiTietThoiGianLamViec_STTDuLieu2.Cells[1, 1] = iDemSTTChiTietThoiGianLamViec2.ToString();
                            excelChiTietThoiGianLamViec_STTDuLieu2.Select();
                            Excel.Range excelChiTietThoiGianLamViec_MaNhanVienDuLieu2;
                            excelChiTietThoiGianLamViec_MaNhanVienDuLieu2 = (ws_ChiTietThoiGianLamViec).get_Range((object)("B" + (iTongDongChiTietThoiGianLamViec2 + iDemNhanVienChiTietThoiGianLamViec2 * 3)), (object)("B" + (iTongDongChiTietThoiGianLamViec2 + iDemNhanVienChiTietThoiGianLamViec2 * 3)));
                            excelChiTietThoiGianLamViec_MaNhanVienDuLieu2.get_Range((object)"A1", (object)"A1").NumberFormat = "@";
                            excelChiTietThoiGianLamViec_MaNhanVienDuLieu2.get_Range((object)"A1", (object)"A3").MergeCells = true;
                            excelChiTietThoiGianLamViec_MaNhanVienDuLieu2.Cells[1, 1] = sMaNhanVienChiTietThoiGianLamViec2;
                            Excel.Range excelChiTietThoiGianLamViec_TenNhanVienDuLieu2;
                            excelChiTietThoiGianLamViec_TenNhanVienDuLieu2 = (ws_ChiTietThoiGianLamViec).get_Range((object)("C" + (iTongDongChiTietThoiGianLamViec2 + iDemNhanVienChiTietThoiGianLamViec2 * 3)), (object)("C" + (iTongDongChiTietThoiGianLamViec2 + iDemNhanVienChiTietThoiGianLamViec2 * 3)));
                            excelChiTietThoiGianLamViec_TenNhanVienDuLieu2.get_Range((object)"A1", (object)"A3").MergeCells = true;
                            excelChiTietThoiGianLamViec_TenNhanVienDuLieu2.Cells[1, 1] = sTenNhanVienChiTietThoiGianLamViec2;
                            string sTenPhongBan2;
                            sTenPhongBan2 = "";
                            new DataTable();
                            _phongBanDTO.MaPhongBan = dtNhanVienChiTietThoiGianLamViec2.Rows[iNhanVienChiTietThoiGianLamViec2]["PhongBan"].ToString();
                            DataTable dtPhongBan2;
                            dtPhongBan2 = _phongBanBLL.getTenPhongBanByMaPhongBan(_phongBanDTO);
                            for (int iPhongBan2 = 0; iPhongBan2 < dtPhongBan2.Rows.Count; iPhongBan2++)
                            {
                                sTenPhongBan2 = dtPhongBan2.Rows[iPhongBan2]["TenPhongBan"].ToString();
                            }
                            Excel.Range excelChiTietThoiGianLamViec_PhongBanDuLieu2;
                            excelChiTietThoiGianLamViec_PhongBanDuLieu2 = (ws_ChiTietThoiGianLamViec).get_Range((object)("D" + (iTongDongChiTietThoiGianLamViec2 + iDemNhanVienChiTietThoiGianLamViec2 * 3)), (object)("D" + (iTongDongChiTietThoiGianLamViec2 + iDemNhanVienChiTietThoiGianLamViec2 * 3)));
                            excelChiTietThoiGianLamViec_PhongBanDuLieu2.get_Range((object)"A1", (object)"A3").MergeCells = true;
                            if (sTenPhongBan2 == "")
                            {
                                excelChiTietThoiGianLamViec_PhongBanDuLieu2.Cells[1, 1] = "------";
                            }
                            else
                            {
                                excelChiTietThoiGianLamViec_PhongBanDuLieu2.Cells[1, 1] = sTenPhongBan2;
                            }
                            int iDemNgayChiTietThoiGianLamViec2;
                            iDemNgayChiTietThoiGianLamViec2 = 0;
                            int iCotGioVao2;
                            iCotGioVao2 = 1;
                            int iCotGioRa2;
                            iCotGioRa2 = 2;
                            for (int iGioChamChiTietThoiGianLamViec2 = 0; iGioChamChiTietThoiGianLamViec2 < 31; iGioChamChiTietThoiGianLamViec2++)
                            {
                                int iDemLanCham4LanChiTietThoiGianLamViec2;
                                iDemLanCham4LanChiTietThoiGianLamViec2 = 0;
                                double dGioTungNgayChiTietThoiGianLamViec2;
                                dGioTungNgayChiTietThoiGianLamViec2 = 0.0;
                                double dTongGioTangCaNgayChiTietThoiGianLamViec2;
                                dTongGioTangCaNgayChiTietThoiGianLamViec2 = 0.0;
                                DateTime dNgayChiTietThoiGianLamViec2;
                                dNgayChiTietThoiGianLamViec2 = Convert.ToDateTime(dNgayBatDauTinhCong.AddDays(iDemNgayChiTietThoiGianLamViec2).ToString());
                                new DataTable();
                                _tinhCongDTO.MaChamCong = iMaChamCongChiTietThoiGianLamViec2;
                                _tinhCongDTO.Ngay = dNgayChiTietThoiGianLamViec2;
                                DataTable dtDuLieuGioChiTietThoiGianLamViec2;
                                dtDuLieuGioChiTietThoiGianLamViec2 = _tinhCongBLL.TinhCongGetMaChamCongAndNgayChiTietThoiGian(_tinhCongDTO);
                                for (int iDuLieuGioChiTietThoiGianLamViec2 = 0; iDuLieuGioChiTietThoiGianLamViec2 < dtDuLieuGioChiTietThoiGianLamViec2.Rows.Count; iDuLieuGioChiTietThoiGianLamViec2++)
                                {
                                    if (iDemLanCham4LanChiTietThoiGianLamViec2 == 2)
                                    {
                                        break;
                                    }
                                    string sGioVao3;
                                    sGioVao3 = "";
                                    string sGioRa3;
                                    sGioRa3 = "";
                                    string sGioVaoChiTietThoiGianLamViec2;
                                    sGioVaoChiTietThoiGianLamViec2 = dtDuLieuGioChiTietThoiGianLamViec2.Rows[iDuLieuGioChiTietThoiGianLamViec2]["GioVao"].ToString();
                                    string sGioRaChiTietThoiGianLamViec2;
                                    sGioRaChiTietThoiGianLamViec2 = dtDuLieuGioChiTietThoiGianLamViec2.Rows[iDuLieuGioChiTietThoiGianLamViec2]["GioRa"].ToString();
                                    dGioTungNgayChiTietThoiGianLamViec2 += Convert.ToDouble(dtDuLieuGioChiTietThoiGianLamViec2.Rows[iDuLieuGioChiTietThoiGianLamViec2]["Gio"].ToString());
                                    dTongGioTangCaNgayChiTietThoiGianLamViec2 += Convert.ToDouble(dtDuLieuGioChiTietThoiGianLamViec2.Rows[iDuLieuGioChiTietThoiGianLamViec2]["TC1"]) + Convert.ToDouble(dtDuLieuGioChiTietThoiGianLamViec2.Rows[iDuLieuGioChiTietThoiGianLamViec2]["TC2"]);
                                    if (sGioVaoChiTietThoiGianLamViec2 != "")
                                    {
                                        DateTime dGioVao2;
                                        dGioVao2 = Convert.ToDateTime(sGioVaoChiTietThoiGianLamViec2);
                                        sGioVao3 = dGioVao2.Hour + ":" + dGioVao2.Minute;
                                    }
                                    if (sGioRaChiTietThoiGianLamViec2 != "")
                                    {
                                        DateTime dGioRa2;
                                        dGioRa2 = Convert.ToDateTime(sGioRaChiTietThoiGianLamViec2);
                                        sGioRa3 = dGioRa2.Hour + ":" + dGioRa2.Minute;
                                    }
                                    if (iDemLanCham4LanChiTietThoiGianLamViec2 == 0)
                                    {
                                        (ws_ChiTietThoiGianLamViec).get_Range((object)("E" + (iTongDongChiTietThoiGianLamViec2 + iDemNhanVienChiTietThoiGianLamViec2 * 3)), (object)("BN" + (iTongDongChiTietThoiGianLamViec2 + iDemNhanVienChiTietThoiGianLamViec2 * 3))).Cells[1, iCotGioVao2] = sGioVao3;
                                        (ws_ChiTietThoiGianLamViec).get_Range((object)("E" + (iTongDongChiTietThoiGianLamViec2 + iDemNhanVienChiTietThoiGianLamViec2 * 3)), (object)("BN" + (iTongDongChiTietThoiGianLamViec2 + iDemNhanVienChiTietThoiGianLamViec2 * 3))).Cells[1, iCotGioRa2] = sGioRa3;
                                    }
                                    if (iDemLanCham4LanChiTietThoiGianLamViec2 == 1)
                                    {
                                        (ws_ChiTietThoiGianLamViec).get_Range((object)("E" + (iTongDongChiTietThoiGianLamViec2 + iDemNhanVienChiTietThoiGianLamViec2 * 3 + 1)), (object)("BN" + (iTongDongChiTietThoiGianLamViec2 + iDemNhanVienChiTietThoiGianLamViec2 * 3 + 1))).Cells[1, iCotGioVao2] = sGioVao3;
                                        (ws_ChiTietThoiGianLamViec).get_Range((object)("E" + (iTongDongChiTietThoiGianLamViec2 + iDemNhanVienChiTietThoiGianLamViec2 * 3 + 1)), (object)("BN" + (iTongDongChiTietThoiGianLamViec2 + iDemNhanVienChiTietThoiGianLamViec2 * 3 + 1))).Cells[1, iCotGioRa2] = sGioRa3;
                                    }
                                    iDemLanCham4LanChiTietThoiGianLamViec2++;
                                }
                                (ws_ChiTietThoiGianLamViec).get_Range((object)("E" + (iTongDongChiTietThoiGianLamViec2 + iDemNhanVienChiTietThoiGianLamViec2 * 3 + 2)), (object)("BN" + (iTongDongChiTietThoiGianLamViec2 + iDemNhanVienChiTietThoiGianLamViec2 * 3 + 2))).Cells[1, iCotGioVao2] = dGioTungNgayChiTietThoiGianLamViec2;
                                (ws_ChiTietThoiGianLamViec).get_Range((object)("E" + (iTongDongChiTietThoiGianLamViec2 + iDemNhanVienChiTietThoiGianLamViec2 * 3 + 2)), (object)("BN" + (iTongDongChiTietThoiGianLamViec2 + iDemNhanVienChiTietThoiGianLamViec2 * 3 + 2))).Cells[1, iCotGioRa2] = dTongGioTangCaNgayChiTietThoiGianLamViec2;
                                iCotGioVao2 = iCotGioVao2 + 1 + 1;
                                iCotGioRa2 = iCotGioRa2 + 1 + 1;
                                iDemNgayChiTietThoiGianLamViec2++;
                            }
                            double dTongGioChiTietThoiGianLamViec2;
                            dTongGioChiTietThoiGianLamViec2 = 0.0;
                            double dTongCongChiTietThoiGianLamViec2;
                            dTongCongChiTietThoiGianLamViec2 = 0.0;
                            double dTongTangCaChiTietThoiGianLamViec2;
                            dTongTangCaChiTietThoiGianLamViec2 = 0.0;
                            int iTongPhutTreChiTietThoiGianLamViec2;
                            iTongPhutTreChiTietThoiGianLamViec2 = 0;
                            int iTongPhutSomChiTietThoiGianLamViec2;
                            iTongPhutSomChiTietThoiGianLamViec2 = 0;
                            new DataTable();
                            _tinhCongDTO.MaChamCong = iMaChamCongChiTietThoiGianLamViec2;
                            DataTable dtChiTietThoiGianLamViec2;
                            dtChiTietThoiGianLamViec2 = _tinhCongBLL.TinhCongGetByMaChamCong(_tinhCongDTO);
                            for (int iChiTietThoiGianLamViec2 = 0; iChiTietThoiGianLamViec2 < dtChiTietThoiGianLamViec2.Rows.Count; iChiTietThoiGianLamViec2++)
                            {
                                dTongGioChiTietThoiGianLamViec2 += Convert.ToDouble(dtChiTietThoiGianLamViec2.Rows[iChiTietThoiGianLamViec2]["Gio"].ToString());
                                dTongCongChiTietThoiGianLamViec2 += Convert.ToDouble(dtChiTietThoiGianLamViec2.Rows[iChiTietThoiGianLamViec2]["Cong"].ToString());
                                dTongTangCaChiTietThoiGianLamViec2 += Convert.ToDouble(dtChiTietThoiGianLamViec2.Rows[iChiTietThoiGianLamViec2]["TC1"].ToString()) + Convert.ToDouble(dtChiTietThoiGianLamViec2.Rows[iChiTietThoiGianLamViec2]["TC2"].ToString()) + Convert.ToDouble(dtChiTietThoiGianLamViec2.Rows[iChiTietThoiGianLamViec2]["TC3"].ToString()) + Convert.ToDouble(dtChiTietThoiGianLamViec2.Rows[iChiTietThoiGianLamViec2]["TC4"].ToString());
                                iTongPhutTreChiTietThoiGianLamViec2 += Convert.ToInt32(dtChiTietThoiGianLamViec2.Rows[iChiTietThoiGianLamViec2]["Tre"].ToString());
                                iTongPhutSomChiTietThoiGianLamViec2 += Convert.ToInt32(dtChiTietThoiGianLamViec2.Rows[iChiTietThoiGianLamViec2]["VeSom"].ToString());
                            }
                            Excel.Range excelChiTietThoiGianLamViec_TongGioDuLieu2;
                            excelChiTietThoiGianLamViec_TongGioDuLieu2 = (ws_ChiTietThoiGianLamViec).get_Range((object)("BO" + (iTongDongChiTietThoiGianLamViec2 + iDemNhanVienChiTietThoiGianLamViec2 * 3)), (object)("BO" + (iTongDongChiTietThoiGianLamViec2 + iDemNhanVienChiTietThoiGianLamViec2 * 3) + 2));
                            excelChiTietThoiGianLamViec_TongGioDuLieu2.Cells[1, 1] = dTongGioChiTietThoiGianLamViec2;
                            excelChiTietThoiGianLamViec_TongGioDuLieu2.get_Range((object)"A1", (object)"A3").MergeCells = true;
                            Excel.Range excelChiTietThoiGianLamViec_TongCongDuLieu2;
                            excelChiTietThoiGianLamViec_TongCongDuLieu2 = (ws_ChiTietThoiGianLamViec).get_Range((object)("BP" + (iTongDongChiTietThoiGianLamViec2 + iDemNhanVienChiTietThoiGianLamViec2 * 3)), (object)("BP" + (iTongDongChiTietThoiGianLamViec2 + iDemNhanVienChiTietThoiGianLamViec2 * 3) + 2));
                            excelChiTietThoiGianLamViec_TongCongDuLieu2.Cells[1, 1] = dTongCongChiTietThoiGianLamViec2;
                            excelChiTietThoiGianLamViec_TongCongDuLieu2.get_Range((object)"A1", (object)"A3").MergeCells = true;
                            Excel.Range excelChiTietThoiGianLamViec_TongTangCaDuLieu2;
                            excelChiTietThoiGianLamViec_TongTangCaDuLieu2 = (ws_ChiTietThoiGianLamViec).get_Range((object)("BQ" + (iTongDongChiTietThoiGianLamViec2 + iDemNhanVienChiTietThoiGianLamViec2 * 3)), (object)("BQ" + (iTongDongChiTietThoiGianLamViec2 + iDemNhanVienChiTietThoiGianLamViec2 * 3) + 2));
                            excelChiTietThoiGianLamViec_TongTangCaDuLieu2.Cells[1, 1] = dTongTangCaChiTietThoiGianLamViec2;
                            excelChiTietThoiGianLamViec_TongTangCaDuLieu2.get_Range((object)"A1", (object)"A3").MergeCells = true;
                            Excel.Range excelChiTietThoiGianLamViec_TongPhutTreDuLieu2;
                            excelChiTietThoiGianLamViec_TongPhutTreDuLieu2 = (ws_ChiTietThoiGianLamViec).get_Range((object)("BR" + (iTongDongChiTietThoiGianLamViec2 + iDemNhanVienChiTietThoiGianLamViec2 * 3)), (object)("BR" + (iTongDongChiTietThoiGianLamViec2 + iDemNhanVienChiTietThoiGianLamViec2 * 3) + 2));
                            excelChiTietThoiGianLamViec_TongPhutTreDuLieu2.Cells[1, 1] = iTongPhutTreChiTietThoiGianLamViec2;
                            excelChiTietThoiGianLamViec_TongPhutTreDuLieu2.get_Range((object)"A1", (object)"A3").MergeCells = true;
                            Excel.Range excelChiTietThoiGianLamViec_TongPhutSomDuLieu2;
                            excelChiTietThoiGianLamViec_TongPhutSomDuLieu2 = (ws_ChiTietThoiGianLamViec).get_Range((object)("BS" + (iTongDongChiTietThoiGianLamViec2 + iDemNhanVienChiTietThoiGianLamViec2 * 3)), (object)("BS" + (iTongDongChiTietThoiGianLamViec2 + iDemNhanVienChiTietThoiGianLamViec2 * 3) + 2));
                            excelChiTietThoiGianLamViec_TongPhutSomDuLieu2.Cells[1, 1] = iTongPhutSomChiTietThoiGianLamViec2;
                            excelChiTietThoiGianLamViec_TongPhutSomDuLieu2.get_Range((object)"A1", (object)"A3").MergeCells = true;
                            iDemNhanVienChiTietThoiGianLamViec2++;
                        }
                        ws_ChiTietThoiGianLamViec.PageSetup.Orientation = Excel.XlPageOrientation.xlLandscape;
                        ws_ChiTietThoiGianLamViec.PageSetup.PaperSize = Excel.XlPaperSize.xlPaperA4;
                        ws_ChiTietThoiGianLamViec.PageSetup.LeftMargin = 13.0;
                        ws_ChiTietThoiGianLamViec.PageSetup.RightMargin = 0.0;
                        ws_ChiTietThoiGianLamViec.PageSetup.BottomMargin = 0.0;
                        ws_ChiTietThoiGianLamViec.PageSetup.TopMargin = 0.0;
                        ws_ChiTietThoiGianLamViec.PageSetup.Zoom = 46;
                        Excel.Range excelChiTietThoiGianLamViec_DinhDangDuLieu2;
                        excelChiTietThoiGianLamViec_DinhDangDuLieu2 = (ws_ChiTietThoiGianLamViec).get_Range((object)"A9", (object)("BS" + (iTongDongChiTietThoiGianLamViec2 + iDemNhanVienChiTietThoiGianLamViec2 * 3 - 1)));
                        excelChiTietThoiGianLamViec_DinhDangDuLieu2.Font.Name = "Times New Roman";
                        excelChiTietThoiGianLamViec_DinhDangDuLieu2.Font.Size = "8";
                        excelChiTietThoiGianLamViec_DinhDangDuLieu2.HorizontalAlignment = Excel.Constants.xlCenter;
                        excelChiTietThoiGianLamViec_DinhDangDuLieu2.Borders.LineStyle = Excel.Constants.xlBoth;
                    }
                    if (iChonLanXuat == 3)
                    {
                        int iDemNhanVienChiTietThoiGianLamViec;
                        iDemNhanVienChiTietThoiGianLamViec = 0;
                        int iDemSTTChiTietThoiGianLamViec;
                        iDemSTTChiTietThoiGianLamViec = 0;
                        int iTongDongChiTietThoiGianLamViec;
                        iTongDongChiTietThoiGianLamViec = 9;
                        new DataTable();
                        _tinhCongDTO.Ngay = dTuNgayChiTietThoiGianLamViec;
                        int iMaChamCongChiTietThoiGianLamViec;
                        iMaChamCongChiTietThoiGianLamViec = 0;
                        DataTable dtNhanVienChiTietThoiGianLamViec;
                        dtNhanVienChiTietThoiGianLamViec = _tinhCongBLL.TinhCongGetNgay(_tinhCongDTO);
                        for (int iNhanVienChiTietThoiGianLamViec = 0; iNhanVienChiTietThoiGianLamViec < dtNhanVienChiTietThoiGianLamViec.Rows.Count; iNhanVienChiTietThoiGianLamViec++)
                        {
                            if (Convert.ToInt32(dtNhanVienChiTietThoiGianLamViec.Rows[iNhanVienChiTietThoiGianLamViec]["MaChamCong"].ToString()) == iMaChamCongChiTietThoiGianLamViec)
                            {
                                continue;
                            }
                            iDemSTTChiTietThoiGianLamViec++;
                            iMaChamCongChiTietThoiGianLamViec = Convert.ToInt32(dtNhanVienChiTietThoiGianLamViec.Rows[iNhanVienChiTietThoiGianLamViec]["MaChamCong"].ToString());
                            string sMaNhanVienChiTietThoiGianLamViec;
                            sMaNhanVienChiTietThoiGianLamViec = dtNhanVienChiTietThoiGianLamViec.Rows[iNhanVienChiTietThoiGianLamViec]["MaNhanVien"].ToString();
                            string sTenNhanVienChiTietThoiGianLamViec;
                            sTenNhanVienChiTietThoiGianLamViec = dtNhanVienChiTietThoiGianLamViec.Rows[iNhanVienChiTietThoiGianLamViec]["TenNhanVien"].ToString();
                            Excel.Range excelChiTietThoiGianLamViec_STTDuLieu;
                            excelChiTietThoiGianLamViec_STTDuLieu = (ws_ChiTietThoiGianLamViec).get_Range((object)("A" + (iTongDongChiTietThoiGianLamViec + iDemNhanVienChiTietThoiGianLamViec * 4)), (object)("A" + (iTongDongChiTietThoiGianLamViec + iDemNhanVienChiTietThoiGianLamViec * 4)));
                            excelChiTietThoiGianLamViec_STTDuLieu.Cells[1, 1] = iDemSTTChiTietThoiGianLamViec.ToString();
                            excelChiTietThoiGianLamViec_STTDuLieu.get_Range((object)"A1", (object)"A4").MergeCells = true;
                            excelChiTietThoiGianLamViec_STTDuLieu.Select();
                            Excel.Range excelChiTietThoiGianLamViec_MaNhanVienDuLieu;
                            excelChiTietThoiGianLamViec_MaNhanVienDuLieu = (ws_ChiTietThoiGianLamViec).get_Range((object)("B" + (iTongDongChiTietThoiGianLamViec + iDemNhanVienChiTietThoiGianLamViec * 4)), (object)("B" + (iTongDongChiTietThoiGianLamViec + iDemNhanVienChiTietThoiGianLamViec * 4)));
                            excelChiTietThoiGianLamViec_MaNhanVienDuLieu.get_Range((object)"A1", (object)"A1").NumberFormat = "@";
                            excelChiTietThoiGianLamViec_MaNhanVienDuLieu.Cells[1, 1] = "'" + sMaNhanVienChiTietThoiGianLamViec;
                            excelChiTietThoiGianLamViec_MaNhanVienDuLieu.get_Range((object)"A1", (object)"A4").MergeCells = true;
                            Excel.Range excelChiTietThoiGianLamViec_TenNhanVienDuLieu;
                            excelChiTietThoiGianLamViec_TenNhanVienDuLieu = (ws_ChiTietThoiGianLamViec).get_Range((object)("C" + (iTongDongChiTietThoiGianLamViec + iDemNhanVienChiTietThoiGianLamViec * 4)), (object)("C" + (iTongDongChiTietThoiGianLamViec + iDemNhanVienChiTietThoiGianLamViec * 4)));
                            excelChiTietThoiGianLamViec_TenNhanVienDuLieu.Cells[1, 1] = sTenNhanVienChiTietThoiGianLamViec;
                            excelChiTietThoiGianLamViec_TenNhanVienDuLieu.get_Range((object)"A1", (object)"A4").MergeCells = true;
                            string sTenPhongBan;
                            sTenPhongBan = "";
                            new DataTable();
                            _phongBanDTO.MaPhongBan = dtNhanVienChiTietThoiGianLamViec.Rows[iNhanVienChiTietThoiGianLamViec]["PhongBan"].ToString();
                            DataTable dtPhongBan;
                            dtPhongBan = _phongBanBLL.getTenPhongBanByMaPhongBan(_phongBanDTO);
                            for (int iPhongBan = 0; iPhongBan < dtPhongBan.Rows.Count; iPhongBan++)
                            {
                                sTenPhongBan = dtPhongBan.Rows[iPhongBan]["TenPhongBan"].ToString();
                            }
                            Excel.Range excelChiTietThoiGianLamViec_PhongBanDuLieu;
                            excelChiTietThoiGianLamViec_PhongBanDuLieu = (ws_ChiTietThoiGianLamViec).get_Range((object)("D" + (iTongDongChiTietThoiGianLamViec + iDemNhanVienChiTietThoiGianLamViec * 4)), (object)("D" + (iTongDongChiTietThoiGianLamViec + iDemNhanVienChiTietThoiGianLamViec * 4)));
                            excelChiTietThoiGianLamViec_PhongBanDuLieu.get_Range((object)"A1", (object)"A4").MergeCells = true;
                            if (sTenPhongBan == "")
                            {
                                excelChiTietThoiGianLamViec_PhongBanDuLieu.Cells[1, 1] = "------";
                            }
                            else
                            {
                                excelChiTietThoiGianLamViec_PhongBanDuLieu.Cells[1, 1] = sTenPhongBan;
                            }
                            int iDemNgayChiTietThoiGianLamViec;
                            iDemNgayChiTietThoiGianLamViec = 0;
                            int iCotGioVao;
                            iCotGioVao = 1;
                            int iCotGioRa;
                            iCotGioRa = 2;
                            for (int iGioChamChiTietThoiGianLamViec = 0; iGioChamChiTietThoiGianLamViec < 31; iGioChamChiTietThoiGianLamViec++)
                            {
                                int iDemLanCham4LanChiTietThoiGianLamViec;
                                iDemLanCham4LanChiTietThoiGianLamViec = 0;
                                double dGioTungNgayChiTietThoiGianLamViec;
                                dGioTungNgayChiTietThoiGianLamViec = 0.0;
                                double dTongGioTangCaNgayChiTietThoiGianLamViec;
                                dTongGioTangCaNgayChiTietThoiGianLamViec = 0.0;
                                DateTime dNgayChiTietThoiGianLamViec;
                                dNgayChiTietThoiGianLamViec = Convert.ToDateTime(dNgayBatDauTinhCong.AddDays(iDemNgayChiTietThoiGianLamViec).ToString());
                                new DataTable();
                                _tinhCongDTO.MaChamCong = iMaChamCongChiTietThoiGianLamViec;
                                _tinhCongDTO.Ngay = dNgayChiTietThoiGianLamViec;
                                DataTable dtDuLieuGioChiTietThoiGianLamViec;
                                dtDuLieuGioChiTietThoiGianLamViec = _tinhCongBLL.TinhCongGetMaChamCongAndNgayChiTietThoiGian(_tinhCongDTO);
                                for (int iDuLieuGioChiTietThoiGianLamViec = 0; iDuLieuGioChiTietThoiGianLamViec < dtDuLieuGioChiTietThoiGianLamViec.Rows.Count; iDuLieuGioChiTietThoiGianLamViec++)
                                {
                                    if (iDemLanCham4LanChiTietThoiGianLamViec == 3)
                                    {
                                        break;
                                    }
                                    string sGioVao4;
                                    sGioVao4 = "";
                                    string sGioRa4;
                                    sGioRa4 = "";
                                    string sGioVaoChiTietThoiGianLamViec;
                                    sGioVaoChiTietThoiGianLamViec = dtDuLieuGioChiTietThoiGianLamViec.Rows[iDuLieuGioChiTietThoiGianLamViec]["GioVao"].ToString();
                                    string sGioRaChiTietThoiGianLamViec;
                                    sGioRaChiTietThoiGianLamViec = dtDuLieuGioChiTietThoiGianLamViec.Rows[iDuLieuGioChiTietThoiGianLamViec]["GioRa"].ToString();
                                    dGioTungNgayChiTietThoiGianLamViec += Convert.ToDouble(dtDuLieuGioChiTietThoiGianLamViec.Rows[iDuLieuGioChiTietThoiGianLamViec]["Gio"].ToString());
                                    dTongGioTangCaNgayChiTietThoiGianLamViec += Convert.ToDouble(dtDuLieuGioChiTietThoiGianLamViec.Rows[iDuLieuGioChiTietThoiGianLamViec]["TC1"]) + Convert.ToDouble(dtDuLieuGioChiTietThoiGianLamViec.Rows[iDuLieuGioChiTietThoiGianLamViec]["TC2"]);
                                    if (sGioVaoChiTietThoiGianLamViec != "")
                                    {
                                        DateTime dGioVao;
                                        dGioVao = Convert.ToDateTime(sGioVaoChiTietThoiGianLamViec);
                                        sGioVao4 = dGioVao.Hour + ":" + dGioVao.Minute;
                                    }
                                    if (sGioRaChiTietThoiGianLamViec != "")
                                    {
                                        DateTime dGioRa;
                                        dGioRa = Convert.ToDateTime(sGioRaChiTietThoiGianLamViec);
                                        sGioRa4 = dGioRa.Hour + ":" + dGioRa.Minute;
                                    }
                                    if (iDemLanCham4LanChiTietThoiGianLamViec == 0)
                                    {
                                        (ws_ChiTietThoiGianLamViec).get_Range((object)("E" + (iTongDongChiTietThoiGianLamViec + iDemNhanVienChiTietThoiGianLamViec * 4)), (object)("BN" + (iTongDongChiTietThoiGianLamViec + iDemNhanVienChiTietThoiGianLamViec * 4))).Cells[1, iCotGioVao] = sGioVao4;
                                        (ws_ChiTietThoiGianLamViec).get_Range((object)("E" + (iTongDongChiTietThoiGianLamViec + iDemNhanVienChiTietThoiGianLamViec * 4)), (object)("BN" + (iTongDongChiTietThoiGianLamViec + iDemNhanVienChiTietThoiGianLamViec * 4))).Cells[1, iCotGioRa] = sGioRa4;
                                    }
                                    if (iDemLanCham4LanChiTietThoiGianLamViec == 1)
                                    {
                                        (ws_ChiTietThoiGianLamViec).get_Range((object)("E" + (iTongDongChiTietThoiGianLamViec + iDemNhanVienChiTietThoiGianLamViec * 4 + 1)), (object)("BN" + (iTongDongChiTietThoiGianLamViec + iDemNhanVienChiTietThoiGianLamViec * 4 + 1))).Cells[1, iCotGioVao] = sGioVao4;
                                        (ws_ChiTietThoiGianLamViec).get_Range((object)("E" + (iTongDongChiTietThoiGianLamViec + iDemNhanVienChiTietThoiGianLamViec * 4 + 1)), (object)("BN" + (iTongDongChiTietThoiGianLamViec + iDemNhanVienChiTietThoiGianLamViec * 4 + 1))).Cells[1, iCotGioRa] = sGioRa4;
                                        sGioRa4 = "";
                                    }
                                    if (iDemLanCham4LanChiTietThoiGianLamViec == 2)
                                    {
                                        (ws_ChiTietThoiGianLamViec).get_Range((object)("E" + (iTongDongChiTietThoiGianLamViec + iDemNhanVienChiTietThoiGianLamViec * 4 + 2)), (object)("BN" + (iTongDongChiTietThoiGianLamViec + iDemNhanVienChiTietThoiGianLamViec * 4 + 2))).Cells[1, iCotGioVao] = sGioVao4;
                                        (ws_ChiTietThoiGianLamViec).get_Range((object)("E" + (iTongDongChiTietThoiGianLamViec + iDemNhanVienChiTietThoiGianLamViec * 4 + 2)), (object)("BN" + (iTongDongChiTietThoiGianLamViec + iDemNhanVienChiTietThoiGianLamViec * 4 + 2))).Cells[1, iCotGioRa] = sGioRa4;
                                    }
                                    iDemLanCham4LanChiTietThoiGianLamViec++;
                                }
                                (ws_ChiTietThoiGianLamViec).get_Range((object)("E" + (iTongDongChiTietThoiGianLamViec + iDemNhanVienChiTietThoiGianLamViec * 4 + 3)), (object)("BN" + (iTongDongChiTietThoiGianLamViec + iDemNhanVienChiTietThoiGianLamViec * 4 + 3))).Cells[1, iCotGioVao] = dGioTungNgayChiTietThoiGianLamViec;
                                (ws_ChiTietThoiGianLamViec).get_Range((object)("E" + (iTongDongChiTietThoiGianLamViec + iDemNhanVienChiTietThoiGianLamViec * 4 + 3)), (object)("BN" + (iTongDongChiTietThoiGianLamViec + iDemNhanVienChiTietThoiGianLamViec * 4 + 3))).Cells[1, iCotGioRa] = dTongGioTangCaNgayChiTietThoiGianLamViec;
                                iCotGioVao = iCotGioVao + 1 + 1;
                                iCotGioRa = iCotGioRa + 1 + 1;
                                iDemNgayChiTietThoiGianLamViec++;
                            }
                            double dTongGioChiTietThoiGianLamViec;
                            dTongGioChiTietThoiGianLamViec = 0.0;
                            double dTongCongChiTietThoiGianLamViec;
                            dTongCongChiTietThoiGianLamViec = 0.0;
                            double dTongTangCaChiTietThoiGianLamViec;
                            dTongTangCaChiTietThoiGianLamViec = 0.0;
                            int iTongPhutTreChiTietThoiGianLamViec;
                            iTongPhutTreChiTietThoiGianLamViec = 0;
                            int iTongPhutSomChiTietThoiGianLamViec;
                            iTongPhutSomChiTietThoiGianLamViec = 0;
                            new DataTable();
                            _tinhCongDTO.MaChamCong = iMaChamCongChiTietThoiGianLamViec;
                            DataTable dtChiTietThoiGianLamViec;
                            dtChiTietThoiGianLamViec = _tinhCongBLL.TinhCongGetByMaChamCong(_tinhCongDTO);
                            for (int iChiTietThoiGianLamViec = 0; iChiTietThoiGianLamViec < dtChiTietThoiGianLamViec.Rows.Count; iChiTietThoiGianLamViec++)
                            {
                                dTongGioChiTietThoiGianLamViec += Convert.ToDouble(dtChiTietThoiGianLamViec.Rows[iChiTietThoiGianLamViec]["Gio"].ToString());
                                dTongCongChiTietThoiGianLamViec += Convert.ToDouble(dtChiTietThoiGianLamViec.Rows[iChiTietThoiGianLamViec]["Cong"].ToString());
                                dTongTangCaChiTietThoiGianLamViec += Convert.ToDouble(dtChiTietThoiGianLamViec.Rows[iChiTietThoiGianLamViec]["TC1"].ToString()) + Convert.ToDouble(dtChiTietThoiGianLamViec.Rows[iChiTietThoiGianLamViec]["TC2"].ToString()) + Convert.ToDouble(dtChiTietThoiGianLamViec.Rows[iChiTietThoiGianLamViec]["TC3"].ToString()) + Convert.ToDouble(dtChiTietThoiGianLamViec.Rows[iChiTietThoiGianLamViec]["TC4"].ToString());
                                iTongPhutTreChiTietThoiGianLamViec += Convert.ToInt32(dtChiTietThoiGianLamViec.Rows[iChiTietThoiGianLamViec]["Tre"].ToString());
                                iTongPhutSomChiTietThoiGianLamViec += Convert.ToInt32(dtChiTietThoiGianLamViec.Rows[iChiTietThoiGianLamViec]["VeSom"].ToString());
                            }
                            Excel.Range excelChiTietThoiGianLamViec_TongGioDuLieu;
                            excelChiTietThoiGianLamViec_TongGioDuLieu = (ws_ChiTietThoiGianLamViec).get_Range((object)("BO" + (iTongDongChiTietThoiGianLamViec + iDemNhanVienChiTietThoiGianLamViec * 4)), (object)("BO" + (iTongDongChiTietThoiGianLamViec + iDemNhanVienChiTietThoiGianLamViec * 4) + 3));
                            excelChiTietThoiGianLamViec_TongGioDuLieu.Cells[1, 1] = dTongGioChiTietThoiGianLamViec;
                            excelChiTietThoiGianLamViec_TongGioDuLieu.get_Range((object)"A1", (object)"A4").MergeCells = true;
                            Excel.Range excelChiTietThoiGianLamViec_TongCongDuLieu;
                            excelChiTietThoiGianLamViec_TongCongDuLieu = (ws_ChiTietThoiGianLamViec).get_Range((object)("BP" + (iTongDongChiTietThoiGianLamViec + iDemNhanVienChiTietThoiGianLamViec * 4)), (object)("BP" + (iTongDongChiTietThoiGianLamViec + iDemNhanVienChiTietThoiGianLamViec * 4) + 3));
                            excelChiTietThoiGianLamViec_TongCongDuLieu.Cells[1, 1] = dTongCongChiTietThoiGianLamViec;
                            excelChiTietThoiGianLamViec_TongCongDuLieu.get_Range((object)"A1", (object)"A4").MergeCells = true;
                            Excel.Range excelChiTietThoiGianLamViec_TongTangCaDuLieu;
                            excelChiTietThoiGianLamViec_TongTangCaDuLieu = (ws_ChiTietThoiGianLamViec).get_Range((object)("BQ" + (iTongDongChiTietThoiGianLamViec + iDemNhanVienChiTietThoiGianLamViec * 4)), (object)("BQ" + (iTongDongChiTietThoiGianLamViec + iDemNhanVienChiTietThoiGianLamViec * 4) + 3));
                            excelChiTietThoiGianLamViec_TongTangCaDuLieu.Cells[1, 1] = dTongTangCaChiTietThoiGianLamViec;
                            excelChiTietThoiGianLamViec_TongTangCaDuLieu.get_Range((object)"A1", (object)"A4").MergeCells = true;
                            Excel.Range excelChiTietThoiGianLamViec_TongPhutTreDuLieu;
                            excelChiTietThoiGianLamViec_TongPhutTreDuLieu = (ws_ChiTietThoiGianLamViec).get_Range((object)("BR" + (iTongDongChiTietThoiGianLamViec + iDemNhanVienChiTietThoiGianLamViec * 4)), (object)("BR" + (iTongDongChiTietThoiGianLamViec + iDemNhanVienChiTietThoiGianLamViec * 4) + 3));
                            excelChiTietThoiGianLamViec_TongPhutTreDuLieu.Cells[1, 1] = iTongPhutTreChiTietThoiGianLamViec;
                            excelChiTietThoiGianLamViec_TongPhutTreDuLieu.get_Range((object)"A1", (object)"A4").MergeCells = true;
                            Excel.Range excelChiTietThoiGianLamViec_TongPhutSomDuLieu;
                            excelChiTietThoiGianLamViec_TongPhutSomDuLieu = (ws_ChiTietThoiGianLamViec).get_Range((object)("BS" + (iTongDongChiTietThoiGianLamViec + iDemNhanVienChiTietThoiGianLamViec * 4)), (object)("BS" + (iTongDongChiTietThoiGianLamViec + iDemNhanVienChiTietThoiGianLamViec * 4) + 3));
                            excelChiTietThoiGianLamViec_TongPhutSomDuLieu.Cells[1, 1] = iTongPhutSomChiTietThoiGianLamViec;
                            excelChiTietThoiGianLamViec_TongPhutSomDuLieu.get_Range((object)"A1", (object)"A4").MergeCells = true;
                            iDemNhanVienChiTietThoiGianLamViec++;
                        }
                        Excel.Range excelChiTietThoiGianLamViec_DinhDangDuLieu;
                        excelChiTietThoiGianLamViec_DinhDangDuLieu = (ws_ChiTietThoiGianLamViec).get_Range((object)"A9", (object)("BS" + (iTongDongChiTietThoiGianLamViec + iDemNhanVienChiTietThoiGianLamViec * 4 - 1)));
                        excelChiTietThoiGianLamViec_DinhDangDuLieu.Font.Name = "Times New Roman";
                        excelChiTietThoiGianLamViec_DinhDangDuLieu.Font.Size = "8";
                        excelChiTietThoiGianLamViec_DinhDangDuLieu.HorizontalAlignment = Excel.Constants.xlCenter;
                        excelChiTietThoiGianLamViec_DinhDangDuLieu.Borders.LineStyle = Excel.Constants.xlBoth;
                    }
                    failed = false;
                }
                catch (COMException)
                {
                    failed = true;
                }
                Thread.Sleep(10);
            }
            while (failed);
        }

        private void XuatLuoi_Click(object sender, EventArgs e)
        {
            testProcess = iDemNhanVienDuocChon;
            demProcess = -1;
            _ = Thread.CurrentThread.CurrentCulture;
            Thread.CurrentThread.CurrentCulture = new CultureInfo("en-US");
            Excel.Application xla_XuatLuoi;
            xla_XuatLuoi = new Excel.Application();
            xla_XuatLuoi.Workbooks.Add(Excel.XlSheetType.xlWorksheet);
            _ = xla_XuatLuoi.ActiveSheet;
            Excel.Worksheet ws_XuatLuoi;
            ws_XuatLuoi = xla_XuatLuoi.Worksheets.get_Item((object)1);
            Excel.Range excelTieuDeXuatLuoi;
            excelTieuDeXuatLuoi = (ws_XuatLuoi).get_Range((object)"A2", (object)"O2");
            excelTieuDeXuatLuoi.Select();
            excelTieuDeXuatLuoi.Cells[1, 1] = "CHI TIẾT CHẤM CÔNG";
            excelTieuDeXuatLuoi.get_Range((object)"A1", (object)"O1").Merge(true);
            excelTieuDeXuatLuoi.Font.Name = "Times New Roman";
            excelTieuDeXuatLuoi.Font.Size = "18";
            excelTieuDeXuatLuoi.Font.Bold = true;
            excelTieuDeXuatLuoi.RowHeight = "24";
            excelTieuDeXuatLuoi.Interior.Color = ColorTranslator.ToOle(Color.BlanchedAlmond);
            excelTieuDeXuatLuoi.HorizontalAlignment = Excel.Constants.xlCenter;
            (ws_XuatLuoi).get_Range((object)"A3", (object)"A3").Cells[1, 1] = "STT";
            Excel.Range excelMaNhanVienHeader;
            excelMaNhanVienHeader = (ws_XuatLuoi).get_Range((object)"B3", (object)"B3");
            excelMaNhanVienHeader.Cells[1, 1] = "Mã nhân viên";
            excelMaNhanVienHeader.ColumnWidth = 12;
            Excel.Range excelTenNhanVienHeader;
            excelTenNhanVienHeader = (ws_XuatLuoi).get_Range((object)"C3", (object)"C3");
            excelTenNhanVienHeader.Cells[1, 1] = "Tên nhân viên";
            excelTenNhanVienHeader.ColumnWidth = 12;
            (ws_XuatLuoi).get_Range((object)"D3", (object)"D3").Cells[1, 1] = "Phòng ban";
            (ws_XuatLuoi).get_Range((object)"E3", (object)"E3").Cells[1, 1] = "Ngày";
            (ws_XuatLuoi).get_Range((object)"F3", (object)"F3").Cells[1, 1] = "Thứ";
            (ws_XuatLuoi).get_Range((object)"G3", (object)"G3").Cells[1, 1] = "Giờ vào";
            (ws_XuatLuoi).get_Range((object)"H3", (object)"H3").Cells[1, 1] = "Giờ ra";
            (ws_XuatLuoi).get_Range((object)"I3", (object)"I3").Cells[1, 1] = "Trễ";
            (ws_XuatLuoi).get_Range((object)"J3", (object)"J3").Cells[1, 1] = "Sớm";
            (ws_XuatLuoi).get_Range((object)"K3", (object)"K3").Cells[1, 1] = "Công";
            (ws_XuatLuoi).get_Range((object)"L3", (object)"L3").Cells[1, 1] = "Tổng giờ";
            (ws_XuatLuoi).get_Range((object)"M3", (object)"M3").Cells[1, 1] = "Tăng ca";
            Excel.Range excelTongToanBoHeader;
            excelTongToanBoHeader = (ws_XuatLuoi).get_Range((object)"N3", (object)"N3");
            excelTongToanBoHeader.Cells[1, 1] = "Tổng toàn bộ";
            excelTongToanBoHeader.ColumnWidth = 5;
            (ws_XuatLuoi).get_Range((object)"O3", (object)"O3").Cells[1, 1] = "Ca";
            Excel.Range excelDinhDangCaHeader;
            excelDinhDangCaHeader = (ws_XuatLuoi).get_Range((object)"A3", (object)"O3");
            excelDinhDangCaHeader.Font.Name = "Times New Roman";
            excelDinhDangCaHeader.Interior.Color = ColorTranslator.ToOle(Color.BlanchedAlmond);
            excelDinhDangCaHeader.Font.Size = "11";
            excelDinhDangCaHeader.Font.Bold = true;
            excelDinhDangCaHeader.RowHeight = "24";
            excelDinhDangCaHeader.HorizontalAlignment = Excel.Constants.xlCenter;
            xla_XuatLuoi.Visible = true;
            int iDemDong;
            iDemDong = 3;
            int iSTT;
            iSTT = 0;
            new DataTable();
            DataTable dtXuatLuoi;
            dtXuatLuoi = _tinhCongBLL.TinhCongGetAll(_tinhCongDTO);
            for (int iXuatLuoi = 0; iXuatLuoi < dtXuatLuoi.Rows.Count; iXuatLuoi++)
            {
                iDemDong++;
                iSTT++;
                Excel.Range excelSTTDuLieu;
                excelSTTDuLieu = (ws_XuatLuoi).get_Range((object)("A" + iDemDong), (object)("A" + iDemDong));
                excelSTTDuLieu.Cells[1, 1] = iSTT;
                excelSTTDuLieu.Select();
                Excel.Range excelMaNhanVienDuLieu;
                excelMaNhanVienDuLieu = (ws_XuatLuoi).get_Range((object)("B" + iDemDong), (object)("B" + iDemDong));
                excelMaNhanVienDuLieu.get_Range((object)"A1", (object)"A1").NumberFormat = "@";
                excelMaNhanVienDuLieu.Cells[1, 1] = dtXuatLuoi.Rows[iXuatLuoi]["MaNhanVien"].ToString();
                (ws_XuatLuoi).get_Range((object)("C" + iDemDong), (object)("C" + iDemDong)).Cells[1, 1] = dtXuatLuoi.Rows[iXuatLuoi]["TenNhanVien"].ToString();
                string sTenPhongBanXuatLuoi;
                sTenPhongBanXuatLuoi = "";
                int iDemPhongBanXuatLuoi;
                iDemPhongBanXuatLuoi = 0;
                new DataTable();
                _phongBanDTO.MaPhongBan = dtXuatLuoi.Rows[iXuatLuoi]["PhongBan"].ToString();
                DataTable dtPhongBanXuatLuoi;
                dtPhongBanXuatLuoi = _phongBanBLL.getTenPhongBanByMaPhongBan(_phongBanDTO);
                for (int iPhongBanXuatLuoi = 0; iPhongBanXuatLuoi < dtPhongBanXuatLuoi.Rows.Count; iPhongBanXuatLuoi++)
                {
                    sTenPhongBanXuatLuoi = dtPhongBanXuatLuoi.Rows[iPhongBanXuatLuoi]["TenPhongBan"].ToString();
                    iDemPhongBanXuatLuoi = 1;
                }
                Excel.Range excelPhongBanDuLieu;
                excelPhongBanDuLieu = (ws_XuatLuoi).get_Range((object)("D" + iDemDong), (object)("D" + iDemDong));
                if (iDemPhongBanXuatLuoi == 1)
                {
                    excelPhongBanDuLieu.Cells[1, 1] = sTenPhongBanXuatLuoi;
                }
                else
                {
                    excelPhongBanDuLieu.Cells[1, 1] = "";
                }
                DateTime dNgayXuatLuoi;
                dNgayXuatLuoi = Convert.ToDateTime(dtXuatLuoi.Rows[iXuatLuoi]["Ngay"].ToString());
                (ws_XuatLuoi).get_Range((object)("E" + iDemDong), (object)("E" + iDemDong)).Cells[1, 1] = dNgayXuatLuoi;
                (ws_XuatLuoi).get_Range((object)("F" + iDemDong), (object)("F" + iDemDong)).Cells[1, 1] = dtXuatLuoi.Rows[iXuatLuoi]["Thu"].ToString();
                string sGioVaoXuatLuoi;
                sGioVaoXuatLuoi = dtXuatLuoi.Rows[iXuatLuoi]["GioVao"].ToString();
                Excel.Range excelGioVaoDuLieu;
                excelGioVaoDuLieu = (ws_XuatLuoi).get_Range((object)("G" + iDemDong), (object)("G" + iDemDong));
                if (sGioVaoXuatLuoi == "")
                {
                    excelGioVaoDuLieu.Cells[1, 1] = "";
                }
                else
                {
                    DateTime dGioVao;
                    dGioVao = Convert.ToDateTime(sGioVaoXuatLuoi);
                    string sGioVao;
                    sGioVao = dGioVao.Hour + ":" + dGioVao.Minute;
                    excelGioVaoDuLieu.Cells[1, 1] = sGioVao;
                }
                string sGioRaXuatLuoi;
                sGioRaXuatLuoi = dtXuatLuoi.Rows[iXuatLuoi]["GioRa"].ToString();
                Excel.Range excelGioRaDuLieu;
                excelGioRaDuLieu = (ws_XuatLuoi).get_Range((object)("H" + iDemDong), (object)("H" + iDemDong));
                if (sGioRaXuatLuoi == "")
                {
                    excelGioRaDuLieu.Cells[1, 1] = "";
                }
                else
                {
                    DateTime dGioRa;
                    dGioRa = Convert.ToDateTime(sGioRaXuatLuoi);
                    string sGioRa;
                    sGioRa = dGioRa.Hour + ":" + dGioRa.Minute;
                    excelGioRaDuLieu.Cells[1, 1] = sGioRa;
                }
                int iDiTre;
                iDiTre = Convert.ToInt32(dtXuatLuoi.Rows[iXuatLuoi]["Tre"].ToString());
                (ws_XuatLuoi).get_Range((object)("I" + iDemDong), (object)("I" + iDemDong)).Cells[1, 1] = iDiTre;
                int iVeSom;
                iVeSom = Convert.ToInt32(dtXuatLuoi.Rows[iXuatLuoi]["VeSom"].ToString());
                (ws_XuatLuoi).get_Range((object)("J" + iDemDong), (object)("J" + iDemDong)).Cells[1, 1] = iVeSom;
                double dCong;
                dCong = Convert.ToDouble(dtXuatLuoi.Rows[iXuatLuoi]["Cong"].ToString());
                (ws_XuatLuoi).get_Range((object)("K" + iDemDong), (object)("K" + iDemDong)).Cells[1, 1] = dCong;
                double dGio;
                dGio = Convert.ToDouble(dtXuatLuoi.Rows[iXuatLuoi]["Gio"].ToString());
                (ws_XuatLuoi).get_Range((object)("L" + iDemDong), (object)("L" + iDemDong)).Cells[1, 1] = dGio;
                (ws_XuatLuoi).get_Range((object)("M" + iDemDong), (object)("M" + iDemDong)).Cells[1, 1] = Convert.ToDouble(dtXuatLuoi.Rows[iXuatLuoi]["TC1"].ToString()) + Convert.ToDouble(dtXuatLuoi.Rows[iXuatLuoi]["TC2"].ToString()) + Convert.ToDouble(dtXuatLuoi.Rows[iXuatLuoi]["TC3"].ToString()) + Convert.ToDouble(dtXuatLuoi.Rows[iXuatLuoi]["TC4"].ToString());
                double dTongGio;
                dTongGio = Convert.ToDouble(dtXuatLuoi.Rows[iXuatLuoi]["TongGio"].ToString());
                (ws_XuatLuoi).get_Range((object)("N" + iDemDong), (object)("N" + iDemDong)).Cells[1, 1] = dTongGio;
                string sCaXuatLuoi;
                sCaXuatLuoi = dtXuatLuoi.Rows[iXuatLuoi]["Ca"].ToString();
                Excel.Range excelCaDuLieu;
                excelCaDuLieu = (ws_XuatLuoi).get_Range((object)("O" + iDemDong), (object)("O" + iDemDong));
                if (sCaXuatLuoi == "***")
                {
                    excelCaDuLieu.Cells[1, 1] = dtXuatLuoi.Rows[iXuatLuoi]["KyHieu"].ToString();
                }
                else
                {
                    excelCaDuLieu.Cells[1, 1] = sCaXuatLuoi;
                }
                Excel.Range excelDinhDangDuLieu;
                excelDinhDangDuLieu = (ws_XuatLuoi).get_Range((object)("A" + iDemDong), (object)("O" + iDemDong));
                if (dtXuatLuoi.Rows[iXuatLuoi]["Thu"].ToString() == "CN")
                {
                    excelDinhDangDuLieu.Interior.Color = ColorTranslator.ToOle(Color.Aqua);
                }
            }
            Excel.Range excelVienXuatLuoi;
            excelVienXuatLuoi = (ws_XuatLuoi).get_Range((object)"A2", (object)("O" + iDemDong));
            excelVienXuatLuoi.Borders.LineStyle = Excel.Constants.xlBoth;
            excelVienXuatLuoi.Font.Name = "Times New Roman";
            excelVienXuatLuoi.Font.Size = "12";
        }

        private void ThongKeThangGio()
        {
            DateTime dNgayTinh;
            dNgayTinh = Convert.ToDateTime(dateTimeTuNgay.Text);
            DateTime dNgayBatDauTinhCong;
            dNgayBatDauTinhCong = new DateTime(dNgayTinh.Year, dNgayTinh.Month, dNgayTinh.Day, 0, 0, 0);
            _ = Thread.CurrentThread.CurrentCulture;
            Thread.CurrentThread.CurrentCulture = new CultureInfo("en-US");
            Excel.Application xla_ThongKeThang_Gio;
            xla_ThongKeThang_Gio = new Excel.Application();
            xla_ThongKeThang_Gio.Workbooks.Add(Excel.XlSheetType.xlWorksheet);
            _ = xla_ThongKeThang_Gio.ActiveSheet;
            Excel.Worksheet ws_ThongKeThang_Gio;
            ws_ThongKeThang_Gio = xla_ThongKeThang_Gio.Worksheets.get_Item((object)1);
            bool failed;
            do
            {
                try
                {
                    Excel.Range excelThongKeThangGio_TenCongTy;
                    excelThongKeThangGio_TenCongTy = (ws_ThongKeThang_Gio).get_Range((object)"A1", (object)"AT1");
                    excelThongKeThangGio_TenCongTy.Select();
                    excelThongKeThangGio_TenCongTy.Cells[1, 1] = "Công ty: " + sTenCongTyReport;
                    excelThongKeThangGio_TenCongTy.get_Range((object)"A1", (object)"AT1").Merge(true);
                    Excel.Range excelThongKeThangGio_DiaChiCongTy;
                    excelThongKeThangGio_DiaChiCongTy = (ws_ThongKeThang_Gio).get_Range((object)"A2", (object)"AT2");
                    excelThongKeThangGio_DiaChiCongTy.Cells[1, 1] = "Địa chỉ: " + sDiaChiCongTyReport;
                    excelThongKeThangGio_DiaChiCongTy.get_Range((object)"A1", (object)"AT1").Merge(true);
                    Excel.Range excelThongKeThangGio_TieuDe;
                    excelThongKeThangGio_TieuDe = (ws_ThongKeThang_Gio).get_Range((object)"A4", (object)"AT4");
                    excelThongKeThangGio_TieuDe.Cells[1, 1] = "BẢNG THỐNG KÊ CHẤM CÔNG (GIỜ)";
                    excelThongKeThangGio_TieuDe.get_Range((object)"A1", (object)"AT1").Merge(true);
                    excelThongKeThangGio_TieuDe.Font.Name = "Times New Roman";
                    excelThongKeThangGio_TieuDe.Font.Size = "16";
                    excelThongKeThangGio_TieuDe.Font.Bold = true;
                    excelThongKeThangGio_TieuDe.RowHeight = "24";
                    excelThongKeThangGio_TieuDe.HorizontalAlignment = Excel.Constants.xlCenter;
                    Excel.Range excelThongKeThangGio_STT;
                    excelThongKeThangGio_STT = (ws_ThongKeThang_Gio).get_Range((object)"A5", (object)"A6");
                    excelThongKeThangGio_STT.Cells[1, 1] = "STT";
                    excelThongKeThangGio_STT.get_Range((object)"A1", (object)"A2").MergeCells = true;
                    excelThongKeThangGio_STT.ColumnWidth = 5;
                    Excel.Range excelThongKeThangGio_PhongBan;
                    excelThongKeThangGio_PhongBan = (ws_ThongKeThang_Gio).get_Range((object)"B5", (object)"B6");
                    excelThongKeThangGio_PhongBan.Cells[1, 1] = "PHÒNG BAN";
                    excelThongKeThangGio_PhongBan.get_Range((object)"A1", (object)"A2").MergeCells = true;
                    excelThongKeThangGio_PhongBan.ColumnWidth = 12;
                    Excel.Range excelThongKeThangGio_MaSoNhanVien;
                    excelThongKeThangGio_MaSoNhanVien = (ws_ThongKeThang_Gio).get_Range((object)"C5", (object)"C6");
                    excelThongKeThangGio_MaSoNhanVien.Cells[1, 1] = "MSNV";
                    excelThongKeThangGio_MaSoNhanVien.get_Range((object)"A1", (object)"A2").MergeCells = true;
                    excelThongKeThangGio_MaSoNhanVien.ColumnWidth = 7;
                    Excel.Range excelThongKeThangGio_TenNhanVien;
                    excelThongKeThangGio_TenNhanVien = (ws_ThongKeThang_Gio).get_Range((object)"D5", (object)"D6");
                    excelThongKeThangGio_TenNhanVien.Cells[1, 1] = "TÊN NHÂN VIÊN";
                    excelThongKeThangGio_TenNhanVien.get_Range((object)"A1", (object)"A2").MergeCells = true;
                    excelThongKeThangGio_TenNhanVien.ColumnWidth = 14;
                    Excel.Range excelThongKeThangGio_NgayVaoLamViec;
                    excelThongKeThangGio_NgayVaoLamViec = (ws_ThongKeThang_Gio).get_Range((object)"E5", (object)"E6");
                    excelThongKeThangGio_NgayVaoLamViec.Cells[1, 1] = "NGÀY VÀO LÀM";
                    excelThongKeThangGio_NgayVaoLamViec.get_Range((object)"A1", (object)"A2").MergeCells = true;
                    excelThongKeThangGio_NgayVaoLamViec.ColumnWidth = 14;
                    int iTangCot;
                    iTangCot = 5;
                    int ColunmNgay;
                    ColunmNgay = 1;
                    for (int iThongKe_Gio = 0; iThongKe_Gio < 31; iThongKe_Gio++)
                    {
                        DateTime dtNgayChamThongKeGio;
                        dtNgayChamThongKeGio = dateTimeTuNgay.Value;
                        int iNgayChamThongKeGio;
                        iNgayChamThongKeGio = Convert.ToInt32(Convert.ToDateTime(dtNgayChamThongKeGio.AddDays(iThongKe_Gio).ToString()).Day);
                        Excel.Range excelThongKeThangGio_Ngay;
                        excelThongKeThangGio_Ngay = (ws_ThongKeThang_Gio).get_Range((object)"F5", (object)"AJ6");
                        excelThongKeThangGio_Ngay.Cells[1, ColunmNgay] = iNgayChamThongKeGio;
                        excelThongKeThangGio_Ngay.Cells[2, ColunmNgay] = DateTimeProgress.XuatThuReport((int)dtNgayChamThongKeGio.AddDays(iThongKe_Gio).DayOfWeek);
                        ColunmNgay++;
                        excelThongKeThangGio_Ngay.ColumnWidth = 5;
                    }
                    Excel.Range excelThongKeThangGio_NgayCong;
                    excelThongKeThangGio_NgayCong = (ws_ThongKeThang_Gio).get_Range((object)"AK5", (object)"AK6");
                    excelThongKeThangGio_NgayCong.Cells[1, 1] = "Giờ công";
                    excelThongKeThangGio_NgayCong.get_Range((object)"A1", (object)"A2").MergeCells = true;
                    Excel.Range excelThongKeThangGio_TangCa;
                    excelThongKeThangGio_TangCa = (ws_ThongKeThang_Gio).get_Range((object)"AL5", (object)"AO5");
                    excelThongKeThangGio_TangCa.Cells[1, 1] = "Tăng ca";
                    excelThongKeThangGio_TangCa.get_Range((object)"A1", (object)"D1").Merge(true);
                    int ColumTangCa;
                    ColumTangCa = 1;
                    for (int iThongKeGio_TangCa = 1; iThongKeGio_TangCa < 5; iThongKeGio_TangCa++)
                    {
                        Excel.Range excelThongKeThangGio_ChiTietTangCa;
                        excelThongKeThangGio_ChiTietTangCa = (ws_ThongKeThang_Gio).get_Range((object)"AL6", (object)"AO6");
                        excelThongKeThangGio_ChiTietTangCa.Cells[1, ColumTangCa] = "TC " + iThongKeGio_TangCa;
                        ColumTangCa++;
                        excelThongKeThangGio_ChiTietTangCa.ColumnWidth = 5;
                    }
                    Excel.Range excelThongKeThangGio_Vang;
                    excelThongKeThangGio_Vang = (ws_ThongKeThang_Gio).get_Range((object)"AP5", (object)"AP6");
                    excelThongKeThangGio_Vang.Cells[1, 1] = "V";
                    excelThongKeThangGio_Vang.get_Range((object)"A1", (object)"A2").MergeCells = true;
                    excelThongKeThangGio_Vang.ColumnWidth = 5;
                    Excel.Range excelThongKeThangGio_PhepNam;
                    excelThongKeThangGio_PhepNam = (ws_ThongKeThang_Gio).get_Range((object)"AQ5", (object)"AQ6");
                    excelThongKeThangGio_PhepNam.Cells[1, 1] = "PN";
                    excelThongKeThangGio_PhepNam.get_Range((object)"A1", (object)"A2").MergeCells = true;
                    excelThongKeThangGio_PhepNam.ColumnWidth = 5;
                    Excel.Range excelThongKeThangGio_CheDo;
                    excelThongKeThangGio_CheDo = (ws_ThongKeThang_Gio).get_Range((object)"AR5", (object)"AR6");
                    excelThongKeThangGio_CheDo.Cells[1, 1] = "CĐ";
                    excelThongKeThangGio_CheDo.get_Range((object)"A1", (object)"A2").MergeCells = true;
                    excelThongKeThangGio_CheDo.ColumnWidth = 5;
                    Excel.Range excelThongKeThangGio_Tre;
                    excelThongKeThangGio_Tre = (ws_ThongKeThang_Gio).get_Range((object)"AS5", (object)"AS6");
                    excelThongKeThangGio_Tre.Cells[1, 1] = "Trễ";
                    excelThongKeThangGio_Tre.get_Range((object)"A1", (object)"A2").MergeCells = true;
                    excelThongKeThangGio_Tre.ColumnWidth = 5;
                    Excel.Range excelThongKeThangGio_Som;
                    excelThongKeThangGio_Som = (ws_ThongKeThang_Gio).get_Range((object)"AT5", (object)"AT6");
                    excelThongKeThangGio_Som.Cells[1, 1] = "Sớm";
                    excelThongKeThangGio_Som.get_Range((object)"A1", (object)"A2").MergeCells = true;
                    excelThongKeThangGio_Som.ColumnWidth = 5;
                    Excel.Range excelThongKeThangGio_Total;
                    excelThongKeThangGio_Total = (ws_ThongKeThang_Gio).get_Range((object)"A5", (object)"AT6");
                    excelThongKeThangGio_Total.Font.Name = "Times New Roman";
                    excelThongKeThangGio_Total.Font.Size = "10";
                    excelThongKeThangGio_Total.Font.Bold = true;
                    excelThongKeThangGio_Total.Interior.Color = ColorTranslator.ToOle(Color.Aqua);
                    excelThongKeThangGio_Total.HorizontalAlignment = Excel.Constants.xlCenter;
                    xla_ThongKeThang_Gio.Visible = true;
                    int iDemDongThongKeThangGio;
                    iDemDongThongKeThangGio = 7;
                    new DataTable();
                    DataTable dtNgayTinhCongThongKeThangGio;
                    dtNgayTinhCongThongKeThangGio = _ngayTinhCongBLL.showThongTinNgayTinhCong();
                    for (int iNgayTinhCongThongKeThangGio = 0; iNgayTinhCongThongKeThangGio < dtNgayTinhCongThongKeThangGio.Rows.Count; iNgayTinhCongThongKeThangGio++)
                    {
                        int iTangHang;
                        iTangHang = 7;
                        int iSTTThongKeThangGio;
                        iSTTThongKeThangGio = 1;
                        int iMaChamCongThongKeThangGio;
                        iMaChamCongThongKeThangGio = 0;
                        DateTime dNgayBatDauTinhCongThongKeThangGio;
                        dNgayBatDauTinhCongThongKeThangGio = Convert.ToDateTime(dtNgayTinhCongThongKeThangGio.Rows[iNgayTinhCongThongKeThangGio]["NgayBatDau"].ToString());
                        int iTongNgayTinhCongThongKeThangGio;
                        iTongNgayTinhCongThongKeThangGio = Convert.ToInt32((Convert.ToDateTime(dtNgayTinhCongThongKeThangGio.Rows[iNgayTinhCongThongKeThangGio]["NgayKetThuc"].ToString()) - dNgayBatDauTinhCongThongKeThangGio).TotalDays);
                        new DataTable();
                        _tinhCongDTO.Ngay = dNgayBatDauTinhCong;
                        DataTable dtTinhCongThongKeThangGio;
                        dtTinhCongThongKeThangGio = _tinhCongBLL.TinhCongGetNgay(_tinhCongDTO);
                        for (int iTinhCongThongKeThangGio = 0; iTinhCongThongKeThangGio < dtTinhCongThongKeThangGio.Rows.Count; iTinhCongThongKeThangGio++)
                        {
                            int iDemCotThongKeThangGio;
                            iDemCotThongKeThangGio = 1;
                            if (Convert.ToInt32(dtTinhCongThongKeThangGio.Rows[iTinhCongThongKeThangGio]["MaChamCong"].ToString()) == iMaChamCongThongKeThangGio)
                            {
                                continue;
                            }
                            iMaChamCongThongKeThangGio = Convert.ToInt32(dtTinhCongThongKeThangGio.Rows[iTinhCongThongKeThangGio]["MaChamCong"].ToString());
                            Excel.Range excelThongKeThangGio_STTDuLieu;
                            excelThongKeThangGio_STTDuLieu = (ws_ThongKeThang_Gio).get_Range((object)("A" + iDemDongThongKeThangGio), (object)("A" + iDemDongThongKeThangGio));
                            excelThongKeThangGio_STTDuLieu.Cells[1, 1] = iSTTThongKeThangGio;
                            excelThongKeThangGio_STTDuLieu.Select();
                            Excel.Range excelThongKeThangGio_MaNhanVienDuLieu;
                            excelThongKeThangGio_MaNhanVienDuLieu = (ws_ThongKeThang_Gio).get_Range((object)("C" + iDemDongThongKeThangGio), (object)("C" + iDemDongThongKeThangGio));
                            excelThongKeThangGio_MaNhanVienDuLieu.get_Range((object)"A1", (object)"A1").NumberFormat = "@";
                            excelThongKeThangGio_MaNhanVienDuLieu.Cells[1, 1] = dtTinhCongThongKeThangGio.Rows[iTinhCongThongKeThangGio]["MaNhanVien"].ToString();
                            (ws_ThongKeThang_Gio).get_Range((object)("D" + iDemDongThongKeThangGio), (object)("D" + iDemDongThongKeThangGio)).Cells[1, 1] = dtTinhCongThongKeThangGio.Rows[iTinhCongThongKeThangGio]["TenNhanVien"].ToString();
                            string sTenPhongBan;
                            sTenPhongBan = "";
                            new DataTable();
                            _phongBanDTO.MaPhongBan = dtTinhCongThongKeThangGio.Rows[iTinhCongThongKeThangGio]["PhongBan"].ToString();
                            DataTable dtPhongBan;
                            dtPhongBan = _phongBanBLL.getTenPhongBanByMaPhongBan(_phongBanDTO);
                            for (int iPhongBan = 0; iPhongBan < dtPhongBan.Rows.Count; iPhongBan++)
                            {
                                sTenPhongBan = dtPhongBan.Rows[iPhongBan]["TenPhongBan"].ToString();
                            }
                            Excel.Range excelThongKeThangGio_PhongBanDuLieu;
                            excelThongKeThangGio_PhongBanDuLieu = (ws_ThongKeThang_Gio).get_Range((object)("B" + iDemDongThongKeThangGio), (object)("B" + iDemDongThongKeThangGio));
                            if (sTenPhongBan == "")
                            {
                                excelThongKeThangGio_PhongBanDuLieu.Cells[1, 1] = "-----";
                            }
                            else
                            {
                                excelThongKeThangGio_PhongBanDuLieu.Cells[1, 1] = sTenPhongBan;
                            }
                            new DataTable();
                            _nhanVienDTO.MaChamCong = iMaChamCongThongKeThangGio.ToString();
                            DataTable dtNhanVien;
                            dtNhanVien = _nhanVienBLL.NhanVienGetByMaChamCong(iMaChamCongThongKeThangGio.ToString());
                            for (int iNhanVien = 0; iNhanVien < dtNhanVien.Rows.Count; iNhanVien++)
                            {
                                string sNgayVaoLam;
                                sNgayVaoLam = string.Format("{0:d}", Convert.ToDateTime(dtNhanVien.Rows[iNhanVien]["NgayVaoLamViec"].ToString()));
                                (ws_ThongKeThang_Gio).get_Range((object)("E" + iDemDongThongKeThangGio), (object)("E" + iDemDongThongKeThangGio)).Cells[1, 1] = sNgayVaoLam;
                            }
                            for (int iThongKeThangGio_NgayDuLieu = 0; iThongKeThangGio_NgayDuLieu <= iTongNgayTinhCongThongKeThangGio; iThongKeThangGio_NgayDuLieu++)
                            {
                                string sKyHieu;
                                sKyHieu = "";
                                string sKyHieuPhu;
                                sKyHieuPhu = "";
                                double dGioHangNgay;
                                dGioHangNgay = 0.0;
                                double dDuLieuThongKeThangGio;
                                dDuLieuThongKeThangGio = 0.0;
                                DateTime dNgayChamThongKeGio;
                                dNgayChamThongKeGio = Convert.ToDateTime(dNgayBatDauTinhCong.AddDays(iThongKeThangGio_NgayDuLieu).ToString());
                                new DataTable();
                                _tinhCongDTO.MaChamCong = iMaChamCongThongKeThangGio;
                                _tinhCongDTO.Ngay = dNgayChamThongKeGio;
                                DataTable dtDuLieuNgayThongKeThangGio;
                                dtDuLieuNgayThongKeThangGio = _tinhCongBLL.TinhCongGetMaChamCongAndNgayThongKeGio(_tinhCongDTO);
                                for (int iDuLieuNgayThongKeThangGio = 0; iDuLieuNgayThongKeThangGio < dtDuLieuNgayThongKeThangGio.Rows.Count; iDuLieuNgayThongKeThangGio++)
                                {
                                    dtDuLieuNgayThongKeThangGio.Rows[iDuLieuNgayThongKeThangGio]["Thu"].ToString();
                                    sKyHieu = dtDuLieuNgayThongKeThangGio.Rows[iDuLieuNgayThongKeThangGio]["KyHieu"].ToString();
                                    sKyHieuPhu = dtDuLieuNgayThongKeThangGio.Rows[iDuLieuNgayThongKeThangGio]["KyHieuPhu"].ToString();
                                    dDuLieuThongKeThangGio += Convert.ToDouble(dtDuLieuNgayThongKeThangGio.Rows[iDuLieuNgayThongKeThangGio]["Gio"].ToString());
                                }
                                Excel.Range excelThongKeThangGio_GioDuLieu;
                                excelThongKeThangGio_GioDuLieu = (ws_ThongKeThang_Gio).get_Range((object)("F" + iDemDongThongKeThangGio), (object)("AJ" + iDemDongThongKeThangGio));
                                excelThongKeThangGio_GioDuLieu.Cells[1, iDemCotThongKeThangGio] = dGioHangNgay;
                                if (sKyHieu == sKHVang)
                                {
                                    if (sKyHieuPhu != "CN")
                                    {
                                        excelThongKeThangGio_GioDuLieu.Cells[1, iDemCotThongKeThangGio] = sKHVang;
                                    }
                                    else
                                    {
                                        excelThongKeThangGio_GioDuLieu.Cells[1, iDemCotThongKeThangGio] = "";
                                    }
                                }
                                else if (sKyHieu == sKHDungGio)
                                {
                                    excelThongKeThangGio_GioDuLieu.Cells[1, iDemCotThongKeThangGio] = dDuLieuThongKeThangGio;
                                }
                                else
                                {
                                    excelThongKeThangGio_GioDuLieu.Cells[1, iDemCotThongKeThangGio] = sKyHieu;
                                }
                                iTangCot++;
                                iDemCotThongKeThangGio++;
                            }
                            double dTongNgayCongThongKeThangGio;
                            dTongNgayCongThongKeThangGio = 0.0;
                            double dTongGioTC1ThongKeThangGio;
                            dTongGioTC1ThongKeThangGio = 0.0;
                            double dTongGioTC2ThongKeThangGio;
                            dTongGioTC2ThongKeThangGio = 0.0;
                            double dTongGioTC3ThongKeThangGio;
                            dTongGioTC3ThongKeThangGio = 0.0;
                            double dTongGioTC4ThongKeThangGio;
                            dTongGioTC4ThongKeThangGio = 0.0;
                            double dTongTreThongKeThangGio;
                            dTongTreThongKeThangGio = 0.0;
                            double dTongVeSomThongKeThangGio;
                            dTongVeSomThongKeThangGio = 0.0;
                            double iDemPhepNamThongKeThangGio;
                            iDemPhepNamThongKeThangGio = 0.0;
                            double dTongGioNghiCheDo;
                            dTongGioNghiCheDo = 0.0;
                            double iDemVangThongKeThangGio;
                            iDemVangThongKeThangGio = 0.0;
                            new DataTable();
                            _tinhCongDTO.MaChamCong = iMaChamCongThongKeThangGio;
                            DataTable dtDuLieuTongThongKeThangGio;
                            dtDuLieuTongThongKeThangGio = _tinhCongBLL.TinhCongGetByMaChamCong(_tinhCongDTO);
                            for (int iDuLieuTongThongKeThangGio = 0; iDuLieuTongThongKeThangGio < dtDuLieuTongThongKeThangGio.Rows.Count; iDuLieuTongThongKeThangGio++)
                            {
                                if (dtDuLieuTongThongKeThangGio.Rows[iDuLieuTongThongKeThangGio]["KyHieu"].ToString() == sKHDungGio)
                                {
                                    dTongNgayCongThongKeThangGio += Convert.ToDouble(dtDuLieuTongThongKeThangGio.Rows[iDuLieuTongThongKeThangGio]["Gio"].ToString());
                                }
                                dTongGioTC1ThongKeThangGio += Convert.ToDouble(dtDuLieuTongThongKeThangGio.Rows[iDuLieuTongThongKeThangGio]["TC1"].ToString());
                                dTongGioTC2ThongKeThangGio += Convert.ToDouble(dtDuLieuTongThongKeThangGio.Rows[iDuLieuTongThongKeThangGio]["TC2"].ToString());
                                dTongGioTC3ThongKeThangGio += Convert.ToDouble(dtDuLieuTongThongKeThangGio.Rows[iDuLieuTongThongKeThangGio]["TC3"].ToString());
                                dTongGioTC4ThongKeThangGio += Convert.ToDouble(dtDuLieuTongThongKeThangGio.Rows[iDuLieuTongThongKeThangGio]["TC4"].ToString());
                                dTongTreThongKeThangGio += Convert.ToDouble(dtDuLieuTongThongKeThangGio.Rows[iDuLieuTongThongKeThangGio]["Tre"].ToString());
                                dTongVeSomThongKeThangGio += Convert.ToDouble(dtDuLieuTongThongKeThangGio.Rows[iDuLieuTongThongKeThangGio]["VeSom"].ToString());
                                string sKyHieuDuLieuThongKeThang;
                                sKyHieuDuLieuThongKeThang = dtDuLieuTongThongKeThangGio.Rows[iDuLieuTongThongKeThangGio]["KyHieu"].ToString();
                                if (sKyHieuDuLieuThongKeThang == sKHPhepNam)
                                {
                                    iDemPhepNamThongKeThangGio += Convert.ToDouble(dtDuLieuTongThongKeThangGio.Rows[iDuLieuTongThongKeThangGio]["Gio"].ToString());
                                }
                                if (sKyHieuDuLieuThongKeThang == sKHVang)
                                {
                                    iDemVangThongKeThangGio += 1.0;
                                }
                                if (sKyHieuDuLieuThongKeThang != sKHVang && sKyHieuDuLieuThongKeThang != sKHDungGio && sKyHieuDuLieuThongKeThang != sKHPhepNam && sKyHieuDuLieuThongKeThang != sKHLe)
                                {
                                    dTongGioNghiCheDo += Convert.ToDouble(dtDuLieuTongThongKeThangGio.Rows[iDuLieuTongThongKeThangGio]["Gio"].ToString());
                                }
                            }
                            (ws_ThongKeThang_Gio).get_Range((object)("AK" + iDemDongThongKeThangGio), (object)("AK" + iDemDongThongKeThangGio)).Cells[1, 1] = dTongNgayCongThongKeThangGio;
                            (ws_ThongKeThang_Gio).get_Range((object)("AL" + iDemDongThongKeThangGio), (object)("AL" + iDemDongThongKeThangGio)).Cells[1, 1] = dTongGioTC1ThongKeThangGio;
                            (ws_ThongKeThang_Gio).get_Range((object)("AM" + iDemDongThongKeThangGio), (object)("AM" + iDemDongThongKeThangGio)).Cells[1, 1] = dTongGioTC2ThongKeThangGio;
                            (ws_ThongKeThang_Gio).get_Range((object)("AN" + iDemDongThongKeThangGio), (object)("AN" + iDemDongThongKeThangGio)).Cells[1, 1] = dTongGioTC3ThongKeThangGio;
                            (ws_ThongKeThang_Gio).get_Range((object)("AO" + iDemDongThongKeThangGio), (object)("AO" + iDemDongThongKeThangGio)).Cells[1, 1] = dTongGioTC4ThongKeThangGio;
                            (ws_ThongKeThang_Gio).get_Range((object)("AP" + iDemDongThongKeThangGio), (object)("AP" + iDemDongThongKeThangGio)).Cells[1, 1] = iDemVangThongKeThangGio * 8.0;
                            (ws_ThongKeThang_Gio).get_Range((object)("AQ" + iDemDongThongKeThangGio), (object)("AQ" + iDemDongThongKeThangGio)).Cells[1, 1] = iDemPhepNamThongKeThangGio;
                            (ws_ThongKeThang_Gio).get_Range((object)("AR" + iDemDongThongKeThangGio), (object)("AR" + iDemDongThongKeThangGio)).Cells[1, 1] = dTongGioNghiCheDo;
                            (ws_ThongKeThang_Gio).get_Range((object)("AS" + iDemDongThongKeThangGio), (object)("AS" + iDemDongThongKeThangGio)).Cells[1, 1] = dTongTreThongKeThangGio;
                            (ws_ThongKeThang_Gio).get_Range((object)("AT" + iDemDongThongKeThangGio), (object)("AT" + iDemDongThongKeThangGio)).Cells[1, 1] = dTongVeSomThongKeThangGio;
                            iTangHang++;
                            iDemDongThongKeThangGio++;
                            iSTTThongKeThangGio++;
                        }
                    }
                    Excel.Range excelThongKeThangGio_DinhDangDuLieu;
                    excelThongKeThangGio_DinhDangDuLieu = (ws_ThongKeThang_Gio).get_Range((object)"A7", (object)("AT" + (iDemDongThongKeThangGio - 1)));
                    excelThongKeThangGio_DinhDangDuLieu.Font.Name = "Times New Roman";
                    excelThongKeThangGio_DinhDangDuLieu.Font.Size = "8";
                    excelThongKeThangGio_DinhDangDuLieu.HorizontalAlignment = Excel.Constants.xlCenter;
                    (ws_ThongKeThang_Gio).get_Range((object)"A4", (object)("AT" + (iDemDongThongKeThangGio - 1))).Borders.LineStyle = Excel.Constants.xlBoth;
                    failed = false;
                }
                catch (COMException)
                {
                    failed = true;
                }
                Thread.Sleep(10);
            }
            while (failed);
        }

        public DataTable GetDataTable(DataGridView dgvtemp)
        {
            DataTable DTT;
            DTT = new DataTable();
            while (DTT.Rows.Count < dgvtemp.Rows.Count - 1)
            {
                DTT.Rows.Add();
            }
            for (int i = 0; i < dgvtemp.Columns.Count; i++)
            {
                DTT.Columns.Add(dgvtemp.Columns[i].Name.ToString());
                for (int j = 0; j < dgvtemp.Rows.Count - 1; j++)
                {
                    DTT.Rows[j][i] = DGVTinhCong[i, j].Value.ToString();
                }
            }
            return DTT;
        }

        private void txtTimKiem_TextChanged(object sender, EventArgs e)
        {
            if (txtTimKiem.Text != "")
            {
                DGVDanhSachNhanVien.Rows.Clear();
                new DataTable();
                _nhanVienDTO.MaNhanVien = txtTimKiem.Text;
                _nhanVienDTO.TenNhanVien = txtTimKiem.Text;
                DataTable dtSearchNhanVienTinhCong;
                dtSearchNhanVienTinhCong = _nhanVienBLL.NhanVienSearchTinhCong(txtTimKiem.Text);
                for (int iSearchNhanVienTinhCong = 0; iSearchNhanVienTinhCong < dtSearchNhanVienTinhCong.Rows.Count; iSearchNhanVienTinhCong++)
                {
                    int addSerchTinhCong;
                    addSerchTinhCong = DGVDanhSachNhanVien.Rows.Add();
                    DGVDanhSachNhanVien.Rows[addSerchTinhCong].Cells[1].Value = dtSearchNhanVienTinhCong.Rows[iSearchNhanVienTinhCong]["MaNhanVien"].ToString();
                    DGVDanhSachNhanVien.Rows[addSerchTinhCong].Cells[2].Value = dtSearchNhanVienTinhCong.Rows[iSearchNhanVienTinhCong]["TenNhanVien"].ToString();
                    DGVDanhSachNhanVien.Rows[addSerchTinhCong].Cells[3].Value = dtSearchNhanVienTinhCong.Rows[iSearchNhanVienTinhCong]["MaChamCong"].ToString();
                    DGVDanhSachNhanVien.Rows[addSerchTinhCong].Cells[4].Value = dtSearchNhanVienTinhCong.Rows[iSearchNhanVienTinhCong]["NgayVaoLamViec"].ToString();
                    DGVDanhSachNhanVien.Rows[addSerchTinhCong].Cells[5].Value = _convertMoney.chendau(Convert.ToInt32(dtSearchNhanVienTinhCong.Rows[iSearchNhanVienTinhCong]["TienLuong"]).ToString());
                    DGVDanhSachNhanVien.Rows[addSerchTinhCong].Cells[6].Value = dtSearchNhanVienTinhCong.Rows[iSearchNhanVienTinhCong]["DangThamGiaBaoHiem"].ToString();
                    DGVDanhSachNhanVien.Rows[addSerchTinhCong].Cells[7].Value = dtSearchNhanVienTinhCong.Rows[iSearchNhanVienTinhCong]["MaPhongBan"].ToString();
                    DGVDanhSachNhanVien.Rows[addSerchTinhCong].Cells[8].Value = _convertMoney.chendau(Convert.ToInt32(dtSearchNhanVienTinhCong.Rows[iSearchNhanVienTinhCong]["LuongHopDong"]).ToString());
                }
            }
        }

        private void checkBoxCoTinhLuong_CheckedChanged(object sender, EventArgs e)
        {
            if (checkBoxCoTinhLuong.Checked)
            {
                txtNgayCongTinh.Enabled = true;
            }
            else
            {
                txtNgayCongTinh.Enabled = false;
            }
        }

        private void DGVTinhCong_CellClick(object sender, DataGridViewCellEventArgs e)
        {
        }

        private void tabControl2_Click(object sender, EventArgs e)
        {
        }

        private void ThemGioToolStripMenuItem_Click(object sender, EventArgs e)
        {

        }

        private void XoaGioToolStripMenuItem_Click(object sender, EventArgs e)
        {

        }

        private void SuaGioToolStripMenuItem_Click(object sender, EventArgs e)
        {

        }
        private void DGVSuaXoaGioCham_CellClick(object sender, DataGridViewCellEventArgs e)
        {
            this.sMaChamCongSuaXoaGioCham = this.DGVSuaXoaGioCham.CurrentRow.Cells[0].Value.ToString();
            this.sNgayChamSuaXoaGioCham = this.DGVSuaXoaGioCham.CurrentRow.Cells[1].Value.ToString();
            this.sGioChamSuaXoaGioCham = this.DGVSuaXoaGioCham.CurrentRow.Cells[2].Value.ToString();
            this.sKieuChamSuaXoaGioCham = this.DGVSuaXoaGioCham.CurrentRow.Cells[3].Value.ToString();
            this.sMaSoMaySuaXoaGioCham = this.DGVSuaXoaGioCham.CurrentRow.Cells[5].Value.ToString();
            this.sIDSuaXoaGioCham = this.DGVSuaXoaGioCham.CurrentRow.Cells[7].Value.ToString();
        }
        private void btnXoa_Click(object sender, EventArgs e)
        {
            //this._checkInOutDTO.ID = Convert.ToInt32(this.sIDSuaXoaGioCham);
            //this._checkInOutBLL.CheckInOutDeleteGioCham(this._checkInOutDTO);
            //MessageBox.Show("Bạn hãy tính công lại");
        }
        private void btnSua_Click(object sender, EventArgs e)
        {
            //frmSuaXoaGioCham _suaXoaGioCham;
            //_suaXoaGioCham = new frmSuaXoaGioCham();
            //_suaXoaGioCham._MaChamCong = this.sMaChamCongSuaXoaGioCham;
            //_suaXoaGioCham._NgayCham = this.sNgayChamSuaXoaGioCham;
            //_suaXoaGioCham._GioCham = this.sGioChamSuaXoaGioCham;
            //_suaXoaGioCham._KieuCham = this.sKieuChamSuaXoaGioCham;
            //_suaXoaGioCham._MaSoMay = this.sMaSoMaySuaXoaGioCham;
            //_suaXoaGioCham._ID = this.sIDSuaXoaGioCham;
            //_suaXoaGioCham.ShowDialog();
        }
        private void button1_Click(object sender, EventArgs e)
        {
            //if (this.sMaChamCongThemGio == "" || this.sMaChamCongThemGio == null)
            //{
            //    MessageBox.Show("Chưa chọn nhân viên");
            //    return;
            //}
            //frmThemGioNhanh _themgionhanh;
            //_themgionhanh = new frmThemGioNhanh();
            //_themgionhanh._MaChamCong = this.sMaChamCongThemGio;
            //_themgionhanh._dNgayCham = this.dNgayChamCongThemGio;
            //_themgionhanh.ShowDialog();
        }

        private void button2_Click(object sender, EventArgs e)
        {
            //if (this.sMaChamCongThemGio == "" || this.sMaChamCongThemGio == null)
            //{
            //    MessageBox.Show("Chưa chọn nhân viên");
            //    return;
            //}
            //frmXoaGio _frmXoaGio;
            //_frmXoaGio = new frmXoaGio();
            //_frmXoaGio.dXoaGioChamVao = this.dGioChamVaoThemGioCheck;
            //_frmXoaGio.dXoaGioChamRa = this.dGioChamRaThemGioCheck;
            //_frmXoaGio.sMaChamCongXoaGio = this.sMaChamCongThemGio;
            //_frmXoaGio.iCheckVao = this.iCheckTrongVao;
            //_frmXoaGio.iCheckRa = this.iCheckTrongRa;
            //_frmXoaGio.Show();
        }

        private void btnSuaGio_Click(object sender, EventArgs e)
        {

        }
    }
}
